<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Mail::Body</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Mail::Body 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/mail/body_rb.html">lib/mail/body.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <h1><a href="Body.html">Body</a></h1>
<p>
The body is where the text of the email is stored. Mail treats the body as
a single object. The body itself has no information about boundaries used
in the MIME standard, it just looks at it&#8217;s content as either a
single block of text, or (if it is a multipart message) as an array of
blocks o text.
</p>
<p>
A body has to be told to split itself up into a multipart message by
calling split with the correct boundary. This is because the body object
has no way of knowing what the correct boundary is for itself (there could
be many boundaries in a body in the case of a nested MIME text).
</p>
<p>
Once split is called, <a href="Body.html">Mail::Body</a> will slice itself
up on this boundary, assigning anything that appears before the first part
to the preamble, and anything that appears after the closing boundary to
the epilogue, then each part gets initialized into a <a
href="Part.html">Mail::Part</a> object.
</p>
<p>
The boundary that is used to split up the <a href="Body.html">Body</a> is
also stored in the <a href="Body.html">Body</a> object for use on encoding
itself back out to a string. You can overwrite this if it needs to be
changed.
</p>
<p>
On encoding, the body will return the preamble, then each part joined by
the boundary, followed by a closing boundary string and then the epilogue.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M000036"><<</a>,</li>
                
                <li><a href="#M000007">==</a>,</li>
                
                <li><a href="#M000008">=~</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000033">boundary</a>,</li>
                
                <li><a href="#M000034">boundary=</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000021">charset</a>,</li>
                
                <li><a href="#M000022">charset=</a>,</li>
                
                <li><a href="#M000040">crlf_boundary</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000019">decoded</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000039">empty?</a>,</li>
                
                <li><a href="#M000015">encoded</a>,</li>
                
                <li><a href="#M000023">encoding</a>,</li>
                
                <li><a href="#M000025">encoding=</a>,</li>
                
                <li><a href="#M000041">end_boundary</a>,</li>
                
                <li><a href="#M000028">epilogue</a>,</li>
                
                <li><a href="#M000031">epilogue=</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000014">get_best_encoding</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000010">include?</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000009">match</a>,</li>
                
                <li><a href="#M000032">multipart?</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000006">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000038">only_us_ascii?</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000035">parts</a>,</li>
                
                <li><a href="#M000026">preamble</a>,</li>
                
                <li><a href="#M000027">preamble=</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000013">raw_source</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000042">set_charset</a>,</li>
                
                <li><a href="#M000011">set_sort_order</a>,</li>
                
                <li><a href="#M000012">sort_parts!</a>,</li>
                
                <li><a href="#M000037">split!</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000020">to_s</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000006">
                    
                    <a name="M000006"></a><b>new</b>(string = '')
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000006_source')" id="l_M000006_source">show</a>
                        
                    </p>
                    <div id="M000006_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/mail/body.rb, line 29</span>
29:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">string</span> = <span class="ruby-value str">''</span>)
30:       <span class="ruby-ivar">@boundary</span> = <span class="ruby-keyword kw">nil</span>
31:       <span class="ruby-ivar">@preamble</span> = <span class="ruby-keyword kw">nil</span>
32:       <span class="ruby-ivar">@epilogue</span> = <span class="ruby-keyword kw">nil</span>
33:       <span class="ruby-ivar">@charset</span>  = <span class="ruby-keyword kw">nil</span>
34:       <span class="ruby-ivar">@part_sort_order</span> = [ <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-value str">&quot;text/enriched&quot;</span>, <span class="ruby-value str">&quot;text/html&quot;</span> ]
35:       <span class="ruby-ivar">@parts</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">PartsList</span>.<span class="ruby-identifier">new</span>
36:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">blank?</span>
37:         <span class="ruby-ivar">@raw_source</span> = <span class="ruby-value str">''</span>
38:       <span class="ruby-keyword kw">else</span>
39:         <span class="ruby-comment cmt"># Do join first incase we have been given an Array in Ruby 1.9</span>
40:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:join</span>)
41:           <span class="ruby-ivar">@raw_source</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
42:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_s</span>)
43:           <span class="ruby-ivar">@raw_source</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">to_s</span>
44:         <span class="ruby-keyword kw">else</span>
45:           <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;You can only assign a string or an object that responds_to? :join or :to_s to a body.&quot;</span>
46:         <span class="ruby-keyword kw">end</span>
47:       <span class="ruby-keyword kw">end</span>
48:       <span class="ruby-ivar">@encoding</span> = (<span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-value">? </span><span class="ruby-value str">'7bit'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'8bit'</span>)
49:       <span class="ruby-identifier">set_charset</span>
50:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000036">
                    
                    <a name="M000036"></a><b>&lt;&lt;</b>( val )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000036_source')" id="l_M000036_source">show</a>
                        
                    </p>
                    <div id="M000036_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 250</span>
250:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>( <span class="ruby-identifier">val</span> )
251:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>
252:         <span class="ruby-ivar">@parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">val</span>
253:       <span class="ruby-keyword kw">else</span>
254:         <span class="ruby-ivar">@parts</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">PartsList</span>.<span class="ruby-identifier">new</span>[<span class="ruby-identifier">val</span>]
255:       <span class="ruby-keyword kw">end</span>
256:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000007">
                    
                    <a name="M000007"></a><b>==</b>(other)
                    
                </div>
                
                <div class="description">
                  <p>
Matches this body with another body. Also matches the decoded value of this
body with a string.
</p>
<p>
Examples:
</p>
<pre>
  body = Mail::Body.new('The body')
  body == body #=&gt; true

  body = Mail::Body.new('The body')
  body == 'The body' #=&gt; true

  body = Mail::Body.new(&quot;VGhlIGJvZHk=\n&quot;)
  body.encoding = 'base64'
  body == &quot;The body&quot; #=&gt; true
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/mail/body.rb, line 66</span>
66:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
67:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
68:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decoded</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
69:       <span class="ruby-keyword kw">else</span>
70:         <span class="ruby-keyword kw">super</span>
71:       <span class="ruby-keyword kw">end</span>
72:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000008">
                    
                    <a name="M000008"></a><b>=~</b>(regexp)
                    
                </div>
                
                <div class="description">
                  <p>
Accepts a string and performs a regular expression against the decoded text
</p>
<p>
Examples:
</p>
<pre>
  body = Mail::Body.new('The body')
  body =~ /The/ #=&gt; 0

  body = Mail::Body.new(&quot;VGhlIGJvZHk=\n&quot;)
  body.encoding = 'base64'
  body =~ /The/ #=&gt; 0
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000008_source')" id="l_M000008_source">show</a>
                        
                    </p>
                    <div id="M000008_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/mail/body.rb, line 84</span>
84:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">=~</span>(<span class="ruby-identifier">regexp</span>)
85:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decoded</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">regexp</span>
86:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000033">
                    
                    <a name="M000033"></a><b>boundary</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the boundary used by the body
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000033_source')" id="l_M000033_source">show</a>
                        
                    </p>
                    <div id="M000033_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 237</span>
237:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">boundary</span>
238:       <span class="ruby-ivar">@boundary</span>
239:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000034">
                    
                    <a name="M000034"></a><b>boundary=</b>( val )
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to change the boundary of this <a href="Body.html">Body</a>
object
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000034_source')" id="l_M000034_source">show</a>
                        
                    </p>
                    <div id="M000034_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 242</span>
242:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">boundary=</span>( <span class="ruby-identifier">val</span> )
243:       <span class="ruby-ivar">@boundary</span> = <span class="ruby-identifier">val</span>
244:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000021">
                    
                    <a name="M000021"></a><b>charset</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000021_source')" id="l_M000021_source">show</a>
                        
                    </p>
                    <div id="M000021_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 187</span>
187:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">charset</span>
188:       <span class="ruby-ivar">@charset</span>
189:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000022">
                    
                    <a name="M000022"></a><b>charset=</b>( val )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000022_source')" id="l_M000022_source">show</a>
                        
                    </p>
                    <div id="M000022_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 191</span>
191:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">charset=</span>( <span class="ruby-identifier">val</span> )
192:       <span class="ruby-ivar">@charset</span> = <span class="ruby-identifier">val</span>
193:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000019">
                    
                    <a name="M000019"></a><b>decoded</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000019_source')" id="l_M000019_source">show</a>
                        
                    </p>
                    <div id="M000019_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 175</span>
175:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">decoded</span>
176:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">defined?</span>(<span class="ruby-identifier">encoding</span>)
177:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">UnknownEncodingType</span>, <span class="ruby-node">&quot;Don't know how to decode #{encoding}, please call #encoded and decode it yourself.&quot;</span>
178:       <span class="ruby-keyword kw">else</span>
179:         <span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">encoding</span>).<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">raw_source</span>)
180:       <span class="ruby-keyword kw">end</span>
181:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000039">
                    
                    <a name="M000039"></a><b>empty?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show</a>
                        
                    </p>
                    <div id="M000039_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 273</span>
273:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
274:       <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">raw_source</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
275:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000015">
                    
                    <a name="M000015"></a><b>encoded</b>(transfer_encoding = '8bit')
                    
                </div>
                
                <div class="description">
                  <p>
Returns a body encoded using transfer_encoding. Multipart always uses an
identiy encoding (i.e. no encoding). Calling this directly is not a good
idea, but supported for compatibility TODO: Validate that preamble and
epilogue are valid for requested encoding
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoded</span>(<span class="ruby-identifier">transfer_encoding</span> = <span class="ruby-value str">'8bit'</span>)
151:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">multipart?</span>
152:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">sort_parts!</span>
153:         <span class="ruby-identifier">encoded_parts</span> = <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">encoded</span> }
154:         ([<span class="ruby-identifier">preamble</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">encoded_parts</span>).<span class="ruby-identifier">join</span>(<span class="ruby-identifier">crlf_boundary</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">end_boundary</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">epilogue</span>.<span class="ruby-identifier">to_s</span>
155:       <span class="ruby-keyword kw">else</span>
156:         <span class="ruby-identifier">be</span> = <span class="ruby-identifier">get_best_encoding</span>(<span class="ruby-identifier">transfer_encoding</span>)
157:         <span class="ruby-identifier">dec</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">encoding</span>)
158:         <span class="ruby-identifier">enc</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">be</span>)
159:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">transfer_encoding</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">encoding</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">nil?</span>
160:             <span class="ruby-comment cmt"># Cannot decode, so skip normalization</span>
161:             <span class="ruby-identifier">raw_source</span>
162:         <span class="ruby-keyword kw">else</span>
163:             <span class="ruby-comment cmt"># Decode then encode to normalize and allow transforming </span>
164:             <span class="ruby-comment cmt"># from base64 to Q-P and vice versa</span>
165:             <span class="ruby-identifier">decoded</span> = <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">raw_source</span>)
166:             <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">charset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">charset</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;US-ASCII&quot;</span>
167:               <span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">encode!</span>(<span class="ruby-identifier">charset</span>)
168:               <span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-value str">'BINARY'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">charset</span>).<span class="ruby-identifier">ascii_compatible?</span>
169:             <span class="ruby-keyword kw">end</span>
170:             <span class="ruby-identifier">enc</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">decoded</span>)
171:         <span class="ruby-keyword kw">end</span>
172:       <span class="ruby-keyword kw">end</span>
173:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000023">
                    
                    <a name="M000023"></a><b>encoding</b>(val = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show</a>
                        
                    </p>
                    <div id="M000023_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoding</span>(<span class="ruby-identifier">val</span> = <span class="ruby-keyword kw">nil</span>)
196:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>
197:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">val</span>
198:       <span class="ruby-keyword kw">else</span>
199:         <span class="ruby-ivar">@encoding</span>
200:       <span class="ruby-keyword kw">end</span>
201:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000025">
                    
                    <a name="M000025"></a><b>encoding=</b>( val )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show</a>
                        
                    </p>
                    <div id="M000025_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 203</span>
203:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoding=</span>( <span class="ruby-identifier">val</span> )
204:       <span class="ruby-ivar">@encoding</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;text&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">blank?</span>
205:           (<span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-value">? </span><span class="ruby-value str">'7bit'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'8bit'</span>)
206:       <span class="ruby-keyword kw">else</span>
207:           <span class="ruby-identifier">val</span>
208:       <span class="ruby-keyword kw">end</span>
209:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000028">
                    
                    <a name="M000028"></a><b>epilogue</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the epilogue (any text that is after the last MIME boundary)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000028_source')" id="l_M000028_source">show</a>
                        
                    </p>
                    <div id="M000028_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 222</span>
222:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">epilogue</span>
223:       <span class="ruby-ivar">@epilogue</span>
224:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000031">
                    
                    <a name="M000031"></a><b>epilogue=</b>( val )
                    
                </div>
                
                <div class="description">
                  <p>
Sets the epilogue to a string (adds text after the last MIME boundary)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000031_source')" id="l_M000031_source">show</a>
                        
                    </p>
                    <div id="M000031_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 227</span>
227:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">epilogue=</span>( <span class="ruby-identifier">val</span> )
228:       <span class="ruby-ivar">@epilogue</span> = <span class="ruby-identifier">val</span>
229:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000014">
                    
                    <a name="M000014"></a><b>get_best_encoding</b>(target)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 141</span>
141:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_best_encoding</span>(<span class="ruby-identifier">target</span>)
142:       <span class="ruby-identifier">target_encoding</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">target</span>)
143:       <span class="ruby-identifier">target_encoding</span>.<span class="ruby-identifier">get_best_compatible</span>(<span class="ruby-identifier">encoding</span>, <span class="ruby-identifier">raw_source</span>)
144:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000010">
                    
                    <a name="M000010"></a><b>include?</b>(other)
                    
                </div>
                
                <div class="description">
                  <p>
Accepts anything that responds to <a href="Body.html#M000020">to_s</a> and
checks if it&#8217;s a substring of the decoded text
</p>
<p>
Examples:
</p>
<pre>
  body = Mail::Body.new('The body')
  body.include?('The') #=&gt; true

  body = Mail::Body.new(&quot;VGhlIGJvZHk=\n&quot;)
  body.encoding = 'base64'
  body.include?('The') #=&gt; true
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000010_source')" id="l_M000010_source">show</a>
                        
                    </p>
                    <div id="M000010_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 112</span>
112:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include?</span>(<span class="ruby-identifier">other</span>)
113:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_s</span>)
114:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000009">
                    
                    <a name="M000009"></a><b>match</b>(regexp)
                    
                </div>
                
                <div class="description">
                  <p>
Accepts a string and performs a regular expression against the decoded text
</p>
<p>
Examples:
</p>
<pre>
  body = Mail::Body.new('The body')
  body.match(/The/) #=&gt; #&lt;MatchData &quot;The&quot;&gt;

  body = Mail::Body.new(&quot;VGhlIGJvZHk=\n&quot;)
  body.encoding = 'base64'
  body.match(/The/) #=&gt; #&lt;MatchData &quot;The&quot;&gt;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000009_source')" id="l_M000009_source">show</a>
                        
                    </p>
                    <div id="M000009_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 98</span>
 98:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">regexp</span>)
 99:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">regexp</span>)
100:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000032">
                    
                    <a name="M000032"></a><b>multipart?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if there are parts defined in the body
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000032_source')" id="l_M000032_source">show</a>
                        
                    </p>
                    <div id="M000032_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 232</span>
232:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">multipart?</span>
233:       <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">empty?</span>
234:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000038">
                    
                    <a name="M000038"></a><b>only_us_ascii?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000038_source')" id="l_M000038_source">show</a>
                        
                    </p>
                    <div id="M000038_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 269</span>
269:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">only_us_ascii?</span>
270:       <span class="ruby-operator">!</span>(<span class="ruby-identifier">raw_source</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[^\x01-\x7f]/</span>)
271:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000035">
                    
                    <a name="M000035"></a><b>parts</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000035_source')" id="l_M000035_source">show</a>
                        
                    </p>
                    <div id="M000035_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 246</span>
246:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parts</span>
247:       <span class="ruby-ivar">@parts</span>
248:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000026">
                    
                    <a name="M000026"></a><b>preamble</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the preamble (any text that is before the first MIME boundary)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show</a>
                        
                    </p>
                    <div id="M000026_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 212</span>
212:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preamble</span>
213:       <span class="ruby-ivar">@preamble</span>
214:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000027">
                    
                    <a name="M000027"></a><b>preamble=</b>( val )
                    
                </div>
                
                <div class="description">
                  <p>
Sets the preamble to a string (adds text before the first MIME boundary)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000027_source')" id="l_M000027_source">show</a>
                        
                    </p>
                    <div id="M000027_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 217</span>
217:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preamble=</span>( <span class="ruby-identifier">val</span> )
218:       <span class="ruby-ivar">@preamble</span> = <span class="ruby-identifier">val</span>
219:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000013">
                    
                    <a name="M000013"></a><b>raw_source</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the raw source that the body was initialized with, without any
tampering
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000013_source')" id="l_M000013_source">show</a>
                        
                    </p>
                    <div id="M000013_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 137</span>
137:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">raw_source</span>
138:       <span class="ruby-ivar">@raw_source</span>
139:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000011">
                    
                    <a name="M000011"></a><b>set_sort_order</b>(order)
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to set the sort order of the parts, overriding the default sort
order. Defaults to &#8216;text/plain&#8217;, then
&#8216;text/enriched&#8217;, then &#8216;text/html&#8217; with any other
content type coming after.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_sort_order</span>(<span class="ruby-identifier">order</span>)
120:       <span class="ruby-ivar">@part_sort_order</span> = <span class="ruby-identifier">order</span>
121:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000012">
                    
                    <a name="M000012"></a><b>sort_parts!</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to sort the parts according to the default sort order, or the
sort order you set with :set_sort_order.
</p>
<p>
sort_parts! is also called from :encode, so there is no need for you to
call this explicitly
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 127</span>
127:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sort_parts!</span>
128:       <span class="ruby-ivar">@parts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
129:         <span class="ruby-identifier">p</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">set_sort_order</span>(<span class="ruby-ivar">@part_sort_order</span>)
130:         <span class="ruby-ivar">@parts</span>.<span class="ruby-identifier">sort!</span>(<span class="ruby-ivar">@part_sort_order</span>)
131:         <span class="ruby-identifier">p</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">sort_parts!</span>
132:       <span class="ruby-keyword kw">end</span>
133:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000037">
                    
                    <a name="M000037"></a><b>split!</b>(boundary)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show</a>
                        
                    </p>
                    <div id="M000037_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 258</span>
258:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">split!</span>(<span class="ruby-identifier">boundary</span>)
259:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">boundary</span> = <span class="ruby-identifier">boundary</span>
260:       <span class="ruby-identifier">parts</span> = <span class="ruby-identifier">raw_source</span>.<span class="ruby-identifier">split</span>(<span class="ruby-node">&quot;--#{boundary}&quot;</span>)
261:       <span class="ruby-comment cmt"># Make the preamble equal to the preamble (if any)</span>
262:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">preamble</span> = <span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
263:       <span class="ruby-comment cmt"># Make the epilogue equal to the epilogue (if any)</span>
264:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">epilogue</span> = <span class="ruby-identifier">parts</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">'--'</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">strip</span>
265:       <span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Part</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">part</span>) }
266:       <span class="ruby-keyword kw">self</span>
267:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000020">
                    
                    <a name="M000020"></a><b>to_s</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000020_source')" id="l_M000020_source">show</a>
                        
                    </p>
                    <div id="M000020_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 183</span>
183:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
184:       <span class="ruby-identifier">decoded</span>
185:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000040">
                    
                    <a name="M000040"></a><b>crlf_boundary</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000040_source')" id="l_M000040_source">show</a>
                        
                    </p>
                    <div id="M000040_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 279</span>
279:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">crlf_boundary</span>
280:       <span class="ruby-node">&quot;\r\n\r\n--#{boundary}\r\n&quot;</span>
281:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000041">
                    
                    <a name="M000041"></a><b>end_boundary</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000041_source')" id="l_M000041_source">show</a>
                        
                    </p>
                    <div id="M000041_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 283</span>
283:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">end_boundary</span>
284:       <span class="ruby-node">&quot;\r\n\r\n--#{boundary}--\r\n&quot;</span>
285:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000042">
                    
                    <a name="M000042"></a><b>set_charset</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000042_source')" id="l_M000042_source">show</a>
                        
                    </p>
                    <div id="M000042_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/mail/body.rb, line 287</span>
287:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_charset</span>
288:       <span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@charset</span> = <span class="ruby-value str">'US-ASCII'</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@charset</span> = <span class="ruby-keyword kw">nil</span>
289:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    