<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Net::NTLM</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            Net::NTLM 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/net/ntlm_rb.html">lib/net/ntlm.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000006">apply_des</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000000">decode_utf16le</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000001">encode_utf16le</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000005">gen_keys</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000007">lm_hash</a>,</li>
                
                <li><a href="#M000010">lm_response</a>,</li>
                
                <li><a href="#M000013">lmv2_response</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000014">ntlm2_session</a>,</li>
                
                <li><a href="#M000008">ntlm_hash</a>,</li>
                
                <li><a href="#M000011">ntlm_response</a>,</li>
                
                <li><a href="#M000009">ntlmv2_hash</a>,</li>
                
                <li><a href="#M000012">ntlmv2_response</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000002">pack_int64le</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000004">split7</a>,</li>
                
                <li><a href="#M000003">swap16</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="NTLM/VERSION.html">Net::NTLM::VERSION</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/Field.html">Net::NTLM::Field</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/FieldSet.html">Net::NTLM::FieldSet</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/Int16LE.html">Net::NTLM::Int16LE</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/Int32LE.html">Net::NTLM::Int32LE</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/Int64LE.html">Net::NTLM::Int64LE</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/Message.html">Net::NTLM::Message</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/SecurityBuffer.html">Net::NTLM::SecurityBuffer</a></li>
        
        <li><span class="type">CLASS</span> <a href="NTLM/String.html">Net::NTLM::String</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">SSP_SIGN</td>
            <td>=</td>
            <td class="attr-value">&quot;NTLMSSP\0&quot;</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">BLOB_SIGN</td>
            <td>=</td>
            <td class="attr-value">0x00000101</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">LM_MAGIC</td>
            <td>=</td>
            <td class="attr-value">&quot;KGS!@\#$%&quot;</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TIME_OFFSET</td>
            <td>=</td>
            <td class="attr-value">11644473600</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">MAX64</td>
            <td>=</td>
            <td class="attr-value">0xffffffffffffffff</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">FLAGS</td>
            <td>=</td>
            <td class="attr-value">{       :UNICODE              =&gt; 0x00000001,       :OEM                  =&gt; 0x00000002,       :REQUEST_TARGET       =&gt; 0x00000004,   #   :UNKNOWN              =&gt; 0x00000008,       :SIGN                 =&gt; 0x00000010,       :SEAL                 =&gt; 0x00000020,   #   :UNKNOWN              =&gt; 0x00000040,       :NETWARE              =&gt; 0x00000100,       :NTLM                 =&gt; 0x00000200,   #   :UNKNOWN              =&gt; 0x00000400,   #   :UNKNOWN              =&gt; 0x00000800,       :DOMAIN_SUPPLIED      =&gt; 0x00001000,       :WORKSTATION_SUPPLIED =&gt; 0x00002000,       :LOCAL_CALL           =&gt; 0x00004000,       :ALWAYS_SIGN          =&gt; 0x00008000,       :TARGET_TYPE_DOMAIN   =&gt; 0x00010000,       :TARGET_INFO          =&gt; 0x00800000,       :NTLM2_KEY            =&gt; 0x00080000,       :KEY128               =&gt; 0x20000000,       :KEY56                =&gt; 0x80000000     }</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">FLAG_KEYS</td>
            <td>=</td>
            <td class="attr-value">FLAGS.keys.sort{|a, b| FLAGS[a] &lt;=&gt; FLAGS[b] }</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DEFAULT_FLAGS</td>
            <td>=</td>
            <td class="attr-value">{       :TYPE1 =&gt; FLAGS[:UNICODE] | FLAGS[:OEM] | FLAGS[:REQUEST_TARGET] | FLAGS[:NTLM] | FLAGS[:ALWAYS_SIGN] | FLAGS[:NTLM2_KEY],       :TYPE2 =&gt; FLAGS[:UNICODE],       :TYPE3 =&gt; FLAGS[:UNICODE] | FLAGS[:REQUEST_TARGET] | FLAGS[:NTLM] | FLAGS[:ALWAYS_SIGN] | FLAGS[:NTLM2_KEY]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">Blob</td>
            <td>=</td>
            <td class="attr-value">FieldSet.define {       int32LE    :blob_signature,   {:value =&gt; BLOB_SIGN}</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SecurityBuffer</td>
            <td>=</td>
            <td class="attr-value">FieldSet.define {       int16LE   :length,        {:value =&gt; 0}</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000006">
                    
                    <a name="M000006"></a><b>apply_des</b>(plain, keys)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000006_source')" id="l_M000006_source">show</a>
                        
                    </p>
                    <div id="M000006_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 130</span>
130:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">apply_des</span>(<span class="ruby-identifier">plain</span>, <span class="ruby-identifier">keys</span>)
131:         <span class="ruby-identifier">dec</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span><span class="ruby-operator">::</span><span class="ruby-constant">DES</span>.<span class="ruby-identifier">new</span>
132:         <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
133:           <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">key</span> = <span class="ruby-identifier">k</span>
134:           <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">encrypt</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">plain</span>)
135:         }
136:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000000">
                    
                    <a name="M000000"></a><b>decode_utf16le</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000000_source')" id="l_M000000_source">show</a>
                        
                    </p>
                    <div id="M000000_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 98</span>
 98:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">decode_utf16le</span>(<span class="ruby-identifier">str</span>)
 99:         <span class="ruby-constant">Kconv</span>.<span class="ruby-identifier">kconv</span>(<span class="ruby-identifier">swap16</span>(<span class="ruby-identifier">str</span>), <span class="ruby-constant">Kconv</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII</span>, <span class="ruby-constant">Kconv</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF16</span>)
100:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000001">
                    
                    <a name="M000001"></a><b>encode_utf16le</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000001_source')" id="l_M000001_source">show</a>
                        
                    </p>
                    <div id="M000001_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 102</span>
102:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encode_utf16le</span>(<span class="ruby-identifier">str</span>)
103:         <span class="ruby-identifier">swap16</span>(<span class="ruby-constant">Kconv</span>.<span class="ruby-identifier">kconv</span>(<span class="ruby-identifier">str</span>, <span class="ruby-constant">Kconv</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF16</span>, <span class="ruby-constant">Kconv</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII</span>))
104:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000005">
                    
                    <a name="M000005"></a><b>gen_keys</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000005_source')" id="l_M000005_source">show</a>
                        
                    </p>
                    <div id="M000005_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 122</span>
122:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gen_keys</span>(<span class="ruby-identifier">str</span>)
123:         <span class="ruby-identifier">split7</span>(<span class="ruby-identifier">str</span>).<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">str7</span><span class="ruby-operator">|</span> 
124:           <span class="ruby-identifier">bits</span> = <span class="ruby-identifier">split7</span>(<span class="ruby-identifier">str7</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">&quot;B*&quot;</span>)[<span class="ruby-value">0</span>]).<span class="ruby-identifier">inject</span>(<span class="ruby-value str">''</span>)\
125:             {<span class="ruby-operator">|</span><span class="ruby-identifier">ret</span>, <span class="ruby-identifier">tkn</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ret</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">tkn</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">tkn</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">'1'</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">size</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span>).<span class="ruby-identifier">to_s</span> }
126:           [<span class="ruby-identifier">bits</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;B*&quot;</span>)
127:         }
128:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000007">
                    
                    <a name="M000007"></a><b>lm_hash</b>(password)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 138</span>
138:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lm_hash</span>(<span class="ruby-identifier">password</span>)
139:         <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">gen_keys</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">upcase</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-value">14</span>, <span class="ruby-value str">&quot;\0&quot;</span>)
140:         <span class="ruby-identifier">apply_des</span>(<span class="ruby-constant">LM_MAGIC</span>, <span class="ruby-identifier">keys</span>).<span class="ruby-identifier">join</span>
141:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000010">
                    
                    <a name="M000010"></a><b>lm_response</b>(arg)
                    
                </div>
                
                <div class="description">
                  <p>
responses
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000010_source')" id="l_M000010_source">show</a>
                        
                    </p>
                    <div id="M000010_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 161</span>
161:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lm_response</span>(<span class="ruby-identifier">arg</span>)
162:         <span class="ruby-keyword kw">begin</span>
163:           <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:lm_hash</span>]
164:           <span class="ruby-identifier">chal</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:challenge</span>]
165:         <span class="ruby-keyword kw">rescue</span>
166:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>
167:         <span class="ruby-keyword kw">end</span>
168:         <span class="ruby-identifier">chal</span> = <span class="ruby-constant">NTL</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">chal</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chal</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
169:         <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">gen_keys</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-value">21</span>, <span class="ruby-value str">&quot;\0&quot;</span>)
170:         <span class="ruby-identifier">apply_des</span>(<span class="ruby-identifier">chal</span>, <span class="ruby-identifier">keys</span>).<span class="ruby-identifier">join</span>
171:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000013">
                    
                    <a name="M000013"></a><b>lmv2_response</b>(arg, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000013_source')" id="l_M000013_source">show</a>
                        
                    </p>
                    <div id="M000013_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 215</span>
215:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lmv2_response</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">opt</span> = {})
216:         <span class="ruby-identifier">key</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:ntlmv2_hash</span>]
217:         <span class="ruby-identifier">chal</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:challenge</span>]
218:         
219:         <span class="ruby-identifier">chal</span> = <span class="ruby-constant">NTLM</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">chal</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chal</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
220: 
221:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
222:           <span class="ruby-identifier">cc</span>  = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
223:         <span class="ruby-keyword kw">else</span>
224:           <span class="ruby-identifier">cc</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-constant">MAX64</span>)
225:         <span class="ruby-keyword kw">end</span>
226:         <span class="ruby-identifier">cc</span> = <span class="ruby-constant">NTLM</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">cc</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cc</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
227: 
228:         <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">chal</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">cc</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">cc</span>
229:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000014">
                    
                    <a name="M000014"></a><b>ntlm2_session</b>(arg, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 231</span>
231:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ntlm2_session</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">opt</span> = {})
232:         <span class="ruby-keyword kw">begin</span>
233:           <span class="ruby-identifier">passwd_hash</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:ntlm_hash</span>]
234:           <span class="ruby-identifier">chal</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:challenge</span>]
235:         <span class="ruby-keyword kw">rescue</span>
236:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>
237:         <span class="ruby-keyword kw">end</span>
238: 
239:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
240:           <span class="ruby-identifier">cc</span>  = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
241:         <span class="ruby-keyword kw">else</span>
242:           <span class="ruby-identifier">cc</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-constant">MAX64</span>)
243:         <span class="ruby-keyword kw">end</span>
244:         <span class="ruby-identifier">cc</span> = <span class="ruby-constant">NTLM</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">cc</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cc</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
245: 
246:         <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">gen_keys</span> <span class="ruby-identifier">passwd_hash</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-value">21</span>, <span class="ruby-value str">&quot;\0&quot;</span>)
247:         <span class="ruby-identifier">session_hash</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">chal</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">cc</span>).<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">8</span>)
248:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">apply_des</span>(<span class="ruby-identifier">session_hash</span>, <span class="ruby-identifier">keys</span>).<span class="ruby-identifier">join</span>
249:         [<span class="ruby-identifier">cc</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-value">24</span>, <span class="ruby-value str">&quot;\0&quot;</span>), <span class="ruby-identifier">response</span>]
250:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000008">
                    
                    <a name="M000008"></a><b>ntlm_hash</b>(password, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000008_source')" id="l_M000008_source">show</a>
                        
                    </p>
                    <div id="M000008_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 143</span>
143:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ntlm_hash</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">opt</span> = {})
144:         <span class="ruby-identifier">pwd</span> = <span class="ruby-identifier">password</span>.<span class="ruby-identifier">dup</span>
145:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:unicode</span>]
146:           <span class="ruby-identifier">pwd</span> = <span class="ruby-identifier">encode_utf16le</span>(<span class="ruby-identifier">pwd</span>)
147:         <span class="ruby-keyword kw">end</span>
148:         <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD4</span>.<span class="ruby-identifier">digest</span> <span class="ruby-identifier">pwd</span>
149:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000011">
                    
                    <a name="M000011"></a><b>ntlm_response</b>(arg)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 173</span>
173:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ntlm_response</span>(<span class="ruby-identifier">arg</span>)
174:         <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:ntlm_hash</span>]
175:         <span class="ruby-identifier">chal</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:challenge</span>]
176:         <span class="ruby-identifier">chal</span> = <span class="ruby-constant">NTL</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">chal</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chal</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
177:         <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">gen_keys</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-value">21</span>, <span class="ruby-value str">&quot;\0&quot;</span>)
178:         <span class="ruby-identifier">apply_des</span>(<span class="ruby-identifier">chal</span>, <span class="ruby-identifier">keys</span>).<span class="ruby-identifier">join</span>
179:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000009">
                    
                    <a name="M000009"></a><b>ntlmv2_hash</b>(user, password, target, opt={})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000009_source')" id="l_M000009_source">show</a>
                        
                    </p>
                    <div id="M000009_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 151</span>
151:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ntlmv2_hash</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">opt</span>={})
152:         <span class="ruby-identifier">ntlmhash</span> = <span class="ruby-identifier">ntlm_hash</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">opt</span>)
153:         <span class="ruby-identifier">userdomain</span> = (<span class="ruby-identifier">user</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">target</span>).<span class="ruby-identifier">upcase</span>
154:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:unicode</span>]
155:           <span class="ruby-identifier">userdomain</span> = <span class="ruby-identifier">encode_utf16le</span>(<span class="ruby-identifier">userdomain</span>)
156:         <span class="ruby-keyword kw">end</span>
157:         <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">ntlmhash</span>, <span class="ruby-identifier">userdomain</span>)
158:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000012">
                    
                    <a name="M000012"></a><b>ntlmv2_response</b>(arg, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 181</span>
181:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ntlmv2_response</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">opt</span> = {})
182:         <span class="ruby-keyword kw">begin</span>
183:           <span class="ruby-identifier">key</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:ntlmv2_hash</span>]
184:           <span class="ruby-identifier">chal</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:challenge</span>]
185:           <span class="ruby-identifier">ti</span> = <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">:target_info</span>]
186:         <span class="ruby-keyword kw">rescue</span>
187:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>
188:         <span class="ruby-keyword kw">end</span>
189:         <span class="ruby-identifier">chal</span> = <span class="ruby-constant">NTL</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">chal</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chal</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
190:         
191:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
192:           <span class="ruby-identifier">cc</span>  = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:client_challenge</span>]
193:         <span class="ruby-keyword kw">else</span>
194:           <span class="ruby-identifier">cc</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-constant">MAX64</span>)
195:         <span class="ruby-keyword kw">end</span>
196:         <span class="ruby-identifier">cc</span> = <span class="ruby-constant">NTLM</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">cc</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cc</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
197: 
198:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:timestamp</span>]
199:           <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:timestamp</span>]
200:         <span class="ruby-keyword kw">else</span>
201:           <span class="ruby-identifier">ts</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
202:         <span class="ruby-keyword kw">end</span>
203:         <span class="ruby-comment cmt"># epoch -&gt; milsec from Jan 1, 1601</span>
204:         <span class="ruby-identifier">ts</span> = <span class="ruby-value">10000000</span> <span class="ruby-operator">*</span> (<span class="ruby-identifier">ts</span> <span class="ruby-operator">+</span> <span class="ruby-constant">TIME_OFFSET</span>)
205: 
206:         <span class="ruby-identifier">blob</span> = <span class="ruby-constant">Blob</span>.<span class="ruby-identifier">new</span>
207:         <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">ts</span>
208:         <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">challenge</span> = <span class="ruby-identifier">cc</span>
209:         <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">target_info</span> = <span class="ruby-identifier">ti</span>
210:         
211:         <span class="ruby-identifier">bb</span> = <span class="ruby-identifier">blob</span>.<span class="ruby-identifier">serialize</span>
212:         <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">chal</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">bb</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">bb</span>
213:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000002">
                    
                    <a name="M000002"></a><b>pack_int64le</b>(val)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000002_source')" id="l_M000002_source">show</a>
                        
                    </p>
                    <div id="M000002_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 106</span>
106:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pack_int64le</span>(<span class="ruby-identifier">val</span>)
107:           [<span class="ruby-identifier">val</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x00000000ffffffff</span>, <span class="ruby-identifier">val</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">32</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;V2&quot;</span>)
108:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000004">
                    
                    <a name="M000004"></a><b>split7</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000004_source')" id="l_M000004_source">show</a>
                        
                    </p>
                    <div id="M000004_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 114</span>
114:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">split7</span>(<span class="ruby-identifier">str</span>)
115:         <span class="ruby-identifier">s</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">dup</span>
116:         <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">empty?</span>
117:           (<span class="ruby-identifier">ret</span> <span class="ruby-operator">||=</span> []).<span class="ruby-identifier">push</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-value">0</span>, <span class="ruby-value">7</span>)
118:         <span class="ruby-keyword kw">end</span>
119:         <span class="ruby-identifier">ret</span>
120:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000003">
                    
                    <a name="M000003"></a><b>swap16</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000003_source')" id="l_M000003_source">show</a>
                        
                    </p>
                    <div id="M000003_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/ntlm.rb, line 110</span>
110:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">swap16</span>(<span class="ruby-identifier">str</span>)
111:         <span class="ruby-identifier">str</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">&quot;v*&quot;</span>).<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;n*&quot;</span>)
112:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    