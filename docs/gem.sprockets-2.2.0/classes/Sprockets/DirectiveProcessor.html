<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Sprockets::DirectiveProcessor</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Sprockets::DirectiveProcessor 
            
                <span class="parent">&lt; 
                    
                    Tilt::Template
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/sprockets/directive_processor_rb.html">lib/sprockets/directive_processor.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
The `DirectiveProcessor` is responsible for parsing and evaluating
directive comments in a source file.
</p>
<p>
A directive comment starts with a comment prefix, followed by an
&#8220;=&#8221;, then the directive name, then any arguments.
</p>
<pre>
    // JavaScript
    //= require &quot;foo&quot;

    # CoffeeScript
    #= require &quot;bar&quot;

    /* CSS
     *= require &quot;baz&quot;
     */
</pre>
<p>
The <a href="Processor.html">Processor</a> is implemented as a
`Tilt::Template` and is loosely coupled to <a
href="../Sprockets.html">Sprockets</a>. This makes it possible to disable
or modify the processor to do whatever you&#8217;d like. You could add your
own custom directives or invent your own directive syntax.
</p>
<p>
`Environment#processors` includes `DirectiveProcessor` by default.
</p>
<p>
To remove the processor entirely:
</p>
<pre>
    env.unregister_processor('text/css', Sprockets::DirectiveProcessor)
    env.unregister_processor('application/javascript', Sprockets::DirectiveProcessor)
</pre>
<p>
Then inject your own preprocessor:
</p>
<pre>
    env.register_processor('text/css', MyProcessor)
</pre>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000116">compat?</a>,</li>
                
                <li><a href="#M000117">constants</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000091">directives</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000122">each_entry</a>,</li>
                
                <li><a href="#M000121">entries</a>,</li>
                
                <li><a href="#M000087">evaluate</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000082">prepare</a>,</li>
                
                <li><a href="#M000115">process_compat_directive</a>,</li>
                
                <li><a href="#M000109">process_depend_on_asset_directive</a>,</li>
                
                <li><a href="#M000108">process_depend_on_directive</a>,</li>
                
                <li><a href="#M000095">process_directives</a>,</li>
                
                <li><a href="#M000105">process_include_directive</a>,</li>
                
                <li><a href="#M000118">process_provide_directive</a>,</li>
                
                <li><a href="#M000101">process_require_directive</a>,</li>
                
                <li><a href="#M000106">process_require_directory_directive</a>,</li>
                
                <li><a href="#M000104">process_require_self_directive</a>,</li>
                
                <li><a href="#M000107">process_require_tree_directive</a>,</li>
                
                <li><a href="#M000096">process_source</a>,</li>
                
                <li><a href="#M000110">process_stub_directive</a>,</li>
                
                <li><a href="#M000088">processed_header</a>,</li>
                
                <li><a href="#M000090">processed_source</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000119">relative?</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000120">stat</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">HEADER_PATTERN</td>
            <td>=</td>
            <td class="attr-value">/       \A (         (?m:\s*) (           (\/\* (?m:.*?) \*\/) |           (\#\#\# (?m:.*?) \#\#\#) |           (\/\/ .* \n?)+ |           (\# .* \n?)+         )       )+     /x</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Directives will only be picked up if they are in the header of the source
file. C style (/* */), JavaScript (//), and Ruby (#) comments are
supported.
</p>
<p>
Directives in comments after the first non-whitespace line of code will not
be processed.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DIRECTIVE_PATTERN</td>
            <td>=</td>
            <td class="attr-value">/       ^ [\W]* = \s* (\w+.*?) (\*\/)? $     /x</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Directives are denoted by a `=` followed by the name, then argument list.
</p>
<p>
A few different styles are allowed:
</p>
<pre>
    // =require foo
    //= require foo
    //= require &quot;foo&quot;
</pre>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>pathname</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>header</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>body</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>included_pathnames</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>context</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000091">
                    
                    <a name="M000091"></a><b>directives</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns an Array of directive structures. Each structure is an Array with
the line number as the first element, the directive name as the second
element, followed by any arguments.
</p>
<pre>
    [[1, &quot;require&quot;, &quot;foo&quot;], [2, &quot;require&quot;, &quot;bar&quot;]]
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000091_source')" id="l_M000091_source">show</a>
                        
                    </p>
                    <div id="M000091_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 125</span>
125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">directives</span>
126:       <span class="ruby-ivar">@directives</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">header</span>.<span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each_with_index</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
127:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">directive</span> = <span class="ruby-identifier">line</span>[<span class="ruby-constant">DIRECTIVE_PATTERN</span>, <span class="ruby-value">1</span>]
128:           <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span> = <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">directive</span>)
129:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-node">&quot;process_#{name}_directive&quot;</span>)
130:             [<span class="ruby-identifier">index</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>]
131:           <span class="ruby-keyword kw">end</span>
132:         <span class="ruby-keyword kw">end</span>
133:       }.<span class="ruby-identifier">compact</span>
134:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000087">
                    
                    <a name="M000087"></a><b>evaluate</b>(context, locals, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Implemented for Tilt#render.
</p>
<p>
`context` is a `Context` instance with methods that allow you to access the
environment and append to the bundle. See `Context` for the complete API.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000087_source')" id="l_M000087_source">show</a>
                        
                    </p>
                    <div id="M000087_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 91</span>
 91:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evaluate</span>(<span class="ruby-identifier">context</span>, <span class="ruby-identifier">locals</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
 92:       <span class="ruby-ivar">@context</span> = <span class="ruby-identifier">context</span>
 93: 
 94:       <span class="ruby-ivar">@result</span> = <span class="ruby-value str">&quot;&quot;</span>
 95:       <span class="ruby-ivar">@has_written_body</span> = <span class="ruby-keyword kw">false</span>
 96: 
 97:       <span class="ruby-identifier">process_directives</span>
 98:       <span class="ruby-identifier">process_source</span>
 99: 
100:       <span class="ruby-ivar">@result</span>
101:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000082">
                    
                    <a name="M000082"></a><b>prepare</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000082_source')" id="l_M000082_source">show</a>
                        
                    </p>
                    <div id="M000082_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 74</span>
74:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>
75:       <span class="ruby-ivar">@pathname</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">file</span>)
76: 
77:       <span class="ruby-ivar">@header</span> = <span class="ruby-identifier">data</span>[<span class="ruby-constant">HEADER_PATTERN</span>, <span class="ruby-value">0</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
78:       <span class="ruby-ivar">@body</span>   = <span class="ruby-identifier">$'</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">data</span>
79:       <span class="ruby-comment cmt"># Ensure body ends in a new line</span>
80:       <span class="ruby-ivar">@body</span>  <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@body</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@body</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\n\Z/</span><span class="ruby-identifier">m</span>
81: 
82:       <span class="ruby-ivar">@included_pathnames</span> = []
83:       <span class="ruby-ivar">@compat</span>             = <span class="ruby-keyword kw">false</span>
84:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000088">
                    
                    <a name="M000088"></a><b>processed_header</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the header String with any directives stripped.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000088_source')" id="l_M000088_source">show</a>
                        
                    </p>
                    <div id="M000088_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 104</span>
104:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">processed_header</span>
105:       <span class="ruby-identifier">lineno</span> = <span class="ruby-value">0</span>
106:       <span class="ruby-ivar">@processed_header</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">header</span>.<span class="ruby-identifier">lines</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
107:         <span class="ruby-identifier">lineno</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
108:         <span class="ruby-comment cmt"># Replace directive line with a clean break</span>
109:         <span class="ruby-identifier">directives</span>.<span class="ruby-identifier">assoc</span>(<span class="ruby-identifier">lineno</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">line</span>
110:       }.<span class="ruby-identifier">join</span>.<span class="ruby-identifier">chomp</span>
111:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000090">
                    
                    <a name="M000090"></a><b>processed_source</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the source String with any directives stripped.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000090_source')" id="l_M000090_source">show</a>
                        
                    </p>
                    <div id="M000090_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">processed_source</span>
115:       <span class="ruby-ivar">@processed_source</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">processed_header</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">body</span>
116:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000116">
                    
                    <a name="M000116"></a><b>compat?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Checks if <a href="../Sprockets.html">Sprockets</a> 1.x compat mode enabled
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000116_source')" id="l_M000116_source">show</a>
                        
                    </p>
                    <div id="M000116_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 367</span>
367:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compat?</span>
368:         <span class="ruby-ivar">@compat</span>
369:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000117">
                    
                    <a name="M000117"></a><b>constants</b>()
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Sprockets.html">Sprockets</a> 1.x allowed for constant
interpolation if a constants.yml was present. This is only available if
compat mode is on.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000117_source')" id="l_M000117_source">show</a>
                        
                    </p>
                    <div id="M000117_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 374</span>
374:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">constants</span>
375:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compat?</span>
376:           <span class="ruby-identifier">pathname</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">context</span>.<span class="ruby-identifier">root_path</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;constants.yml&quot;</span>)
377:           <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load_file</span>(<span class="ruby-identifier">pathname</span>) <span class="ruby-operator">:</span> {}
378:         <span class="ruby-keyword kw">else</span>
379:           {}
380:         <span class="ruby-keyword kw">end</span>
381:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000115">
                    
                    <a name="M000115"></a><b>process_compat_directive</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Enable <a href="../Sprockets.html">Sprockets</a> 1.x compat mode.
</p>
<p>
Makes it possible to use the same JavaScript source file in both <a
href="../Sprockets.html">Sprockets</a> 1 and 2.
</p>
<pre>
    //= compat
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000115_source')" id="l_M000115_source">show</a>
                        
                    </p>
                    <div id="M000115_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 362</span>
362:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_compat_directive</span>
363:         <span class="ruby-ivar">@compat</span> = <span class="ruby-keyword kw">true</span>
364:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000109">
                    
                    <a name="M000109"></a><b>process_depend_on_asset_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to state a dependency on an asset without including it.
</p>
<p>
This is used for caching purposes. Any changes that would invalid the asset
dependency will invalidate the cache our the source file.
</p>
<p>
Unlike `depend_on`, the path must be a requirable asset.
</p>
<pre>
    //= depend_on_asset &quot;bar.js&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000109_source')" id="l_M000109_source">show</a>
                        
                    </p>
                    <div id="M000109_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 339</span>
339:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_depend_on_asset_directive</span>(<span class="ruby-identifier">path</span>)
340:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">path</span>)
341:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000108">
                    
                    <a name="M000108"></a><b>process_depend_on_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to state a dependency on a file without including it.
</p>
<p>
This is used for caching purposes. Any changes made to the dependency file
will invalidate the cache of the source file.
</p>
<p>
This is useful if you are using ERB and File.read to pull in contents from
another file.
</p>
<pre>
    //= depend_on &quot;foo.png&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000108_source')" id="l_M000108_source">show</a>
                        
                    </p>
                    <div id="M000108_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 324</span>
324:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_depend_on_directive</span>(<span class="ruby-identifier">path</span>)
325:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">path</span>)
326:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000095">
                    
                    <a name="M000095"></a><b>process_directives</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Gathers comment directives in the source and processes them. Any directive
method matching `process_*_directive` will automatically be available. This
makes it easy to extend the processor.
</p>
<p>
To implement a custom directive called `require_glob`, subclass
`Sprockets::DirectiveProcessor`, then add a method called
`process_require_glob_directive`.
</p>
<pre>
    class DirectiveProcessor &lt; Sprockets::DirectiveProcessor
      def process_require_glob_directive
        Dir[&quot;#{pathname.dirname}/#{glob}&quot;].sort.each do |filename|
          require(filename)
        end
      end
    end
</pre>
<p>
Replace the current processor on the environment with your own:
</p>
<pre>
    env.unregister_processor('text/css', Sprockets::DirectiveProcessor)
    env.register_processor('text/css', DirectiveProcessor)
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000095_source')" id="l_M000095_source">show</a>
                        
                    </p>
                    <div id="M000095_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 162</span>
162:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_directives</span>
163:         <span class="ruby-identifier">directives</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
164:           <span class="ruby-identifier">context</span>.<span class="ruby-identifier">__LINE__</span> = <span class="ruby-identifier">line_number</span>
165:           <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;process_#{name}_directive&quot;</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
166:           <span class="ruby-identifier">context</span>.<span class="ruby-identifier">__LINE__</span> = <span class="ruby-keyword kw">nil</span>
167:         <span class="ruby-keyword kw">end</span>
168:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000105">
                    
                    <a name="M000105"></a><b>process_include_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
The `include` directive works similar to `require` but inserts the contents
of the dependency even if it already has been required.
</p>
<pre>
    //= include &quot;header&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000105_source')" id="l_M000105_source">show</a>
                        
                    </p>
                    <div id="M000105_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 246</span>
246:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_include_directive</span>(<span class="ruby-identifier">path</span>)
247:         <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">context</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>)
248:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">pathname</span>)
249:         <span class="ruby-identifier">included_pathnames</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pathname</span>
250:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000118">
                    
                    <a name="M000118"></a><b>process_provide_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
`provide` is stubbed out for <a href="../Sprockets.html">Sprockets</a> 1.x
compat. Mutating the path when an asset is being built is not permitted.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000118_source')" id="l_M000118_source">show</a>
                        
                    </p>
                    <div id="M000118_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 386</span>
386:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_provide_directive</span>(<span class="ruby-identifier">path</span>)
387:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000101">
                    
                    <a name="M000101"></a><b>process_require_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
The `require` directive functions similar to Ruby&#8217;s own `require`. It
provides a way to declare a dependency on a file in your path and ensures
its only loaded once before the source file.
</p>
<p>
`require` works with files in the environment path:
</p>
<pre>
    //= require &quot;foo.js&quot;
</pre>
<p>
Extensions are optional. If your source file is &#8220;.js&#8221;, it
assumes you are requiring another &#8220;.js&#8221;.
</p>
<pre>
    //= require &quot;foo&quot;
</pre>
<p>
Relative paths work too. Use a leading `./` to denote a relative path:
</p>
<pre>
    //= require &quot;./bar&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000101_source')" id="l_M000101_source">show</a>
                        
                    </p>
                    <div id="M000101_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 206</span>
206:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_require_directive</span>(<span class="ruby-identifier">path</span>)
207:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@compat</span>
208:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/&lt;([^&gt;]+)&gt;/</span>
209:             <span class="ruby-identifier">path</span> = <span class="ruby-identifier">$1</span>
210:           <span class="ruby-keyword kw">else</span>
211:             <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;./#{path}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">relative?</span>(<span class="ruby-identifier">path</span>)
212:           <span class="ruby-keyword kw">end</span>
213:         <span class="ruby-keyword kw">end</span>
214: 
215:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">path</span>)
216:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000106">
                    
                    <a name="M000106"></a><b>process_require_directory_directive</b>(path = &quot;.&quot;)
                    
                </div>
                
                <div class="description">
                  <p>
`require_directory` requires all the files inside a single directory.
It&#8217;s similar to `path/*` since it does not follow nested directories.
</p>
<pre>
    //= require_directory &quot;./javascripts&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000106_source')" id="l_M000106_source">show</a>
                        
                    </p>
                    <div id="M000106_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 258</span>
258:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_require_directory_directive</span>(<span class="ruby-identifier">path</span> = <span class="ruby-value str">&quot;.&quot;</span>)
259:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">relative?</span>(<span class="ruby-identifier">path</span>)
260:           <span class="ruby-identifier">root</span> = <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">dirname</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">expand_path</span>
261: 
262:           <span class="ruby-keyword kw">unless</span> (<span class="ruby-identifier">stats</span> = <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">root</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stats</span>.<span class="ruby-identifier">directory?</span>
263:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;require_directory argument must be a directory&quot;</span>
264:           <span class="ruby-keyword kw">end</span>
265: 
266:           <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">root</span>)
267: 
268:           <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">root</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pathname</span><span class="ruby-operator">|</span>
269:             <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">root</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">pathname</span>)
270:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file</span>
271:               <span class="ruby-keyword kw">next</span>
272:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">context</span>.<span class="ruby-identifier">asset_requirable?</span>(<span class="ruby-identifier">pathname</span>)
273:               <span class="ruby-identifier">context</span>.<span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">pathname</span>)
274:             <span class="ruby-keyword kw">end</span>
275:           <span class="ruby-keyword kw">end</span>
276:         <span class="ruby-keyword kw">else</span>
277:           <span class="ruby-comment cmt"># The path must be relative and start with a `./`.</span>
278:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;require_directory argument must be a relative path&quot;</span>
279:         <span class="ruby-keyword kw">end</span>
280:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000104">
                    
                    <a name="M000104"></a><b>process_require_self_directive</b>()
                    
                </div>
                
                <div class="description">
                  <p>
`require_self` causes the body of the current file to be inserted before
any subsequent `require` or `include` directives. Useful in CSS files,
where it&#8217;s common for the index file to contain global styles that
need to be defined before other dependencies are loaded.
</p>
<pre>
    /*= require &quot;reset&quot;
     *= require_self
     *= require_tree .
     */
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000104_source')" id="l_M000104_source">show</a>
                        
                    </p>
                    <div id="M000104_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 229</span>
229:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_require_self_directive</span>
230:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@has_written_body</span>
231:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;require_self can only be called once per source file&quot;</span>
232:         <span class="ruby-keyword kw">end</span>
233: 
234:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">pathname</span>)
235:         <span class="ruby-identifier">process_source</span>
236:         <span class="ruby-identifier">included_pathnames</span>.<span class="ruby-identifier">clear</span>
237:         <span class="ruby-ivar">@has_written_body</span> = <span class="ruby-keyword kw">true</span>
238:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000107">
                    
                    <a name="M000107"></a><b>process_require_tree_directive</b>(path = &quot;.&quot;)
                    
                </div>
                
                <div class="description">
                  <p>
`require_tree` requires all the nested files in a directory. Its glob
equivalent is `path/*<b>/</b>`.
</p>
<pre>
    //= require_tree &quot;./public&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000107_source')" id="l_M000107_source">show</a>
                        
                    </p>
                    <div id="M000107_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 287</span>
287:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_require_tree_directive</span>(<span class="ruby-identifier">path</span> = <span class="ruby-value str">&quot;.&quot;</span>)
288:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">relative?</span>(<span class="ruby-identifier">path</span>)
289:           <span class="ruby-identifier">root</span> = <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">dirname</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">expand_path</span>
290: 
291:           <span class="ruby-keyword kw">unless</span> (<span class="ruby-identifier">stats</span> = <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">root</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stats</span>.<span class="ruby-identifier">directory?</span>
292:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;require_tree argument must be a directory&quot;</span>
293:           <span class="ruby-keyword kw">end</span>
294: 
295:           <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">root</span>)
296: 
297:           <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pathname</span><span class="ruby-operator">|</span>
298:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file</span>
299:               <span class="ruby-keyword kw">next</span>
300:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>).<span class="ruby-identifier">directory?</span>
301:               <span class="ruby-identifier">context</span>.<span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">pathname</span>)
302:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">context</span>.<span class="ruby-identifier">asset_requirable?</span>(<span class="ruby-identifier">pathname</span>)
303:               <span class="ruby-identifier">context</span>.<span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">pathname</span>)
304:             <span class="ruby-keyword kw">end</span>
305:           <span class="ruby-keyword kw">end</span>
306:         <span class="ruby-keyword kw">else</span>
307:           <span class="ruby-comment cmt"># The path must be relative and start with a `./`.</span>
308:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;require_tree argument must be a relative path&quot;</span>
309:         <span class="ruby-keyword kw">end</span>
310:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000096">
                    
                    <a name="M000096"></a><b>process_source</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000096_source')" id="l_M000096_source">show</a>
                        
                    </p>
                    <div id="M000096_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 170</span>
170:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_source</span>
171:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@has_written_body</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">processed_header</span>.<span class="ruby-identifier">empty?</span>
172:           <span class="ruby-ivar">@result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">processed_header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
173:         <span class="ruby-keyword kw">end</span>
174: 
175:         <span class="ruby-identifier">included_pathnames</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pathname</span><span class="ruby-operator">|</span>
176:           <span class="ruby-ivar">@result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">context</span>.<span class="ruby-identifier">evaluate</span>(<span class="ruby-identifier">pathname</span>)
177:         <span class="ruby-keyword kw">end</span>
178: 
179:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@has_written_body</span>
180:           <span class="ruby-ivar">@result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">body</span>
181:         <span class="ruby-keyword kw">end</span>
182: 
183:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compat?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">constants</span>.<span class="ruby-identifier">any?</span>
184:           <span class="ruby-ivar">@result</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/&lt;%=(.*?)%&gt;/</span>) { <span class="ruby-identifier">constants</span>[<span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>] }
185:         <span class="ruby-keyword kw">end</span>
186:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000110">
                    
                    <a name="M000110"></a><b>process_stub_directive</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Allows dependency to be excluded from the asset bundle.
</p>
<p>
The `path` must be a valid asset and may or may not already be part of the
bundle. Once stubbed, it is blacklisted and can&#8217;t be brought back by
any other `require`.
</p>
<pre>
    //= stub &quot;jquery&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000110_source')" id="l_M000110_source">show</a>
                        
                    </p>
                    <div id="M000110_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 351</span>
351:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_stub_directive</span>(<span class="ruby-identifier">path</span>)
352:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">stub_asset</span>(<span class="ruby-identifier">path</span>)
353:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000122">
                    
                    <a name="M000122"></a><b>each_entry</b>(root, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000122_source')" id="l_M000122_source">show</a>
                        
                    </p>
                    <div id="M000122_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 402</span>
402:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
403:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">environment</span>.<span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
404:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000121">
                    
                    <a name="M000121"></a><b>entries</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000121_source')" id="l_M000121_source">show</a>
                        
                    </p>
                    <div id="M000121_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 398</span>
398:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>)
399:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">environment</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>)
400:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000119">
                    
                    <a name="M000119"></a><b>relative?</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000119_source')" id="l_M000119_source">show</a>
                        
                    </p>
                    <div id="M000119_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 390</span>
390:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">relative?</span>(<span class="ruby-identifier">path</span>)
391:         <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\.($|\.?\/)/</span>
392:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000120">
                    
                    <a name="M000120"></a><b>stat</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000120_source')" id="l_M000120_source">show</a>
                        
                    </p>
                    <div id="M000120_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/directive_processor.rb, line 394</span>
394:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
395:         <span class="ruby-identifier">context</span>.<span class="ruby-identifier">environment</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
396:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    