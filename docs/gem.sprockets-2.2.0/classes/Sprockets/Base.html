<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Sprockets::Base</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Sprockets::Base 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/sprockets/base_rb.html">lib/sprockets/base.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
`Base` class for `Environment` and `Index`.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M000061">[]</a></li>
                
            </ul>
        </dd>
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000057">attributes_for</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000069">build_asset</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000052">cache=</a>,</li>
                
                <li><a href="#M000070">cache_key_for</a>,</li>
                
                <li><a href="#M000071">circular_call_protection</a>,</li>
                
                <li><a href="#M000058">content_type_of</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000047">digest</a>,</li>
                
                <li><a href="#M000044">digest_class=</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000062">each_entry</a>,</li>
                
                <li><a href="#M000065">each_file</a>,</li>
                
                <li><a href="#M000066">each_logical_path</a>,</li>
                
                <li><a href="#M000054">entries</a>,</li>
                
                <li><a href="#M000068">expire_index!</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000056">file_digest</a>,</li>
                
                <li><a href="#M000059">find_asset</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000053">index</a>,</li>
                
                <li><a href="#M000067">inspect</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000072">logical_path_for_filename</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000074">matches_filter</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000055">stat</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M000045">version=</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="Utils.html">Sprockets::Utils</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="Utils.html">Sprockets::Utils</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="Utils.html">Sprockets::Utils</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="Utils.html">Sprockets::Utils</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>digest_class</td>
            <td class='attr-desc'><p>
Returns a `Digest` implementation class.
</p>
<p>
Defaults to `Digest::MD5`.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>version</td>
            <td class='attr-desc'><p>
The `Environment#version` is a custom value used for manually expiring all
asset caches.
</p>
<p>
<a href="../Sprockets.html">Sprockets</a> is able to track most file and
directory changes and will take care of expiring the cache for you.
However, its impossible to know when any custom helpers change that you mix
into the `Context`.
</p>
<p>
It would be wise to increment this value anytime you make a configuration
change to the `Environment` object.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>logger</td>
            <td class='attr-desc'><p>
Get and set `Logger` instance.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>context_class</td>
            <td class='attr-desc'><p>
Get `Context` class.
</p>
<p>
This class maybe mutated and mixed in with custom helpers.
</p>
<pre>
    environment.context_class.instance_eval do
      include MyHelpers
      def asset_url; end
    end
</pre></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>cache</td>
            <td class='attr-desc'><p>
Get persistent cache store
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000061">
                    
                    <a name="M000061"></a><b>[]</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Preferred `<a href="Base.html#M000059">find_asset</a>` shorthand.
</p>
<pre>
    environment['application.js']
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000061_source')" id="l_M000061_source">show</a>
                        
                    </p>
                    <div id="M000061_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
177:       <span class="ruby-identifier">find_asset</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
178:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000057">
                    
                    <a name="M000057"></a><b>attributes_for</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Internal. Return a `AssetAttributes` for `path`.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000057_source')" id="l_M000057_source">show</a>
                        
                    </p>
                    <div id="M000057_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 144</span>
144:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">path</span>)
145:       <span class="ruby-constant">AssetAttributes</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">path</span>)
146:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000052">
                    
                    <a name="M000052"></a><b>cache=</b>(cache)
                    
                </div>
                
                <div class="description">
                  <p>
Set persistent cache store
</p>
<p>
The cache store must implement a pair of getters and setters. Either
`get(key)`/`set(key, value)`, `[key]`/`[key]=value`,
`read(key)`/`write(key, value)`.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000052_source')" id="l_M000052_source">show</a>
                        
                    </p>
                    <div id="M000052_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 96</span>
96:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cache=</span>(<span class="ruby-identifier">cache</span>)
97:       <span class="ruby-identifier">expire_index!</span>
98:       <span class="ruby-ivar">@cache</span> = <span class="ruby-identifier">cache</span>
99:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000058">
                    
                    <a name="M000058"></a><b>content_type_of</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Internal. Return content type of `path`.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000058_source')" id="l_M000058_source">show</a>
                        
                    </p>
                    <div id="M000058_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 149</span>
149:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">path</span>)
150:       <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">content_type</span>
151:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000047">
                    
                    <a name="M000047"></a><b>digest</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns a `Digest` instance for the `Environment`.
</p>
<p>
This value serves two purposes. If two `Environment`s have the same digest
value they can be treated as equal. This is more useful for comparing
environment states between processes rather than in the same. Two equal
`Environment`s can share the same cached assets.
</p>
<p>
The value also provides a seed digest for all `Asset` digests. Any change
in the environment digest will affect all of its assets.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000047_source')" id="l_M000047_source">show</a>
                        
                    </p>
                    <div id="M000047_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 64</span>
64:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">digest</span>
65:       <span class="ruby-comment cmt"># Compute the initial digest using the implementation class. The</span>
66:       <span class="ruby-comment cmt"># Sprockets release version and custom environment version are</span>
67:       <span class="ruby-comment cmt"># mixed in. So any new releases will affect all your assets.</span>
68:       <span class="ruby-ivar">@digest</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">digest_class</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">VERSION</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_s</span>)
69: 
70:       <span class="ruby-comment cmt"># Returned a dupped copy so the caller can safely mutate it with `.update`</span>
71:       <span class="ruby-ivar">@digest</span>.<span class="ruby-identifier">dup</span>
72:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000044">
                    
                    <a name="M000044"></a><b>digest_class=</b>(klass)
                    
                </div>
                
                <div class="description">
                  <p>
Assign a `Digest` implementation class. This maybe any Ruby `Digest::`
implementation such as `Digest::MD5` or `Digest::SHA1`.
</p>
<pre>
    environment.digest_class = Digest::SHA1
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000044_source')" id="l_M000044_source">show</a>
                        
                    </p>
                    <div id="M000044_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 27</span>
27:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">digest_class=</span>(<span class="ruby-identifier">klass</span>)
28:       <span class="ruby-identifier">expire_index!</span>
29:       <span class="ruby-ivar">@digest_class</span> = <span class="ruby-identifier">klass</span>
30:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000062">
                    
                    <a name="M000062"></a><b>each_entry</b>(root, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000062_source')" id="l_M000062_source">show</a>
                        
                    </p>
                    <div id="M000062_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 180</span>
180:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
181:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>, <span class="ruby-identifier">root</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block_given?</span>
182:       <span class="ruby-identifier">root</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">root</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">root</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Pathname</span>)
183: 
184:       <span class="ruby-identifier">paths</span> = []
185:       <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">root</span>).<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
186:         <span class="ruby-identifier">path</span> = <span class="ruby-identifier">root</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">filename</span>)
187:         <span class="ruby-identifier">paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
188: 
189:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
190:           <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">subpath</span><span class="ruby-operator">|</span>
191:             <span class="ruby-identifier">paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">subpath</span>
192:           <span class="ruby-keyword kw">end</span>
193:         <span class="ruby-keyword kw">end</span>
194:       <span class="ruby-keyword kw">end</span>
195: 
196:       <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:to_s</span>).<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
197: 
198:       <span class="ruby-keyword kw">nil</span>
199:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000065">
                    
                    <a name="M000065"></a><b>each_file</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000065_source')" id="l_M000065_source">show</a>
                        
                    </p>
                    <div id="M000065_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 201</span>
201:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_file</span>
202:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block_given?</span>
203:       <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">root</span><span class="ruby-operator">|</span>
204:         <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
205:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
206:             <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">path</span>
207:           <span class="ruby-keyword kw">end</span>
208:         <span class="ruby-keyword kw">end</span>
209:       <span class="ruby-keyword kw">end</span>
210:       <span class="ruby-keyword kw">nil</span>
211:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000066">
                    
                    <a name="M000066"></a><b>each_logical_path</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000066_source')" id="l_M000066_source">show</a>
                        
                    </p>
                    <div id="M000066_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 213</span>
213:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_logical_path</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
214:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block_given?</span>
215:       <span class="ruby-identifier">filters</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>
216:       <span class="ruby-identifier">files</span> = {}
217:       <span class="ruby-identifier">each_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
218:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">logical_path_for_filename</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">filters</span>)
219:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">logical_path</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">files</span>[<span class="ruby-identifier">logical_path</span>]
220:           <span class="ruby-identifier">files</span>[<span class="ruby-identifier">logical_path</span>] = <span class="ruby-keyword kw">true</span>
221:         <span class="ruby-keyword kw">end</span>
222:       <span class="ruby-keyword kw">end</span>
223:       <span class="ruby-keyword kw">nil</span>
224:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000054">
                    
                    <a name="M000054"></a><b>entries</b>(pathname)
                    
                </div>
                
                <div class="description">
                  <p>
Works like `Dir.entries`.
</p>
<p>
Subclasses may cache this method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000054_source')" id="l_M000054_source">show</a>
                        
                    </p>
                    <div id="M000054_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 115</span>
115:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">pathname</span>)
116:       <span class="ruby-identifier">trail</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">pathname</span>)
117:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000056">
                    
                    <a name="M000056"></a><b>file_digest</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Read and compute digest of filename.
</p>
<p>
Subclasses may cache this method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000056_source')" id="l_M000056_source">show</a>
                        
                    </p>
                    <div id="M000056_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 129</span>
129:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">file_digest</span>(<span class="ruby-identifier">path</span>)
130:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stat</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
131:         <span class="ruby-comment cmt"># If its a file, digest the contents</span>
132:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">file?</span>
133:           <span class="ruby-identifier">digest</span>.<span class="ruby-identifier">file</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>)
134: 
135:         <span class="ruby-comment cmt"># If its a directive, digest the list of filenames</span>
136:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">directory?</span>
137:           <span class="ruby-identifier">contents</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)
138:           <span class="ruby-identifier">digest</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">contents</span>)
139:         <span class="ruby-keyword kw">end</span>
140:       <span class="ruby-keyword kw">end</span>
141:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000059">
                    
                    <a name="M000059"></a><b>find_asset</b>(path, options = {})
                    
                </div>
                
                <div class="description">
                  <p>
Find asset by logical path or expanded path.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000059_source')" id="l_M000059_source">show</a>
                        
                    </p>
                    <div id="M000059_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 154</span>
154:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_asset</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
155:       <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">path</span>
156:       <span class="ruby-identifier">pathname</span>     = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)
157: 
158:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">absolute?</span>
159:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>)
160:         <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>).<span class="ruby-identifier">logical_path</span>
161:       <span class="ruby-keyword kw">else</span>
162:         <span class="ruby-keyword kw">begin</span>
163:           <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">logical_path</span>)
164:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">FileNotFound</span>
165:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
166:         <span class="ruby-keyword kw">end</span>
167:       <span class="ruby-keyword kw">end</span>
168: 
169:       <span class="ruby-identifier">build_asset</span>(<span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">options</span>)
170:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000053">
                    
                    <a name="M000053"></a><b>index</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Return an `Index`. Must be implemented by the subclass.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000053_source')" id="l_M000053_source">show</a>
                        
                    </p>
                    <div id="M000053_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 102</span>
102:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
103:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
104:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000067">
                    
                    <a name="M000067"></a><b>inspect</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Pretty inspect
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000067_source')" id="l_M000067_source">show</a>
                        
                    </p>
                    <div id="M000067_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 227</span>
227:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
228:       <span class="ruby-node">&quot;#&lt;#{self.class}:0x#{object_id.to_s(16)} &quot;</span> <span class="ruby-operator">+</span>
229:         <span class="ruby-node">&quot;root=#{root.to_s.inspect}, &quot;</span> <span class="ruby-operator">+</span>
230:         <span class="ruby-node">&quot;paths=#{paths.inspect}, &quot;</span> <span class="ruby-operator">+</span>
231:         <span class="ruby-node">&quot;digest=#{digest.to_s.inspect}&quot;</span> <span class="ruby-operator">+</span>
232:         <span class="ruby-value str">&quot;&gt;&quot;</span>
233:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000055">
                    
                    <a name="M000055"></a><b>stat</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
Works like `File.stat`.
</p>
<p>
Subclasses may cache this method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000055_source')" id="l_M000055_source">show</a>
                        
                    </p>
                    <div id="M000055_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 122</span>
122:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
123:       <span class="ruby-identifier">trail</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
124:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000045">
                    
                    <a name="M000045"></a><b>version=</b>(version)
                    
                </div>
                
                <div class="description">
                  <p>
Assign an environment version.
</p>
<pre>
    environment.version = '2.0'
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000045_source')" id="l_M000045_source">show</a>
                        
                    </p>
                    <div id="M000045_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 48</span>
48:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">version=</span>(<span class="ruby-identifier">version</span>)
49:       <span class="ruby-identifier">expire_index!</span>
50:       <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">version</span>
51:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000069">
                    
                    <a name="M000069"></a><b>build_asset</b>(logical_path, pathname, options)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000069_source')" id="l_M000069_source">show</a>
                        
                    </p>
                    <div id="M000069_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 241</span>
241:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build_asset</span>(<span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">options</span>)
242:         <span class="ruby-identifier">pathname</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">pathname</span>)
243: 
244:         <span class="ruby-comment cmt"># If there are any processors to run on the pathname, use</span>
245:         <span class="ruby-comment cmt"># `BundledAsset`. Otherwise use `StaticAsset` and treat is as binary.</span>
246:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>).<span class="ruby-identifier">processors</span>.<span class="ruby-identifier">any?</span>
247:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:bundle</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
248:             <span class="ruby-identifier">circular_call_protection</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-keyword kw">do</span>
249:               <span class="ruby-constant">ProcessedAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
250:             <span class="ruby-keyword kw">end</span>
251:           <span class="ruby-keyword kw">else</span>
252:             <span class="ruby-constant">BundledAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
253:           <span class="ruby-keyword kw">end</span>
254:         <span class="ruby-keyword kw">else</span>
255:           <span class="ruby-constant">StaticAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
256:         <span class="ruby-keyword kw">end</span>
257:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000070">
                    
                    <a name="M000070"></a><b>cache_key_for</b>(path, options)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000070_source')" id="l_M000070_source">show</a>
                        
                    </p>
                    <div id="M000070_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 259</span>
259:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cache_key_for</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
260:         <span class="ruby-node">&quot;#{path}:#{options[:bundle] ? '1' : '0'}&quot;</span>
261:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000071">
                    
                    <a name="M000071"></a><b>circular_call_protection</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000071_source')" id="l_M000071_source">show</a>
                        
                    </p>
                    <div id="M000071_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 263</span>
263:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">circular_call_protection</span>(<span class="ruby-identifier">path</span>)
264:         <span class="ruby-identifier">reset</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:sprockets_circular_calls</span>].<span class="ruby-identifier">nil?</span>
265:         <span class="ruby-identifier">calls</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:sprockets_circular_calls</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
266:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">path</span>)
267:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">CircularDependencyError</span>, <span class="ruby-node">&quot;#{path} has already been required&quot;</span>
268:         <span class="ruby-keyword kw">end</span>
269:         <span class="ruby-identifier">calls</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
270:         <span class="ruby-keyword kw">yield</span>
271:       <span class="ruby-keyword kw">ensure</span>
272:         <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:sprockets_circular_calls</span>] = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reset</span>
273:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000068">
                    
                    <a name="M000068"></a><b>expire_index!</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Clear index after mutating state. Must be implemented by the subclass.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000068_source')" id="l_M000068_source">show</a>
                        
                    </p>
                    <div id="M000068_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 237</span>
237:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">expire_index!</span>
238:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
239:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000072">
                    
                    <a name="M000072"></a><b>logical_path_for_filename</b>(filename, filters)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000072_source')" id="l_M000072_source">show</a>
                        
                    </p>
                    <div id="M000072_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 275</span>
275:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">logical_path_for_filename</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">filters</span>)
276:         <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">logical_path</span>.<span class="ruby-identifier">to_s</span>
277: 
278:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matches_filter</span>(<span class="ruby-identifier">filters</span>, <span class="ruby-identifier">logical_path</span>)
279:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">logical_path</span>
280:         <span class="ruby-keyword kw">end</span>
281: 
282:         <span class="ruby-comment cmt"># If filename is an index file, retest with alias</span>
283:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">logical_path</span>)[<span class="ruby-regexp re">/[^\.]+/</span>, <span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'index'</span>
284:           <span class="ruby-identifier">path</span> = <span class="ruby-identifier">logical_path</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\/index\./</span>, <span class="ruby-value str">'.'</span>)
285:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matches_filter</span>(<span class="ruby-identifier">filters</span>, <span class="ruby-identifier">path</span>)
286:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span>
287:           <span class="ruby-keyword kw">end</span>
288:         <span class="ruby-keyword kw">end</span>
289: 
290:         <span class="ruby-keyword kw">nil</span>
291:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000074">
                    
                    <a name="M000074"></a><b>matches_filter</b>(filters, filename)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000074_source')" id="l_M000074_source">show</a>
                        
                    </p>
                    <div id="M000074_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sprockets/base.rb, line 293</span>
293:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">matches_filter</span>(<span class="ruby-identifier">filters</span>, <span class="ruby-identifier">filename</span>)
294:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filters</span>.<span class="ruby-identifier">empty?</span>
295: 
296:         <span class="ruby-identifier">filters</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
297:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)
298:             <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">filename</span>)
299:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:call</span>)
300:             <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">filename</span>)
301:           <span class="ruby-keyword kw">else</span>
302:             <span class="ruby-constant">File</span>.<span class="ruby-identifier">fnmatch</span>(<span class="ruby-identifier">filter</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">filename</span>)
303:           <span class="ruby-keyword kw">end</span>
304:         <span class="ruby-keyword kw">end</span>
305:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    