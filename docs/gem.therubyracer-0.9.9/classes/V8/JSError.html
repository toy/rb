<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>V8::JSError</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            V8::JSError 
            
                <span class="parent">&lt; 
                    
                    StandardError
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/v8/error_rb.html">lib/v8/error.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000037">backtrace</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000036">in_javascript?</a>,</li>
                
                <li><a href="#M000035">in_ruby?</a>,</li>
                
                <li><a href="#M000030">initialize_unsafe</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000029">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000038">parse_js_frames</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000039">syntax_error?</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="JSError/Boundary.html">V8::JSError::Boundary</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>boundaries</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000037">
                    
                    <a name="M000037"></a><b>backtrace</b>(*modifiers)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show</a>
                        
                    </p>
                    <div id="M000037_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/v8/error.rb, line 58</span>
58:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">backtrace</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">modifiers</span>)
59:       <span class="ruby-identifier">trace_framework</span> = <span class="ruby-identifier">modifiers</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:framework</span>)
60:       <span class="ruby-identifier">trace_ruby</span> = <span class="ruby-identifier">modifiers</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">modifiers</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:ruby</span>)
61:       <span class="ruby-identifier">trace_javascript</span> = <span class="ruby-identifier">modifiers</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">modifiers</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:javascript</span>)
62:       <span class="ruby-identifier">mixed</span> = []
63:       <span class="ruby-identifier">rbcontext</span> = []
64:       <span class="ruby-identifier">jscontext</span> = []
65:       <span class="ruby-ivar">@boundaries</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
66:         <span class="ruby-identifier">rbframes</span> = <span class="ruby-identifier">b</span>.<span class="ruby-identifier">rbframes</span>.<span class="ruby-identifier">dup</span>
67:         <span class="ruby-identifier">rbcontext</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span><span class="ruby-operator">|</span>
68:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">frame</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">rbframes</span>.<span class="ruby-identifier">last</span>
69:             <span class="ruby-identifier">rbframes</span>.<span class="ruby-identifier">pop</span>
70:           <span class="ruby-keyword kw">else</span>
71:             <span class="ruby-keyword kw">break</span>
72:           <span class="ruby-keyword kw">end</span>
73:         <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trace_ruby</span>
74:         <span class="ruby-identifier">jsframes</span> = <span class="ruby-identifier">b</span>.<span class="ruby-identifier">jsframes</span>.<span class="ruby-identifier">dup</span>
75:         <span class="ruby-identifier">jscontext</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span><span class="ruby-operator">|</span>
76:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">frame</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">jsframes</span>.<span class="ruby-identifier">last</span>
77:             <span class="ruby-identifier">jsframes</span>.<span class="ruby-identifier">pop</span>
78:           <span class="ruby-keyword kw">else</span>
79:             <span class="ruby-keyword kw">break</span>
80:           <span class="ruby-keyword kw">end</span>
81:         <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trace_javascript</span>
82:         <span class="ruby-identifier">rbcontext</span> = <span class="ruby-identifier">b</span>.<span class="ruby-identifier">rbframes</span>
83:         <span class="ruby-identifier">jscontext</span> = <span class="ruby-identifier">b</span>.<span class="ruby-identifier">jsframes</span>
84:         <span class="ruby-identifier">rbframes</span>.<span class="ruby-identifier">reject!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/lib\/v8\/.*\.rb/</span>} <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">trace_framework</span>
85:         <span class="ruby-identifier">mixed</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">rbframes</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trace_ruby</span>
86:         <span class="ruby-identifier">mixed</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">jsframes</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trace_javascript</span>
87:       <span class="ruby-keyword kw">end</span>
88:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">mixed</span>
89:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000036">
                    
                    <a name="M000036"></a><b>in_javascript?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000036_source')" id="l_M000036_source">show</a>
                        
                    </p>
                    <div id="M000036_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/v8/error.rb, line 54</span>
54:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_javascript?</span>
55:       <span class="ruby-operator">!</span><span class="ruby-identifier">in_ruby?</span>
56:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000035">
                    
                    <a name="M000035"></a><b>in_ruby?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000035_source')" id="l_M000035_source">show</a>
                        
                    </p>
                    <div id="M000035_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/v8/error.rb, line 50</span>
50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_ruby?</span>
51:       <span class="ruby-ivar">@value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Exception</span>)
52:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000030">
                    
                    <a name="M000030"></a><b>initialize_unsafe</b>(try)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000030_source')" id="l_M000030_source">show</a>
                        
                    </p>
                    <div id="M000030_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/v8/error.rb, line 19</span>
19:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_unsafe</span>(<span class="ruby-identifier">try</span>)
20:       <span class="ruby-identifier">message</span> = <span class="ruby-keyword kw">nil</span>
21:       <span class="ruby-identifier">ex</span> = <span class="ruby-ivar">@to</span>.<span class="ruby-identifier">rb</span>(<span class="ruby-identifier">try</span>.<span class="ruby-constant">Exception</span>())
22:       <span class="ruby-ivar">@boundaries</span> = [<span class="ruby-constant">Boundary</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:rbframes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">caller</span>(<span class="ruby-value">3</span>), <span class="ruby-identifier">:jsframes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">parse_js_frames</span>(<span class="ruby-identifier">try</span>))]
23:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">V8</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">ex</span>
24:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">ex</span>[<span class="ruby-value str">'message'</span>]
25:           <span class="ruby-identifier">message</span> = <span class="ruby-identifier">msg</span>
26:         <span class="ruby-keyword kw">else</span>
27:           <span class="ruby-identifier">message</span> = <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">to_s</span>
28:         <span class="ruby-keyword kw">end</span>
29:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cause</span> = <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@native</span>).<span class="ruby-constant">GetHiddenValue</span>(<span class="ruby-value str">&quot;TheRubyRacer::Cause&quot;</span>)
30:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">cause</span>.<span class="ruby-constant">IsEmpty</span>()
31:             <span class="ruby-identifier">prev</span> = <span class="ruby-identifier">cause</span>.<span class="ruby-constant">Value</span>()
32:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prev</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">JSError</span>)
33:               <span class="ruby-ivar">@boundaries</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">prev</span>.<span class="ruby-identifier">boundaries</span>
34:               <span class="ruby-ivar">@value</span> = <span class="ruby-identifier">prev</span>.<span class="ruby-identifier">value</span>
35:             <span class="ruby-keyword kw">else</span>
36:               <span class="ruby-ivar">@value</span> = <span class="ruby-identifier">prev</span>
37:               <span class="ruby-ivar">@boundaries</span>.<span class="ruby-identifier">concat</span> [<span class="ruby-constant">Boundary</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:rbframes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">prev</span>.<span class="ruby-identifier">backtrace</span>)]
38:             <span class="ruby-keyword kw">end</span>
39:           <span class="ruby-keyword kw">else</span>
40:             <span class="ruby-ivar">@value</span> = <span class="ruby-identifier">ex</span>
41:           <span class="ruby-keyword kw">end</span>
42:         <span class="ruby-keyword kw">end</span>
43:       <span class="ruby-keyword kw">else</span>
44:         <span class="ruby-ivar">@value</span> = <span class="ruby-identifier">ex</span>
45:         <span class="ruby-identifier">message</span> = <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">to_s</span>
46:       <span class="ruby-keyword kw">end</span>
47:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">message</span>
48:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000038">
                    
                    <a name="M000038"></a><b>parse_js_frames</b>(try)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000038_source')" id="l_M000038_source">show</a>
                        
                    </p>
                    <div id="M000038_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/v8/error.rb, line 91</span>
 91:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_js_frames</span>(<span class="ruby-identifier">try</span>)
 92:       <span class="ruby-comment cmt">#I can't figure out why V8 is not capturing the stacktrace here</span>
 93:       <span class="ruby-comment cmt">#in terms of StackTrace and StackFrame objects, so we have to</span>
 94:       <span class="ruby-comment cmt">#parse the string.</span>
 95:       <span class="ruby-identifier">raw</span> = <span class="ruby-ivar">@to</span>.<span class="ruby-identifier">rb</span>(<span class="ruby-identifier">try</span>.<span class="ruby-constant">StackTrace</span>())
 96:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">raw</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">raw</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">syntax_error?</span>(<span class="ruby-identifier">try</span>)
 97:         <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">tap</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frames</span><span class="ruby-operator">|</span>
 98:           <span class="ruby-identifier">frames</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">frame</span><span class="ruby-operator">|</span> <span class="ruby-identifier">frame</span>.<span class="ruby-identifier">strip!</span>; <span class="ruby-identifier">frame</span>.<span class="ruby-identifier">chomp!</span>(<span class="ruby-value str">&quot;,&quot;</span>)}
 99:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">reject</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:empty?</span>)
100:       <span class="ruby-keyword kw">else</span>
101:         <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">try</span>.<span class="ruby-constant">Message</span>()
102:         [<span class="ruby-node">&quot;at #{@to.rb(msg.GetScriptResourceName())}:#{msg.GetLineNumber()}:#{msg.GetStartColumn() + 1}&quot;</span>]
103:       <span class="ruby-keyword kw">end</span>
104:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000039">
                    
                    <a name="M000039"></a><b>syntax_error?</b>(try)
                    
                </div>
                
                <div class="description">
                  <p>
Syntax errors are weird in that they have a non-empty stack trace but it
does not contain any source location information, so in these instances, we
have to pull it out of the Message object in the TryCatch. Is there a
better way to detect a syntax error
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show</a>
                        
                    </p>
                    <div id="M000039_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/v8/error.rb, line 110</span>
110:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">syntax_error?</span>(<span class="ruby-identifier">try</span>)
111:       <span class="ruby-identifier">ex</span> = <span class="ruby-ivar">@to</span>.<span class="ruby-identifier">rb</span>(<span class="ruby-identifier">try</span>.<span class="ruby-constant">Exception</span>())
112:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ex</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">V8</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span>)
113:         <span class="ruby-identifier">type</span> = <span class="ruby-identifier">ex</span>[<span class="ruby-value str">&quot;constructor&quot;</span>]
114:         <span class="ruby-identifier">type</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">V8</span><span class="ruby-operator">::</span><span class="ruby-constant">Function</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;SyntaxError&quot;</span>
115:       <span class="ruby-keyword kw">else</span>
116:         <span class="ruby-keyword kw">false</span>
117:       <span class="ruby-keyword kw">end</span>
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000029">
                    
                    <a name="M000029"></a><b>new</b>(try, to)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000029_source')" id="l_M000029_source">show</a>
                        
                    </p>
                    <div id="M000029_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/v8/error.rb, line 6</span>
 6:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">try</span>, <span class="ruby-identifier">to</span>)
 7:       <span class="ruby-ivar">@to</span> = <span class="ruby-identifier">to</span>
 8:       <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">initialize_unsafe</span>(<span class="ruby-identifier">try</span>))
 9:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
10:       <span class="ruby-ivar">@boundaries</span> = [<span class="ruby-constant">Boundary</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:rbframes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>)]
11:       <span class="ruby-ivar">@value</span> = <span class="ruby-identifier">e</span>
12:       <span class="ruby-keyword kw">super</span>(<span class="ruby-value str">&quot;You have uncovered what is probably a BUG in therubyracer exception code. An error report would be very helpful.\nJSError#initialize failed!: \#{e.message}\&quot;\n&quot;</span>)
13:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    