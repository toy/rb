<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Net::SFTP::Operations::Download</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Net::SFTP::Operations::Download 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../../files/lib/net/sftp/operations/download_rb.html">lib/net/sftp/operations/download.rb</a></li>
            
            <li><a href="../../../../files/lib/net/sftp/operations/download_rb.html">lib/net/sftp/operations/download.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
A general purpose downloader module for <a
href="../../SFTP.html">Net::SFTP</a>. It can download files into IO
objects, or directly to files on the local file system. It can even
download entire directory trees via <a href="../../SFTP.html">SFTP</a>, and
provides a flexible progress reporting mechanism.
</p>
<p>
To download a single file from the remote server, simply specify both the
remote and local paths:
</p>
<pre>
  downloader = sftp.download(&quot;/path/to/remote.txt&quot;, &quot;/path/to/local.txt&quot;)
</pre>
<p>
By default, this operates asynchronously, so if you want to block until the
download finishes, you can use the &#8216;bang&#8217; variant:
</p>
<pre>
  sftp.download!(&quot;/path/to/remote.txt&quot;, &quot;/path/to/local.txt&quot;)
</pre>
<p>
Or, if you have multiple downloads that you want to run in parallel, you
can employ the <a href="Download.html#M000017">wait</a> method of the
returned object:
</p>
<pre>
  dls = %w(file1 file2 file3).map { |f| sftp.download(&quot;remote/#{f}&quot;, f) }
  dls.each { |d| d.wait }
</pre>
<p>
To download an entire directory tree, recursively, simply specify
:recursive => true:
</p>
<pre>
  sftp.download!(&quot;/path/to/remotedir&quot;, &quot;/path/to/local&quot;, :recursive =&gt; true)
</pre>
<p>
This will download &#8220;/path/to/remotedir&#8220;, it&#8217;s contents,
it&#8217;s subdirectories, and their contents, recursively, to
&#8220;/path/to/local&#8220; on the local host. (If you specify :recursive
=> true and the source is not a directory, you&#8217;ll get an error!)
</p>
<p>
If you want to pull the contents of a file on the remote server, and store
the data in memory rather than immediately to disk, you can pass an IO
object as the destination:
</p>
<pre>
  require 'stringio'
  io = StringIO.new
  sftp.download!(&quot;/path/to/remote&quot;, io)
</pre>
<p>
This will only work for single-file downloads. Trying to do so with
:recursive => true will cause an error.
</p>
<p>
The following options are supported:
</p>
<ul>
<li><tt>:progress</tt> - either a block or an object to act as a progress
callback. See the discussion of &#8220;progress monitoring&#8221; below.

</li>
<li><tt>:requests</tt> - the number of pending <a
href="../../SFTP.html">SFTP</a> requests to allow at any given time. When
downloading an entire directory tree recursively, this will default to 16.
Setting this higher might improve throughput. Reducing it will reduce
throughput.

</li>
<li><tt>:<a href="Download.html#M000026">read_size</a></tt> - the maximum
number of bytes to read at a time from the source. Increasing this value
might improve throughput. It defaults to 32,000 bytes.

</li>
</ul>
<h2>Progress Monitoring</h2>
<p>
Sometimes it is desirable to track the progress of a download. There are
two ways to do this: either using a callback block, or a special custom
object.
</p>
<p>
Using a block it&#8217;s pretty straightforward:
</p>
<pre>
  sftp.download!(&quot;remote&quot;, &quot;local&quot;) do |event, downloader, *args|
    case event
    when :open then
      # args[0] : file metadata
      puts &quot;starting download: #{args[0].remote} -&gt; #{args[0].local} (#{args[0].size} bytes}&quot;
    when :get then
      # args[0] : file metadata
      # args[1] : byte offset in remote file
      # args[2] : data that was received
      puts &quot;writing #{args[2].length} bytes to #{args[0].local} starting at #{args[1]}&quot;
    when :close then
      # args[0] : file metadata
      puts &quot;finished with #{args[0].remote}&quot;
    when :mkdir then
      # args[0] : local path name
      puts &quot;creating directory #{args[0]}&quot;
    when :finish then
      puts &quot;all done!&quot;
  end
</pre>
<p>
However, for more complex implementations (e.g., GUI interfaces and such) a
block can become cumbersome. In those cases, you can create custom handler
objects that respond to certain methods, and then pass your handler to the
downloader:
</p>
<pre>
  class CustomHandler
    def on_open(downloader, file)
      puts &quot;starting download: #{file.remote} -&gt; #{file.local} (#{file.size} bytes)&quot;
    end

    def on_get(downloader, file, offset, data)
      puts &quot;writing #{data.length} bytes to #{file.local} starting at #{offset}&quot;
    end

    def on_close(downloader, file)
      puts &quot;finished with #{file.remote}&quot;
    end

    def on_mkdir(downloader, path)
      puts &quot;creating directory #{path}&quot;
    end

    def on_finish(downloader)
      puts &quot;all done!&quot;
    end
  end

  sftp.download!(&quot;remote&quot;, &quot;local&quot;, :progress =&gt; CustomHandler.new)
</pre>
<p>
If you omit any of those methods, the progress updates for those missing
events will be ignored. You can create a catchall method named
&#8220;call&#8221; for those, instead.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M000018">[]</a>,</li>
                
                <li><a href="#M000241">[]</a>,</li>
                
                <li><a href="#M000021">[]=</a>,</li>
                
                <li><a href="#M000242">[]=</a></li>
                
            </ul>
        </dd>
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000016">abort!</a>,</li>
                
                <li><a href="#M000239">abort!</a>,</li>
                
                <li><a href="#M000238">active?</a>,</li>
                
                <li><a href="#M000015">active?</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000255">download_next_chunk</a>,</li>
                
                <li><a href="#M000036">download_next_chunk</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000012">new</a>,</li>
                
                <li><a href="#M000234">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000262">on_close</a>,</li>
                
                <li><a href="#M000039">on_close</a>,</li>
                
                <li><a href="#M000253">on_closedir</a>,</li>
                
                <li><a href="#M000034">on_closedir</a>,</li>
                
                <li><a href="#M000254">on_open</a>,</li>
                
                <li><a href="#M000035">on_open</a>,</li>
                
                <li><a href="#M000031">on_opendir</a>,</li>
                
                <li><a href="#M000250">on_opendir</a>,</li>
                
                <li><a href="#M000037">on_read</a>,</li>
                
                <li><a href="#M000260">on_read</a>,</li>
                
                <li><a href="#M000032">on_readdir</a>,</li>
                
                <li><a href="#M000251">on_readdir</a>,</li>
                
                <li><a href="#M000252">open_file</a>,</li>
                
                <li><a href="#M000033">open_file</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000028">process_next_entry</a>,</li>
                
                <li><a href="#M000248">process_next_entry</a>,</li>
                
                <li><a href="#M000023">progress</a>,</li>
                
                <li><a href="#M000245">progress</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000246">read_size</a>,</li>
                
                <li><a href="#M000026">read_size</a>,</li>
                
                <li><a href="#M000014">recursive?</a>,</li>
                
                <li><a href="#M000236">recursive?</a>,</li>
                
                <li><a href="#M000247">requests</a>,</li>
                
                <li><a href="#M000027">requests</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000022">stack</a>,</li>
                
                <li><a href="#M000243">stack</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M000040">update_progress</a>,</li>
                
                <li><a href="#M000264">update_progress</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000240">wait</a>,</li>
                
                <li><a href="#M000017">wait</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <span>Net::SSH::Loggable</span>
            
            START:includes
        </li>
        
        <li>
            
            <span>Net::SSH::Loggable</span>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">Entry</td>
            <td>=</td>
            <td class="attr-value">Struct.new(:remote, :local, :directory, :size, :handle, :offset, :sink)</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
A simple struct for encapsulating information about a single remote file or
directory that needs to be downloaded.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DEFAULT_READ_SIZE</td>
            <td>=</td>
            <td class="attr-value">32_000</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
The default read size.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">Entry</td>
            <td>=</td>
            <td class="attr-value">Struct.new(:remote, :local, :directory, :size, :handle, :offset, :sink)</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
A simple struct for encapsulating information about a single remote file or
directory that needs to be downloaded.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DEFAULT_READ_SIZE</td>
            <td>=</td>
            <td class="attr-value">32_000</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
The default read size.
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>local</td>
            <td class='attr-desc'><p>
The destination of the download (the name of a file or directory on the
local server, or an IO object)
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>remote</td>
            <td class='attr-desc'><p>
The source of the download (the name of a file or directory on the remote
server)
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>
The hash of options that was given to this <a
href="Download.html">Download</a> instance.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>sftp</td>
            <td class='attr-desc'><p>
The <a href="../../SFTP.html">SFTP</a> session instance that drives this
download.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>properties</td>
            <td class='attr-desc'><p>
The properties hash for this object
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>local</td>
            <td class='attr-desc'><p>
The destination of the download (the name of a file or directory on the
local server, or an IO object)
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>remote</td>
            <td class='attr-desc'><p>
The source of the download (the name of a file or directory on the remote
server)
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>
The hash of options that was given to this <a
href="Download.html">Download</a> instance.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>sftp</td>
            <td class='attr-desc'><p>
The <a href="../../SFTP.html">SFTP</a> session instance that drives this
download.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>properties</td>
            <td class='attr-desc'><p>
The properties hash for this object
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000012">
                    
                    <a name="M000012"></a><b>new</b>(sftp, local, remote, options={}, &amp;progress)
                    
                </div>
                
                <div class="description">
                  <p>
Instantiates a new downloader process on top of the given <a
href="../../SFTP.html">SFTP</a> session. <tt>local</tt> is either an IO
object that should receive the data, or a string identifying the target
file or directory on the local host. <tt>remote</tt> is a string
identifying the location on the remote host that the download should
source.
</p>
<p>
This will return immediately, and requires that the <a
href="../../SSH.html">SSH</a> event loop be run in order to effect the
download. (See <a href="Download.html#M000017">wait</a>.)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 146</span>
146:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">sftp</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">remote</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">progress</span>)
147:       <span class="ruby-ivar">@sftp</span> = <span class="ruby-identifier">sftp</span>
148:       <span class="ruby-ivar">@local</span> = <span class="ruby-identifier">local</span>
149:       <span class="ruby-ivar">@remote</span> = <span class="ruby-identifier">remote</span>
150:       <span class="ruby-ivar">@progress</span> = <span class="ruby-identifier">progress</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:progress</span>]
151:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
152:       <span class="ruby-ivar">@active</span> = <span class="ruby-value">0</span>
153:       <span class="ruby-ivar">@properties</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:properties</span>] <span class="ruby-operator">||</span> {}
154: 
155:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">logger</span>
156: 
157:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recursive?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">local</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:write</span>)
158:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;cannot download a directory tree in-memory&quot;</span>
159:       <span class="ruby-keyword kw">end</span>
160: 
161:       <span class="ruby-ivar">@stack</span> = [<span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">remote</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">recursive?</span>)]
162:       <span class="ruby-identifier">process_next_entry</span>
163:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000234">
                    
                    <a name="M000234"></a><b>new</b>(sftp, local, remote, options={}, &amp;progress)
                    
                </div>
                
                <div class="description">
                  <p>
Instantiates a new downloader process on top of the given <a
href="../../SFTP.html">SFTP</a> session. <tt>local</tt> is either an IO
object that should receive the data, or a string identifying the target
file or directory on the local host. <tt>remote</tt> is a string
identifying the location on the remote host that the download should
source.
</p>
<p>
This will return immediately, and requires that the <a
href="../../SSH.html">SSH</a> event loop be run in order to effect the
download. (See <a href="Download.html#M000017">wait</a>.)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000234_source')" id="l_M000234_source">show</a>
                        
                    </p>
                    <div id="M000234_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 146</span>
146:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">sftp</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">remote</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">progress</span>)
147:       <span class="ruby-ivar">@sftp</span> = <span class="ruby-identifier">sftp</span>
148:       <span class="ruby-ivar">@local</span> = <span class="ruby-identifier">local</span>
149:       <span class="ruby-ivar">@remote</span> = <span class="ruby-identifier">remote</span>
150:       <span class="ruby-ivar">@progress</span> = <span class="ruby-identifier">progress</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:progress</span>]
151:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
152:       <span class="ruby-ivar">@active</span> = <span class="ruby-value">0</span>
153:       <span class="ruby-ivar">@properties</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:properties</span>] <span class="ruby-operator">||</span> {}
154: 
155:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">logger</span>
156: 
157:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recursive?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">local</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:write</span>)
158:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;cannot download a directory tree in-memory&quot;</span>
159:       <span class="ruby-keyword kw">end</span>
160: 
161:       <span class="ruby-ivar">@stack</span> = [<span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">remote</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">recursive?</span>)]
162:       <span class="ruby-identifier">process_next_entry</span>
163:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000241">
                    
                    <a name="M000241"></a><b>[]</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the property with the given name. This allows <a
href="Download.html">Download</a> instances to store their own state when
used as part of a state machine.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000241_source')" id="l_M000241_source">show</a>
                        
                    </p>
                    <div id="M000241_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 192</span>
192:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)
193:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_sym</span>]
194:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000018">
                    
                    <a name="M000018"></a><b>[]</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the property with the given name. This allows <a
href="Download.html">Download</a> instances to store their own state when
used as part of a state machine.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000018_source')" id="l_M000018_source">show</a>
                        
                    </p>
                    <div id="M000018_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 192</span>
192:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)
193:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_sym</span>]
194:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000242">
                    
                    <a name="M000242"></a><b>[]=</b>(name, value)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the given property to the given name. This allows <a
href="Download.html">Download</a> instances to store their own state when
used as part of a state machine.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000242_source')" id="l_M000242_source">show</a>
                        
                    </p>
                    <div id="M000242_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 198</span>
198:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
199:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
200:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000021">
                    
                    <a name="M000021"></a><b>[]=</b>(name, value)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the given property to the given name. This allows <a
href="Download.html">Download</a> instances to store their own state when
used as part of a state machine.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000021_source')" id="l_M000021_source">show</a>
                        
                    </p>
                    <div id="M000021_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 198</span>
198:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
199:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
200:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000016">
                    
                    <a name="M000016"></a><b>abort!</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Forces the transfer to stop.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000016_source')" id="l_M000016_source">show</a>
                        
                    </p>
                    <div id="M000016_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 178</span>
178:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">abort!</span>
179:       <span class="ruby-ivar">@active</span> = <span class="ruby-value">0</span>
180:       <span class="ruby-ivar">@stack</span>.<span class="ruby-identifier">clear</span>
181:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000239">
                    
                    <a name="M000239"></a><b>abort!</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Forces the transfer to stop.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000239_source')" id="l_M000239_source">show</a>
                        
                    </p>
                    <div id="M000239_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 178</span>
178:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">abort!</span>
179:       <span class="ruby-ivar">@active</span> = <span class="ruby-value">0</span>
180:       <span class="ruby-ivar">@stack</span>.<span class="ruby-identifier">clear</span>
181:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000015">
                    
                    <a name="M000015"></a><b>active?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if there are any active requests or pending files or
directories.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 173</span>
173:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active?</span>
174:       <span class="ruby-ivar">@active</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">any?</span>
175:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000238">
                    
                    <a name="M000238"></a><b>active?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if there are any active requests or pending files or
directories.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000238_source')" id="l_M000238_source">show</a>
                        
                    </p>
                    <div id="M000238_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 173</span>
173:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active?</span>
174:       <span class="ruby-ivar">@active</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">any?</span>
175:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000014">
                    
                    <a name="M000014"></a><b>recursive?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the value of the :recursive key in the options hash that was given
when the object was instantiated.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">recursive?</span>
168:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:recursive</span>]
169:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000236">
                    
                    <a name="M000236"></a><b>recursive?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the value of the :recursive key in the options hash that was given
when the object was instantiated.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000236_source')" id="l_M000236_source">show</a>
                        
                    </p>
                    <div id="M000236_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">recursive?</span>
168:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:recursive</span>]
169:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000017">
                    
                    <a name="M000017"></a><b>wait</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Runs the <a href="../../SSH.html">SSH</a> event loop for as long as the
downloader is active (see <a href="Download.html#M000015">active?</a>).
This can be used to block until the download completes.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000017_source')" id="l_M000017_source">show</a>
                        
                    </p>
                    <div id="M000017_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 185</span>
185:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wait</span>
186:       <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">loop</span> { <span class="ruby-identifier">active?</span> }
187:       <span class="ruby-keyword kw">self</span>
188:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000240">
                    
                    <a name="M000240"></a><b>wait</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Runs the <a href="../../SSH.html">SSH</a> event loop for as long as the
downloader is active (see <a href="Download.html#M000015">active?</a>).
This can be used to block until the download completes.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000240_source')" id="l_M000240_source">show</a>
                        
                    </p>
                    <div id="M000240_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 185</span>
185:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wait</span>
186:       <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">loop</span> { <span class="ruby-identifier">active?</span> }
187:       <span class="ruby-keyword kw">self</span>
188:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000255">
                    
                    <a name="M000255"></a><b>download_next_chunk</b>(entry)
                    
                </div>
                
                <div class="description">
                  <p>
Initiates a read of the next <a href="Download.html#M000026">read_size</a>
bytes from the file.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000255_source')" id="l_M000255_source">show</a>
                        
                    </p>
                    <div id="M000255_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 317</span>
317:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
318:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span>, <span class="ruby-identifier">read_size</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_read</span>))
319:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
320:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:offset</span>] = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span>
321:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">read_size</span>
322:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000036">
                    
                    <a name="M000036"></a><b>download_next_chunk</b>(entry)
                    
                </div>
                
                <div class="description">
                  <p>
Initiates a read of the next <a href="Download.html#M000026">read_size</a>
bytes from the file.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000036_source')" id="l_M000036_source">show</a>
                        
                    </p>
                    <div id="M000036_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 317</span>
317:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
318:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span>, <span class="ruby-identifier">read_size</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_read</span>))
319:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
320:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:offset</span>] = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span>
321:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">read_size</span>
322:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000039">
                    
                    <a name="M000039"></a><b>on_close</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file handle is closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show</a>
                        
                    </p>
                    <div id="M000039_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 345</span>
345:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_close</span>(<span class="ruby-identifier">response</span>)
346:         <span class="ruby-ivar">@active</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
347:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
348:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;close #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
349:         <span class="ruby-identifier">process_next_entry</span>
350:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000262">
                    
                    <a name="M000262"></a><b>on_close</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file handle is closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000262_source')" id="l_M000262_source">show</a>
                        
                    </p>
                    <div id="M000262_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 345</span>
345:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_close</span>(<span class="ruby-identifier">response</span>)
346:         <span class="ruby-ivar">@active</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
347:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
348:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;close #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
349:         <span class="ruby-identifier">process_next_entry</span>
350:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000034">
                    
                    <a name="M000034"></a><b>on_closedir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a directory handle is closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000034_source')" id="l_M000034_source">show</a>
                        
                    </p>
                    <div id="M000034_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 296</span>
296:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_closedir</span>(<span class="ruby-identifier">response</span>)
297:         <span class="ruby-ivar">@active</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
298:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>]
299:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;close #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
300:         <span class="ruby-identifier">process_next_entry</span>
301:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000253">
                    
                    <a name="M000253"></a><b>on_closedir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a directory handle is closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000253_source')" id="l_M000253_source">show</a>
                        
                    </p>
                    <div id="M000253_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 296</span>
296:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_closedir</span>(<span class="ruby-identifier">response</span>)
297:         <span class="ruby-ivar">@active</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
298:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>]
299:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;close #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
300:         <span class="ruby-identifier">process_next_entry</span>
301:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000035">
                    
                    <a name="M000035"></a><b>on_open</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file has been opened. This will call <a
href="Download.html#M000036">download_next_chunk</a> to initiate the data
transfer.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000035_source')" id="l_M000035_source">show</a>
                        
                    </p>
                    <div id="M000035_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 305</span>
305:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_open</span>(<span class="ruby-identifier">response</span>)
306:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
307:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;open #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
308: 
309:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span> = <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>]
310:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:write</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span> <span class="ruby-operator">:</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>, <span class="ruby-value str">&quot;wb&quot;</span>)
311:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span> = <span class="ruby-value">0</span>
312: 
313:         <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
314:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000254">
                    
                    <a name="M000254"></a><b>on_open</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file has been opened. This will call <a
href="Download.html#M000036">download_next_chunk</a> to initiate the data
transfer.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000254_source')" id="l_M000254_source">show</a>
                        
                    </p>
                    <div id="M000254_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 305</span>
305:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_open</span>(<span class="ruby-identifier">response</span>)
306:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
307:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;open #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
308: 
309:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span> = <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>]
310:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:write</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span> <span class="ruby-operator">:</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>, <span class="ruby-value str">&quot;wb&quot;</span>)
311:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">offset</span> = <span class="ruby-value">0</span>
312: 
313:         <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
314:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000031">
                    
                    <a name="M000031"></a><b>on_opendir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a remote directory is &#8220;opened&#8221; for reading, e.g. to
enumerate its contents. Starts an readdir operation if the opendir
operation was successful.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000031_source')" id="l_M000031_source">show</a>
                        
                    </p>
                    <div id="M000031_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 256</span>
256:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_opendir</span>(<span class="ruby-identifier">response</span>)
257:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
258:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;opendir #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
259:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span> = <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>]
260:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">readdir</span>(<span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_readdir</span>))
261:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
262:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000250">
                    
                    <a name="M000250"></a><b>on_opendir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a remote directory is &#8220;opened&#8221; for reading, e.g. to
enumerate its contents. Starts an readdir operation if the opendir
operation was successful.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000250_source')" id="l_M000250_source">show</a>
                        
                    </p>
                    <div id="M000250_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 256</span>
256:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_opendir</span>(<span class="ruby-identifier">response</span>)
257:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
258:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;opendir #{entry.remote}: #{response}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
259:         <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span> = <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>]
260:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">readdir</span>(<span class="ruby-identifier">response</span>[<span class="ruby-identifier">:handle</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_readdir</span>))
261:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
262:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000037">
                    
                    <a name="M000037"></a><b>on_read</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a read from a file finishes. If the read was successful and
returned data, this will call <a
href="Download.html#M000036">download_next_chunk</a> to read the next bit
from the file. Otherwise the file will be closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show</a>
                        
                    </p>
                    <div id="M000037_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 327</span>
327:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_read</span>(<span class="ruby-identifier">response</span>)
328:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
329: 
330:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">eof?</span>
331:           <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:close</span>, <span class="ruby-identifier">entry</span>)
332:           <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span>.<span class="ruby-identifier">close</span>
333:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">close</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_close</span>))
334:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
335:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
336:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;read #{entry.remote}: #{response}&quot;</span>
337:         <span class="ruby-keyword kw">else</span>
338:           <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:offset</span>], <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:data</span>])
339:           <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">response</span>[<span class="ruby-identifier">:data</span>])
340:           <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
341:         <span class="ruby-keyword kw">end</span>
342:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000260">
                    
                    <a name="M000260"></a><b>on_read</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a read from a file finishes. If the read was successful and
returned data, this will call <a
href="Download.html#M000036">download_next_chunk</a> to read the next bit
from the file. Otherwise the file will be closed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000260_source')" id="l_M000260_source">show</a>
                        
                    </p>
                    <div id="M000260_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 327</span>
327:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_read</span>(<span class="ruby-identifier">response</span>)
328:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>]
329: 
330:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">eof?</span>
331:           <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:close</span>, <span class="ruby-identifier">entry</span>)
332:           <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span>.<span class="ruby-identifier">close</span>
333:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">close</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_close</span>))
334:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
335:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
336:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;read #{entry.remote}: #{response}&quot;</span>
337:         <span class="ruby-keyword kw">else</span>
338:           <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:offset</span>], <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:data</span>])
339:           <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sink</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">response</span>[<span class="ruby-identifier">:data</span>])
340:           <span class="ruby-identifier">download_next_chunk</span>(<span class="ruby-identifier">entry</span>)
341:         <span class="ruby-keyword kw">end</span>
342:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000032">
                    
                    <a name="M000032"></a><b>on_readdir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when the next batch of items is read from a directory on the remote
server. If any items were read, they are added to the queue and <a
href="Download.html#M000028">process_next_entry</a> is called.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000032_source')" id="l_M000032_source">show</a>
                        
                    </p>
                    <div id="M000032_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 267</span>
267:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_readdir</span>(<span class="ruby-identifier">response</span>)
268:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>]
269:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">eof?</span>
270:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">close</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_closedir</span>))
271:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
272:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
273:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;readdir #{entry.remote}: #{response}&quot;</span>
274:         <span class="ruby-keyword kw">else</span>
275:           <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:names</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>
276:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;..&quot;</span>
277:             <span class="ruby-identifier">stack</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span>), <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span>), <span class="ruby-identifier">item</span>.<span class="ruby-identifier">directory?</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>)
278:           <span class="ruby-keyword kw">end</span>
279: 
280:           <span class="ruby-comment cmt"># take this opportunity to enqueue more requests</span>
281:           <span class="ruby-identifier">process_next_entry</span>
282: 
283:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">readdir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_readdir</span>))
284:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
285:         <span class="ruby-keyword kw">end</span>
286:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000251">
                    
                    <a name="M000251"></a><b>on_readdir</b>(response)
                    
                </div>
                
                <div class="description">
                  <p>
Called when the next batch of items is read from a directory on the remote
server. If any items were read, they are added to the queue and <a
href="Download.html#M000028">process_next_entry</a> is called.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000251_source')" id="l_M000251_source">show</a>
                        
                    </p>
                    <div id="M000251_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 267</span>
267:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_readdir</span>(<span class="ruby-identifier">response</span>)
268:         <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>]
269:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">eof?</span>
270:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">close</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_closedir</span>))
271:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
272:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">ok?</span>
273:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;readdir #{entry.remote}: #{response}&quot;</span>
274:         <span class="ruby-keyword kw">else</span>
275:           <span class="ruby-identifier">response</span>[<span class="ruby-identifier">:names</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>
276:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;..&quot;</span>
277:             <span class="ruby-identifier">stack</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span>), <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span>), <span class="ruby-identifier">item</span>.<span class="ruby-identifier">directory?</span>, <span class="ruby-identifier">item</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>)
278:           <span class="ruby-keyword kw">end</span>
279: 
280:           <span class="ruby-comment cmt"># take this opportunity to enqueue more requests</span>
281:           <span class="ruby-identifier">process_next_entry</span>
282: 
283:           <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">readdir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">handle</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_readdir</span>))
284:           <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:parent</span>] = <span class="ruby-identifier">entry</span>
285:         <span class="ruby-keyword kw">end</span>
286:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000252">
                    
                    <a name="M000252"></a><b>open_file</b>(entry)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file is to be opened for reading from the remote server.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000252_source')" id="l_M000252_source">show</a>
                        
                    </p>
                    <div id="M000252_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 289</span>
289:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">entry</span>)
290:         <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:open</span>, <span class="ruby-identifier">entry</span>)
291:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_open</span>))
292:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
293:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000033">
                    
                    <a name="M000033"></a><b>open_file</b>(entry)
                    
                </div>
                
                <div class="description">
                  <p>
Called when a file is to be opened for reading from the remote server.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000033_source')" id="l_M000033_source">show</a>
                        
                    </p>
                    <div id="M000033_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 289</span>
289:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">entry</span>)
290:         <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:open</span>, <span class="ruby-identifier">entry</span>)
291:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_open</span>))
292:         <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
293:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000028">
                    
                    <a name="M000028"></a><b>process_next_entry</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Enqueues as many files and directories from the stack as possible (see <a
href="Download.html#M000027">requests</a>).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000028_source')" id="l_M000028_source">show</a>
                        
                    </p>
                    <div id="M000028_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 235</span>
235:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_next_entry</span>
236:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">requests</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@active</span>
237:           <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">shift</span>
238:           <span class="ruby-ivar">@active</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
239: 
240:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">directory</span>
241:             <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:mkdir</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>)
242:             <span class="ruby-operator">::</span><span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>)
243:             <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">opendir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_opendir</span>))
244:             <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
245:           <span class="ruby-keyword kw">else</span>
246:             <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">entry</span>)
247:           <span class="ruby-keyword kw">end</span>
248:         <span class="ruby-keyword kw">end</span>
249: 
250:         <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:finish</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">active?</span>
251:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000248">
                    
                    <a name="M000248"></a><b>process_next_entry</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Enqueues as many files and directories from the stack as possible (see <a
href="Download.html#M000027">requests</a>).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000248_source')" id="l_M000248_source">show</a>
                        
                    </p>
                    <div id="M000248_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 235</span>
235:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_next_entry</span>
236:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">requests</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@active</span>
237:           <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">shift</span>
238:           <span class="ruby-ivar">@active</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
239: 
240:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">directory</span>
241:             <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:mkdir</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>)
242:             <span class="ruby-operator">::</span><span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">local</span>)
243:             <span class="ruby-identifier">request</span> = <span class="ruby-identifier">sftp</span>.<span class="ruby-identifier">opendir</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">remote</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:on_opendir</span>))
244:             <span class="ruby-identifier">request</span>[<span class="ruby-identifier">:entry</span>] = <span class="ruby-identifier">entry</span>
245:           <span class="ruby-keyword kw">else</span>
246:             <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">entry</span>)
247:           <span class="ruby-keyword kw">end</span>
248:         <span class="ruby-keyword kw">end</span>
249: 
250:         <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">:finish</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">active?</span>
251:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000023">
                    
                    <a name="M000023"></a><b>progress</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The progress handler for this instance. Possibly nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show</a>
                        
                    </p>
                    <div id="M000023_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 217</span>
217:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">progress</span>; <span class="ruby-ivar">@progress</span>; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000245">
                    
                    <a name="M000245"></a><b>progress</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The progress handler for this instance. Possibly nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000245_source')" id="l_M000245_source">show</a>
                        
                    </p>
                    <div id="M000245_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 217</span>
217:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">progress</span>; <span class="ruby-ivar">@progress</span>; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000026">
                    
                    <a name="M000026"></a><b>read_size</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The number of bytes to read at a time from remote files.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show</a>
                        
                    </p>
                    <div id="M000026_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 223</span>
223:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_size</span>
224:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:read_size</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_READ_SIZE</span>
225:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000246">
                    
                    <a name="M000246"></a><b>read_size</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The number of bytes to read at a time from remote files.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000246_source')" id="l_M000246_source">show</a>
                        
                    </p>
                    <div id="M000246_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 223</span>
223:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_size</span>
224:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:read_size</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_READ_SIZE</span>
225:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000247">
                    
                    <a name="M000247"></a><b>requests</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The number of simultaneou <a href="../../SFTP.html">SFTP</a> requests to
use to effect the download. Defaults to 16 for recursive downloads.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000247_source')" id="l_M000247_source">show</a>
                        
                    </p>
                    <div id="M000247_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 229</span>
229:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">requests</span>
230:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:requests</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">recursive?</span> <span class="ruby-value">? </span><span class="ruby-value">16</span> <span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
231:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000027">
                    
                    <a name="M000027"></a><b>requests</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The number of simultaneou <a href="../../SFTP.html">SFTP</a> requests to
use to effect the download. Defaults to 16 for recursive downloads.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000027_source')" id="l_M000027_source">show</a>
                        
                    </p>
                    <div id="M000027_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 229</span>
229:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">requests</span>
230:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:requests</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">recursive?</span> <span class="ruby-value">? </span><span class="ruby-value">16</span> <span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
231:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000022">
                    
                    <a name="M000022"></a><b>stack</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The stack of <a href="Download.html#Entry">Entry</a> instances, indicating
which files and directories on the remote host remain to be downloaded.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000022_source')" id="l_M000022_source">show</a>
                        
                    </p>
                    <div id="M000022_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 214</span>
214:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stack</span>; <span class="ruby-ivar">@stack</span>; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000243">
                    
                    <a name="M000243"></a><b>stack</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The stack of <a href="Download.html#Entry">Entry</a> instances, indicating
which files and directories on the remote host remain to be downloaded.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000243_source')" id="l_M000243_source">show</a>
                        
                    </p>
                    <div id="M000243_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 214</span>
214:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stack</span>; <span class="ruby-ivar">@stack</span>; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000040">
                    
                    <a name="M000040"></a><b>update_progress</b>(hook, *args)
                    
                </div>
                
                <div class="description">
                  <p>
If a progress callback or object has been set, this will report the
progress to that callback or object.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000040_source')" id="l_M000040_source">show</a>
                        
                    </p>
                    <div id="M000040_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 354</span>
354:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">hook</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
355:         <span class="ruby-identifier">on</span> = <span class="ruby-node">&quot;on_#{hook}&quot;</span>
356:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">on</span>)
357:           <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">on</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
358:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:call</span>)
359:           <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">hook</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
360:         <span class="ruby-keyword kw">end</span>
361:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000264">
                    
                    <a name="M000264"></a><b>update_progress</b>(hook, *args)
                    
                </div>
                
                <div class="description">
                  <p>
If a progress callback or object has been set, this will report the
progress to that callback or object.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000264_source')" id="l_M000264_source">show</a>
                        
                    </p>
                    <div id="M000264_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/net/sftp/operations/download.rb, line 354</span>
354:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_progress</span>(<span class="ruby-identifier">hook</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
355:         <span class="ruby-identifier">on</span> = <span class="ruby-node">&quot;on_#{hook}&quot;</span>
356:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">on</span>)
357:           <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">on</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
358:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:call</span>)
359:           <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">hook</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
360:         <span class="ruby-keyword kw">end</span>
361:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    