<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ThinkingSphinx::Search</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            ThinkingSphinx::Search 
            
                <span class="parent">&lt; 
                    
                    Array
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/thinking_sphinx/search_rb.html">lib/thinking_sphinx/search.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Once you&#8217;ve got those indexes in and built, this is the stuff that
matters - how to search! This class provides a generic search interface -
which you can use to search all your indexed models at once. Most times,
you will just want a specific model&#8217;s results - to search and <a
href="Search.html#M000366">search_for_ids</a> methods will do the job in
exactly the same manner when called from a model.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000493">add_default_scope</a>,</li>
                
                <li><a href="#M000431">add_excerpter</a>,</li>
                
                <li><a href="#M000433">add_matching_fields</a>,</li>
                
                <li><a href="#M000494">add_scope</a>,</li>
                
                <li><a href="#M000432">add_sphinx_attributes</a>,</li>
                
                <li><a href="#M000375">all</a>,</li>
                
                <li><a href="#M000468">anchor</a>,</li>
                
                <li><a href="#M000419">append_to</a>,</li>
                
                <li><a href="#M000377">as_json</a>,</li>
                
                <li><a href="#M000477">attribute</a>,</li>
                
                <li><a href="#M000480">attributes</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000371">bundle_searches</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000490">class_from_crc</a>,</li>
                
                <li><a href="#M000440">classes</a>,</li>
                
                <li><a href="#M000418">client</a>,</li>
                
                <li><a href="#M000451">comment</a>,</li>
                
                <li><a href="#M000429">compose_ids_results</a>,</li>
                
                <li><a href="#M000430">compose_only_results</a>,</li>
                
                <li><a href="#M000428">compose_results</a>,</li>
                
                <li><a href="#M000445">conditions_as_query</a>,</li>
                
                <li><a href="#M000423">config</a>,</li>
                
                <li><a href="#M000368">count</a>,</li>
                
                <li><a href="#M000502">crc_attribute</a>,</li>
                
                <li><a href="#M000388">current_page</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000450">default_star_token</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000491">each_with_attribute</a>,</li>
                
                <li><a href="#M000408">each_with_group_and_count</a>,</li>
                
                <li><a href="#M000407">each_with_groupby_and_count</a>,</li>
                
                <li><a href="#M000410">each_with_match</a>,</li>
                
                <li><a href="#M000409">each_with_weighting</a>,</li>
                
                <li><a href="#M000380">error</a>,</li>
                
                <li><a href="#M000379">error?</a>,</li>
                
                <li><a href="#M000411">excerpt_for</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000417">facets</a>,</li>
                
                <li><a href="#M000369">facets</a>,</li>
                
                <li><a href="#M000455">field_names</a>,</li>
                
                <li><a href="#M000467">filter_value</a>,</li>
                
                <li><a href="#M000463">filters</a>,</li>
                
                <li><a href="#M000389">first_page?</a>,</li>
                
                <li><a href="#M000376">freeze</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000459">group_by</a>,</li>
                
                <li><a href="#M000460">group_function</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000482">include_for_class</a>,</li>
                
                <li><a href="#M000484">include_from_array</a>,</li>
                
                <li><a href="#M000485">include_from_hash</a>,</li>
                
                <li><a href="#M000476">index_option</a>,</li>
                
                <li><a href="#M000457">index_weights</a>,</li>
                
                <li><a href="#M000406">indexes</a>,</li>
                
                <li><a href="#M000486">instances_from_class</a>,</li>
                
                <li><a href="#M000487">instances_from_matches</a>,</li>
                
                <li><a href="#M000461">internal_filters</a>,</li>
                
                <li><a href="#M000492">is_scope?</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000393">last_page?</a>,</li>
                
                <li><a href="#M000470">latitude_attr</a>,</li>
                
                <li><a href="#M000396">limit_value</a>,</li>
                
                <li><a href="#M000436">log</a>,</li>
                
                <li><a href="#M000435">log</a>,</li>
                
                <li><a href="#M000475">longitude_attr</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000434">match_hash</a>,</li>
                
                <li><a href="#M000452">match_mode</a>,</li>
                
                <li><a href="#M000372">matching_fields</a>,</li>
                
                <li><a href="#M000495">merge_search</a>,</li>
                
                <li><a href="#M000386">method_missing</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000373">new</a>,</li>
                
                <li><a href="#M000391">next_page</a>,</li>
                
                <li><a href="#M000392">next_page?</a>,</li>
                
                <li><a href="#M000400">num_pages</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000404">offset</a>,</li>
                
                <li><a href="#M000405">offset_value</a>,</li>
                
                <li><a href="#M000441">one_class</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000390">page</a>,</li>
                
                <li><a href="#M000399">page_count</a>,</li>
                
                <li><a href="#M000397">per</a>,</li>
                
                <li><a href="#M000395">per_page</a>,</li>
                
                <li><a href="#M000424">populate</a>,</li>
                
                <li><a href="#M000422">populate_from_queue</a>,</li>
                
                <li><a href="#M000378">populated?</a>,</li>
                
                <li><a href="#M000437">prepare</a>,</li>
                
                <li><a href="#M000394">previous_page</a></li>
                
            </ul>
        </dd>
    
        <dt>Q</dt>
        <dd>
            <ul>
                
                <li><a href="#M000442">query</a>,</li>
                
                <li><a href="#M000401">query_time</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000387">respond_to?</a>,</li>
                
                <li><a href="#M000385">results</a>,</li>
                
                <li><a href="#M000438">retry_on_stale_index</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000499">scoped_count</a>,</li>
                
                <li><a href="#M000413">search</a>,</li>
                
                <li><a href="#M000365">search</a>,</li>
                
                <li><a href="#M000367">search_for_id</a>,</li>
                
                <li><a href="#M000366">search_for_ids</a>,</li>
                
                <li><a href="#M000414">search_for_ids</a>,</li>
                
                <li><a href="#M000489">single_class_results</a>,</li>
                
                <li><a href="#M000454">sort_by</a>,</li>
                
                <li><a href="#M000453">sort_mode</a>,</li>
                
                <li><a href="#M000456">sorted_fields_to_attributes</a>,</li>
                
                <li><a href="#M000481">stale_retries</a>,</li>
                
                <li><a href="#M000446">star_query</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000374">to_a</a>,</li>
                
                <li><a href="#M000403">total_count</a>,</li>
                
                <li><a href="#M000402">total_entries</a>,</li>
                
                <li><a href="#M000398">total_pages</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000370">warn</a>,</li>
                
                <li><a href="#M000382">warning</a>,</li>
                
                <li><a href="#M000381">warning?</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">CoreMethods</td>
            <td>=</td>
            <td class="attr-value">%w( == class class_eval extend frozen? id instance_eval       instance_of? instance_values instance_variable_defined?       instance_variable_get instance_variable_set instance_variables is_a?       kind_of? member? method methods nil? object_id respond_to?       respond_to_missing? send should type )</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SafeMethods</td>
            <td>=</td>
            <td class="attr-value">%w( partition private_methods protected_methods       public_methods send class )</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">HashOptions</td>
            <td>=</td>
            <td class="attr-value">[:conditions, :with, :without, :with_all, :without_any]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ArrayOptions</td>
            <td>=</td>
            <td class="attr-value">[:classes, :without_ids]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DefaultStarToken</td>
            <td>=</td>
            <td class="attr-value">Regexp.new('\p{Word}+')</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DefaultStarToken</td>
            <td>=</td>
            <td class="attr-value">Regexp.new('\w+', nil, 'u')</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>args</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000371">
                    
                    <a name="M000371"></a><b>bundle_searches</b>(enum = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000371_source')" id="l_M000371_source">show</a>
                        
                    </p>
                    <div id="M000371_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 64</span>
64:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">bundle_searches</span>(<span class="ruby-identifier">enum</span> = <span class="ruby-keyword kw">nil</span>)
65:       <span class="ruby-identifier">bundle</span> = <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">BundledSearch</span>.<span class="ruby-identifier">new</span>
66: 
67:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">nil?</span>
68:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">bundle</span>
69:       <span class="ruby-keyword kw">else</span>
70:         <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">bundle</span>, <span class="ruby-identifier">item</span> }
71:       <span class="ruby-keyword kw">end</span>
72: 
73:       <span class="ruby-identifier">bundle</span>.<span class="ruby-identifier">searches</span>
74:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000368">
                    
                    <a name="M000368"></a><b>count</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use ThinkingSphinx.count
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000368_source')" id="l_M000368_source">show</a>
                        
                    </p>
                    <div id="M000368_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 49</span>
49:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">count</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
50:       <span class="ruby-identifier">warn</span> <span class="ruby-value str">'ThinkingSphinx::Search.count is deprecated. Please use ThinkingSphinx.count instead.'</span>
51:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">count</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
52:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000369">
                    
                    <a name="M000369"></a><b>facets</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use ThinkingSphinx.facets
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000369_source')" id="l_M000369_source">show</a>
                        
                    </p>
                    <div id="M000369_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 55</span>
55:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">facets</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
56:       <span class="ruby-identifier">warn</span> <span class="ruby-value str">'ThinkingSphinx::Search.facets is deprecated. Please use ThinkingSphinx.facets instead.'</span>
57:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">facets</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
58:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000372">
                    
                    <a name="M000372"></a><b>matching_fields</b>(fields, bitmask)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000372_source')" id="l_M000372_source">show</a>
                        
                    </p>
                    <div id="M000372_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 76</span>
76:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">matching_fields</span>(<span class="ruby-identifier">fields</span>, <span class="ruby-identifier">bitmask</span>)
77:       <span class="ruby-identifier">matches</span>   = []
78:       <span class="ruby-identifier">bitstring</span> = <span class="ruby-identifier">bitmask</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">rjust</span>(<span class="ruby-value">32</span>, <span class="ruby-value str">'0'</span>).<span class="ruby-identifier">reverse</span>
79: 
80:       <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
81:         <span class="ruby-identifier">matches</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">field</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bitstring</span>[<span class="ruby-identifier">index</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'1'</span>
82:       <span class="ruby-keyword kw">end</span>
83:       <span class="ruby-identifier">matches</span>
84:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000373">
                    
                    <a name="M000373"></a><b>new</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000373_source')" id="l_M000373_source">show</a>
                        
                    </p>
                    <div id="M000373_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 86</span>
86:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
87:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">context</span>.<span class="ruby-identifier">define_indexes</span>
88: 
89:       <span class="ruby-ivar">@array</span>    = []
90:       <span class="ruby-ivar">@options</span>  = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
91:       <span class="ruby-ivar">@args</span>     = <span class="ruby-identifier">args</span>
92: 
93:       <span class="ruby-identifier">add_default_scope</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ignore_default</span>]
94: 
95:       <span class="ruby-identifier">populate</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:populate</span>]
96:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000365">
                    
                    <a name="M000365"></a><b>search</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use ThinkingSphinx.search
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000365_source')" id="l_M000365_source">show</a>
                        
                    </p>
                    <div id="M000365_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 31</span>
31:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">search</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
32:       <span class="ruby-identifier">warn</span> <span class="ruby-value str">'ThinkingSphinx::Search.search is deprecated. Please use ThinkingSphinx.search instead.'</span>
33:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">search</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
34:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000367">
                    
                    <a name="M000367"></a><b>search_for_id</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use ThinkingSphinx.search_for_ids
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000367_source')" id="l_M000367_source">show</a>
                        
                    </p>
                    <div id="M000367_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 43</span>
43:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">search_for_id</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
44:       <span class="ruby-identifier">warn</span> <span class="ruby-value str">'ThinkingSphinx::Search.search_for_id is deprecated. Please use ThinkingSphinx.search_for_id instead.'</span>
45:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">search_for_id</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
46:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000366">
                    
                    <a name="M000366"></a><b>search_for_ids</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use ThinkingSphinx.search_for_ids
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000366_source')" id="l_M000366_source">show</a>
                        
                    </p>
                    <div id="M000366_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 37</span>
37:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">search_for_ids</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
38:       <span class="ruby-identifier">warn</span> <span class="ruby-value str">'ThinkingSphinx::Search.search_for_ids is deprecated. Please use ThinkingSphinx.search_for_ids instead.'</span>
39:       <span class="ruby-constant">ThinkingSphinx</span>.<span class="ruby-identifier">search_for_ids</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
40:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000370">
                    
                    <a name="M000370"></a><b>warn</b>(message)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000370_source')" id="l_M000370_source">show</a>
                        
                    </p>
                    <div id="M000370_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 60</span>
60:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-identifier">message</span>)
61:       <span class="ruby-operator">::</span><span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">warn</span> <span class="ruby-identifier">message</span>
62:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Private methods</div>
            
            <div class="method">
                <div class="title" id="M000435">
                    
                    <a name="M000435"></a><b>log</b>(message, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000435_source')" id="l_M000435_source">show</a>
                        
                    </p>
                    <div id="M000435_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 519</span>
519:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">message</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
520:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">LogSubscriber</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">nil?</span>
521:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
522:         <span class="ruby-keyword kw">return</span>
523:       <span class="ruby-keyword kw">end</span>
524: 
525:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
526:         <span class="ruby-operator">::</span><span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Notifications</span>.
527:           <span class="ruby-identifier">instrument</span>(<span class="ruby-value str">'query.thinking_sphinx'</span>, <span class="ruby-identifier">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">message</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
528:       <span class="ruby-keyword kw">else</span>
529:         <span class="ruby-operator">::</span><span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Notifications</span>.
530:           <span class="ruby-identifier">instrument</span>(<span class="ruby-value str">'message.thinking_sphinx'</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">message</span>)
531:       <span class="ruby-keyword kw">end</span>
532:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000375">
                    
                    <a name="M000375"></a><b>all</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Populates the search result set
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000375_source')" id="l_M000375_source">show</a>
                        
                    </p>
                    <div id="M000375_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 104</span>
104:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all</span>
105:       <span class="ruby-identifier">populate</span>
106:       <span class="ruby-keyword kw">self</span>
107:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000419">
                    
                    <a name="M000419"></a><b>append_to</b>(client)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000419_source')" id="l_M000419_source">show</a>
                        
                    </p>
                    <div id="M000419_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 395</span>
395:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">append_to</span>(<span class="ruby-identifier">client</span>)
396:       <span class="ruby-identifier">prepare</span> <span class="ruby-identifier">client</span>
397:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">append_query</span> <span class="ruby-identifier">query</span>, <span class="ruby-identifier">indexes</span>, <span class="ruby-identifier">comment</span>
398:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">reset</span>
399:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000377">
                    
                    <a name="M000377"></a><b>as_json</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000377_source')" id="l_M000377_source">show</a>
                        
                    </p>
                    <div id="M000377_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 115</span>
115:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">as_json</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
116:       <span class="ruby-identifier">populate</span>
117:       <span class="ruby-ivar">@array</span>.<span class="ruby-identifier">as_json</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000418">
                    
                    <a name="M000418"></a><b>client</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000418_source')" id="l_M000418_source">show</a>
                        
                    </p>
                    <div id="M000418_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 389</span>
389:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">client</span>
390:       <span class="ruby-identifier">client</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:client</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">client</span>
391: 
392:       <span class="ruby-identifier">prepare</span> <span class="ruby-identifier">client</span>
393:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000388">
                    
                    <a name="M000388"></a><b>current_page</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The current page number of the result set. Defaults to 1 if no page was
explicitly requested.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000388_source')" id="l_M000388_source">show</a>
                        
                    </p>
                    <div id="M000388_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 207</span>
207:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_page</span>
208:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:page</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-value">? </span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:page</span>].<span class="ruby-identifier">to_i</span>
209:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000408">
                    
                    <a name="M000408"></a><b>each_with_group_and_count</b>(&amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000407">each_with_groupby_and_count</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000407">
                    
                    <a name="M000407"></a><b>each_with_groupby_and_count</b>(&amp;block)
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Search.html#M000408">each_with_group_and_count</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000407_source')" id="l_M000407_source">show</a>
                        
                    </p>
                    <div id="M000407_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 325</span>
325:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_with_groupby_and_count</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
326:       <span class="ruby-identifier">populate</span>
327:       <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
328:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">index</span>],
329:           <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">&quot;@groupby&quot;</span>],
330:           <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">&quot;@count&quot;</span>]
331:       <span class="ruby-keyword kw">end</span>
332:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000410">
                    
                    <a name="M000410"></a><b>each_with_match</b>(&amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000410_source')" id="l_M000410_source">show</a>
                        
                    </p>
                    <div id="M000410_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 342</span>
342:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_with_match</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
343:       <span class="ruby-identifier">populate</span>
344:       <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
345:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">index</span>], <span class="ruby-identifier">match</span>
346:       <span class="ruby-keyword kw">end</span>
347:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000409">
                    
                    <a name="M000409"></a><b>each_with_weighting</b>(&amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000409_source')" id="l_M000409_source">show</a>
                        
                    </p>
                    <div id="M000409_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 335</span>
335:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_with_weighting</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
336:       <span class="ruby-identifier">populate</span>
337:       <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
338:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">index</span>], <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:weight</span>]
339:       <span class="ruby-keyword kw">end</span>
340:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000380">
                    
                    <a name="M000380"></a><b>error</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The Sphinx-reported error, if any.
</p>
<p>
@return [<a href="../String.html">String</a>, nil]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000380_source')" id="l_M000380_source">show</a>
                        
                    </p>
                    <div id="M000380_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 141</span>
141:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>
142:       <span class="ruby-identifier">populate</span>
143:       <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:error</span>]
144:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000379">
                    
                    <a name="M000379"></a><b>error?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Indication of whether the request resulted in an error from Sphinx.
</p>
<p>
@return [Boolean] true if Sphinx reports query error
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000379_source')" id="l_M000379_source">show</a>
                        
                    </p>
                    <div id="M000379_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 133</span>
133:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error?</span>
134:       <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">error</span>
135:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000411">
                    
                    <a name="M000411"></a><b>excerpt_for</b>(string, model = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000411_source')" id="l_M000411_source">show</a>
                        
                    </p>
                    <div id="M000411_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 349</span>
349:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">excerpt_for</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">model</span> = <span class="ruby-keyword kw">nil</span>)
350:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">one_class</span>
351:         <span class="ruby-identifier">model</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">one_class</span>
352:       <span class="ruby-keyword kw">end</span>
353: 
354:       <span class="ruby-identifier">populate</span>
355: 
356:       <span class="ruby-identifier">index</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:index</span>] <span class="ruby-operator">||</span> <span class="ruby-node">&quot;#{model.core_index_names.first}&quot;</span>
357:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">excerpts</span>(
358:         {
359:           <span class="ruby-identifier">:docs</span>   =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">string</span>.<span class="ruby-identifier">to_s</span>],
360:           <span class="ruby-identifier">:words</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:words</span>].<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>),
361:           <span class="ruby-identifier">:index</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">strip</span>
362:         }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:excerpt_options</span>] <span class="ruby-operator">||</span> {})
363:       ).<span class="ruby-identifier">first</span>
364:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000417">
                    
                    <a name="M000417"></a><b>facets</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000417_source')" id="l_M000417_source">show</a>
                        
                    </p>
                    <div id="M000417_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 381</span>
381:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">facets</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
382:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
383:       <span class="ruby-identifier">merge_search</span> <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>
384:       <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">options</span>
385: 
386:       <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">FacetSearch</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
387:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000389">
                    
                    <a name="M000389"></a><b>first_page?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000389_source')" id="l_M000389_source">show</a>
                        
                    </p>
                    <div id="M000389_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 211</span>
211:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first_page?</span>
212:       <span class="ruby-identifier">current_page</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
213:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000376">
                    
                    <a name="M000376"></a><b>freeze</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000376_source')" id="l_M000376_source">show</a>
                        
                    </p>
                    <div id="M000376_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 109</span>
109:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">freeze</span>
110:       <span class="ruby-identifier">populate</span>
111:       <span class="ruby-ivar">@array</span>.<span class="ruby-identifier">freeze</span>
112:       <span class="ruby-keyword kw">self</span>
113:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000406">
                    
                    <a name="M000406"></a><b>indexes</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000406_source')" id="l_M000406_source">show</a>
                        
                    </p>
                    <div id="M000406_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 316</span>
316:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">indexes</span>
317:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:index</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:index</span>]
318:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'*'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">empty?</span>
319: 
320:       <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
321:         <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">sphinx_index_names</span>
322:       }.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)
323:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000393">
                    
                    <a name="M000393"></a><b>last_page?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000393_source')" id="l_M000393_source">show</a>
                        
                    </p>
                    <div id="M000393_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 234</span>
234:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last_page?</span>
235:       <span class="ruby-identifier">next_page</span>.<span class="ruby-identifier">nil?</span>
236:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000396">
                    
                    <a name="M000396"></a><b>limit_value</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000395">per_page</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000386">
                    
                    <a name="M000386"></a><b>method_missing</b>(method, *args, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000386_source')" id="l_M000386_source">show</a>
                        
                    </p>
                    <div id="M000386_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 172</span>
172:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
173:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_scope?</span>(<span class="ruby-identifier">method</span>)
174:         <span class="ruby-identifier">add_scope</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
175:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
176:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">method</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:search_count</span>
177:         <span class="ruby-identifier">merge_search</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">search</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>), <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>
178:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">scoped_count</span>
179:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-regexp re">/^each_with_.*/</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@array</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
180:         <span class="ruby-keyword kw">super</span>
181:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-constant">SafeMethods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>)
182:         <span class="ruby-identifier">populate</span>
183:       <span class="ruby-keyword kw">end</span>
184: 
185:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-regexp re">/^each_with_.*/</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@array</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
186:         <span class="ruby-identifier">each_with_attribute</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^each_with_/</span>, <span class="ruby-value str">''</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
187:       <span class="ruby-keyword kw">else</span>
188:         <span class="ruby-ivar">@array</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
189:       <span class="ruby-keyword kw">end</span>
190:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000391">
                    
                    <a name="M000391"></a><b>next_page</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The next page number of the result set. If there are no more pages
available, nil is returned.
</p>
<p>
@return [Integer, nil]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000391_source')" id="l_M000391_source">show</a>
                        
                    </p>
                    <div id="M000391_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 226</span>
226:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">next_page</span>
227:       <span class="ruby-identifier">current_page</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">total_pages</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">current_page</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
228:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000392">
                    
                    <a name="M000392"></a><b>next_page?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000392_source')" id="l_M000392_source">show</a>
                        
                    </p>
                    <div id="M000392_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 230</span>
230:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">next_page?</span>
231:       <span class="ruby-operator">!</span><span class="ruby-identifier">next_page</span>.<span class="ruby-identifier">nil?</span>
232:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000400">
                    
                    <a name="M000400"></a><b>num_pages</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000398">total_pages</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000404">
                    
                    <a name="M000404"></a><b>offset</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The current page&#8217;s offset, based on the number of records per page.
Or explicit :offset if given.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Search.html#M000405">offset_value</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000404_source')" id="l_M000404_source">show</a>
                        
                    </p>
                    <div id="M000404_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 310</span>
310:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">offset</span>
311:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:offset</span>] <span class="ruby-operator">||</span> ((<span class="ruby-identifier">current_page</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">per_page</span>)
312:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000405">
                    
                    <a name="M000405"></a><b>offset_value</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000404">offset</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000390">
                    
                    <a name="M000390"></a><b>page</b>(page_number)
                    
                </div>
                
                <div class="description">
                  <p>
Kaminari support
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000390_source')" id="l_M000390_source">show</a>
                        
                    </p>
                    <div id="M000390_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 216</span>
216:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">page</span>(<span class="ruby-identifier">page_number</span>)
217:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:page</span>] = <span class="ruby-identifier">page_number</span>
218:       <span class="ruby-keyword kw">self</span>
219:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000399">
                    
                    <a name="M000399"></a><b>page_count</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000398">total_pages</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000397">
                    
                    <a name="M000397"></a><b>per</b>(limit)
                    
                </div>
                
                <div class="description">
                  <p>
Kaminari support
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000397_source')" id="l_M000397_source">show</a>
                        
                    </p>
                    <div id="M000397_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 261</span>
261:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">per</span>(<span class="ruby-identifier">limit</span>)
262:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:limit</span>] = <span class="ruby-identifier">limit</span>
263:       <span class="ruby-keyword kw">self</span>
264:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000395">
                    
                    <a name="M000395"></a><b>per_page</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The amount of records per set of paged results. Defaults to 20 unless a
specific page size is requested.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Search.html#M000396">limit_value</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000395_source')" id="l_M000395_source">show</a>
                        
                    </p>
                    <div id="M000395_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 252</span>
252:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">per_page</span>
253:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:limit</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:per_page</span>]
254:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:limit</span>] <span class="ruby-operator">||=</span> <span class="ruby-value">20</span>
255:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:limit</span>].<span class="ruby-identifier">to_i</span>
256:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000422">
                    
                    <a name="M000422"></a><b>populate_from_queue</b>(results)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000422_source')" id="l_M000422_source">show</a>
                        
                    </p>
                    <div id="M000422_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 401</span>
401:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">populate_from_queue</span>(<span class="ruby-identifier">results</span>)
402:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@populated</span>
403:       <span class="ruby-ivar">@populated</span> = <span class="ruby-keyword kw">true</span>
404:       <span class="ruby-ivar">@results</span>   = <span class="ruby-identifier">results</span>
405: 
406:       <span class="ruby-identifier">compose_results</span>
407:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000378">
                    
                    <a name="M000378"></a><b>populated?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Indication of whether the request has been made to Sphinx for the search
query.
</p>
<p>
@return [Boolean] true if the results have been requested.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000378_source')" id="l_M000378_source">show</a>
                        
                    </p>
                    <div id="M000378_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 125</span>
125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">populated?</span>
126:       <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-ivar">@populated</span>
127:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000394">
                    
                    <a name="M000394"></a><b>previous_page</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The previous page number of the result set. If this is the first page, then
nil is returned.
</p>
<p>
@return [Integer, nil]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000394_source')" id="l_M000394_source">show</a>
                        
                    </p>
                    <div id="M000394_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 243</span>
243:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">previous_page</span>
244:       <span class="ruby-identifier">current_page</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">current_page</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
245:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000401">
                    
                    <a name="M000401"></a><b>query_time</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Query time taken
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000401_source')" id="l_M000401_source">show</a>
                        
                    </p>
                    <div id="M000401_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 284</span>
284:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_time</span>
285:       <span class="ruby-identifier">populate</span>
286:       <span class="ruby-keyword kw">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:time</span>].<span class="ruby-identifier">nil?</span>
287: 
288:       <span class="ruby-ivar">@query_time</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:time</span>]
289:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000387">
                    
                    <a name="M000387"></a><b>respond_to?</b>(method, include_private = false)
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if the <a href="Search.html">Search</a> object or the
underlying Array object respond to the requested method.
</p>
<p>
@param [Symbol] method The method name @return [Boolean] true if either <a
href="Search.html">Search</a> or Array responds to the method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000387_source')" id="l_M000387_source">show</a>
                        
                    </p>
                    <div id="M000387_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 198</span>
198:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_private</span> = <span class="ruby-keyword kw">false</span>)
199:       <span class="ruby-keyword kw">super</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@array</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_private</span>)
200:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000385">
                    
                    <a name="M000385"></a><b>results</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The query result hash from Riddle.
</p>
<p>
@return [Hash] Raw Sphinx results
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000385_source')" id="l_M000385_source">show</a>
                        
                    </p>
                    <div id="M000385_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">results</span>
168:       <span class="ruby-identifier">populate</span>
169:       <span class="ruby-ivar">@results</span>
170:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000413">
                    
                    <a name="M000413"></a><b>search</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000413_source')" id="l_M000413_source">show</a>
                        
                    </p>
                    <div id="M000413_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 366</span>
366:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
367:       <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:ignore_default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
368:       <span class="ruby-identifier">merge_search</span> <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>), <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>
369:       <span class="ruby-keyword kw">self</span>
370:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000414">
                    
                    <a name="M000414"></a><b>search_for_ids</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000414_source')" id="l_M000414_source">show</a>
                        
                    </p>
                    <div id="M000414_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 372</span>
372:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_for_ids</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
373:       <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>.<span class="ruby-identifier">merge</span>(
374:         <span class="ruby-identifier">:ignore_default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
375:         <span class="ruby-identifier">:ids_only</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
376:       )
377:       <span class="ruby-identifier">merge_search</span> <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>), <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>
378:       <span class="ruby-keyword kw">self</span>
379:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000374">
                    
                    <a name="M000374"></a><b>to_a</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000374_source')" id="l_M000374_source">show</a>
                        
                    </p>
                    <div id="M000374_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 98</span>
 98:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_a</span>
 99:       <span class="ruby-identifier">populate</span>
100:       <span class="ruby-ivar">@array</span>
101:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000403">
                    
                    <a name="M000403"></a><b>total_count</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Search.html#M000402">total_entries</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000402">
                    
                    <a name="M000402"></a><b>total_entries</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The total number of search results available.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Search.html#M000403">total_count</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000402_source')" id="l_M000402_source">show</a>
                        
                    </p>
                    <div id="M000402_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 295</span>
295:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total_entries</span>
296:       <span class="ruby-identifier">populate</span>
297:       <span class="ruby-keyword kw">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@results</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:total_found</span>].<span class="ruby-identifier">nil?</span>
298: 
299:       <span class="ruby-ivar">@total_entries</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:total_found</span>]
300:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000398">
                    
                    <a name="M000398"></a><b>total_pages</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The total number of pages available if the results are paginated.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Search.html#M000399">page_count</a>
                    
                    <a href="Search.html#M000400">num_pages</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000398_source')" id="l_M000398_source">show</a>
                        
                    </p>
                    <div id="M000398_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 270</span>
270:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total_pages</span>
271:       <span class="ruby-identifier">populate</span>
272:       <span class="ruby-keyword kw">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@results</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:total</span>].<span class="ruby-identifier">nil?</span>
273: 
274:       <span class="ruby-ivar">@total_pages</span> <span class="ruby-operator">||=</span> (<span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:total</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">per_page</span>.<span class="ruby-identifier">to_f</span>).<span class="ruby-identifier">ceil</span>
275:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000382">
                    
                    <a name="M000382"></a><b>warning</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The Sphinx-reported warning, if any.
</p>
<p>
@return [<a href="../String.html">String</a>, nil]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000382_source')" id="l_M000382_source">show</a>
                        
                    </p>
                    <div id="M000382_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 158</span>
158:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">warning</span>
159:       <span class="ruby-identifier">populate</span>
160:       <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:warning</span>]
161:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000381">
                    
                    <a name="M000381"></a><b>warning?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Indication of whether the request resulted in a warning from Sphinx.
</p>
<p>
@return [Boolean] true if Sphinx reports query warning
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000381_source')" id="l_M000381_source">show</a>
                        
                    </p>
                    <div id="M000381_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">warning?</span>
151:       <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">warning</span>
152:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000493">
                    
                    <a name="M000493"></a><b>add_default_scope</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Adds the default_sphinx_scope if set.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000493_source')" id="l_M000493_source">show</a>
                        
                    </p>
                    <div id="M000493_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 965</span>
965:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_default_scope</span>
966:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">one_class</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">has_default_sphinx_scope?</span>
967:       <span class="ruby-identifier">add_scope</span>(<span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">get_default_sphinx_scope</span>.<span class="ruby-identifier">to_sym</span>)
968:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000431">
                    
                    <a name="M000431"></a><b>add_excerpter</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000431_source')" id="l_M000431_source">show</a>
                        
                    </p>
                    <div id="M000431_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 477</span>
477:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_excerpter</span>
478:       <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span>
479:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">nil?</span>
480: 
481:         <span class="ruby-identifier">object</span>.<span class="ruby-identifier">excerpts</span> = <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Excerpter</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">object</span>
482:       <span class="ruby-keyword kw">end</span>
483:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000433">
                    
                    <a name="M000433"></a><b>add_matching_fields</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000433_source')" id="l_M000433_source">show</a>
                        
                    </p>
                    <div id="M000433_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 496</span>
496:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_matching_fields</span>
497:       <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span>
498:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">nil?</span>
499: 
500:         <span class="ruby-identifier">match</span> = <span class="ruby-identifier">match_hash</span> <span class="ruby-identifier">object</span>
501:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">nil?</span>
502:         <span class="ruby-identifier">object</span>.<span class="ruby-identifier">matching_fields</span> = <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Search</span>.<span class="ruby-identifier">matching_fields</span>(
503:           <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:fields</span>], <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:weight</span>]
504:         )
505:       <span class="ruby-keyword kw">end</span>
506:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000494">
                    
                    <a name="M000494"></a><b>add_scope</b>(method, *args, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000494_source')" id="l_M000494_source">show</a>
                        
                    </p>
                    <div id="M000494_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 970</span>
970:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_scope</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
971:       <span class="ruby-identifier">method</span> = <span class="ruby-node">&quot;#{method}_without_default&quot;</span>.<span class="ruby-identifier">to_sym</span>
972:       <span class="ruby-identifier">merge_search</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>), <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>
973:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000432">
                    
                    <a name="M000432"></a><b>add_sphinx_attributes</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000432_source')" id="l_M000432_source">show</a>
                        
                    </p>
                    <div id="M000432_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 485</span>
485:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_sphinx_attributes</span>
486:       <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span>
487:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">nil?</span>
488: 
489:         <span class="ruby-identifier">match</span> = <span class="ruby-identifier">match_hash</span> <span class="ruby-identifier">object</span>
490:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">nil?</span>
491: 
492:         <span class="ruby-identifier">object</span>.<span class="ruby-identifier">sphinx_attributes</span> = <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>]
493:       <span class="ruby-keyword kw">end</span>
494:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000468">
                    
                    <a name="M000468"></a><b>anchor</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000468_source')" id="l_M000468_source">show</a>
                        
                    </p>
                    <div id="M000468_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 787</span>
787:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">anchor</span>
788:       <span class="ruby-keyword kw">return</span> {} <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:geo</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lat</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lng</span>])
789: 
790:       {
791:         <span class="ruby-identifier">:latitude</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:geo</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:geo</span>].<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lat</span>],
792:         <span class="ruby-identifier">:longitude</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:geo</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:geo</span>].<span class="ruby-identifier">last</span>  <span class="ruby-operator">:</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lng</span>],
793:         <span class="ruby-identifier">:latitude_attribute</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">latitude_attr</span>.<span class="ruby-identifier">to_s</span>,
794:         <span class="ruby-identifier">:longitude_attribute</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">longitude_attr</span>.<span class="ruby-identifier">to_s</span>
795:       }
796:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000477">
                    
                    <a name="M000477"></a><b>attribute</b>(*keys)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000477_source')" id="l_M000477_source">show</a>
                        
                    </p>
                    <div id="M000477_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 818</span>
818:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attribute</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">keys</span>)
819:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">one_class</span>
820: 
821:       <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
822:         <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span>)
823:       }
824:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000480">
                    
                    <a name="M000480"></a><b>attributes</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000480_source')" id="l_M000480_source">show</a>
                        
                    </p>
                    <div id="M000480_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 826</span>
826:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attributes</span>
827:       <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">one_class</span>
828: 
829:       <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
830:         <span class="ruby-identifier">index</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span><span class="ruby-operator">|</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">unique_name</span> }
831:       }.<span class="ruby-identifier">flatten</span>
832:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000490">
                    
                    <a name="M000490"></a><b>class_from_crc</b>(crc)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000490_source')" id="l_M000490_source">show</a>
                        
                    </p>
                    <div id="M000490_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 944</span>
944:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">class_from_crc</span>(<span class="ruby-identifier">crc</span>)
945:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Riddle</span>.<span class="ruby-identifier">loaded_version</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
946:         <span class="ruby-identifier">config</span>.<span class="ruby-identifier">models_by_crc</span>[<span class="ruby-identifier">crc</span>].<span class="ruby-identifier">constantize</span>
947:       <span class="ruby-keyword kw">else</span>
948:         <span class="ruby-identifier">crc</span>.<span class="ruby-identifier">constantize</span>
949:       <span class="ruby-keyword kw">end</span>
950:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000440">
                    
                    <a name="M000440"></a><b>classes</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000440_source')" id="l_M000440_source">show</a>
                        
                    </p>
                    <div id="M000440_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 597</span>
597:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">classes</span>
598:       <span class="ruby-ivar">@classes</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:classes</span>] <span class="ruby-operator">||</span> []
599:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000451">
                    
                    <a name="M000451"></a><b>comment</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000451_source')" id="l_M000451_source">show</a>
                        
                    </p>
                    <div id="M000451_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 649</span>
649:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">comment</span>
650:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:comment</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>
651:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000429">
                    
                    <a name="M000429"></a><b>compose_ids_results</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000429_source')" id="l_M000429_source">show</a>
                        
                    </p>
                    <div id="M000429_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 455</span>
455:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compose_ids_results</span>
456:       <span class="ruby-identifier">replace</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
457:         <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">'sphinx_internal_id'</span>]
458:       }
459:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000430">
                    
                    <a name="M000430"></a><b>compose_only_results</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000430_source')" id="l_M000430_source">show</a>
                        
                    </p>
                    <div id="M000430_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 461</span>
461:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compose_only_results</span>
462:       <span class="ruby-identifier">replace</span> <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
463:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">only</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:only</span>]
464:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Symbol</span>
465:           <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">only</span>.<span class="ruby-identifier">to_s</span>]
466:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
467:           <span class="ruby-identifier">only</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, <span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
468:             <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">attribute</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">attribute</span>.<span class="ruby-identifier">to_s</span>]
469:             <span class="ruby-identifier">hash</span>
470:           <span class="ruby-keyword kw">end</span>
471:         <span class="ruby-keyword kw">else</span>
472:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unexpected object for :only argument. String or Array is expected, #{only.class} was received.&quot;</span>
473:         <span class="ruby-keyword kw">end</span>
474:       }
475:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000428">
                    
                    <a name="M000428"></a><b>compose_results</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000428_source')" id="l_M000428_source">show</a>
                        
                    </p>
                    <div id="M000428_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 442</span>
442:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compose_results</span>
443:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ids_only</span>]
444:         <span class="ruby-identifier">compose_ids_results</span>
445:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:only</span>]
446:         <span class="ruby-identifier">compose_only_results</span>
447:       <span class="ruby-keyword kw">else</span>
448:         <span class="ruby-identifier">replace</span> <span class="ruby-identifier">instances_from_matches</span>
449:         <span class="ruby-identifier">add_excerpter</span>
450:         <span class="ruby-identifier">add_sphinx_attributes</span>
451:         <span class="ruby-identifier">add_matching_fields</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">rank_mode</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:fieldmask</span>
452:       <span class="ruby-keyword kw">end</span>
453:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000445">
                    
                    <a name="M000445"></a><b>conditions_as_query</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000445_source')" id="l_M000445_source">show</a>
                        
                    </p>
                    <div id="M000445_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 612</span>
612:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_as_query</span>
613:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">''</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:conditions</span>].<span class="ruby-identifier">blank?</span>
614: 
615:       <span class="ruby-value str">' '</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:conditions</span>].<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
616:         <span class="ruby-node">&quot;@#{key} #{options[:conditions][key]}&quot;</span>
617:       }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)
618:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000423">
                    
                    <a name="M000423"></a><b>config</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000423_source')" id="l_M000423_source">show</a>
                        
                    </p>
                    <div id="M000423_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 411</span>
411:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">config</span>
412:       <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">instance</span>
413:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000502">
                    
                    <a name="M000502"></a><b>crc_attribute</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000502_source')" id="l_M000502_source">show</a>
                        
                    </p>
                    <div id="M000502_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 1003</span>
1003:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">crc_attribute</span>
1004:       <span class="ruby-constant">Riddle</span>.<span class="ruby-identifier">loaded_version</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'class_crc'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'sphinx_internal_class'</span>
1005:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000450">
                    
                    <a name="M000450"></a><b>default_star_token</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000450_source')" id="l_M000450_source">show</a>
                        
                    </p>
                    <div id="M000450_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 645</span>
645:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_star_token</span>
646:       <span class="ruby-constant">DefaultStarToken</span>
647:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000491">
                    
                    <a name="M000491"></a><b>each_with_attribute</b>(attribute, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000491_source')" id="l_M000491_source">show</a>
                        
                    </p>
                    <div id="M000491_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 952</span>
952:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_with_attribute</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
953:       <span class="ruby-identifier">populate</span>
954:       <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
955:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">index</span>],
956:           (<span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">attribute</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-node">&quot;@#{attribute}&quot;</span>])
957:       <span class="ruby-keyword kw">end</span>
958:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000455">
                    
                    <a name="M000455"></a><b>field_names</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000455_source')" id="l_M000455_source">show</a>
                        
                    </p>
                    <div id="M000455_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 689</span>
689:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">field_names</span>
690:       <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">one_class</span>
691: 
692:       <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
693:         <span class="ruby-identifier">index</span>.<span class="ruby-identifier">fields</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span> <span class="ruby-identifier">field</span>.<span class="ruby-identifier">unique_name</span> }
694:       }.<span class="ruby-identifier">flatten</span>
695:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000467">
                    
                    <a name="M000467"></a><b>filter_value</b>(value)
                    
                </div>
                
                <div class="description">
                  <p>
When passed a Time instance, returns the integer timestamp.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000467_source')" id="l_M000467_source">show</a>
                        
                    </p>
                    <div id="M000467_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 772</span>
772:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>)
773:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span>
774:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Range</span>
775:         <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">first</span>).<span class="ruby-identifier">first</span><span class="ruby-operator">..</span><span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">last</span>).<span class="ruby-identifier">first</span>
776:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
777:         <span class="ruby-identifier">value</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">v</span>) }.<span class="ruby-identifier">flatten</span>
778:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Date</span>, <span class="ruby-constant">Time</span>
779:         [<span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_i</span>]
780:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NilClass</span>
781:         <span class="ruby-value">0</span>
782:       <span class="ruby-keyword kw">else</span>
783:         <span class="ruby-constant">Array</span>(<span class="ruby-identifier">value</span>)
784:       <span class="ruby-keyword kw">end</span>
785:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000463">
                    
                    <a name="M000463"></a><b>filters</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000463_source')" id="l_M000463_source">show</a>
                        
                    </p>
                    <div id="M000463_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 751</span>
751:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filters</span>
752:       <span class="ruby-identifier">internal_filters</span> <span class="ruby-operator">+</span>
753:       (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:with</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
754:         <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>)
755:       } <span class="ruby-operator">+</span>
756:       (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
757:         <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>), <span class="ruby-keyword kw">true</span>
758:       } <span class="ruby-operator">+</span>
759:       (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:with_all</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">values</span><span class="ruby-operator">|</span>
760:         <span class="ruby-constant">Array</span>(<span class="ruby-identifier">values</span>).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
761:           <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>)
762:         }
763:       }.<span class="ruby-identifier">flatten</span> <span class="ruby-operator">+</span>
764:       (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_any</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">values</span><span class="ruby-operator">|</span>
765:         <span class="ruby-constant">Array</span>(<span class="ruby-identifier">values</span>).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
766:           <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">value</span>), <span class="ruby-keyword kw">true</span>
767:         }
768:       }.<span class="ruby-identifier">flatten</span>
769:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000459">
                    
                    <a name="M000459"></a><b>group_by</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000459_source')" id="l_M000459_source">show</a>
                        
                    </p>
                    <div id="M000459_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 725</span>
725:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group_by</span>
726:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:group</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:group</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
727:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000460">
                    
                    <a name="M000460"></a><b>group_function</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000460_source')" id="l_M000460_source">show</a>
                        
                    </p>
                    <div id="M000460_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 729</span>
729:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group_function</span>
730:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:group</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:attr</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
731:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000482">
                    
                    <a name="M000482"></a><b>include_for_class</b>(klass)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000482_source')" id="l_M000482_source">show</a>
                        
                    </p>
                    <div id="M000482_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 845</span>
845:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_for_class</span>(<span class="ruby-identifier">klass</span>)
846:       <span class="ruby-identifier">includes</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:include</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">sphinx_index_options</span>[<span class="ruby-identifier">:include</span>]
847: 
848:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">includes</span>
849:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NilClass</span>
850:         <span class="ruby-keyword kw">nil</span>
851:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
852:         <span class="ruby-identifier">include_from_array</span> <span class="ruby-identifier">includes</span>, <span class="ruby-identifier">klass</span>
853:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
854:         <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">reflections</span>[<span class="ruby-identifier">includes</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">includes</span>
855:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
856:         <span class="ruby-identifier">include_from_hash</span> <span class="ruby-identifier">includes</span>, <span class="ruby-identifier">klass</span>
857:       <span class="ruby-keyword kw">else</span>
858:         <span class="ruby-identifier">includes</span>
859:       <span class="ruby-keyword kw">end</span>
860:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000484">
                    
                    <a name="M000484"></a><b>include_from_array</b>(array, klass)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000484_source')" id="l_M000484_source">show</a>
                        
                    </p>
                    <div id="M000484_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 862</span>
862:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_from_array</span>(<span class="ruby-identifier">array</span>, <span class="ruby-identifier">klass</span>)
863:       <span class="ruby-identifier">scoped_array</span> = []
864:       <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
865:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span>
866:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
867:           <span class="ruby-identifier">scoped_hash</span> = <span class="ruby-identifier">include_from_hash</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">klass</span>)
868:           <span class="ruby-identifier">scoped_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">scoped_hash</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">scoped_hash</span>.<span class="ruby-identifier">nil?</span>
869:         <span class="ruby-keyword kw">else</span>
870:           <span class="ruby-identifier">scoped_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">reflections</span>[<span class="ruby-identifier">value</span>].<span class="ruby-identifier">nil?</span>
871:         <span class="ruby-keyword kw">end</span>
872:       <span class="ruby-keyword kw">end</span>
873:       <span class="ruby-identifier">scoped_array</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">scoped_array</span>
874:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000485">
                    
                    <a name="M000485"></a><b>include_from_hash</b>(hash, klass)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000485_source')" id="l_M000485_source">show</a>
                        
                    </p>
                    <div id="M000485_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 876</span>
876:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_from_hash</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">klass</span>)
877:       <span class="ruby-identifier">scoped_hash</span> = {}
878:       <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
879:         <span class="ruby-identifier">scoped_hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">reflections</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">nil?</span>
880:       <span class="ruby-keyword kw">end</span>
881:       <span class="ruby-identifier">scoped_hash</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">scoped_hash</span>
882:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000476">
                    
                    <a name="M000476"></a><b>index_option</b>(key)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000476_source')" id="l_M000476_source">show</a>
                        
                    </p>
                    <div id="M000476_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 810</span>
810:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index_option</span>(<span class="ruby-identifier">key</span>)
811:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">one_class</span>
812: 
813:       <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
814:         <span class="ruby-identifier">index</span>.<span class="ruby-identifier">local_options</span>[<span class="ruby-identifier">key</span>]
815:       }.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">first</span>
816:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000457">
                    
                    <a name="M000457"></a><b>index_weights</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Turn :<a href="Search.html#M000457">index_weights</a> => {
&#8220;foo&#8221; => 2, User => 1 } into :<a
href="Search.html#M000457">index_weights</a> => { &#8220;foo&#8221; => 2,
&#8220;user_core&#8220; => 1, &#8220;user_delta&#8220; => 1 }
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000457_source')" id="l_M000457_source">show</a>
                        
                    </p>
                    <div id="M000457_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 710</span>
710:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index_weights</span>
711:       <span class="ruby-identifier">weights</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:index_weights</span>] <span class="ruby-operator">||</span> {}
712:       <span class="ruby-identifier">weights</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, <span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
713:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Class</span>)
714:           <span class="ruby-identifier">name</span> = <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">Index</span>.<span class="ruby-identifier">name_for</span>(<span class="ruby-identifier">key</span>)
715:           <span class="ruby-identifier">hash</span>[<span class="ruby-node">&quot;#{name}_core&quot;</span>]  = <span class="ruby-identifier">weights</span>[<span class="ruby-identifier">key</span>]
716:           <span class="ruby-identifier">hash</span>[<span class="ruby-node">&quot;#{name}_delta&quot;</span>] = <span class="ruby-identifier">weights</span>[<span class="ruby-identifier">key</span>]
717:         <span class="ruby-keyword kw">else</span>
718:           <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">weights</span>[<span class="ruby-identifier">key</span>]
719:         <span class="ruby-keyword kw">end</span>
720: 
721:         <span class="ruby-identifier">hash</span>
722:       <span class="ruby-keyword kw">end</span>
723:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000486">
                    
                    <a name="M000486"></a><b>instances_from_class</b>(klass, matches)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000486_source')" id="l_M000486_source">show</a>
                        
                    </p>
                    <div id="M000486_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 884</span>
884:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instances_from_class</span>(<span class="ruby-identifier">klass</span>, <span class="ruby-identifier">matches</span>)
885:       <span class="ruby-identifier">index_options</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">sphinx_index_options</span>
886: 
887:       <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">&quot;sphinx_internal_id&quot;</span>] }
888:       <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">find</span>(
889:         <span class="ruby-identifier">:all</span>,
890:         <span class="ruby-identifier">:joins</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:joins</span>],
891:         <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">primary_key_for_sphinx</span>.<span class="ruby-identifier">to_sym</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ids</span>},
892:         <span class="ruby-identifier">:include</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">include_for_class</span>(<span class="ruby-identifier">klass</span>),
893:         <span class="ruby-identifier">:select</span>     =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:select</span>]  <span class="ruby-operator">||</span> <span class="ruby-identifier">index_options</span>[<span class="ruby-identifier">:select</span>]),
894:         <span class="ruby-identifier">:order</span>      =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sql_order</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">index_options</span>[<span class="ruby-identifier">:sql_order</span>])
895:       ) <span class="ruby-operator">:</span> []
896: 
897:       <span class="ruby-comment cmt"># Raise an exception if we find records in Sphinx but not in the DB, so</span>
898:       <span class="ruby-comment cmt"># the search method can retry without them. See</span>
899:       <span class="ruby-comment cmt"># ThinkingSphinx::Search.retry_search_on_stale_index.</span>
900:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:raise_on_stale</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">length</span>
901:         <span class="ruby-identifier">stale_ids</span> = <span class="ruby-identifier">ids</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">id</span> }
902:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">StaleIdsException</span>, <span class="ruby-identifier">stale_ids</span>
903:       <span class="ruby-keyword kw">end</span>
904: 
905:       <span class="ruby-comment cmt"># if the user has specified an SQL order, return the collection</span>
906:       <span class="ruby-comment cmt"># without rearranging it into the Sphinx order</span>
907:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instances</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sql_order</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">index_options</span>[<span class="ruby-identifier">:sql_order</span>])
908: 
909:       <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">obj_id</span><span class="ruby-operator">|</span>
910:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">detect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>
911:           <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">primary_key_for_sphinx</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">obj_id</span>
912:         <span class="ruby-keyword kw">end</span>
913:       }
914:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000487">
                    
                    <a name="M000487"></a><b>instances_from_matches</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Group results by class and call find(:all) once for each group to reduce
the number of find&#8217;s in multi-model searches.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000487_source')" id="l_M000487_source">show</a>
                        
                    </p>
                    <div id="M000487_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 919</span>
919:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instances_from_matches</span>
920:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">single_class_results</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">one_class</span>
921: 
922:       <span class="ruby-identifier">groups</span> = <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
923:         <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">crc_attribute</span>]
924:       }
925:       <span class="ruby-identifier">groups</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">crc</span>, <span class="ruby-identifier">group</span><span class="ruby-operator">|</span>
926:         <span class="ruby-identifier">group</span>.<span class="ruby-identifier">replace</span>(
927:           <span class="ruby-identifier">instances_from_class</span>(<span class="ruby-identifier">class_from_crc</span>(<span class="ruby-identifier">crc</span>), <span class="ruby-identifier">group</span>)
928:         )
929:       <span class="ruby-keyword kw">end</span>
930: 
931:       <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
932:         <span class="ruby-identifier">groups</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">crc</span>, <span class="ruby-identifier">group</span><span class="ruby-operator">|</span>
933:           <span class="ruby-identifier">crc</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">crc_attribute</span>]
934:         }[<span class="ruby-value">1</span>].<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>
935:           <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">primary_key_for_sphinx</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">&quot;sphinx_internal_id&quot;</span>]
936:         }
937:       <span class="ruby-keyword kw">end</span>
938:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000461">
                    
                    <a name="M000461"></a><b>internal_filters</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000461_source')" id="l_M000461_source">show</a>
                        
                    </p>
                    <div id="M000461_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 733</span>
733:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">internal_filters</span>
734:       <span class="ruby-identifier">filters</span> = [<span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'sphinx_deleted'</span>, [<span class="ruby-value">0</span>])]
735: 
736:       <span class="ruby-identifier">class_crcs</span> = <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
737:         <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">to_crc32s</span>
738:       }.<span class="ruby-identifier">flatten</span>
739: 
740:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">class_crcs</span>.<span class="ruby-identifier">empty?</span>
741:         <span class="ruby-identifier">filters</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'class_crc'</span>, <span class="ruby-identifier">class_crcs</span>)
742:       <span class="ruby-keyword kw">end</span>
743: 
744:       <span class="ruby-identifier">filters</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span><span class="ruby-operator">::</span><span class="ruby-constant">Filter</span>.<span class="ruby-identifier">new</span>(
745:         <span class="ruby-value str">'sphinx_internal_id'</span>, <span class="ruby-identifier">filter_value</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_ids</span>]), <span class="ruby-keyword kw">true</span>
746:       ) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_ids</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_ids</span>].<span class="ruby-identifier">empty?</span>
747: 
748:       <span class="ruby-identifier">filters</span>
749:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000492">
                    
                    <a name="M000492"></a><b>is_scope?</b>(method)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000492_source')" id="l_M000492_source">show</a>
                        
                    </p>
                    <div id="M000492_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 960</span>
960:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_scope?</span>(<span class="ruby-identifier">method</span>)
961:       <span class="ruby-identifier">one_class</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_scopes</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
962:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000470">
                    
                    <a name="M000470"></a><b>latitude_attr</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000470_source')" id="l_M000470_source">show</a>
                        
                    </p>
                    <div id="M000470_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 798</span>
798:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">latitude_attr</span>
799:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:latitude_attr</span>]      <span class="ruby-operator">||</span>
800:       <span class="ruby-identifier">index_option</span>(<span class="ruby-identifier">:latitude_attr</span>) <span class="ruby-operator">||</span>
801:       <span class="ruby-identifier">attribute</span>(<span class="ruby-identifier">:lat</span>, <span class="ruby-identifier">:latitude</span>)
802:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000436">
                    
                    <a name="M000436"></a><b>log</b>(query, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000436_source')" id="l_M000436_source">show</a>
                        
                    </p>
                    <div id="M000436_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 534</span>
534:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log</span>(<span class="ruby-identifier">query</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
535:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">query</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
536:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000475">
                    
                    <a name="M000475"></a><b>longitude_attr</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000475_source')" id="l_M000475_source">show</a>
                        
                    </p>
                    <div id="M000475_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 804</span>
804:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">longitude_attr</span>
805:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:longitude_attr</span>]      <span class="ruby-operator">||</span>
806:       <span class="ruby-identifier">index_option</span>(<span class="ruby-identifier">:longitude_attr</span>) <span class="ruby-operator">||</span>
807:       <span class="ruby-identifier">attribute</span>(<span class="ruby-identifier">:lon</span>, <span class="ruby-identifier">:lng</span>, <span class="ruby-identifier">:longitude</span>)
808:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000434">
                    
                    <a name="M000434"></a><b>match_hash</b>(object)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000434_source')" id="l_M000434_source">show</a>
                        
                    </p>
                    <div id="M000434_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 508</span>
508:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_hash</span>(<span class="ruby-identifier">object</span>)
509:       <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:matches</span>].<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
510:         <span class="ruby-identifier">class_crc</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>
511:         <span class="ruby-identifier">class_crc</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_crc32</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Riddle</span>.<span class="ruby-identifier">loaded_version</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
512: 
513:         <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-value str">'sphinx_internal_id'</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">object</span>.
514:           <span class="ruby-identifier">primary_key_for_sphinx</span> <span class="ruby-operator">&amp;&amp;</span>
515:         <span class="ruby-identifier">match</span>[<span class="ruby-identifier">:attributes</span>][<span class="ruby-identifier">crc_attribute</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">class_crc</span>
516:       }
517:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000452">
                    
                    <a name="M000452"></a><b>match_mode</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000452_source')" id="l_M000452_source">show</a>
                        
                    </p>
                    <div id="M000452_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 653</span>
653:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_mode</span>
654:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:match_mode</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:conditions</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-value">? </span><span class="ruby-operator">:</span><span class="ruby-identifier">all</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:extended</span>)
655:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000495">
                    
                    <a name="M000495"></a><b>merge_search</b>(search, args, options)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000495_source')" id="l_M000495_source">show</a>
                        
                    </p>
                    <div id="M000495_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 975</span>
975:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge_search</span>(<span class="ruby-identifier">search</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>)
976:       <span class="ruby-identifier">search</span>.<span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span> }
977: 
978:       <span class="ruby-identifier">search</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
979:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HashOptions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span>)
980:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> {}
981:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">merge!</span> <span class="ruby-identifier">search</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>]
982:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">ArrayOptions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span>)
983:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> []
984:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">search</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>]
985:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">uniq!</span>
986:         <span class="ruby-keyword kw">else</span>
987:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">search</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>]
988:         <span class="ruby-keyword kw">end</span>
989:       <span class="ruby-keyword kw">end</span>
990:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000441">
                    
                    <a name="M000441"></a><b>one_class</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000441_source')" id="l_M000441_source">show</a>
                        
                    </p>
                    <div id="M000441_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 601</span>
601:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">one_class</span>
602:       <span class="ruby-ivar">@one_class</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">first</span>
603:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000424">
                    
                    <a name="M000424"></a><b>populate</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000424_source')" id="l_M000424_source">show</a>
                        
                    </p>
                    <div id="M000424_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 415</span>
415:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">populate</span>
416:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@populated</span>
417:       <span class="ruby-ivar">@populated</span> = <span class="ruby-keyword kw">true</span>
418: 
419:       <span class="ruby-identifier">retry_on_stale_index</span> <span class="ruby-keyword kw">do</span>
420:         <span class="ruby-keyword kw">begin</span>
421:           <span class="ruby-identifier">log</span> <span class="ruby-identifier">query</span> <span class="ruby-keyword kw">do</span>
422:             <span class="ruby-ivar">@results</span> = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">query</span> <span class="ruby-identifier">query</span>, <span class="ruby-identifier">indexes</span>, <span class="ruby-identifier">comment</span>
423:           <span class="ruby-keyword kw">end</span>
424:           <span class="ruby-identifier">total</span> = <span class="ruby-ivar">@results</span>[<span class="ruby-identifier">:total_found</span>].<span class="ruby-identifier">to_i</span>
425:           <span class="ruby-identifier">log</span> <span class="ruby-node">&quot;Found #{total} result#{'s' unless total == 1}&quot;</span>
426: 
427:           <span class="ruby-identifier">log</span> <span class="ruby-node">&quot;Sphinx Daemon returned warning: #{warning}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">warning?</span>
428: 
429:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">error?</span>
430:             <span class="ruby-identifier">log</span> <span class="ruby-node">&quot;Sphinx Daemon returned error: #{error}&quot;</span>
431:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">SphinxError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">error</span>, <span class="ruby-ivar">@results</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ignore_errors</span>]
432:           <span class="ruby-keyword kw">end</span>
433:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ECONNREFUSED</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">err</span>
434:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ThinkingSphinx</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionError</span>,
435:             <span class="ruby-value str">'Connection to Sphinx Daemon (searchd) failed.'</span>
436:         <span class="ruby-keyword kw">end</span>
437: 
438:         <span class="ruby-identifier">compose_results</span>
439:       <span class="ruby-keyword kw">end</span>
440:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000437">
                    
                    <a name="M000437"></a><b>prepare</b>(client)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000437_source')" id="l_M000437_source">show</a>
                        
                    </p>
                    <div id="M000437_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 538</span>
538:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">client</span>)
539:       <span class="ruby-identifier">index_options</span> = {}
540:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">one_class</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span>.<span class="ruby-identifier">first</span>
541:         <span class="ruby-identifier">index_options</span> = <span class="ruby-identifier">one_class</span>.<span class="ruby-identifier">sphinx_indexes</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">local_options</span>
542:       <span class="ruby-keyword kw">end</span>
543: 
544:       [
545:         <span class="ruby-identifier">:max_matches</span>, <span class="ruby-identifier">:group_by</span>, <span class="ruby-identifier">:group_function</span>, <span class="ruby-identifier">:group_clause</span>,
546:         <span class="ruby-identifier">:group_distinct</span>, <span class="ruby-identifier">:id_range</span>, <span class="ruby-identifier">:cut_off</span>, <span class="ruby-identifier">:retry_count</span>, <span class="ruby-identifier">:retry_delay</span>,
547:         <span class="ruby-identifier">:rank_mode</span>, <span class="ruby-identifier">:max_query_time</span>, <span class="ruby-identifier">:field_weights</span>
548:       ].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
549:         <span class="ruby-identifier">value</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">index_options</span>[<span class="ruby-identifier">key</span>]
550:         <span class="ruby-identifier">client</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{key}=&quot;</span>, <span class="ruby-identifier">value</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>
551:       <span class="ruby-keyword kw">end</span>
552: 
553:       <span class="ruby-comment cmt"># treated non-standard as :select is already used for AR queries</span>
554:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">select</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sphinx_select</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'*'</span>
555: 
556:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">limit</span>      = <span class="ruby-identifier">per_page</span>
557:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">offset</span>     = <span class="ruby-identifier">offset</span>
558:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">match_mode</span> = <span class="ruby-identifier">match_mode</span>
559:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">filters</span>    = <span class="ruby-identifier">filters</span>
560:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">sort_mode</span>  = <span class="ruby-identifier">sort_mode</span>
561:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">sort_by</span>    = <span class="ruby-identifier">sort_by</span>
562:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">group_by</span>   = <span class="ruby-identifier">group_by</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group_by</span>
563:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">group_function</span> = <span class="ruby-identifier">group_function</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group_function</span>
564:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">index_weights</span>  = <span class="ruby-identifier">index_weights</span>
565:       <span class="ruby-identifier">client</span>.<span class="ruby-identifier">anchor</span>     = <span class="ruby-identifier">anchor</span>
566: 
567:       <span class="ruby-identifier">client</span>
568:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000442">
                    
                    <a name="M000442"></a><b>query</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000442_source')" id="l_M000442_source">show</a>
                        
                    </p>
                    <div id="M000442_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 605</span>
605:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query</span>
606:       <span class="ruby-ivar">@query</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">begin</span>
607:         <span class="ruby-identifier">q</span> = <span class="ruby-ivar">@args</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">conditions_as_query</span>
608:         (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:star</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">star_query</span>(<span class="ruby-identifier">q</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">q</span>).<span class="ruby-identifier">strip</span>
609:       <span class="ruby-keyword kw">end</span>
610:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000438">
                    
                    <a name="M000438"></a><b>retry_on_stale_index</b>(&amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000438_source')" id="l_M000438_source">show</a>
                        
                    </p>
                    <div id="M000438_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 570</span>
570:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">retry_on_stale_index</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
571:       <span class="ruby-identifier">stale_ids</span> = []
572:       <span class="ruby-identifier">retries</span>   = <span class="ruby-identifier">stale_retries</span>
573: 
574:       <span class="ruby-keyword kw">begin</span>
575:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:raise_on_stale</span>] = <span class="ruby-identifier">retries</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
576:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>
577: 
578:         <span class="ruby-comment cmt"># If ThinkingSphinx::Search#instances_from_matches found records in</span>
579:         <span class="ruby-comment cmt"># Sphinx but not in the DB and the :raise_on_stale option is set, this</span>
580:         <span class="ruby-comment cmt"># exception is raised. We retry a limited number of times, excluding the</span>
581:         <span class="ruby-comment cmt"># stale ids from the search.</span>
582:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">StaleIdsException</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">err</span>
583:         <span class="ruby-identifier">retries</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
584: 
585:         <span class="ruby-comment cmt"># For logging</span>
586:         <span class="ruby-identifier">stale_ids</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">err</span>.<span class="ruby-identifier">ids</span>
587:         <span class="ruby-comment cmt"># ID exclusion</span>
588:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_ids</span>] = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:without_ids</span>]) <span class="ruby-operator">|</span> <span class="ruby-identifier">err</span>.<span class="ruby-identifier">ids</span>
589: 
590:         <span class="ruby-identifier">log</span> <span class="ruby-value str">'Stale Ids (%s %s left): %s'</span> <span class="ruby-operator">%</span> [
591:           <span class="ruby-identifier">retries</span>, (<span class="ruby-identifier">retries</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'try'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'tries'</span>), <span class="ruby-identifier">stale_ids</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)
592:         ]
593:         <span class="ruby-keyword kw">retry</span>
594:       <span class="ruby-keyword kw">end</span>
595:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000499">
                    
                    <a name="M000499"></a><b>scoped_count</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000499_source')" id="l_M000499_source">show</a>
                        
                    </p>
                    <div id="M000499_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 992</span>
 992:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scoped_count</span>
 993:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">total_entries</span> <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ids_only</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:only</span>])
 994: 
 995:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ids_only</span>] = <span class="ruby-keyword kw">true</span>
 996:       <span class="ruby-identifier">results_count</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">total_entries</span>
 997:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ids_only</span>] = <span class="ruby-keyword kw">false</span>
 998:       <span class="ruby-ivar">@populated</span> = <span class="ruby-keyword kw">false</span>
 999: 
1000:       <span class="ruby-identifier">results_count</span>
1001:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000489">
                    
                    <a name="M000489"></a><b>single_class_results</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000489_source')" id="l_M000489_source">show</a>
                        
                    </p>
                    <div id="M000489_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 940</span>
940:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">single_class_results</span>
941:       <span class="ruby-identifier">instances_from_class</span> <span class="ruby-identifier">one_class</span>, <span class="ruby-identifier">results</span>[<span class="ruby-identifier">:matches</span>]
942:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000454">
                    
                    <a name="M000454"></a><b>sort_by</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000454_source')" id="l_M000454_source">show</a>
                        
                    </p>
                    <div id="M000454_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 677</span>
677:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sort_by</span>
678:       <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@sort_by</span> = (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sort_by</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:order</span>])
679:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
680:         <span class="ruby-identifier">sorted_fields_to_attributes</span>(<span class="ruby-ivar">@sort_by</span>.<span class="ruby-identifier">clone</span>)
681:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
682:         <span class="ruby-identifier">field_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@sort_by</span>) <span class="ruby-operator">?</span>
683:           <span class="ruby-ivar">@sort_by</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-value str">'_sort'</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@sort_by</span>.<span class="ruby-identifier">to_s</span>
684:       <span class="ruby-keyword kw">else</span>
685:         <span class="ruby-value str">''</span>
686:       <span class="ruby-keyword kw">end</span>
687:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000453">
                    
                    <a name="M000453"></a><b>sort_mode</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000453_source')" id="l_M000453_source">show</a>
                        
                    </p>
                    <div id="M000453_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 657</span>
657:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sort_mode</span>
658:       <span class="ruby-ivar">@sort_mode</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sort_mode</span>]
659:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:asc</span>
660:         <span class="ruby-identifier">:attr_asc</span>
661:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:desc</span>
662:         <span class="ruby-identifier">:attr_desc</span>
663:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>
664:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:order</span>]
665:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
666:           <span class="ruby-identifier">:extended</span>
667:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
668:           <span class="ruby-identifier">:attr_asc</span>
669:         <span class="ruby-keyword kw">else</span>
670:           <span class="ruby-identifier">:relevance</span>
671:         <span class="ruby-keyword kw">end</span>
672:       <span class="ruby-keyword kw">else</span>
673:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:sort_mode</span>]
674:       <span class="ruby-keyword kw">end</span>
675:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000456">
                    
                    <a name="M000456"></a><b>sorted_fields_to_attributes</b>(order_string)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000456_source')" id="l_M000456_source">show</a>
                        
                    </p>
                    <div id="M000456_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 697</span>
697:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sorted_fields_to_attributes</span>(<span class="ruby-identifier">order_string</span>)
698:       <span class="ruby-identifier">field_names</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>
699:         <span class="ruby-identifier">order_string</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-node">/(^|\s)#{field}(,?\s|$)/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
700:           <span class="ruby-identifier">match</span>.<span class="ruby-identifier">gsub</span> <span class="ruby-identifier">field</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">field</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-value str">&quot;_sort&quot;</span>)
701:         }
702:       }
703: 
704:       <span class="ruby-identifier">order_string</span>
705:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000481">
                    
                    <a name="M000481"></a><b>stale_retries</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000481_source')" id="l_M000481_source">show</a>
                        
                    </p>
                    <div id="M000481_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 834</span>
834:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stale_retries</span>
835:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:retry_stale</span>]
836:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">TrueClass</span>
837:         <span class="ruby-value">3</span>
838:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-constant">FalseClass</span>
839:         <span class="ruby-value">0</span>
840:       <span class="ruby-keyword kw">else</span>
841:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:retry_stale</span>].<span class="ruby-identifier">to_i</span>
842:       <span class="ruby-keyword kw">end</span>
843:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000446">
                    
                    <a name="M000446"></a><b>star_query</b>(query)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000446_source')" id="l_M000446_source">show</a>
                        
                    </p>
                    <div id="M000446_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/thinking_sphinx/search.rb, line 620</span>
620:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">star_query</span>(<span class="ruby-identifier">query</span>)
621:       <span class="ruby-identifier">token</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:star</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:star</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">default_star_token</span>
622: 
623:       <span class="ruby-identifier">query</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/(&quot;#{token}(.*?#{token})?&quot;|(?![!-])#{token})/</span><span class="ruby-identifier">u</span>) <span class="ruby-keyword kw">do</span>
624:         <span class="ruby-identifier">pre</span>, <span class="ruby-identifier">proper</span>, <span class="ruby-identifier">post</span> = <span class="ruby-identifier">$`</span>, <span class="ruby-identifier">$&amp;</span>, <span class="ruby-identifier">$'</span>
625:         <span class="ruby-comment cmt"># E.g. &quot;@foo&quot;, &quot;/2&quot;, &quot;~3&quot;, but not as part of a token</span>
626:         <span class="ruby-identifier">is_operator</span> = <span class="ruby-identifier">pre</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">%r{(\W|^)[@~/]\Z}</span>) <span class="ruby-operator">||</span>
627:                       <span class="ruby-identifier">pre</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">%r{(\W|^)@\([^\)]*$}</span>)
628:         <span class="ruby-comment cmt"># E.g. &quot;foo bar&quot;, with quotes</span>
629:         <span class="ruby-identifier">is_quote</span>    = <span class="ruby-identifier">proper</span>.<span class="ruby-identifier">starts_with?</span>(<span class="ruby-value str">'&quot;'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">proper</span>.<span class="ruby-identifier">ends_with?</span>(<span class="ruby-value str">'&quot;'</span>)
630:         <span class="ruby-identifier">has_star</span>    = <span class="ruby-identifier">pre</span>.<span class="ruby-identifier">ends_with?</span>(<span class="ruby-value str">&quot;*&quot;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">starts_with?</span>(<span class="ruby-value str">&quot;*&quot;</span>)
631:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_operator</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">is_quote</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">has_star</span>
632:           <span class="ruby-identifier">proper</span>
633:         <span class="ruby-keyword kw">else</span>
634:           <span class="ruby-node">&quot;*#{proper}*&quot;</span>
635:         <span class="ruby-keyword kw">end</span>
636:       <span class="ruby-keyword kw">end</span>
637:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    