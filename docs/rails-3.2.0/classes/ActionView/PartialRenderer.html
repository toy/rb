<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActionView::PartialRenderer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            ActionView::PartialRenderer 
            
                <span class="parent">&lt; 
                    
                    AbstractRenderer
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/actionpack-3_2_0/lib/action_view/renderer/partial_renderer_rb.html">actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <h1>Action View Partials</h1>
<p>
There&#8217;s also a convenience method for rendering sub templates within
the current controller that depends on a single object (we call this kind
of sub templates for partials). It relies on the fact that partials should
follow the naming convention of being prefixed with an underscore &#8212;
as to separate them from regular templates that could be rendered on their
own.
</p>
<p>
In a template for Advertiser#account:
</p>
<pre>
 &lt;%= render :partial =&gt; &quot;account&quot; %&gt;
</pre>
<p>
This would render &#8220;advertiser/_account.html.erb&#8220;.
</p>
<p>
In another template for Advertiser#buy, we could have:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;account&quot;, :locals =&gt; { :account =&gt; @buyer } %&gt;

  &lt;% @advertisements.each do |ad| %&gt;
    &lt;%= render :partial =&gt; &quot;ad&quot;, :locals =&gt; { :ad =&gt; ad } %&gt;
  &lt;% end %&gt;
</pre>
<p>
This would first render &#8220;advertiser/_account.html.erb&#8220; with
@buyer passed in as the local variable <tt>account</tt>, then render
&#8220;advertiser/_ad.html.erb&#8220; and pass the local variable
<tt>ad</tt> to the template for display.
</p>
<h2>The :as and :object options</h2>
<p>
By default <tt>ActionView::PartialRenderer</tt> doesn&#8217;t have any
local variables. The <tt>:object</tt> option can be used to pass an object
to the partial. For instance:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;account&quot;, :object =&gt; @buyer %&gt;
</pre>
<p>
would provide the +@buyer+ object to the partial, available under the local
variable <tt>account</tt> and is equivalent to:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;account&quot;, :locals =&gt; { :account =&gt; @buyer } %&gt;
</pre>
<p>
With the <tt>:as</tt> option we can specify a different name for said local
variable. For example, if we wanted it to be <tt>user</tt> instead of
<tt>account</tt> we&#8217;d do:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;account&quot;, :object =&gt; @buyer, :as =&gt; 'user' %&gt;
</pre>
<p>
This is equivalent to
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;account&quot;, :locals =&gt; { :user =&gt; @buyer } %&gt;
</pre>
<h2>Rendering a collection of partials</h2>
<p>
The example of partial use describes a familiar pattern where a template
needs to iterate over an array and render a sub template for each of the
elements. This pattern has been implemented as a single method that accepts
an array and renders a partial by the same name as the elements contained
within. So the three-lined example in &#8220;Using partials&#8221; can be
rewritten with a single line:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;ad&quot;, :collection =&gt; @advertisements %&gt;
</pre>
<p>
This will render &#8220;advertiser/_ad.html.erb&#8220; and pass the local
variable <tt>ad</tt> to the template for display. An iteration counter will
automatically be made available to the template with a name of the form
<tt>partial_name_counter</tt>. In the case of the example above, the
template would be fed <tt>ad_counter</tt>.
</p>
<p>
The <tt>:as</tt> option may be used when rendering partials.
</p>
<p>
You can specify a partial to be rendered between elements via the
<tt>:spacer_template</tt> option. The following example will render
<tt>advertiser/_ad_divider.html.erb</tt> between each ad partial:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;ad&quot;, :collection =&gt; @advertisements, :spacer_template =&gt; &quot;ad_divider&quot; %&gt;
</pre>
<p>
If the given <tt>:collection</tt> is nil or empty, <tt>render</tt> will
return nil. This will allow you to specify a text which will displayed
instead by using this form:
</p>
<pre>
  &lt;%= render(:partial =&gt; &quot;ad&quot;, :collection =&gt; @advertisements) || &quot;There's no ad to be displayed&quot; %&gt;
</pre>
<p>
NOTE: Due to backwards compatibility concerns, the collection can&#8217;t
be one of hashes. Normally you&#8217;d also just keep domain objects, like
Active Records, in there.
</p>
<h2>Rendering shared partials</h2>
<p>
Two controllers can share a set of partials and render them like this:
</p>
<pre>
  &lt;%= render :partial =&gt; &quot;advertisement/ad&quot;, :locals =&gt; { :ad =&gt; @advertisement } %&gt;
</pre>
<p>
This will render the partial &#8220;advertisement/_ad.html.erb&#8220;
regardless of which controller this is being called from.
</p>
<h2>Rendering objects that respond to `to_partial_path`</h2>
<p>
Instead of explicitly naming the location of a partial, you can also let <a
href="PartialRenderer.html">PartialRenderer</a> do the work and pick the
proper path by checking `to_proper_path` method. If the object passed to
render is a collection, all objects must return the same path.
</p>
<pre>
 # @account.to_partial_path returns 'accounts/account', so it can be used to replace:
 # &lt;%= render :partial =&gt; &quot;accounts/account&quot;, :locals =&gt; { :account =&gt; @account} %&gt;
 &lt;%= render :partial =&gt; @account %&gt;

 # @posts is an array of Post instances, so every post record returns 'posts/post' on `to_partial_path`,
 # that's why we can replace:
 # &lt;%= render :partial =&gt; &quot;posts/post&quot;, :collection =&gt; @posts %&gt;
 &lt;%= render :partial =&gt; @posts %&gt;
</pre>
<h2>Rendering the default case</h2>
<p>
If you&#8217;re not going to be using any of the options like collections
or layouts, you can also use the short-hand defaults of render to render
partials. Examples:
</p>
<pre>
 # Instead of &lt;%= render :partial =&gt; &quot;account&quot; %&gt;
 &lt;%= render &quot;account&quot; %&gt;

 # Instead of &lt;%= render :partial =&gt; &quot;account&quot;, :locals =&gt; { :account =&gt; @buyer } %&gt;
 &lt;%= render &quot;account&quot;, :account =&gt; @buyer %&gt;

 # @account.to_partial_path returns 'accounts/account', so it can be used to replace:
 # &lt;%= render :partial =&gt; &quot;accounts/account&quot;, :locals =&gt; { :account =&gt; @account} %&gt;
 &lt;%= render @account %&gt;

 # @posts is an array of Post instances, so every post record returns 'posts/post' on `to_partial_path`,
 # that's why we can replace:
 # &lt;%= render :partial =&gt; &quot;posts/post&quot;, :collection =&gt; @posts %&gt;
 &lt;%= render @posts %&gt;
</pre>
<h2>Rendering partials with layouts</h2>
<p>
Partials can have their own layouts applied to them. These layouts are
different than the ones that are specified globally for the entire action,
but they work in a similar fashion. Imagine a list with two types of users:
</p>
<pre>
  &lt;%# app/views/users/index.html.erb &amp;&gt;
  Here's the administrator:
  &lt;%= render :partial =&gt; &quot;user&quot;, :layout =&gt; &quot;administrator&quot;, :locals =&gt; { :user =&gt; administrator } %&gt;

  Here's the editor:
  &lt;%= render :partial =&gt; &quot;user&quot;, :layout =&gt; &quot;editor&quot;, :locals =&gt; { :user =&gt; editor } %&gt;

  &lt;%# app/views/users/_user.html.erb &amp;&gt;
  Name: &lt;%= user.name %&gt;

  &lt;%# app/views/users/_administrator.html.erb &amp;&gt;
  &lt;div id=&quot;administrator&quot;&gt;
    Budget: $&lt;%= user.budget %&gt;
    &lt;%= yield %&gt;
  &lt;/div&gt;

  &lt;%# app/views/users/_editor.html.erb &amp;&gt;
  &lt;div id=&quot;editor&quot;&gt;
    Deadline: &lt;%= user.deadline %&gt;
    &lt;%= yield %&gt;
  &lt;/div&gt;
</pre>
<p>
&#8230;this will return:
</p>
<pre>
  Here's the administrator:
  &lt;div id=&quot;administrator&quot;&gt;
    Budget: $&lt;%= user.budget %&gt;
    Name: &lt;%= user.name %&gt;
  &lt;/div&gt;

  Here's the editor:
  &lt;div id=&quot;editor&quot;&gt;
    Deadline: &lt;%= user.deadline %&gt;
    Name: &lt;%= user.name %&gt;
  &lt;/div&gt;
</pre>
<p>
You can also apply a layout to a block within any template:
</p>
<pre>
  &lt;%# app/views/users/_chief.html.erb &amp;&gt;
  &lt;%= render(:layout =&gt; &quot;administrator&quot;, :locals =&gt; { :user =&gt; chief }) do %&gt;
    Title: &lt;%= chief.title %&gt;
  &lt;% end %&gt;
</pre>
<p>
&#8230;this will return:
</p>
<pre>
  &lt;div id=&quot;administrator&quot;&gt;
    Budget: $&lt;%= user.budget %&gt;
    Title: &lt;%= chief.name %&gt;
  &lt;/div&gt;
</pre>
<p>
As you can see, the <tt>:locals</tt> hash is shared between both the
partial and its layout.
</p>
<p>
If you pass arguments to &#8220;yield&#8221; then this will be passed to
the block. One way to use this is to pass an array to layout and treat it
as an enumerable.
</p>
<pre>
  &lt;%# app/views/users/_user.html.erb &amp;&gt;
  &lt;div class=&quot;user&quot;&gt;
    Budget: $&lt;%= user.budget %&gt;
    &lt;%= yield user %&gt;
  &lt;/div&gt;

  &lt;%# app/views/users/index.html.erb &amp;&gt;
  &lt;%= render :layout =&gt; @users do |user| %&gt;
    Title: &lt;%= user.title %&gt;
  &lt;% end %&gt;
</pre>
<p>
This will render the layout for each user and yield to the block, passing
the user, each time.
</p>
<p>
You can also yield multiple times in one layout and use block arguments to
differentiate the sections.
</p>
<pre>
  &lt;%# app/views/users/_user.html.erb &amp;&gt;
  &lt;div class=&quot;user&quot;&gt;
    &lt;%= yield user, :header %&gt;
    Budget: $&lt;%= user.budget %&gt;
    &lt;%= yield user, :footer %&gt;
  &lt;/div&gt;

  &lt;%# app/views/users/index.html.erb &amp;&gt;
  &lt;%= render :layout =&gt; @users do |user, section| %&gt;
    &lt;%- case section when :header -%&gt;
      Title: &lt;%= user.title %&gt;
    &lt;%- when :footer -%&gt;
      Deadline: &lt;%= user.deadline %&gt;
    &lt;%- end -%&gt;
  &lt;% end %&gt;
</pre>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000579">collection</a>,</li>
                
                <li><a href="#M000580">collection_from_object</a>,</li>
                
                <li><a href="#M000583">collection_with_template</a>,</li>
                
                <li><a href="#M000584">collection_without_template</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000581">find_partial</a>,</li>
                
                <li><a href="#M000582">find_template</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000586">merge_prefix_into_object_path</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000574">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000585">partial_path</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000575">render</a>,</li>
                
                <li><a href="#M000576">render_collection</a>,</li>
                
                <li><a href="#M000577">render_partial</a>,</li>
                
                <li><a href="#M000587">retrieve_variable</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000578">setup</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">PARTIAL_NAMES</td>
            <td>=</td>
            <td class="attr-value">Hash.new { |h,k| h[k] = {} }</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000574">
                    
                    <a name="M000574"></a><b>new</b>(*)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000574_source')" id="l_M000574_source">show</a>
                        
                    </p>
                    <div id="M000574_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 214</span>
214:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span>)
215:       <span class="ruby-keyword kw">super</span>
216:       <span class="ruby-ivar">@context_prefix</span> = <span class="ruby-ivar">@lookup_context</span>.<span class="ruby-identifier">prefixes</span>.<span class="ruby-identifier">first</span>
217:       <span class="ruby-ivar">@partial_names</span> = <span class="ruby-constant">PARTIAL_NAMES</span>[<span class="ruby-ivar">@context_prefix</span>]
218:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000575">
                    
                    <a name="M000575"></a><b>render</b>(context, options, block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000575_source')" id="l_M000575_source">show</a>
                        
                    </p>
                    <div id="M000575_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 220</span>
220:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render</span>(<span class="ruby-identifier">context</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">block</span>)
221:       <span class="ruby-identifier">setup</span>(<span class="ruby-identifier">context</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">block</span>)
222:       <span class="ruby-identifier">identifier</span> = (<span class="ruby-ivar">@template</span> = <span class="ruby-identifier">find_partial</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@template</span>.<span class="ruby-identifier">identifier</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@path</span>
223: 
224:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span>
225:         <span class="ruby-identifier">instrument</span>(<span class="ruby-identifier">:collection</span>, <span class="ruby-identifier">:identifier</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">identifier</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;collection&quot;</span>, <span class="ruby-identifier">:count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">size</span>) <span class="ruby-keyword kw">do</span>
226:           <span class="ruby-identifier">render_collection</span>
227:         <span class="ruby-keyword kw">end</span>
228:       <span class="ruby-keyword kw">else</span>
229:         <span class="ruby-identifier">instrument</span>(<span class="ruby-identifier">:partial</span>, <span class="ruby-identifier">:identifier</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">identifier</span>) <span class="ruby-keyword kw">do</span>
230:           <span class="ruby-identifier">render_partial</span>
231:         <span class="ruby-keyword kw">end</span>
232:       <span class="ruby-keyword kw">end</span>
233:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000576">
                    
                    <a name="M000576"></a><b>render_collection</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000576_source')" id="l_M000576_source">show</a>
                        
                    </p>
                    <div id="M000576_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 235</span>
235:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render_collection</span>
236:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">blank?</span>
237: 
238:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">:spacer_template</span>)
239:         <span class="ruby-identifier">spacer</span> = <span class="ruby-identifier">find_template</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:spacer_template</span>]).<span class="ruby-identifier">render</span>(<span class="ruby-ivar">@view</span>, <span class="ruby-ivar">@locals</span>)
240:       <span class="ruby-keyword kw">end</span>
241: 
242:       <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@template</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">collection_with_template</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">collection_without_template</span>
243:       <span class="ruby-identifier">result</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">spacer</span>).<span class="ruby-identifier">html_safe</span>
244:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000577">
                    
                    <a name="M000577"></a><b>render_partial</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000577_source')" id="l_M000577_source">show</a>
                        
                    </p>
                    <div id="M000577_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 246</span>
246:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render_partial</span>
247:       <span class="ruby-identifier">locals</span>, <span class="ruby-identifier">view</span>, <span class="ruby-identifier">block</span> = <span class="ruby-ivar">@locals</span>, <span class="ruby-ivar">@view</span>, <span class="ruby-ivar">@block</span>
248:       <span class="ruby-identifier">object</span>, <span class="ruby-identifier">as</span> = <span class="ruby-ivar">@object</span>, <span class="ruby-ivar">@variable</span>
249: 
250:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">layout</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:layout</span>])
251:         <span class="ruby-identifier">layout</span> = <span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">layout</span>)
252:       <span class="ruby-keyword kw">end</span>
253: 
254:       <span class="ruby-identifier">object</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">as</span>]
255:       <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">as</span>] = <span class="ruby-identifier">object</span>
256: 
257:       <span class="ruby-identifier">content</span> = <span class="ruby-ivar">@template</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">view</span>, <span class="ruby-identifier">locals</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
258:         <span class="ruby-identifier">view</span>.<span class="ruby-identifier">_layout_for</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
259:       <span class="ruby-keyword kw">end</span>
260: 
261:       <span class="ruby-identifier">content</span> = <span class="ruby-identifier">layout</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">view</span>, <span class="ruby-identifier">locals</span>){ <span class="ruby-identifier">content</span> } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">layout</span>
262:       <span class="ruby-identifier">content</span>
263:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000579">
                    
                    <a name="M000579"></a><b>collection</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000579_source')" id="l_M000579_source">show</a>
                        
                    </p>
                    <div id="M000579_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 307</span>
307:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collection</span>
308:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">:collection</span>)
309:         <span class="ruby-identifier">collection</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:collection</span>]
310:         <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_ary</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">to_ary</span> <span class="ruby-operator">:</span> []
311:       <span class="ruby-keyword kw">end</span>
312:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000580">
                    
                    <a name="M000580"></a><b>collection_from_object</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000580_source')" id="l_M000580_source">show</a>
                        
                    </p>
                    <div id="M000580_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 314</span>
314:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collection_from_object</span>
315:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@object</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_ary</span>)
316:         <span class="ruby-ivar">@object</span>.<span class="ruby-identifier">to_ary</span>
317:       <span class="ruby-keyword kw">end</span>
318:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000583">
                    
                    <a name="M000583"></a><b>collection_with_template</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000583_source')" id="l_M000583_source">show</a>
                        
                    </p>
                    <div id="M000583_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 334</span>
334:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collection_with_template</span>
335:       <span class="ruby-identifier">segments</span>, <span class="ruby-identifier">locals</span>, <span class="ruby-identifier">template</span> = [], <span class="ruby-ivar">@locals</span>, <span class="ruby-ivar">@template</span>
336:       <span class="ruby-identifier">as</span>, <span class="ruby-identifier">counter</span> = <span class="ruby-ivar">@variable</span>, <span class="ruby-ivar">@variable_counter</span>
337: 
338:       <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">counter</span>] = <span class="ruby-value">-1</span>
339: 
340:       <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span>
341:         <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">counter</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
342:         <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">as</span>] = <span class="ruby-identifier">object</span>
343:         <span class="ruby-identifier">segments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">template</span>.<span class="ruby-identifier">render</span>(<span class="ruby-ivar">@view</span>, <span class="ruby-identifier">locals</span>)
344:       <span class="ruby-keyword kw">end</span>
345: 
346:       <span class="ruby-identifier">segments</span>
347:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000584">
                    
                    <a name="M000584"></a><b>collection_without_template</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000584_source')" id="l_M000584_source">show</a>
                        
                    </p>
                    <div id="M000584_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 349</span>
349:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collection_without_template</span>
350:       <span class="ruby-identifier">segments</span>, <span class="ruby-identifier">locals</span>, <span class="ruby-identifier">collection_data</span> = [], <span class="ruby-ivar">@locals</span>, <span class="ruby-ivar">@collection_data</span>
351:       <span class="ruby-identifier">index</span>, <span class="ruby-identifier">template</span>, <span class="ruby-identifier">cache</span> = <span class="ruby-value">-1</span>, <span class="ruby-keyword kw">nil</span>, {}
352:       <span class="ruby-identifier">keys</span> = <span class="ruby-ivar">@locals</span>.<span class="ruby-identifier">keys</span>
353: 
354:       <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
355:         <span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">data</span> = <span class="ruby-identifier">collection_data</span>[<span class="ruby-identifier">i</span>]
356:         <span class="ruby-identifier">template</span> = (<span class="ruby-identifier">cache</span>[<span class="ruby-identifier">path</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">keys</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">data</span>))
357:         <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>]] = <span class="ruby-identifier">object</span>
358:         <span class="ruby-identifier">locals</span>[<span class="ruby-identifier">data</span>[<span class="ruby-value">1</span>]] = (<span class="ruby-identifier">index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>)
359:         <span class="ruby-identifier">segments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">template</span>.<span class="ruby-identifier">render</span>(<span class="ruby-ivar">@view</span>, <span class="ruby-identifier">locals</span>)
360:       <span class="ruby-keyword kw">end</span>
361: 
362:       <span class="ruby-ivar">@template</span> = <span class="ruby-identifier">template</span>
363:       <span class="ruby-identifier">segments</span>
364:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000581">
                    
                    <a name="M000581"></a><b>find_partial</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000581_source')" id="l_M000581_source">show</a>
                        
                    </p>
                    <div id="M000581_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 320</span>
320:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_partial</span>
321:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@path</span>
322:         <span class="ruby-identifier">locals</span> = <span class="ruby-ivar">@locals</span>.<span class="ruby-identifier">keys</span>
323:         <span class="ruby-identifier">locals</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@variable</span>
324:         <span class="ruby-identifier">locals</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@variable_counter</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span>
325:         <span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">locals</span>)
326:       <span class="ruby-keyword kw">end</span>
327:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000582">
                    
                    <a name="M000582"></a><b>find_template</b>(path=@path, locals=@locals.keys)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000582_source')" id="l_M000582_source">show</a>
                        
                    </p>
                    <div id="M000582_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 329</span>
329:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">path</span>=<span class="ruby-ivar">@path</span>, <span class="ruby-identifier">locals</span>=<span class="ruby-ivar">@locals</span>.<span class="ruby-identifier">keys</span>)
330:       <span class="ruby-identifier">prefixes</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">?/</span>) <span class="ruby-operator">?</span> [] <span class="ruby-operator">:</span> <span class="ruby-ivar">@lookup_context</span>.<span class="ruby-identifier">prefixes</span>
331:       <span class="ruby-ivar">@lookup_context</span>.<span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">prefixes</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">locals</span>, <span class="ruby-ivar">@details</span>)
332:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000586">
                    
                    <a name="M000586"></a><b>merge_prefix_into_object_path</b>(prefix, object_path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000586_source')" id="l_M000586_source">show</a>
                        
                    </p>
                    <div id="M000586_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 384</span>
384:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge_prefix_into_object_path</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">object_path</span>)
385:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prefix</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">?/</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">object_path</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">?/</span>)
386:         <span class="ruby-identifier">prefixes</span> = []
387:         <span class="ruby-identifier">prefix_array</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">prefix</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>)
388:         <span class="ruby-identifier">object_path_array</span> = <span class="ruby-identifier">object_path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-3</span>] <span class="ruby-comment cmt"># skip model dir &amp; partial</span>
389: 
390:         <span class="ruby-identifier">prefix_array</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
391:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dir</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">object_path_array</span>[<span class="ruby-identifier">index</span>]
392:           <span class="ruby-identifier">prefixes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dir</span>
393:         <span class="ruby-keyword kw">end</span>
394: 
395:         (<span class="ruby-identifier">prefixes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">object_path</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;/&quot;</span>)
396:       <span class="ruby-keyword kw">else</span>
397:         <span class="ruby-identifier">object_path</span>
398:       <span class="ruby-keyword kw">end</span>
399:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000585">
                    
                    <a name="M000585"></a><b>partial_path</b>(object = @object)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000585_source')" id="l_M000585_source">show</a>
                        
                    </p>
                    <div id="M000585_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 366</span>
366:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">partial_path</span>(<span class="ruby-identifier">object</span> = <span class="ruby-ivar">@object</span>)
367:       <span class="ruby-identifier">object</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">to_model</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_model</span>)
368: 
369:       <span class="ruby-identifier">path</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_partial_path</span>)
370:         <span class="ruby-identifier">object</span>.<span class="ruby-identifier">to_partial_path</span>
371:       <span class="ruby-keyword kw">else</span>
372:         <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">class</span>
373:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:model_name</span>)
374:           <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;ActiveModel-compatible objects whose classes return a #model_name that responds to #partial_path are deprecated. Please respond to #to_partial_path directly instead.&quot;</span>
375:           <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">model_name</span>.<span class="ruby-identifier">partial_path</span>
376:         <span class="ruby-keyword kw">else</span>
377:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;'#{object.inspect}' is not an ActiveModel-compatible object that returns a valid partial path.&quot;</span>)
378:         <span class="ruby-keyword kw">end</span>
379:       <span class="ruby-keyword kw">end</span>
380: 
381:       <span class="ruby-ivar">@partial_names</span>[<span class="ruby-identifier">path</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">merge_prefix_into_object_path</span>(<span class="ruby-ivar">@context_prefix</span>, <span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>)
382:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000587">
                    
                    <a name="M000587"></a><b>retrieve_variable</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000587_source')" id="l_M000587_source">show</a>
                        
                    </p>
                    <div id="M000587_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 401</span>
401:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">retrieve_variable</span>(<span class="ruby-identifier">path</span>)
402:       <span class="ruby-identifier">variable</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:as</span>].<span class="ruby-identifier">try</span>(<span class="ruby-identifier">:to_sym</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">path</span>[<span class="ruby-regexp re">%r'_?(\w+)(\.\w+)*$'</span>, <span class="ruby-value">1</span>].<span class="ruby-identifier">to_sym</span>
403:       <span class="ruby-identifier">variable_counter</span> = <span class="ruby-identifier">:&quot;#{variable}_counter&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span>
404:       [<span class="ruby-identifier">variable</span>, <span class="ruby-identifier">variable_counter</span>]
405:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000578">
                    
                    <a name="M000578"></a><b>setup</b>(context, options, block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000578_source')" id="l_M000578_source">show</a>
                        
                    </p>
                    <div id="M000578_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File actionpack-3.2.0/lib/action_view/renderer/partial_renderer.rb, line 267</span>
267:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>(<span class="ruby-identifier">context</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">block</span>)
268:       <span class="ruby-ivar">@view</span>   = <span class="ruby-identifier">context</span>
269:       <span class="ruby-identifier">partial</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:partial</span>]
270: 
271:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
272:       <span class="ruby-ivar">@locals</span>  = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:locals</span>] <span class="ruby-operator">||</span> {}
273:       <span class="ruby-ivar">@block</span>   = <span class="ruby-identifier">block</span>
274:       <span class="ruby-ivar">@details</span> = <span class="ruby-identifier">extract_details</span>(<span class="ruby-identifier">options</span>)
275: 
276:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">partial</span>
277:         <span class="ruby-ivar">@object</span>     = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:object</span>]
278:         <span class="ruby-ivar">@path</span>       = <span class="ruby-identifier">partial</span>
279:         <span class="ruby-ivar">@collection</span> = <span class="ruby-identifier">collection</span>
280:       <span class="ruby-keyword kw">else</span>
281:         <span class="ruby-ivar">@object</span> = <span class="ruby-identifier">partial</span>
282: 
283:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span> = <span class="ruby-identifier">collection_from_object</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">collection</span>
284:           <span class="ruby-identifier">paths</span> = <span class="ruby-ivar">@collection_data</span> = <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">partial_path</span>(<span class="ruby-identifier">o</span>) }
285:           <span class="ruby-ivar">@path</span> = <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
286:         <span class="ruby-keyword kw">else</span>
287:           <span class="ruby-ivar">@path</span> = <span class="ruby-identifier">partial_path</span>
288:         <span class="ruby-keyword kw">end</span>
289:       <span class="ruby-keyword kw">end</span>
290: 
291:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@path</span>
292:         <span class="ruby-ivar">@variable</span>, <span class="ruby-ivar">@variable_counter</span> = <span class="ruby-identifier">retrieve_variable</span>(<span class="ruby-ivar">@path</span>)
293:       <span class="ruby-keyword kw">else</span>
294:         <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">retrieve_variable</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">path</span>) }
295:       <span class="ruby-keyword kw">end</span>
296: 
297:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">partial</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@variable</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/^[a-z_][a-zA-Z_0-9]*$/</span>
298:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;The partial name (#{partial}) is not a valid Ruby identifier; &quot;</span> <span class="ruby-operator">+</span>
299:                                 <span class="ruby-value str">&quot;make sure your partial name starts with a letter or underscore, &quot;</span> <span class="ruby-operator">+</span>
300:                                 <span class="ruby-value str">&quot;and is followed by any combinations of letters, numbers, or underscores.&quot;</span>)
301:       <span class="ruby-keyword kw">end</span>
302: 
303:       <span class="ruby-identifier">extract_format</span>(<span class="ruby-ivar">@path</span>, <span class="ruby-ivar">@details</span>)
304:       <span class="ruby-keyword kw">self</span>
305:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    