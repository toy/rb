<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Capistrano::Deploy::SCM::Darcs</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Capistrano::Deploy::SCM::Darcs 
            
                <span class="parent">&lt; 
                    
                    Base
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../../files/lib/capistrano/recipes/deploy/scm/darcs_rb.html">lib/capistrano/recipes/deploy/scm/darcs.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Implements the <a href="../../../Capistrano.html">Capistrano</a> <a
href="../SCM.html">SCM</a> interface for the darcs revision control system
(<a
href="http://www.abridgegame.org/darcs/">www.abridgegame.org/darcs/</a>).
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000260">checkout</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000264">diff</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000263">export</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000258">head</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000268">log</a></li>
                
            </ul>
        </dd>
    
        <dt>Q</dt>
        <dd>
            <ul>
                
                <li><a href="#M000269">query_revision</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000262">sync</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000259">to_match</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M000271">verbose</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000260">
                    
                    <a name="M000260"></a><b>checkout</b>(revision, destination)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the command that will check out the given revision to the given
destination. The &#8216;revision&#8217; parameter must be the
&#8216;hash&#8217; value for the revision in question, as given by
&#8216;darcs changes &#8212;xml-output&#8217;.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000260_source')" id="l_M000260_source">show</a>
                        
                    </p>
                    <div id="M000260_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 32</span>
32:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">checkout</span>(<span class="ruby-identifier">revision</span>, <span class="ruby-identifier">destination</span>)
33:           <span class="ruby-identifier">scm</span> <span class="ruby-identifier">:get</span>, <span class="ruby-operator">*</span>[<span class="ruby-identifier">verbose</span>, 
34:                       <span class="ruby-node">&quot;--repo-name=#{destination}&quot;</span>, 
35:                       <span class="ruby-identifier">to_match</span>(<span class="ruby-identifier">revision</span>),
36:                       <span class="ruby-identifier">repository</span>].<span class="ruby-identifier">compact</span>
37:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000264">
                    
                    <a name="M000264"></a><b>diff</b>(from, to=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the command that will do a &#8220;darcs diff&#8221; for the two
revisions. Each revision must be the &#8216;hash&#8217; identifier of a
darcs revision.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000264_source')" id="l_M000264_source">show</a>
                        
                    </p>
                    <div id="M000264_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 57</span>
57:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">diff</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>=<span class="ruby-keyword kw">nil</span>)
58:           <span class="ruby-identifier">scm</span> <span class="ruby-identifier">:diff</span>, <span class="ruby-node">&quot;--from-match 'hash #{from}'&quot;</span>, <span class="ruby-identifier">to</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">&quot;--to-match 'hash #{to}'&quot;</span>
59:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000263">
                    
                    <a name="M000263"></a><b>export</b>(revision, destination)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="Darcs.html">Darcs</a> does not have a real &#8216;export&#8217;
option; there is &#8216;darcs dist&#8217;, but that presupposes a utility
that can untar and ungzip the dist file. We&#8217;ll cheat and just do a
get, followed by a deletion of the _darcs metadata directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000263_source')" id="l_M000263_source">show</a>
                        
                    </p>
                    <div id="M000263_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 51</span>
51:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">export</span>(<span class="ruby-identifier">revision</span>, <span class="ruby-identifier">destination</span>)
52:           [<span class="ruby-identifier">checkout</span>(<span class="ruby-identifier">revision</span>, <span class="ruby-identifier">destination</span>), <span class="ruby-node">&quot;rm -rf #{destination}/_darcs&quot;</span>].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &amp;&amp; &quot;</span>)
53:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000258">
                    
                    <a name="M000258"></a><b>head</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Because darcs does not have any support for pseudo-ids, we&#8217;ll just
return something here that we can use in the helpers below for determining
whether we need to look up the latest revision.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000258_source')" id="l_M000258_source">show</a>
                        
                    </p>
                    <div id="M000258_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 17</span>
17:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">head</span>
18:           <span class="ruby-identifier">:head</span>
19:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000268">
                    
                    <a name="M000268"></a><b>log</b>(from, to=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the log of changes between the two revisions. Each revision must be
the &#8216;hash&#8217; identifier of a darcs revision.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000268_source')" id="l_M000268_source">show</a>
                        
                    </p>
                    <div id="M000268_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 63</span>
63:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>=<span class="ruby-keyword kw">nil</span>)
64:           <span class="ruby-identifier">scm</span> <span class="ruby-identifier">:changes</span>, <span class="ruby-node">&quot;--from-match 'hash #{from}'&quot;</span>, <span class="ruby-identifier">to</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">&quot;--to-match 'hash #{to}'&quot;</span>, <span class="ruby-node">&quot;--repo=#{repository}&quot;</span>
65:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000269">
                    
                    <a name="M000269"></a><b>query_revision</b>(revision)
                    
                </div>
                
                <div class="description">
                  <p>
Attempts to translate the given revision identifier to a &#8220;real&#8221;
revision. If the identifier is a symbol, it is assumed to be a pseudo-id.
Otherwise, it will be immediately returned. If it is a pseudo-id, a set of
commands to execute will be yielded, and the result of executing those
commands must be returned by the block. This method will then extract the
actual revision hash from the returned data.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000269_source')" id="l_M000269_source">show</a>
                        
                    </p>
                    <div id="M000269_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 74</span>
74:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_revision</span>(<span class="ruby-identifier">revision</span>)
75:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">revision</span>
76:           <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:head</span>
77:             <span class="ruby-identifier">xml</span> = <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">scm</span>(<span class="ruby-identifier">:changes</span>, <span class="ruby-value str">&quot;--last 1&quot;</span>, <span class="ruby-value str">&quot;--xml-output&quot;</span>, <span class="ruby-node">&quot;--repo=#{repository}&quot;</span>))
78:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">xml</span>[<span class="ruby-regexp re">/hash='(.*?)'/</span>, <span class="ruby-value">1</span>]
79:           <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">revision</span>
80:           <span class="ruby-keyword kw">end</span>
81:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000262">
                    
                    <a name="M000262"></a><b>sync</b>(revision, destination)
                    
                </div>
                
                <div class="description">
                  <p>
Tries to update the destination repository in-place, to bring it up to the
given revision. Note that because darcs&#8217; &#8220;pull&#8221; operation
does not support a &#8220;to-match&#8221; argument (or similar), this
basically nukes the destination directory and re-gets it.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000262_source')" id="l_M000262_source">show</a>
                        
                    </p>
                    <div id="M000262_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 43</span>
43:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sync</span>(<span class="ruby-identifier">revision</span>, <span class="ruby-identifier">destination</span>)
44:           [<span class="ruby-node">&quot;rm -rf #{destination}&quot;</span>, <span class="ruby-identifier">checkout</span>(<span class="ruby-identifier">revision</span>, <span class="ruby-identifier">destination</span>)].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &amp;&amp; &quot;</span>)
45:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000259">
                    
                    <a name="M000259"></a><b>to_match</b>(revision)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000259_source')" id="l_M000259_source">show</a>
                        
                    </p>
                    <div id="M000259_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 21</span>
21:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_match</span>(<span class="ruby-identifier">revision</span>)
22:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">revision</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">revision</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">head</span>
23:             <span class="ruby-keyword kw">nil</span>
24:           <span class="ruby-keyword kw">else</span>
25:             <span class="ruby-node">&quot;--to-match='hash #{revision}'&quot;</span>
26:           <span class="ruby-keyword kw">end</span>
27:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000271">
                    
                    <a name="M000271"></a><b>verbose</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000271_source')" id="l_M000271_source">show</a>
                        
                    </p>
                    <div id="M000271_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/capistrano/recipes/deploy/scm/darcs.rb, line 85</span>
85:           <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">verbose</span>
86:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">variable</span>(<span class="ruby-identifier">:scm_verbose</span>)
87:             <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span> <span class="ruby-value str">&quot;-q&quot;</span>
88:             <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">then</span> <span class="ruby-keyword kw">nil</span>
89:             <span class="ruby-keyword kw">else</span> <span class="ruby-value str">&quot;-v&quot;</span>
90:             <span class="ruby-keyword kw">end</span>
91:           <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    