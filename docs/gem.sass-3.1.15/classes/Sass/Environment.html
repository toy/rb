<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Sass::Environment</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Sass::Environment 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/sass/environment_rb.html">lib/sass/environment.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
The lexical environment for SassScript. This keeps track of variable,
mixin, and function definitions.
</p>
<p>
A new environment is created for each level of <a
href="../Sass.html">Sass</a> nesting. This allows variables to be lexically
scoped. The new environment refers to the environment in the upper scope,
so it has access to variables defined in enclosing scopes, but new
variables are defined locally.
</p>
<p>
<a href="Environment.html">Environment</a> also keeps track of the {Engine}
options so that they can be made available to {Sass::Script::Functions}.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000045">files_in_use</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000051">inherited_hash</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000044">mixins_in_use</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000037">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000039">options</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000050">parent_options</a>,</li>
                
                <li><a href="#M000048">pop_and_unuse</a>,</li>
                
                <li><a href="#M000042">pop_frame</a>,</li>
                
                <li><a href="#M000041">prepare_frame</a>,</li>
                
                <li><a href="#M000040">push_frame</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000043">stack</a>,</li>
                
                <li><a href="#M000046">stack_trace</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">DASH</td>
            <td>=</td>
            <td class="attr-value">'_', '-'</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>parent</td>
            <td class='attr-desc'><p>
The enclosing environment, or nil if this is the global environment.
</p>
<p>
@return [Environment]
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [W]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000037">
                    
                    <a name="M000037"></a><b>new</b>(parent = nil)
                    
                </div>
                
                <div class="description">
                  <p>
@param parent [Environment] See {#parent}
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show</a>
                        
                    </p>
                    <div id="M000037_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 24</span>
24:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">parent</span> = <span class="ruby-keyword kw">nil</span>)
25:       <span class="ruby-ivar">@parent</span> = <span class="ruby-identifier">parent</span>
26:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parent</span>
27:         <span class="ruby-ivar">@stack</span> = []
28:         <span class="ruby-ivar">@mixins_in_use</span> = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
29:         <span class="ruby-ivar">@files_in_use</span> = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
30:       <span class="ruby-keyword kw">end</span>
31:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Private methods</div>
            
            <div class="method">
                <div class="title" id="M000051">
                    
                    <a name="M000051"></a><b>inherited_hash</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Note: when updating this, update sass/yard/inherited_hash.rb as well.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000051_source')" id="l_M000051_source">show</a>
                        
                    </p>
                    <div id="M000051_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 133</span>
133:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inherited_hash</span>(<span class="ruby-identifier">name</span>)
134:         <span class="ruby-identifier">class_eval</span> <span class="ruby-value str">&quot;          def \#{name}(name)\n            _\#{name}(name.tr(UNDERSCORE, DASH))\n          end\n\n          def _\#{name}(name)\n            (@\#{name}s &amp;&amp; @\#{name}s[name]) || @parent &amp;&amp; @parent._\#{name}(name)\n          end\n          protected :_\#{name}\n\n          def set_\#{name}(name, value)\n            name = name.tr(UNDERSCORE, DASH)\n            @\#{name}s[name] = value unless try_set_\#{name}(name, value)\n          end\n\n          def try_set_\#{name}(name, value)\n            @\#{name}s ||= {}\n            if @\#{name}s.include?(name)\n              @\#{name}s[name] = value\n              true\n            elsif @parent\n              @parent.try_set_\#{name}(name, value)\n            else\n              false\n            end\n          end\n          protected :try_set_\#{name}\n\n          def set_local_\#{name}(name, value)\n            @\#{name}s ||= {}\n            @\#{name}s[name.tr(UNDERSCORE, DASH)] = value\n          end\n&quot;</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-keyword kw">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
135:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000045">
                    
                    <a name="M000045"></a><b>files_in_use</b>()
                    
                </div>
                
                <div class="description">
                  <p>
A set of names of files currently present in the stack.
</p>
<p>
@return [Set<String>] The filenames.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000045_source')" id="l_M000045_source">show</a>
                        
                    </p>
                    <div id="M000045_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 99</span>
 99:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">files_in_use</span>
100:       <span class="ruby-ivar">@files_in_use</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">files_in_use</span>
101:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000044">
                    
                    <a name="M000044"></a><b>mixins_in_use</b>()
                    
                </div>
                
                <div class="description">
                  <p>
A set of names of mixins currently present in the stack.
</p>
<p>
@return [Set<String>] The mixin names.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000044_source')" id="l_M000044_source">show</a>
                        
                    </p>
                    <div id="M000044_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 92</span>
92:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mixins_in_use</span>
93:       <span class="ruby-ivar">@mixins_in_use</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">mixins_in_use</span>
94:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000039">
                    
                    <a name="M000039"></a><b>options</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The options hash. See {file:SASS_REFERENCE.md#sass_options the <a
href="../Sass.html">Sass</a> options documentation}.
</p>
<p>
@return [{Symbol => Object}]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show</a>
                        
                    </p>
                    <div id="M000039_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 37</span>
37:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options</span>
38:       <span class="ruby-ivar">@options</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">parent_options</span> <span class="ruby-operator">||</span> {}
39:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000042">
                    
                    <a name="M000042"></a><b>pop_frame</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Pop a stack frame from the mixin/include stack.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000042_source')" id="l_M000042_source">show</a>
                        
                    </p>
                    <div id="M000042_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 75</span>
75:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pop_frame</span>
76:       <span class="ruby-identifier">pop_and_unuse</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>[<span class="ruby-identifier">:prepared</span>]
77:       <span class="ruby-identifier">pop_and_unuse</span>
78:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000041">
                    
                    <a name="M000041"></a><b>prepare_frame</b>(frame_info)
                    
                </div>
                
                <div class="description">
                  <p>
Like {#push_frame}, but next time a stack frame is pushed, it will be
merged with this frame.
</p>
<p>
@param frame_info [{Symbol => Object}] Same as for {#push_frame}.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000041_source')" id="l_M000041_source">show</a>
                        
                    </p>
                    <div id="M000041_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 70</span>
70:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare_frame</span>(<span class="ruby-identifier">frame_info</span>)
71:       <span class="ruby-identifier">push_frame</span>(<span class="ruby-identifier">frame_info</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:prepared</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
72:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000040">
                    
                    <a name="M000040"></a><b>push_frame</b>(frame_info)
                    
                </div>
                
                <div class="description">
                  <p>
Push a new stack frame onto the mixin/include stack.
</p>
<p>
@param frame_info [{Symbol => Object}]
</p>
<pre>
  Frame information has the following keys:

  `:filename`
  : The name of the file in which the lexical scope changed.

  `:mixin`
  : The name of the mixin in which the lexical scope changed,
    or `nil` if it wasn't within in a mixin.

  `:line`
  : The line of the file on which the lexical scope changed. Never nil.
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000040_source')" id="l_M000040_source">show</a>
                        
                    </p>
                    <div id="M000040_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 55</span>
55:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">push_frame</span>(<span class="ruby-identifier">frame_info</span>)
56:       <span class="ruby-identifier">top_of_stack</span> = <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>
57:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">top_of_stack</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">top_of_stack</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:prepared</span>)
58:         <span class="ruby-identifier">top_of_stack</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">frame_info</span>)
59:       <span class="ruby-keyword kw">else</span>
60:         <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">top_of_stack</span> = <span class="ruby-identifier">frame_info</span>)
61:       <span class="ruby-keyword kw">end</span>
62:       <span class="ruby-identifier">mixins_in_use</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">top_of_stack</span>[<span class="ruby-identifier">:mixin</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">top_of_stack</span>[<span class="ruby-identifier">:mixin</span>]
63:       <span class="ruby-identifier">files_in_use</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">top_of_stack</span>[<span class="ruby-identifier">:filename</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">top_of_stack</span>[<span class="ruby-identifier">:filename</span>]
64:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000043">
                    
                    <a name="M000043"></a><b>stack</b>()
                    
                </div>
                
                <div class="description">
                  <p>
A list of stack frames in the mixin/include stack. The last element in the
list is the most deeply-nested frame.
</p>
<p>
@return [Array<{Symbol => Object}>] The stack frames,
</p>
<pre>
  of the form passed to \{#push\_frame}.
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000043_source')" id="l_M000043_source">show</a>
                        
                    </p>
                    <div id="M000043_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 85</span>
85:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stack</span>
86:       <span class="ruby-ivar">@stack</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">stack</span>
87:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000046">
                    
                    <a name="M000046"></a><b>stack_trace</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000046_source')" id="l_M000046_source">show</a>
                        
                    </p>
                    <div id="M000046_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 103</span>
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stack_trace</span>
104:       <span class="ruby-identifier">trace</span> = []
105:       <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
106:         <span class="ruby-identifier">msg</span> = <span class="ruby-node">&quot;#{i == 0 ? &quot;on&quot; : &quot;from&quot;} line #{entry[:line]}&quot;</span>
107:         <span class="ruby-identifier">msg</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; of #{entry[:filename] || &quot;an unknown file&quot;}&quot;</span>
108:         <span class="ruby-identifier">msg</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;, in `#{entry[:mixin]}'&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span>[<span class="ruby-identifier">:mixin</span>]
109:         <span class="ruby-identifier">trace</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">msg</span>
110:       <span class="ruby-keyword kw">end</span>
111:       <span class="ruby-identifier">trace</span>
112:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000050">
                    
                    <a name="M000050"></a><b>parent_options</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000050_source')" id="l_M000050_source">show</a>
                        
                    </p>
                    <div id="M000050_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 123</span>
123:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parent_options</span>
124:       <span class="ruby-ivar">@parent_options</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@parent</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">options</span>
125:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000048">
                    
                    <a name="M000048"></a><b>pop_and_unuse</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000048_source')" id="l_M000048_source">show</a>
                        
                    </p>
                    <div id="M000048_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/sass/environment.rb, line 116</span>
116:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pop_and_unuse</span>
117:       <span class="ruby-identifier">popped</span> = <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">pop</span>
118:       <span class="ruby-identifier">mixins_in_use</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">popped</span>[<span class="ruby-identifier">:mixin</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">popped</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">popped</span>[<span class="ruby-identifier">:mixin</span>]
119:       <span class="ruby-identifier">files_in_use</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">popped</span>[<span class="ruby-identifier">:filename</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">popped</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">popped</span>[<span class="ruby-identifier">:filename</span>]
120:       <span class="ruby-identifier">popped</span>
121:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    