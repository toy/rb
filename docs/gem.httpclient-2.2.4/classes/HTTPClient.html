<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>HTTPClient</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            HTTPClient 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/lib/httpclient/auth_rb.html">lib/httpclient/auth.rb</a></li>
            
            <li><a href="../files/lib/httpclient/connection_rb.html">lib/httpclient/connection.rb</a></li>
            
            <li><a href="../files/lib/httpclient/session_rb.html">lib/httpclient/session.rb</a></li>
            
            <li><a href="../files/lib/httpclient/ssl_config_rb.html">lib/httpclient/ssl_config.rb</a></li>
            
            <li><a href="../files/lib/httpclient/timeout_rb.html">lib/httpclient/timeout.rb</a></li>
            
            <li><a href="../files/lib/httpclient/util_rb.html">lib/httpclient/util.rb</a></li>
            
            <li><a href="../files/lib/httpclient/version_rb.html">lib/httpclient/version.rb</a></li>
            
            <li><a href="../files/lib/httpclient_rb.html">lib/httpclient.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
The <a href="HTTPClient.html">HTTPClient</a> class provides several methods
for accessing Web resources via <a href="HTTP.html">HTTP</a>.
</p>
<p>
<a href="HTTPClient.html">HTTPClient</a> instance is designed to be
MT-safe. You can call a <a href="HTTPClient.html">HTTPClient</a> instance
from several threads without synchronization after setting up an instance.
</p>
<pre>
  clnt = HTTPClient.new
  clnt.set_cookie_store('/home/nahi/cookie.dat')
  urls.each do |url|
    Thread.new(url) do |u|
      p clnt.head(u).status
    end
  end
</pre>
<h2>How to use</h2>
<p>
At first, how to create your client. See initialize for more detail.
</p>
<ol>
<li>Create simple client.

<pre>
 clnt = HTTPClient.new
</pre>
</li>
<li>Accessing resources through <a href="HTTP.html">HTTP</a> proxy. You can use
environment variable &#8216;http_proxy&#8217; or &#8216;HTTP_PROXY&#8217;
instead.

<pre>
 clnt = HTTPClient.new('http://myproxy:8080')
</pre>
</li>
</ol>
<h3>How to retrieve web resources</h3>
<p>
See get and get_content.
</p>
<ol>
<li>Get content of specified URL. It returns <a
href="HTTP/Message.html">HTTP::Message</a> object and calling
&#8216;body&#8217; method of it returns a content <a
href="String.html">String</a>.

<pre>
 puts clnt.get('http://dev.ctor.org/').body
</pre>
</li>
<li>For getting content directly, use get_content. It follows redirect response
and returns a <a href="String.html">String</a> of whole result.

<pre>
 puts clnt.get_content('http://dev.ctor.org/')
</pre>
</li>
<li>You can pass :<a href="HTTPClient.html#M000359">follow_redirect</a> option
to follow redirect response in get.

<pre>
 puts clnt.get('http://dev.ctor.org/', :foolow_redirect =&gt; true)
</pre>
</li>
<li>Get content as chunks of <a href="String.html">String</a>. It yields chunks
of <a href="String.html">String</a>.

<pre>
 clnt.get_content('http://dev.ctor.org/') do |chunk|
   puts chunk
 end
</pre>
</li>
</ol>
<h3>Invoking other <a href="HTTP.html">HTTP</a> methods</h3>
<p>
See head, get, post, put, delete, options, propfind, proppatch and trace.
It returns a <a href="HTTP/Message.html">HTTP::Message</a> instance as a
response.
</p>
<ol>
<li>Do HEAD request.

<pre>
 res = clnt.head(uri)
 p res.header['Last-Modified'][0]
</pre>
</li>
<li>Do GET request with query.

<pre>
 query = { 'keyword' =&gt; 'ruby', 'lang' =&gt; 'en' }
 res = clnt.get(uri, query)
 p res.status
 p res.contenttype
 p res.header['X-Custom']
 puts res.body
</pre>
<p>
You can also use keyword argument style.
</p>
<pre>
 res = clnt.get(uri, :query =&gt; { :keyword =&gt; 'ruby', :lang =&gt; 'en' })
</pre>
</li>
</ol>
<h3>How to POST</h3>
<p>
See post.
</p>
<ol>
<li>Do POST a form data.

<pre>
 body = { 'keyword' =&gt; 'ruby', 'lang' =&gt; 'en' }
 res = clnt.post(uri, body)
</pre>
<p>
Keyword argument style.
</p>
<pre>
 res = clnt.post(uri, :body =&gt; ...)
</pre>
</li>
<li>Do multipart file upload with POST. No need to set extra header by yourself
from httpclient/2.1.4.

<pre>
 File.open('/tmp/post_data') do |file|
   body = { 'upload' =&gt; file, 'user' =&gt; 'nahi' }
   res = clnt.post(uri, body)
 end
</pre>
</li>
<li>Do multipart wth custom body.

<pre>
 File.open('/tmp/post_data') do |file|
   body = [{ 'Content-Type' =&gt; 'application/atom+xml; charset=UTF-8',
             :content =&gt; '&lt;entry&gt;...&lt;/entry&gt;' },
           { 'Content-Type' =&gt; 'video/mp4',
             'Content-Transfer-Encoding' =&gt; 'binary',
             :content =&gt; file }]
   res = clnt.post(uri, body)
 end
</pre>
</li>
</ol>
<h3>Accessing via SSL</h3>
<p>
Ruby needs to be compiled with OpenSSL.
</p>
<ol>
<li>Get content of specified URL via SSL. Just pass an URL which starts with
&#8216;https://&#8217;.

<pre>
 https_url = 'https://www.rsa.com'
 clnt.get(https_url)
</pre>
</li>
<li>Getting peer certificate from response.

<pre>
 res = clnt.get(https_url)
 p res.peer_cert #=&gt; returns OpenSSL::X509::Certificate
</pre>
</li>
<li>Configuring OpenSSL options. See <a
href="HTTPClient/SSLConfig.html">HTTPClient::SSLConfig</a> for more
details.

<pre>
 user_cert_file = 'cert.pem'
 user_key_file = 'privkey.pem'
 clnt.ssl_config.set_client_cert_file(user_cert_file, user_key_file)
 clnt.get(https_url)
</pre>
</li>
</ol>
<h3>Handling Cookies</h3>
<ol>
<li>Using volatile Cookies. Nothing to do. <a
href="HTTPClient.html">HTTPClient</a> handles Cookies.

<pre>
 clnt = HTTPClient.new
 res = clnt.get(url1) # receives Cookies.
 res = clnt.get(url2) # sends Cookies if needed.
 p res.cookies
</pre>
</li>
<li>Saving non volatile Cookies to a specified file. Need to set a file at
first and invoke save method at last.

<pre>
 clnt = HTTPClient.new
 clnt.set_cookie_store('/home/nahi/cookie.dat')
 clnt.get(url)
 ...
 clnt.save_cookie_store
</pre>
</li>
<li>Disabling Cookies.

<pre>
 clnt = HTTPClient.new
 clnt.cookie_manager = nil
</pre>
</li>
</ol>
<h3>Configuring authentication credentials</h3>
<ol>
<li>Authentication with Web server. Supports <a
href="HTTPClient/BasicAuth.html">BasicAuth</a>, <a
href="HTTPClient/DigestAuth.html">DigestAuth</a>, and Negotiate/NTLM
(requires ruby/ntlm module).

<pre>
 clnt = HTTPClient.new
 domain = 'http://dev.ctor.org/http-access2/'
 user = 'user'
 password = 'user'
 clnt.set_auth(domain, user, password)
 p clnt.get('http://dev.ctor.org/http-access2/login').status
</pre>
</li>
<li>Authentication with Proxy server. Supports <a
href="HTTPClient/BasicAuth.html">BasicAuth</a> and NTLM (requires
win32/sspi)

<pre>
 clnt = HTTPClient.new(proxy)
 user = 'proxy'
 password = 'proxy'
 clnt.set_proxy_auth(user, password)
 p clnt.get(url)
</pre>
</li>
</ol>
<h3>Invoking <a href="HTTP.html">HTTP</a> methods with custom header</h3>
<p>
Pass a Hash or an Array for header argument.
</p>
<pre>
    header = { 'Accept' =&gt; '*/*' }
    clnt.get(uri, query, header)

    header = [['Accept', 'image/jpeg'], ['Accept', 'image/png']]
    clnt.get_content(uri, query, header)
</pre>
<h3>Invoking <a href="HTTP.html">HTTP</a> methods asynchronously</h3>
<p>
See <a href="HTTPClient.html#M000343">head_async</a>, <a
href="HTTPClient.html#M000344">get_async</a>, <a
href="HTTPClient.html#M000345">post_async</a>, <a
href="HTTPClient.html#M000346">put_async</a>, <a
href="HTTPClient.html#M000347">delete_async</a>, <a
href="HTTPClient.html#M000348">options_async</a>, <a
href="HTTPClient.html#M000349">propfind_async</a>, <a
href="HTTPClient.html#M000350">proppatch_async</a>, and trace_async. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
returning value.
</p>
<pre>
    connection = clnt.post_async(url, body)
    print 'posting.'
    while true
      break if connection.finished?
      print '.'
      sleep 1
    end
    puts '.'
    res = connection.pop
    p res.status
    p res.body.read # res.body is an IO for the res of async method.
</pre>
<h3>Shortcut methods</h3>
<p>
You can invoke <a href="HTTPClient.html#M000329">get_content</a>, get, etc.
without creating <a href="HTTPClient.html">HTTPClient</a> instance.
</p>
<pre>
  ruby -rhttpclient -e 'puts HTTPClient.get_content(ARGV.shift)' http://dev.ctor.org/
  ruby -rhttpclient -e 'p HTTPClient.head(ARGV.shift).header[&quot;last-modified&quot;]' http://dev.ctor.org/
</pre>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000311">attr_proxy</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000314">body</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000327">cookies</a>,</li>
                
                <li><a href="#M000362">create_boundary</a>,</li>
                
                <li><a href="#M000361">create_request</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000316">debug_dev</a>,</li>
                
                <li><a href="#M000317">debug_dev=</a>,</li>
                
                <li><a href="#M000332">default_redirect_uri_callback</a>,</li>
                
                <li><a href="#M000337">delete</a>,</li>
                
                <li><a href="#M000347">delete_async</a>,</li>
                
                <li><a href="#M000366">do_get_block</a>,</li>
                
                <li><a href="#M000368">do_get_header</a>,</li>
                
                <li><a href="#M000367">do_get_stream</a>,</li>
                
                <li><a href="#M000355">do_request</a>,</li>
                
                <li><a href="#M000356">do_request_async</a>,</li>
                
                <li><a href="#M000369">dump_dummy_request_response</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000363">file_in_form_data?</a>,</li>
                
                <li><a href="#M000359">follow_redirect</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000334">get</a>,</li>
                
                <li><a href="#M000344">get_async</a>,</li>
                
                <li><a href="#M000329">get_content</a>,</li>
                
                <li><a href="#M000358">getenv</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000333">head</a>,</li>
                
                <li><a href="#M000343">head_async</a></li>
                
            </ul>
        </dd>
    
        <dt>K</dt>
        <dd>
            <ul>
                
                <li><a href="#M000313">keep_webmock_compat</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000357">load_environment</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000312">new</a>,</li>
                
                <li><a href="#M000320">no_proxy</a>,</li>
                
                <li><a href="#M000321">no_proxy=</a>,</li>
                
                <li><a href="#M000365">no_proxy?</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000338">options</a>,</li>
                
                <li><a href="#M000348">options_async</a>,</li>
                
                <li><a href="#M000364">override_header</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000335">post</a>,</li>
                
                <li><a href="#M000345">post_async</a>,</li>
                
                <li><a href="#M000330">post_content</a>,</li>
                
                <li><a href="#M000339">propfind</a>,</li>
                
                <li><a href="#M000349">propfind_async</a>,</li>
                
                <li><a href="#M000340">proppatch</a>,</li>
                
                <li><a href="#M000350">proppatch_async</a>,</li>
                
                <li><a href="#M000360">protect_keep_alive_disconnected</a>,</li>
                
                <li><a href="#M000318">proxy</a>,</li>
                
                <li><a href="#M000319">proxy=</a>,</li>
                
                <li><a href="#M000336">put</a>,</li>
                
                <li><a href="#M000346">put_async</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000328">redirect_uri_callback=</a>,</li>
                
                <li><a href="#M000342">request</a>,</li>
                
                <li><a href="#M000352">request_async</a>,</li>
                
                <li><a href="#M000353">reset</a>,</li>
                
                <li><a href="#M000354">reset_all</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000326">save_cookie_store</a>,</li>
                
                <li><a href="#M000322">set_auth</a>,</li>
                
                <li><a href="#M000323">set_basic_auth</a>,</li>
                
                <li><a href="#M000325">set_cookie_store</a>,</li>
                
                <li><a href="#M000370">set_encoding</a>,</li>
                
                <li><a href="#M000324">set_proxy_auth</a>,</li>
                
                <li><a href="#M000331">strict_redirect_uri_callback</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000302">timeout_scheduler</a>,</li>
                
                <li><a href="#M000341">trace</a>,</li>
                
                <li><a href="#M000351">trace_async</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="HTTPClient/Util.html">HTTPClient::Util</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="HTTPClient/DebugSocket.html">HTTPClient::DebugSocket</a></li>
        
        <li><span class="type">MODULE</span> <a href="HTTPClient/SocketWrap.html">HTTPClient::SocketWrap</a></li>
        
        <li><span class="type">MODULE</span> <a href="HTTPClient/Timeout.html">HTTPClient::Timeout</a></li>
        
        <li><span class="type">MODULE</span> <a href="HTTPClient/Util.html">HTTPClient::Util</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/AuthFilterBase.html">HTTPClient::AuthFilterBase</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/BadResponseError.html">HTTPClient::BadResponseError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/BasicAuth.html">HTTPClient::BasicAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/ConfigurationError.html">HTTPClient::ConfigurationError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/ConnectTimeoutError.html">HTTPClient::ConnectTimeoutError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/Connection.html">HTTPClient::Connection</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/DigestAuth.html">HTTPClient::DigestAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/KeepAliveDisconnected.html">HTTPClient::KeepAliveDisconnected</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/LoopBackSocket.html">HTTPClient::LoopBackSocket</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/NegotiateAuth.html">HTTPClient::NegotiateAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/OAuth.html">HTTPClient::OAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/ProxyAuth.html">HTTPClient::ProxyAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/ReceiveTimeoutError.html">HTTPClient::ReceiveTimeoutError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/RetryableResponse.html">HTTPClient::RetryableResponse</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/SSLConfig.html">HTTPClient::SSLConfig</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/SSLSocketWrap.html">HTTPClient::SSLSocketWrap</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/SSPINegotiateAuth.html">HTTPClient::SSPINegotiateAuth</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/SendTimeoutError.html">HTTPClient::SendTimeoutError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/Session.html">HTTPClient::Session</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/SessionManager.html">HTTPClient::SessionManager</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/Site.html">HTTPClient::Site</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/TimeoutError.html">HTTPClient::TimeoutError</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/TimeoutScheduler.html">HTTPClient::TimeoutScheduler</a></li>
        
        <li><span class="type">CLASS</span> <a href="HTTPClient/WWWAuth.html">HTTPClient::WWWAuth</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">NTLMEnabled</td>
            <td>=</td>
            <td class="attr-value">true</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">NTLMEnabled</td>
            <td>=</td>
            <td class="attr-value">false</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SSPIEnabled</td>
            <td>=</td>
            <td class="attr-value">true</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SSPIEnabled</td>
            <td>=</td>
            <td class="attr-value">false</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">GSSAPIEnabled</td>
            <td>=</td>
            <td class="attr-value">true</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">GSSAPIEnabled</td>
            <td>=</td>
            <td class="attr-value">false</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SSLEnabled</td>
            <td>=</td>
            <td class="attr-value">true</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SSLEnabled</td>
            <td>=</td>
            <td class="attr-value">false</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">VERSION</td>
            <td>=</td>
            <td class="attr-value">'2.2.4'</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RUBY_VERSION_STRING</td>
            <td>=</td>
            <td class="attr-value">&quot;ruby #{RUBY_VERSION} (#{RUBY_RELEASE_DATE}) [#{RUBY_PLATFORM}]&quot;</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">LIB_NAME</td>
            <td>=</td>
            <td class="attr-value">&quot;(#{VERSION}, #{RUBY_VERSION_STRING})&quot;</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">PROPFIND_DEFAULT_EXTHEADER</td>
            <td>=</td>
            <td class="attr-value">{ 'Depth' =&gt; '0' }</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Default header for PROPFIND request.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">NO_PROXY_HOSTS</td>
            <td>=</td>
            <td class="attr-value">['localhost']</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>ssl_config</td>
            <td class='attr-desc'><table>
<tr><td valign="top">HTTPClient::SSLConfig:</td><td>SSL configurator.

</td></tr>
</table></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>cookie_manager</td>
            <td class='attr-desc'><table>
<tr><td valign="top">WebAgent::CookieManager:</td><td>Cookies configurator.

</td></tr>
</table></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>test_loopback_response</td>
            <td class='attr-desc'><p>
An array of response <a href="HTTP.html">HTTP</a> message body <a
href="String.html">String</a> which is used for loop-back test. See test/*
to see how to use it. If you want to do loop-back test of <a
href="HTTP.html">HTTP</a> header, use test_loopback_http_response instead.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>request_filter</td>
            <td class='attr-desc'><p>
An array of request filter which can trap <a href="HTTP.html">HTTP</a>
request/response. See <a
href="HTTPClient/WWWAuth.html">HTTPClient::WWWAuth</a> to see how to use
it.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>proxy_auth</td>
            <td class='attr-desc'><table>
<tr><td valign="top">HTTPClient::ProxyAuth:</td><td>Proxy authentication handler.

</td></tr>
</table></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>www_auth</td>
            <td class='attr-desc'><table>
<tr><td valign="top">HTTPClient::WWWAuth:</td><td>WWW authentication handler.

</td></tr>
</table></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>follow_redirect_count</td>
            <td class='attr-desc'><p>
How many times <a href="HTTPClient.html#M000329">get_content</a> and <a
href="HTTPClient.html#M000330">post_content</a> follows <a
href="HTTP.html">HTTP</a> redirect. 10 by default.
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000312">
                    
                    <a name="M000312"></a><b>new</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a <a href="HTTPClient.html">HTTPClient</a> instance which manages
sessions, cookies, etc.
</p>
<p>
<a href="HTTPClient.html#M000312">HTTPClient.new</a> takes 3 optional
arguments for proxy url string, User-Agent <a href="String.html">String</a>
and From header <a href="String.html">String</a>. User-Agent and From are
embedded in <a href="HTTP.html">HTTP</a> request Header if given. No
User-Agent and From header added without setting it explicitly.
</p>
<pre>
  proxy = 'http://myproxy:8080'
  agent_name = 'MyAgent/0.1'
  from = 'from@example.com'
  HTTPClient.new(proxy, agent_name, from)
</pre>
<p>
You can use a keyword argument style Hash. Keys are :proxy, :agent_name and
:from.
</p>
<pre>
  HTTPClient.new(:agent_name =&gt; 'MyAgent/0.1')
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000312_source')" id="l_M000312_source">show</a>
                        
                    </p>
                    <div id="M000312_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 378</span>
378:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
379:     <span class="ruby-identifier">proxy</span>, <span class="ruby-identifier">agent_name</span>, <span class="ruby-identifier">from</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:proxy</span>, <span class="ruby-identifier">:agent_name</span>, <span class="ruby-identifier">:from</span>)
380:     <span class="ruby-ivar">@proxy</span> = <span class="ruby-keyword kw">nil</span>        <span class="ruby-comment cmt"># assigned later.</span>
381:     <span class="ruby-ivar">@no_proxy</span> = <span class="ruby-keyword kw">nil</span>
382:     <span class="ruby-ivar">@www_auth</span> = <span class="ruby-constant">WWWAuth</span>.<span class="ruby-identifier">new</span>
383:     <span class="ruby-ivar">@proxy_auth</span> = <span class="ruby-constant">ProxyAuth</span>.<span class="ruby-identifier">new</span>
384:     <span class="ruby-ivar">@request_filter</span> = [<span class="ruby-ivar">@proxy_auth</span>, <span class="ruby-ivar">@www_auth</span>]
385:     <span class="ruby-ivar">@debug_dev</span> = <span class="ruby-keyword kw">nil</span>
386:     <span class="ruby-ivar">@redirect_uri_callback</span> = <span class="ruby-identifier">method</span>(<span class="ruby-identifier">:default_redirect_uri_callback</span>)
387:     <span class="ruby-ivar">@test_loopback_response</span> = []
388:     <span class="ruby-ivar">@session_manager</span> = <span class="ruby-constant">SessionManager</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)
389:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">agent_name</span> = <span class="ruby-identifier">agent_name</span>
390:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">from</span> = <span class="ruby-identifier">from</span>
391:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">ssl_config</span> = <span class="ruby-ivar">@ssl_config</span> = <span class="ruby-constant">SSLConfig</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)
392:     <span class="ruby-ivar">@cookie_manager</span> = <span class="ruby-constant">WebAgent</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieManager</span>.<span class="ruby-identifier">new</span>
393:     <span class="ruby-ivar">@follow_redirect_count</span> = <span class="ruby-value">10</span>
394:     <span class="ruby-identifier">load_environment</span>
395:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">proxy</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">proxy</span>
396:     <span class="ruby-identifier">keep_webmock_compat</span>
397:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000302">
                    
                    <a name="M000302"></a><b>timeout_scheduler</b>()
                    
                </div>
                
                <div class="description">
                  <p>
CAUTION: caller must aware of race condition.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000302_source')" id="l_M000302_source">show</a>
                        
                    </p>
                    <div id="M000302_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient/timeout.rb, line 116</span>
116:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">timeout_scheduler</span>
117:       <span class="ruby-ivar">@timeout_scheduler</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">TimeoutScheduler</span>.<span class="ruby-identifier">new</span>
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Private methods</div>
            
            <div class="method">
                <div class="title" id="M000311">
                    
                    <a name="M000311"></a><b>attr_proxy</b>(symbol, assignable = false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000311_source')" id="l_M000311_source">show</a>
                        
                    </p>
                    <div id="M000311_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 296</span>
296:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attr_proxy</span>(<span class="ruby-identifier">symbol</span>, <span class="ruby-identifier">assignable</span> = <span class="ruby-keyword kw">false</span>)
297:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">symbol</span>.<span class="ruby-identifier">to_s</span>
298:       <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">name</span>) {
299:         <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">__send__</span>(<span class="ruby-identifier">name</span>)
300:       }
301:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">assignable</span>
302:         <span class="ruby-identifier">aname</span> = <span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'='</span>
303:         <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">aname</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">rhs</span><span class="ruby-operator">|</span>
304:           <span class="ruby-identifier">reset_all</span>
305:           <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">__send__</span>(<span class="ruby-identifier">aname</span>, <span class="ruby-identifier">rhs</span>)
306:         }
307:       <span class="ruby-keyword kw">end</span>
308:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000314">
                    
                    <a name="M000314"></a><b>body</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000314_source')" id="l_M000314_source">show</a>
                        
                    </p>
                    <div id="M000314_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 404</span>
404:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">body</span>
405:           <span class="ruby-keyword kw">def</span> (<span class="ruby-identifier">o</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">content</span>).<span class="ruby-identifier">content</span>
406:             <span class="ruby-keyword kw">self</span>
407:           <span class="ruby-keyword kw">end</span>
408:           <span class="ruby-identifier">o</span>
409:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000327">
                    
                    <a name="M000327"></a><b>cookies</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns stored cookies.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000327_source')" id="l_M000327_source">show</a>
                        
                    </p>
                    <div id="M000327_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 540</span>
540:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cookies</span>
541:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@cookie_manager</span>
542:       <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">cookies</span>
543:     <span class="ruby-keyword kw">end</span>
544:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000316">
                    
                    <a name="M000316"></a><b>debug_dev</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns debug device if exists. See <a
href="HTTPClient.html#M000316">debug_dev</a>=.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000316_source')" id="l_M000316_source">show</a>
                        
                    </p>
                    <div id="M000316_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 415</span>
415:   <span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">debug_dev</span><span class="ruby-identifier">debug_dev</span>
416:     <span class="ruby-ivar">@debug_dev</span>
417:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000317">
                    
                    <a name="M000317"></a><b>debug_dev=</b>(dev)
                    
                </div>
                
                <div class="description">
                  <p>
Sets debug device. Once debug device is set, all <a
href="HTTP.html">HTTP</a> requests and responses are dumped to given
device. dev must respond to << for dump.
</p>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000317_source')" id="l_M000317_source">show</a>
                        
                    </p>
                    <div id="M000317_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 423</span>
423:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug_dev=</span>(<span class="ruby-identifier">dev</span>)
424:     <span class="ruby-ivar">@debug_dev</span> = <span class="ruby-identifier">dev</span>
425:     <span class="ruby-identifier">reset_all</span>
426:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">debug_dev</span> = <span class="ruby-identifier">dev</span>
427:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000332">
                    
                    <a name="M000332"></a><b>default_redirect_uri_callback</b>(uri, res)
                    
                </div>
                
                <div class="description">
                  <p>
A default method for redirect uri callback. This method is used by <a
href="HTTPClient.html">HTTPClient</a> instance by default. This callback
allows relative redirect such as
</p>
<pre>
  Location: ../foo/
</pre>
<p>
in <a href="HTTP.html">HTTP</a> header.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000332_source')" id="l_M000332_source">show</a>
                        
                    </p>
                    <div id="M000332_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 641</span>
641:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_redirect_uri_callback</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">res</span>)
642:     <span class="ruby-identifier">newuri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'location'</span>][<span class="ruby-value">0</span>])
643:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">newuri</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>)
644:       <span class="ruby-identifier">newuri</span> = <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">newuri</span>
645:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;could be a relative URI in location header which is not recommended&quot;</span>)
646:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;'The field value consists of a single absolute URI' in HTTP spec&quot;</span>)
647:     <span class="ruby-keyword kw">end</span>
648:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">https?</span>(<span class="ruby-identifier">uri</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">https?</span>(<span class="ruby-identifier">newuri</span>)
649:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">BadResponseError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;redirecting to non-https resource&quot;</span>)
650:     <span class="ruby-keyword kw">end</span>
651:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;redirect to: #{newuri}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
652:     <span class="ruby-identifier">newuri</span>
653:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000337">
                    
                    <a name="M000337"></a><b>delete</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends DELETE request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000337_source')" id="l_M000337_source">show</a>
                        
                    </p>
                    <div id="M000337_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 676</span>
676:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
677:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:delete</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
678:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000347">
                    
                    <a name="M000347"></a><b>delete_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends DELETE request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000347_source')" id="l_M000347_source">show</a>
                        
                    </p>
                    <div id="M000347_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 791</span>
791:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
792:     <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>)
793:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:delete</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
794:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000334">
                    
                    <a name="M000334"></a><b>get</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends GET request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000334_source')" id="l_M000334_source">show</a>
                        
                    </p>
                    <div id="M000334_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 661</span>
661:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
662:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:header</span>, <span class="ruby-identifier">:follow_redirect</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
663:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000344">
                    
                    <a name="M000344"></a><b>get_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends GET request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000344_source')" id="l_M000344_source">show</a>
                        
                    </p>
                    <div id="M000344_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 770</span>
770:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
771:     <span class="ruby-identifier">query</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:header</span>)
772:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
773:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000329">
                    
                    <a name="M000329"></a><b>get_content</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Retrieves a web resource.
</p>
<table>
<tr><td valign="top">uri:</td><td>a <a href="String.html">String</a> or an URI object which represents an URL
of web resource.

</td></tr>
<tr><td valign="top">query:</td><td>a Hash or an Array of query part of URL. e.g. { &#8220;a&#8221; =>
&#8220;b&#8221; } => &#8216;<a
href="http://host/part?a=b">host/part?a=b</a>&#8217;. Give an array to pass
multiple value like

<dl>
<dt>[&#8220;a&#8221;, &#8220;b&#8221;], [&#8220;a&#8221;, &#8220;c&#8221;]</dt><dd>=> &#8216;<a href="http://host/part?a=b&a=c">host/part?a=b&a=c</a>&#8217;.

</dd>
</dl>
</td></tr>
<tr><td valign="top">header:</td><td>a Hash or an Array of extra headers. e.g. { &#8216;Accept&#8217; =>
&#8216;<b>/</b>&#8217; } or [[&#8216;Accept&#8217;,
&#8216;image/jpeg&#8217;], [&#8216;Accept&#8217;,
&#8216;image/png&#8217;]].

</td></tr>
<tr><td valign="top">&amp;block:</td><td>Give a block to get chunked message-body of response like <a
href="HTTPClient.html#M000329">get_content</a>(uri) { |chunked_body|
&#8230; }. Size of each chunk may not be the same.

</td></tr>
</table>
<p>
<a href="HTTPClient.html#M000329">get_content</a> follows <a
href="HTTP.html">HTTP</a> redirect status (see <a
href="HTTP/Status.html#M000087">HTTP::Status.redirect?</a>) internally and
try to retrieve content from redirected URL. See redirect_uri_callback= how
<a href="HTTP.html">HTTP</a> redirection is handled.
</p>
<p>
If you need to get full <a href="HTTP.html">HTTP</a> response including <a
href="HTTP.html">HTTP</a> status and headers, use get method. get returns
<a href="HTTP/Message.html">HTTP::Message</a> as a response and you need to
follow <a href="HTTP.html">HTTP</a> redirect by yourself if you need.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000329_source')" id="l_M000329_source">show</a>
                        
                    </p>
                    <div id="M000329_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 579</span>
579:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_content</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
580:     <span class="ruby-identifier">query</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:header</span>)
581:     <span class="ruby-identifier">follow_redirect</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">content</span>
582:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000333">
                    
                    <a name="M000333"></a><b>head</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends HEAD request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000333_source')" id="l_M000333_source">show</a>
                        
                    </p>
                    <div id="M000333_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 656</span>
656:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">head</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
657:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:head</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:header</span>))
658:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000343">
                    
                    <a name="M000343"></a><b>head_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends HEAD request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000343_source')" id="l_M000343_source">show</a>
                        
                    </p>
                    <div id="M000343_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 763</span>
763:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">head_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
764:     <span class="ruby-identifier">query</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:header</span>)
765:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:head</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
766:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000313">
                    
                    <a name="M000313"></a><b>keep_webmock_compat</b>()
                    
                </div>
                
                <div class="description">
                  <p>
webmock 1.6.2 depends on <a
href="HTTP/Message.html#M000237">HTTP::Message#body</a>.content to work.
let&#8217;s keep it work iif webmock is loaded for a while.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000313_source')" id="l_M000313_source">show</a>
                        
                    </p>
                    <div id="M000313_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 401</span>
401:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keep_webmock_compat</span>
402:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:do_get_block_with_webmock</span>)
403:       <span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword kw">do</span>
404:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">body</span>
405:           <span class="ruby-keyword kw">def</span> (<span class="ruby-identifier">o</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">content</span>).<span class="ruby-identifier">content</span>
406:             <span class="ruby-keyword kw">self</span>
407:           <span class="ruby-keyword kw">end</span>
408:           <span class="ruby-identifier">o</span>
409:         <span class="ruby-keyword kw">end</span>
410:       <span class="ruby-keyword kw">end</span>
411:     <span class="ruby-keyword kw">end</span>
412:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000320">
                    
                    <a name="M000320"></a><b>no_proxy</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns NO_PROXY setting <a href="String.html">String</a> if given.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000320_source')" id="l_M000320_source">show</a>
                        
                    </p>
                    <div id="M000320_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 465</span>
465:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">no_proxy</span>
466:     <span class="ruby-ivar">@no_proxy</span>
467:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000321">
                    
                    <a name="M000321"></a><b>no_proxy=</b>(no_proxy)
                    
                </div>
                
                <div class="description">
                  <p>
Sets NO_PROXY setting <a href="String.html">String</a>. <a
href="HTTPClient.html#M000320">no_proxy</a> must be a comma separated <a
href="String.html">String</a>. Each entry must be &#8216;host&#8217; or
&#8216;host:port&#8217; such as; <a
href="HTTPClient.html#M000320">HTTPClient#no_proxy</a> =
&#8216;example.com,example.co.jp:443&#8217;
</p>
<p>
&#8216;localhost&#8217; is treated as a <a
href="HTTPClient.html#M000320">no_proxy</a> site regardless of explicitly
listed. <a href="HTTPClient.html">HTTPClient</a> checks given URI objects
before accessing it. &#8216;host&#8217; is tail string match. No IP-addr
conversion.
</p>
<p>
You can use environment variable &#8216;<a
href="HTTPClient.html#M000320">no_proxy</a>&#8217; or
&#8216;NO_PROXY&#8217; for it.
</p>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000321_source')" id="l_M000321_source">show</a>
                        
                    </p>
                    <div id="M000321_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 480</span>
480:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">no_proxy=</span>(<span class="ruby-identifier">no_proxy</span>)
481:     <span class="ruby-ivar">@no_proxy</span> = <span class="ruby-identifier">no_proxy</span>
482:     <span class="ruby-identifier">reset_all</span>
483:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000338">
                    
                    <a name="M000338"></a><b>options</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends OPTIONS request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000338_source')" id="l_M000338_source">show</a>
                        
                    </p>
                    <div id="M000338_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 681</span>
681:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
682:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:options</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
683:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000348">
                    
                    <a name="M000348"></a><b>options_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends OPTIONS request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000348_source')" id="l_M000348_source">show</a>
                        
                    </p>
                    <div id="M000348_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 798</span>
798:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
799:     <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>)
800:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:options</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
801:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000335">
                    
                    <a name="M000335"></a><b>post</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends POST request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000335_source')" id="l_M000335_source">show</a>
                        
                    </p>
                    <div id="M000335_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 666</span>
666:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
667:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:post</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>, <span class="ruby-identifier">:follow_redirect</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
668:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000345">
                    
                    <a name="M000345"></a><b>post_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends POST request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000345_source')" id="l_M000345_source">show</a>
                        
                    </p>
                    <div id="M000345_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 777</span>
777:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
778:     <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>)
779:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:post</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">body</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
780:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000330">
                    
                    <a name="M000330"></a><b>post_content</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Posts a content.
</p>
<table>
<tr><td valign="top">uri:</td><td>a <a href="String.html">String</a> or an URI object which represents an URL
of web resource.

</td></tr>
<tr><td valign="top">body:</td><td>a Hash or an Array of body part. e.g.

<pre>
  { &quot;a&quot; =&gt; &quot;b&quot; } =&gt; 'a=b'
</pre>
<p>
Give an array to pass multiple value like
</p>
<pre>
  [[&quot;a&quot;, &quot;b&quot;], [&quot;a&quot;, &quot;c&quot;]] =&gt; 'a=b&amp;a=c'
</pre>
<p>
When you pass a File as a value, it will be posted as a
multipart/form-data. e.g.
</p>
<pre>
  { 'upload' =&gt; file }
</pre>
<p>
You can also send custom multipart by passing an array of hashes. Each part
must have a :content attribute which can be a file, all other keys will
become headers.
</p>
<pre>
  [{ 'Content-Type' =&gt; 'text/plain', :content =&gt; &quot;some text&quot; },
   { 'Content-Type' =&gt; 'video/mp4', :content =&gt; File.new('video.mp4') }]
  =&gt; &lt;Two parts with custom Content-Type header&gt;
</pre>
</td></tr>
<tr><td valign="top">header:</td><td>a Hash or an Array of extra headers. e.g.

<pre>
  { 'Accept' =&gt; '*/*' }
</pre>
<p>
or
</p>
<pre>
  [['Accept', 'image/jpeg'], ['Accept', 'image/png']].
</pre>
</td></tr>
<tr><td valign="top">&amp;block:</td><td>Give a block to get chunked message-body of response like

<pre>
  post_content(uri) { |chunked_body| ... }.
</pre>
<p>
Size of each chunk may not be the same.
</p>
</td></tr>
</table>
<p>
<a href="HTTPClient.html#M000330">post_content</a> follows <a
href="HTTP.html">HTTP</a> redirect status (see <a
href="HTTP/Status.html#M000087">HTTP::Status.redirect?</a>) internally and
try to post the content to redirected URL. See redirect_uri_callback= how
<a href="HTTP.html">HTTP</a> redirection is handled.
</p>
<p>
If you need to get full <a href="HTTP.html">HTTP</a> response including <a
href="HTTP.html">HTTP</a> status and headers, use post method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000330_source')" id="l_M000330_source">show</a>
                        
                    </p>
                    <div id="M000330_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 614</span>
614:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post_content</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
615:     <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>)
616:     <span class="ruby-identifier">follow_redirect</span>(<span class="ruby-identifier">:post</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">content</span>
617:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000339">
                    
                    <a name="M000339"></a><b>propfind</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PROPFIND request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000339_source')" id="l_M000339_source">show</a>
                        
                    </p>
                    <div id="M000339_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 686</span>
686:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">propfind</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
687:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:propfind</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
688:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000349">
                    
                    <a name="M000349"></a><b>propfind_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PROPFIND request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000349_source')" id="l_M000349_source">show</a>
                        
                    </p>
                    <div id="M000349_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 805</span>
805:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">propfind_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
806:     <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:header</span>)
807:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:propfind</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> <span class="ruby-constant">PROPFIND_DEFAULT_EXTHEADER</span>)
808:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000340">
                    
                    <a name="M000340"></a><b>proppatch</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PROPPATCH request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000340_source')" id="l_M000340_source">show</a>
                        
                    </p>
                    <div id="M000340_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 691</span>
691:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proppatch</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
692:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:proppatch</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
693:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000350">
                    
                    <a name="M000350"></a><b>proppatch_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PROPPATCH request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000350_source')" id="l_M000350_source">show</a>
                        
                    </p>
                    <div id="M000350_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 812</span>
812:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proppatch_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
813:     <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>)
814:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:proppatch</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
815:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000318">
                    
                    <a name="M000318"></a><b>proxy</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns URI object of <a href="HTTP.html">HTTP</a> proxy if exists.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000318_source')" id="l_M000318_source">show</a>
                        
                    </p>
                    <div id="M000318_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 430</span>
430:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy</span>
431:     <span class="ruby-ivar">@proxy</span>
432:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000319">
                    
                    <a name="M000319"></a><b>proxy=</b>(proxy)
                    
                </div>
                
                <div class="description">
                  <p>
Sets <a href="HTTP.html">HTTP</a> proxy used for <a
href="HTTP.html">HTTP</a> connection. Given proxy can be an URI, a <a
href="String.html">String</a> or nil. You can set user/password for proxy
authentication like <a href="HTTPClient.html#M000318">HTTPClient#proxy</a>
= &#8216;<a
href="http://user:passwd@myproxy:8080">user:passwd@myproxy:8080</a>&#8216;
</p>
<p>
You can use environment variable &#8216;http_proxy&#8217; or
&#8216;HTTP_PROXY&#8217; for it. You need to use
&#8216;cgi_http_proxy&#8217; or &#8216;CGI_HTTP_PROXY&#8217; instead if you
run <a href="HTTPClient.html">HTTPClient</a> from CGI environment from
security reason. (<a href="HTTPClient.html">HTTPClient</a> checks
&#8216;REQUEST_METHOD&#8217; environment variable whether it&#8217;s CGI or
not)
</p>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000319_source')" id="l_M000319_source">show</a>
                        
                    </p>
                    <div id="M000319_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 444</span>
444:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy=</span>(<span class="ruby-identifier">proxy</span>)
445:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
446:       <span class="ruby-ivar">@proxy</span> = <span class="ruby-keyword kw">nil</span>
447:       <span class="ruby-ivar">@proxy_auth</span>.<span class="ruby-identifier">reset_challenge</span>
448:     <span class="ruby-keyword kw">else</span>
449:       <span class="ruby-ivar">@proxy</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">proxy</span>)
450:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">'http'</span> <span class="ruby-keyword kw">or</span>
451:           <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
452:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;unsupported proxy #{proxy}&quot;</span>)
453:       <span class="ruby-keyword kw">end</span>
454:       <span class="ruby-ivar">@proxy_auth</span>.<span class="ruby-identifier">reset_challenge</span>
455:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">password</span>
456:         <span class="ruby-ivar">@proxy_auth</span>.<span class="ruby-identifier">set_auth</span>(<span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@proxy</span>.<span class="ruby-identifier">password</span>)
457:       <span class="ruby-keyword kw">end</span>
458:     <span class="ruby-keyword kw">end</span>
459:     <span class="ruby-identifier">reset_all</span>
460:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">proxy</span> = <span class="ruby-ivar">@proxy</span>
461:     <span class="ruby-ivar">@proxy</span>
462:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000336">
                    
                    <a name="M000336"></a><b>put</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PUT request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000336_source')" id="l_M000336_source">show</a>
                        
                    </p>
                    <div id="M000336_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 671</span>
671:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">put</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
672:     <span class="ruby-identifier">request</span>(<span class="ruby-identifier">:put</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
673:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000346">
                    
                    <a name="M000346"></a><b>put_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends PUT request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000346_source')" id="l_M000346_source">show</a>
                        
                    </p>
                    <div id="M000346_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 784</span>
784:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">put_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
785:     <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>)
786:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:put</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">body</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
787:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000328">
                    
                    <a name="M000328"></a><b>redirect_uri_callback=</b>(redirect_uri_callback)
                    
                </div>
                
                <div class="description">
                  <p>
Sets callback proc when <a href="HTTP.html">HTTP</a> redirect status is
returned for <a href="HTTPClient.html#M000329">get_content</a> and
post_content. <a
href="HTTPClient.html#M000332">default_redirect_uri_callback</a> is used by
default.
</p>
<p>
If you need strict implementation which does not allow relative URI
redirection, set <a
href="HTTPClient.html#M000331">strict_redirect_uri_callback</a> instead.
</p>
<pre>
  clnt.redirect_uri_callback = clnt.method(:strict_redirect_uri_callback)
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000328_source')" id="l_M000328_source">show</a>
                        
                    </p>
                    <div id="M000328_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 554</span>
554:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">redirect_uri_callback=</span>(<span class="ruby-identifier">redirect_uri_callback</span>)
555:     <span class="ruby-ivar">@redirect_uri_callback</span> = <span class="ruby-identifier">redirect_uri_callback</span>
556:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000342">
                    
                    <a name="M000342"></a><b>request</b>(method, uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends a request to the specified URL.
</p>
<table>
<tr><td valign="top">method:</td><td><a href="HTTP.html">HTTP</a> method to be sent. method.to_s.upcase is used.

</td></tr>
<tr><td valign="top">uri:</td><td>a <a href="String.html">String</a> or an URI object which represents an URL
of web resource.

</td></tr>
<tr><td valign="top">query:</td><td>a Hash or an Array of query part of URL. e.g. { &#8220;a&#8221; =>
&#8220;b&#8221; } => &#8216;<a
href="http://host/part?a=b">host/part?a=b</a>&#8217; Give an array to pass
multiple value like

<dl>
<dt>[&#8220;a&#8221;, &#8220;b&#8221;], [&#8220;a&#8221;, &#8220;c&#8221;]</dt><dd>=> &#8216;<a href="http://host/part?a=b&a=c">host/part?a=b&a=c</a>&#8216;

</dd>
</dl>
</td></tr>
<tr><td valign="top">body:</td><td>a Hash or an Array of body part. e.g.

<pre>
  { &quot;a&quot; =&gt; &quot;b&quot; }
  =&gt; 'a=b'
</pre>
<p>
Give an array to pass multiple value like
</p>
<pre>
  [[&quot;a&quot;, &quot;b&quot;], [&quot;a&quot;, &quot;c&quot;]]
  =&gt; 'a=b&amp;a=c'.
</pre>
<p>
When the given method is &#8216;POST&#8217; and the given body contains a
file as a value, it will be posted as a multipart/form-data. e.g.
</p>
<pre>
  { 'upload' =&gt; file }
</pre>
<p>
You can also send custom multipart by passing an array of hashes. Each part
must have a :content attribute which can be a file, all other keys will
become headers.
</p>
<pre>
  [{ 'Content-Type' =&gt; 'text/plain', :content =&gt; &quot;some text&quot; },
   { 'Content-Type' =&gt; 'video/mp4', :content =&gt; File.new('video.mp4') }]
  =&gt; &lt;Two parts with custom Content-Type header&gt;
</pre>
<p>
See <a href="HTTP/Message.html#M000178">HTTP::Message.file?</a> for actual
condition of &#8216;a file&#8217;.
</p>
</td></tr>
<tr><td valign="top">header:</td><td>a Hash or an Array of extra headers. e.g. { &#8216;Accept&#8217; =>
&#8216;<b>/</b>&#8217; } or [[&#8216;Accept&#8217;,
&#8216;image/jpeg&#8217;], [&#8216;Accept&#8217;,
&#8216;image/png&#8217;]].

</td></tr>
<tr><td valign="top">&amp;block:</td><td>Give a block to get chunked message-body of response like get(uri) {
|chunked_body| &#8230; }. Size of each chunk may not be the same.

</td></tr>
</table>
<p>
You can also pass a <a href="String.html">String</a> as a body. <a
href="HTTPClient.html">HTTPClient</a> just sends a <a
href="String.html">String</a> as a <a href="HTTP.html">HTTP</a> request
message body.
</p>
<p>
When you pass an IO as a body, <a href="HTTPClient.html">HTTPClient</a>
sends it as a <a href="HTTP.html">HTTP</a> request with chunked encoding
(Transfer-Encoding: chunked in <a href="HTTP.html">HTTP</a> header) if IO
does not respond to :read. Bear in mind that some server application does
not support chunked request. At least cgi.rb does not support it.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000342_source')" id="l_M000342_source">show</a>
                        
                    </p>
                    <div id="M000342_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 738</span>
738:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
739:     <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-identifier">follow_redirect</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>, <span class="ruby-identifier">:follow_redirect</span>)
740:     <span class="ruby-keyword kw">if</span> [<span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:put</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
741:       <span class="ruby-identifier">body</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">''</span>
742:     <span class="ruby-keyword kw">end</span>
743:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:propfind</span>
744:       <span class="ruby-identifier">header</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">PROPFIND_DEFAULT_EXTHEADER</span>
745:     <span class="ruby-keyword kw">else</span>
746:       <span class="ruby-identifier">header</span> <span class="ruby-operator">||=</span> {}
747:     <span class="ruby-keyword kw">end</span>
748:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">uri</span>)
749:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
750:       <span class="ruby-identifier">filtered_block</span> = <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">res</span>, <span class="ruby-identifier">str</span><span class="ruby-operator">|</span>
751:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">str</span>)
752:       }
753:     <span class="ruby-keyword kw">end</span>
754:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">follow_redirect</span>
755:       <span class="ruby-identifier">follow_redirect</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
756:     <span class="ruby-keyword kw">else</span>
757:       <span class="ruby-identifier">do_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">filtered_block</span>)
758:     <span class="ruby-keyword kw">end</span>
759:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000352">
                    
                    <a name="M000352"></a><b>request_async</b>(method, uri, query = nil, body = nil, header = {})
                    
                </div>
                
                <div class="description">
                  <p>
Sends a request in async style. request method creates new Thread for <a
href="HTTP.html">HTTP</a> connection and returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance
immediately.
</p>
<p>
Arguments definition is the same as request.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000352_source')" id="l_M000352_source">show</a>
                        
                    </p>
                    <div id="M000352_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 828</span>
828:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">body</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">header</span> = {})
829:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">uri</span>)
830:     <span class="ruby-identifier">do_request_async</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>)
831:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000353">
                    
                    <a name="M000353"></a><b>reset</b>(uri)
                    
                </div>
                
                <div class="description">
                  <p>
Resets internal session for the given URL. Keep-alive connection for the
site (host-port pair) is disconnected if exists.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000353_source')" id="l_M000353_source">show</a>
                        
                    </p>
                    <div id="M000353_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 835</span>
835:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>(<span class="ruby-identifier">uri</span>)
836:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">uri</span>)
837:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">reset</span>(<span class="ruby-identifier">uri</span>)
838:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000354">
                    
                    <a name="M000354"></a><b>reset_all</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Resets all of internal sessions. Keep-alive connections are disconnected.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000354_source')" id="l_M000354_source">show</a>
                        
                    </p>
                    <div id="M000354_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 841</span>
841:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset_all</span>
842:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">reset_all</span>
843:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000326">
                    
                    <a name="M000326"></a><b>save_cookie_store</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Try to save Cookies to the file specified in set_cookie_store. Unexpected
error will be raised if you don&#8217;t call <a
href="HTTPClient.html#M000325">set_cookie_store</a> first. (interface
mismatch between <a
href="WebAgent/CookieManager.html">WebAgent::CookieManager</a>
implementation)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000326_source')" id="l_M000326_source">show</a>
                        
                    </p>
                    <div id="M000326_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 535</span>
535:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save_cookie_store</span>
536:     <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">save_cookies</span>
537:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000322">
                    
                    <a name="M000322"></a><b>set_auth</b>(domain, user, passwd)
                    
                </div>
                
                <div class="description">
                  <p>
Sets credential for Web server authentication.
</p>
<table>
<tr><td valign="top">domain:</td><td>a <a href="String.html">String</a> or an URI to specify where <a
href="HTTPClient.html">HTTPClient</a> should use this

</td></tr>
</table>
<pre>
      credential.  If you set uri to nil, HTTPClient uses this credential
      wherever a server requires it.
</pre>
<table>
<tr><td valign="top">user:</td><td>username <a href="String.html">String</a>.

</td></tr>
<tr><td valign="top">passwd:</td><td>password <a href="String.html">String</a>.

</td></tr>
</table>
<p>
You can set multiple credentials for each uri.
</p>
<pre>
  clnt.set_auth('http://www.example.com/foo/', 'foo_user', 'passwd')
  clnt.set_auth('http://www.example.com/bar/', 'bar_user', 'passwd')
</pre>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000322_source')" id="l_M000322_source">show</a>
                        
                    </p>
                    <div id="M000322_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 498</span>
498:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_auth</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
499:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">domain</span>)
500:     <span class="ruby-ivar">@www_auth</span>.<span class="ruby-identifier">set_auth</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
501:     <span class="ruby-identifier">reset_all</span>
502:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000323">
                    
                    <a name="M000323"></a><b>set_basic_auth</b>(domain, user, passwd)
                    
                </div>
                
                <div class="description">
                  <p>
Deprecated. Use <a href="HTTPClient.html#M000322">set_auth</a> instead.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000323_source')" id="l_M000323_source">show</a>
                        
                    </p>
                    <div id="M000323_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 505</span>
505:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_basic_auth</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
506:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">domain</span>)
507:     <span class="ruby-ivar">@www_auth</span>.<span class="ruby-identifier">basic_auth</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
508:     <span class="ruby-identifier">reset_all</span>
509:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000325">
                    
                    <a name="M000325"></a><b>set_cookie_store</b>(filename)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the filename where non-volatile Cookies be saved by calling
save_cookie_store. This method tries to load and managing Cookies from the
specified file.
</p>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000325_source')" id="l_M000325_source">show</a>
                        
                    </p>
                    <div id="M000325_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 526</span>
526:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_cookie_store</span>(<span class="ruby-identifier">filename</span>)
527:     <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">cookies_file</span> = <span class="ruby-identifier">filename</span>
528:     <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">load_cookies</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filename</span>
529:     <span class="ruby-identifier">reset_all</span>
530:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000324">
                    
                    <a name="M000324"></a><b>set_proxy_auth</b>(user, passwd)
                    
                </div>
                
                <div class="description">
                  <p>
Sets credential for Proxy authentication.
</p>
<table>
<tr><td valign="top">user:</td><td>username <a href="String.html">String</a>.

</td></tr>
<tr><td valign="top">passwd:</td><td>password <a href="String.html">String</a>.

</td></tr>
</table>
<p>
Calling this method resets all existing sessions.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000324_source')" id="l_M000324_source">show</a>
                        
                    </p>
                    <div id="M000324_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 516</span>
516:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_proxy_auth</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
517:     <span class="ruby-ivar">@proxy_auth</span>.<span class="ruby-identifier">set_auth</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">passwd</span>)
518:     <span class="ruby-identifier">reset_all</span>
519:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000331">
                    
                    <a name="M000331"></a><b>strict_redirect_uri_callback</b>(uri, res)
                    
                </div>
                
                <div class="description">
                  <p>
A method for redirect uri callback. How to use:
</p>
<pre>
  clnt.redirect_uri_callback = clnt.method(:strict_redirect_uri_callback)
</pre>
<p>
This callback does not allow relative redirect such as
</p>
<pre>
  Location: ../foo/
</pre>
<p>
in <a href="HTTP.html">HTTP</a> header. (raises <a
href="HTTPClient/BadResponseError.html">BadResponseError</a> instead)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000331_source')" id="l_M000331_source">show</a>
                        
                    </p>
                    <div id="M000331_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 624</span>
624:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">strict_redirect_uri_callback</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">res</span>)
625:     <span class="ruby-identifier">newuri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'location'</span>][<span class="ruby-value">0</span>])
626:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">https?</span>(<span class="ruby-identifier">uri</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">https?</span>(<span class="ruby-identifier">newuri</span>)
627:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">BadResponseError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;redirecting to non-https resource&quot;</span>)
628:     <span class="ruby-keyword kw">end</span>
629:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">newuri</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>)
630:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">BadResponseError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;unexpected location: #{newuri}&quot;</span>, <span class="ruby-identifier">res</span>)
631:     <span class="ruby-keyword kw">end</span>
632:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;redirect to: #{newuri}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
633:     <span class="ruby-identifier">newuri</span>
634:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000341">
                    
                    <a name="M000341"></a><b>trace</b>(uri, *args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Sends TRACE request to the specified URL. See request for arguments.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000341_source')" id="l_M000341_source">show</a>
                        
                    </p>
                    <div id="M000341_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 696</span>
696:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">trace</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
697:     <span class="ruby-identifier">request</span>(<span class="ruby-value str">'TRACE'</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">argument_to_hash</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
698:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000351">
                    
                    <a name="M000351"></a><b>trace_async</b>(uri, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Sends TRACE request in async style. See <a
href="HTTPClient.html#M000352">request_async</a> for arguments. It
immediately returns a <a
href="HTTPClient/Connection.html">HTTPClient::Connection</a> instance as a
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000351_source')" id="l_M000351_source">show</a>
                        
                    </p>
                    <div id="M000351_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 819</span>
819:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">trace_async</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
820:     <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> = <span class="ruby-identifier">keyword_argument</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:body</span>, <span class="ruby-identifier">:header</span>)
821:     <span class="ruby-identifier">request_async</span>(<span class="ruby-identifier">:trace</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span> <span class="ruby-operator">||</span> {})
822:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000362">
                    
                    <a name="M000362"></a><b>create_boundary</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000362_source')" id="l_M000362_source">show</a>
                        
                    </p>
                    <div id="M000362_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1008</span>
1008:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_boundary</span>
1009:     <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>)
1010:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000361">
                    
                    <a name="M000361"></a><b>create_request</b>(method, uri, query, body, header)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000361_source')" id="l_M000361_source">show</a>
                        
                    </p>
                    <div id="M000361_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 966</span>
 966:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>)
 967:     <span class="ruby-identifier">method</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span>
 968:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">header</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
 969:       <span class="ruby-identifier">header</span> = <span class="ruby-identifier">header</span>.<span class="ruby-identifier">to_a</span>
 970:     <span class="ruby-keyword kw">else</span>
 971:       <span class="ruby-identifier">header</span> = <span class="ruby-identifier">header</span>.<span class="ruby-identifier">dup</span>
 972:     <span class="ruby-keyword kw">end</span>
 973:     <span class="ruby-identifier">boundary</span> = <span class="ruby-keyword kw">nil</span>
 974:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">body</span>
 975:       <span class="ruby-identifier">_</span>, <span class="ruby-identifier">content_type</span> = <span class="ruby-identifier">header</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
 976:         <span class="ruby-identifier">key</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'content-type'</span>
 977:       }
 978:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">content_type</span>
 979:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\Amultipart/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">content_type</span>
 980:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/boundary=(.+)\z/</span>
 981:             <span class="ruby-identifier">boundary</span> = <span class="ruby-identifier">$1</span>
 982:           <span class="ruby-keyword kw">else</span>
 983:             <span class="ruby-identifier">boundary</span> = <span class="ruby-identifier">create_boundary</span>
 984:             <span class="ruby-identifier">content_type</span> = <span class="ruby-node">&quot;#{content_type}; boundary=#{boundary}&quot;</span>
 985:             <span class="ruby-identifier">header</span> = <span class="ruby-identifier">override_header</span>(<span class="ruby-identifier">header</span>, <span class="ruby-value str">'Content-Type'</span>, <span class="ruby-identifier">content_type</span>)
 986:           <span class="ruby-keyword kw">end</span>
 987:         <span class="ruby-keyword kw">end</span>
 988:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">method</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'POST'</span>
 989:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_in_form_data?</span>(<span class="ruby-identifier">body</span>)
 990:           <span class="ruby-identifier">boundary</span> = <span class="ruby-identifier">create_boundary</span>
 991:           <span class="ruby-identifier">content_type</span> = <span class="ruby-node">&quot;multipart/form-data; boundary=#{boundary}&quot;</span>
 992:         <span class="ruby-keyword kw">else</span>
 993:           <span class="ruby-identifier">content_type</span> = <span class="ruby-value str">'application/x-www-form-urlencoded'</span>
 994:         <span class="ruby-keyword kw">end</span>
 995:         <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value str">'Content-Type'</span>, <span class="ruby-identifier">content_type</span>]
 996:       <span class="ruby-keyword kw">end</span>
 997:     <span class="ruby-keyword kw">end</span>
 998:     <span class="ruby-identifier">req</span> = <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">new_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">boundary</span>)
 999:     <span class="ruby-identifier">header</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1000:       <span class="ruby-identifier">req</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
1001:     <span class="ruby-keyword kw">end</span>
1002:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@cookie_manager</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cookie</span> = <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">uri</span>)
1003:       <span class="ruby-identifier">req</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">'Cookie'</span>, <span class="ruby-identifier">cookie</span>)
1004:     <span class="ruby-keyword kw">end</span>
1005:     <span class="ruby-identifier">req</span>
1006:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000366">
                    
                    <a name="M000366"></a><b>do_get_block</b>(req, proxy, conn, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
!! CAUTION !!
</p>
<pre>
  Method 'do_get*' runs under MT conditon. Be careful to change.
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000366_source')" id="l_M000366_source">show</a>
                        
                    </p>
                    <div id="M000366_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1049</span>
1049:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_get_block</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>, <span class="ruby-identifier">conn</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
1050:     <span class="ruby-ivar">@request_filter</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
1051:       <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">filter_request</span>(<span class="ruby-identifier">req</span>)
1052:     <span class="ruby-keyword kw">end</span>
1053:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">str</span> = <span class="ruby-ivar">@test_loopback_response</span>.<span class="ruby-identifier">shift</span>
1054:       <span class="ruby-identifier">dump_dummy_request_response</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">http_body</span>.<span class="ruby-identifier">dump</span>, <span class="ruby-identifier">str</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1055:       <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">new_response</span>(<span class="ruby-identifier">str</span>))
1056:       <span class="ruby-keyword kw">return</span>
1057:     <span class="ruby-keyword kw">end</span>
1058:     <span class="ruby-identifier">content</span> = <span class="ruby-identifier">block</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>
1059:     <span class="ruby-identifier">res</span> = <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">new_response</span>(<span class="ruby-identifier">content</span>)
1060:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;= Request\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1061:     <span class="ruby-identifier">sess</span> = <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>)
1062:     <span class="ruby-identifier">res</span>.<span class="ruby-identifier">peer_cert</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">ssl_peer_cert</span>
1063:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\n= Response\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1064:     <span class="ruby-identifier">do_get_header</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">sess</span>)
1065:     <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">res</span>)
1066:     <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">get_body</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span>
1067:       <span class="ruby-identifier">set_encoding</span>(<span class="ruby-identifier">part</span>, <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body_encoding</span>)
1068:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
1069:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">res</span>, <span class="ruby-identifier">part</span>)
1070:       <span class="ruby-keyword kw">else</span>
1071:         <span class="ruby-identifier">content</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">part</span>
1072:       <span class="ruby-keyword kw">end</span>
1073:     <span class="ruby-keyword kw">end</span>
1074:     <span class="ruby-comment cmt"># there could be a race condition but it's OK to cache unreusable</span>
1075:     <span class="ruby-comment cmt"># connection because we do retry for that case.</span>
1076:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">keep</span>(<span class="ruby-identifier">sess</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">closed?</span>
1077:     <span class="ruby-identifier">commands</span> = <span class="ruby-ivar">@request_filter</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
1078:       <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">filter_response</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
1079:     }
1080:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">commands</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">command</span><span class="ruby-operator">|</span> <span class="ruby-identifier">command</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:retry</span> }
1081:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RetryableResponse</span>.<span class="ruby-identifier">new</span>
1082:     <span class="ruby-keyword kw">end</span>
1083:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000368">
                    
                    <a name="M000368"></a><b>do_get_header</b>(req, res, sess)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000368_source')" id="l_M000368_source">show</a>
                        
                    </p>
                    <div id="M000368_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1114</span>
1114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_get_header</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">sess</span>)
1115:     <span class="ruby-identifier">res</span>.<span class="ruby-identifier">http_version</span>, <span class="ruby-identifier">res</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">res</span>.<span class="ruby-identifier">reason</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">get_header</span>
1116:     <span class="ruby-identifier">res</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">set_headers</span>(<span class="ruby-identifier">headers</span>)
1117:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@cookie_manager</span>
1118:       <span class="ruby-identifier">res</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'set-cookie'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cookie</span><span class="ruby-operator">|</span>
1119:         <span class="ruby-ivar">@cookie_manager</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">cookie</span>, <span class="ruby-identifier">req</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">request_uri</span>)
1120:       <span class="ruby-keyword kw">end</span>
1121:     <span class="ruby-keyword kw">end</span>
1122:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000367">
                    
                    <a name="M000367"></a><b>do_get_stream</b>(req, proxy, conn)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000367_source')" id="l_M000367_source">show</a>
                        
                    </p>
                    <div id="M000367_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1085</span>
1085:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_get_stream</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>, <span class="ruby-identifier">conn</span>)
1086:     <span class="ruby-ivar">@request_filter</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
1087:       <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">filter_request</span>(<span class="ruby-identifier">req</span>)
1088:     <span class="ruby-keyword kw">end</span>
1089:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">str</span> = <span class="ruby-ivar">@test_loopback_response</span>.<span class="ruby-identifier">shift</span>
1090:       <span class="ruby-identifier">dump_dummy_request_response</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">http_body</span>.<span class="ruby-identifier">dump</span>, <span class="ruby-identifier">str</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1091:       <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">new_response</span>(<span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>)))
1092:       <span class="ruby-keyword kw">return</span>
1093:     <span class="ruby-keyword kw">end</span>
1094:     <span class="ruby-identifier">piper</span>, <span class="ruby-identifier">pipew</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
1095:     <span class="ruby-identifier">res</span> = <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">new_response</span>(<span class="ruby-identifier">piper</span>)
1096:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;= Request\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1097:     <span class="ruby-identifier">sess</span> = <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>)
1098:     <span class="ruby-identifier">res</span>.<span class="ruby-identifier">peer_cert</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">ssl_peer_cert</span>
1099:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\n= Response\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug_dev</span>
1100:     <span class="ruby-identifier">do_get_header</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">sess</span>)
1101:     <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">res</span>)
1102:     <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">get_body</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span>
1103:       <span class="ruby-identifier">set_encoding</span>(<span class="ruby-identifier">part</span>, <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body_encoding</span>)
1104:       <span class="ruby-identifier">pipew</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">part</span>)
1105:     <span class="ruby-keyword kw">end</span>
1106:     <span class="ruby-identifier">pipew</span>.<span class="ruby-identifier">close</span>
1107:     <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">keep</span>(<span class="ruby-identifier">sess</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">closed?</span>
1108:     <span class="ruby-identifier">_</span> = <span class="ruby-ivar">@request_filter</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
1109:       <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">filter_response</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
1110:     }
1111:     <span class="ruby-comment cmt"># ignore commands (not retryable in async mode)</span>
1112:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000355">
                    
                    <a name="M000355"></a><b>do_request</b>(method, uri, query, body, header, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000355_source')" id="l_M000355_source">show</a>
                        
                    </p>
                    <div id="M000355_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 857</span>
857:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
858:     <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Connection</span>.<span class="ruby-identifier">new</span>
859:     <span class="ruby-identifier">res</span> = <span class="ruby-keyword kw">nil</span>
860:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">body</span>)
861:       <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
862:     <span class="ruby-keyword kw">end</span>
863:     <span class="ruby-identifier">retry_count</span> = <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">protocol_retry_count</span>
864:     <span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">no_proxy?</span>(<span class="ruby-identifier">uri</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@proxy</span>
865:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">retry_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
866:       <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> = <span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pos</span>
867:       <span class="ruby-identifier">req</span> = <span class="ruby-identifier">create_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>)
868:       <span class="ruby-keyword kw">begin</span>
869:         <span class="ruby-identifier">protect_keep_alive_disconnected</span> <span class="ruby-keyword kw">do</span>
870:           <span class="ruby-identifier">do_get_block</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>, <span class="ruby-identifier">conn</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
871:         <span class="ruby-keyword kw">end</span>
872:         <span class="ruby-identifier">res</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">pop</span>
873:         <span class="ruby-keyword kw">break</span>
874:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">RetryableResponse</span>
875:         <span class="ruby-identifier">res</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">pop</span>
876:         <span class="ruby-identifier">retry_count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
877:       <span class="ruby-keyword kw">end</span>
878:     <span class="ruby-keyword kw">end</span>
879:     <span class="ruby-identifier">res</span>
880:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000356">
                    
                    <a name="M000356"></a><b>do_request_async</b>(method, uri, query, body, header)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000356_source')" id="l_M000356_source">show</a>
                        
                    </p>
                    <div id="M000356_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 882</span>
882:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_request_async</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>)
883:     <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Connection</span>.<span class="ruby-identifier">new</span>
884:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">conn</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">tconn</span><span class="ruby-operator">|</span>
885:       <span class="ruby-keyword kw">begin</span>
886:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">body</span>)
887:           <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
888:         <span class="ruby-keyword kw">end</span>
889:         <span class="ruby-identifier">retry_count</span> = <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">protocol_retry_count</span>
890:         <span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">no_proxy?</span>(<span class="ruby-identifier">uri</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@proxy</span>
891:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">retry_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
892:           <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> = <span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pos</span>
893:           <span class="ruby-identifier">req</span> = <span class="ruby-identifier">create_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>)
894:           <span class="ruby-keyword kw">begin</span>
895:             <span class="ruby-identifier">protect_keep_alive_disconnected</span> <span class="ruby-keyword kw">do</span>
896:               <span class="ruby-identifier">do_get_stream</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">proxy</span>, <span class="ruby-identifier">tconn</span>)
897:             <span class="ruby-keyword kw">end</span>
898:             <span class="ruby-keyword kw">break</span>
899:           <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">RetryableResponse</span>
900:             <span class="ruby-identifier">retry_count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
901:           <span class="ruby-keyword kw">end</span>
902:         <span class="ruby-keyword kw">end</span>
903:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span>
904:         <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">$!</span>
905:       <span class="ruby-keyword kw">end</span>
906:     }
907:     <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">async_thread</span> = <span class="ruby-identifier">t</span>
908:     <span class="ruby-identifier">conn</span>
909:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000369">
                    
                    <a name="M000369"></a><b>dump_dummy_request_response</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000369_source')" id="l_M000369_source">show</a>
                        
                    </p>
                    <div id="M000369_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1124</span>
1124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dump_dummy_request_response</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
1125:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;= Dummy Request\n\n&quot;</span>
1126:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">req</span>
1127:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\n= Dummy Response\n\n&quot;</span>
1128:     <span class="ruby-ivar">@debug_dev</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">res</span>
1129:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000363">
                    
                    <a name="M000363"></a><b>file_in_form_data?</b>(body)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000363_source')" id="l_M000363_source">show</a>
                        
                    </p>
                    <div id="M000363_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1012</span>
1012:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">file_in_form_data?</span>(<span class="ruby-identifier">body</span>)
1013:     <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">multiparam_query?</span>(<span class="ruby-identifier">body</span>) <span class="ruby-operator">&amp;&amp;</span>
1014:       <span class="ruby-identifier">body</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">v</span>) }
1015:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000359">
                    
                    <a name="M000359"></a><b>follow_redirect</b>(method, uri, query, body, header, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000359_source')" id="l_M000359_source">show</a>
                        
                    </p>
                    <div id="M000359_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 929</span>
929:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">follow_redirect</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
930:     <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-identifier">uri</span>)
931:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
932:       <span class="ruby-identifier">filtered_block</span> = <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span>, <span class="ruby-identifier">str</span><span class="ruby-operator">|</span>
933:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">str</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Status</span>.<span class="ruby-identifier">successful?</span>(<span class="ruby-identifier">r</span>.<span class="ruby-identifier">status</span>)
934:       }
935:     <span class="ruby-keyword kw">end</span>
936:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Message</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">body</span>)
937:       <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
938:     <span class="ruby-keyword kw">end</span>
939:     <span class="ruby-identifier">retry_number</span> = <span class="ruby-value">0</span>
940:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">retry_number</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@follow_redirect_count</span>
941:       <span class="ruby-identifier">body</span>.<span class="ruby-identifier">pos</span> = <span class="ruby-identifier">pos</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pos</span>
942:       <span class="ruby-identifier">res</span> = <span class="ruby-identifier">do_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">filtered_block</span>)
943:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Status</span>.<span class="ruby-identifier">successful?</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">status</span>)
944:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>
945:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Status</span>.<span class="ruby-identifier">redirect?</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">status</span>)
946:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">urify</span>(<span class="ruby-ivar">@redirect_uri_callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">res</span>))
947:         <span class="ruby-identifier">retry_number</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
948:       <span class="ruby-keyword kw">else</span>
949:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">BadResponseError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;unexpected response: #{res.header.inspect}&quot;</span>, <span class="ruby-identifier">res</span>)
950:       <span class="ruby-keyword kw">end</span>
951:     <span class="ruby-keyword kw">end</span>
952:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">BadResponseError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;retry count exceeded&quot;</span>, <span class="ruby-identifier">res</span>)
953:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000358">
                    
                    <a name="M000358"></a><b>getenv</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000358_source')" id="l_M000358_source">show</a>
                        
                    </p>
                    <div id="M000358_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 925</span>
925:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getenv</span>(<span class="ruby-identifier">name</span>)
926:     <span class="ruby-constant">ENV</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">upcase</span>]
927:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000357">
                    
                    <a name="M000357"></a><b>load_environment</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000357_source')" id="l_M000357_source">show</a>
                        
                    </p>
                    <div id="M000357_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 911</span>
911:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_environment</span>
912:     <span class="ruby-comment cmt"># http_proxy</span>
913:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">getenv</span>(<span class="ruby-value str">'REQUEST_METHOD'</span>)
914:       <span class="ruby-comment cmt"># HTTP_PROXY conflicts with the environment variable usage in CGI where</span>
915:       <span class="ruby-comment cmt"># HTTP_* is used for HTTP header information.  Unlike open-uri, we</span>
916:       <span class="ruby-comment cmt"># simply ignore http_proxy in CGI env and use cgi_http_proxy instead.</span>
917:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">getenv</span>(<span class="ruby-value str">'cgi_http_proxy'</span>)
918:     <span class="ruby-keyword kw">else</span>
919:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">getenv</span>(<span class="ruby-value str">'http_proxy'</span>)
920:     <span class="ruby-keyword kw">end</span>
921:     <span class="ruby-comment cmt"># no_proxy</span>
922:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">no_proxy</span> = <span class="ruby-identifier">getenv</span>(<span class="ruby-value str">'no_proxy'</span>)
923:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000365">
                    
                    <a name="M000365"></a><b>no_proxy?</b>(uri)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000365_source')" id="l_M000365_source">show</a>
                        
                    </p>
                    <div id="M000365_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1031</span>
1031:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">no_proxy?</span>(<span class="ruby-identifier">uri</span>)
1032:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@proxy</span> <span class="ruby-keyword kw">or</span> <span class="ruby-constant">NO_PROXY_HOSTS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>)
1033:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
1034:     <span class="ruby-keyword kw">end</span>
1035:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@no_proxy</span>
1036:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
1037:     <span class="ruby-keyword kw">end</span>
1038:     <span class="ruby-ivar">@no_proxy</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/([^:,]+)(?::(\d+))?/</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span><span class="ruby-operator">|</span>
1039:       <span class="ruby-keyword kw">if</span> <span class="ruby-node">/(\A|\.)#{Regexp.quote(host)}\z/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">&amp;&amp;</span>
1040:           (<span class="ruby-operator">!</span><span class="ruby-identifier">port</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span>)
1041:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
1042:       <span class="ruby-keyword kw">end</span>
1043:     <span class="ruby-keyword kw">end</span>
1044:     <span class="ruby-keyword kw">false</span>
1045:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000364">
                    
                    <a name="M000364"></a><b>override_header</b>(header, key, value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000364_source')" id="l_M000364_source">show</a>
                        
                    </p>
                    <div id="M000364_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1017</span>
1017:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">override_header</span>(<span class="ruby-identifier">header</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
1018:     <span class="ruby-identifier">result</span> = []
1019:     <span class="ruby-identifier">header</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
1020:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">downcase</span>
1021:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
1022:       <span class="ruby-keyword kw">else</span>
1023:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>]
1024:       <span class="ruby-keyword kw">end</span>
1025:     <span class="ruby-keyword kw">end</span>
1026:     <span class="ruby-identifier">result</span>
1027:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000360">
                    
                    <a name="M000360"></a><b>protect_keep_alive_disconnected</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000360_source')" id="l_M000360_source">show</a>
                        
                    </p>
                    <div id="M000360_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/httpclient.rb, line 955</span>
955:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">protect_keep_alive_disconnected</span>
956:     <span class="ruby-keyword kw">begin</span>
957:       <span class="ruby-keyword kw">yield</span>
958:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">KeepAliveDisconnected</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
959:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">sess</span>
960:         <span class="ruby-ivar">@session_manager</span>.<span class="ruby-identifier">invalidate</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">sess</span>.<span class="ruby-identifier">dest</span>)
961:       <span class="ruby-keyword kw">end</span>
962:       <span class="ruby-keyword kw">yield</span>
963:     <span class="ruby-keyword kw">end</span>
964:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000370">
                    
                    <a name="M000370"></a><b>set_encoding</b>(str, encoding)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000370_source')" id="l_M000370_source">show</a>
                        
                    </p>
                    <div id="M000370_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/httpclient.rb, line 1131</span>
1131:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_encoding</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">encoding</span>)
1132:     <span class="ruby-identifier">str</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-identifier">encoding</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">encoding</span>
1133:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    