<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Grit::GitRuby::Repository</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Grit::GitRuby::Repository 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/grit/git-ruby/repository_rb.html">lib/grit/git-ruby/repository.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000241">add_file</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000228">blame_tree</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000174">cached</a>,</li>
                
                <li><a href="#M000184">cat_file</a>,</li>
                
                <li><a href="#M000183">cat_file_size</a>,</li>
                
                <li><a href="#M000182">cat_file_type</a>,</li>
                
                <li><a href="#M000242">close</a>,</li>
                
                <li><a href="#M000240">create_initial_config</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000209">diff</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000245">each_alternate_path</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000220">files_changed?</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000175">get_object_by_sha1</a>,</li>
                
                <li><a href="#M000173">get_raw_object_by_sha1</a>,</li>
                
                <li><a href="#M000191">get_raw_tree</a>,</li>
                
                <li><a href="#M000192">get_raw_trees</a>,</li>
                
                <li><a href="#M000225">get_subtree</a>,</li>
                
                <li><a href="#M000243">git_path</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000180">in_loose?</a>,</li>
                
                <li><a href="#M000179">in_packs?</a>,</li>
                
                <li><a href="#M000237">init</a>,</li>
                
                <li><a href="#M000244">initloose</a>,</li>
                
                <li><a href="#M000249">initpacks</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000185">list_tree</a>,</li>
                
                <li><a href="#M000247">load_alternate_loose</a>,</li>
                
                <li><a href="#M000250">load_alternate_packs</a>,</li>
                
                <li><a href="#M000248">load_loose</a>,</li>
                
                <li><a href="#M000251">load_packs</a>,</li>
                
                <li><a href="#M000197">log</a>,</li>
                
                <li><a href="#M000231">look_for_commits</a>,</li>
                
                <li><a href="#M000170">loose</a>,</li>
                
                <li><a href="#M000189">ls_tree</a>,</li>
                
                <li><a href="#M000194">ls_tree_path</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000169">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000177">object_exists?</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000171">packs</a>,</li>
                
                <li><a href="#M000176">put_raw_object</a></li>
                
            </ul>
        </dd>
    
        <dt>Q</dt>
        <dd>
            <ul>
                
                <li><a href="#M000210">quick_diff</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000199">rev_list</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000172">show</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000198">truncate_arr</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000202">walk_log</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="Repository/NoSuchPath.html">Grit::GitRuby::Repository::NoSuchPath</a></li>
        
        <li><span class="type">CLASS</span> <a href="Repository/NoSuchShaFound.html">Grit::GitRuby::Repository::NoSuchShaFound</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>git_dir</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000228">
                    
                    <a name="M000228"></a><b>blame_tree</b>(commit_sha, path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000228_source')" id="l_M000228_source">show</a>
                        
                    </p>
                    <div id="M000228_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 567</span>
567:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">blame_tree</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>)
568:         <span class="ruby-comment cmt"># find subtree</span>
569:         <span class="ruby-identifier">tree_sha</span> = <span class="ruby-identifier">get_subtree</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>)
570:         <span class="ruby-keyword kw">return</span> {} <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">tree_sha</span>
571: 
572:         <span class="ruby-identifier">looking_for</span> = []
573:         <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">tree_sha</span>).<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
574:           <span class="ruby-identifier">looking_for</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'.'</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">name</span>)
575:         <span class="ruby-keyword kw">end</span>
576: 
577:         <span class="ruby-ivar">@already_searched</span> = {}
578:         <span class="ruby-identifier">commits</span> = <span class="ruby-identifier">look_for_commits</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">looking_for</span>)
579: 
580:         <span class="ruby-comment cmt"># cleaning up array</span>
581:         <span class="ruby-identifier">arr</span> = {}
582:         <span class="ruby-identifier">commits</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">commit_array</span><span class="ruby-operator">|</span>
583:           <span class="ruby-identifier">key</span> = <span class="ruby-identifier">commit_array</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">'./'</span>, <span class="ruby-value str">''</span>)
584:           <span class="ruby-identifier">arr</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">commit_array</span>[<span class="ruby-value">1</span>]
585:         <span class="ruby-keyword kw">end</span>
586:         <span class="ruby-identifier">arr</span>
587:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000174">
                    
                    <a name="M000174"></a><b>cached</b>(key, object, do_cache = true)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000174_source')" id="l_M000174_source">show</a>
                        
                    </p>
                    <div id="M000174_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 99</span>
 99:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cached</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">object</span>, <span class="ruby-identifier">do_cache</span> = <span class="ruby-keyword kw">true</span>)
100:         <span class="ruby-identifier">object</span>
101:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000184">
                    
                    <a name="M000184"></a><b>cat_file</b>(sha)
                    
                </div>
                
                <div class="description">
                  <p>
returns the raw file contents of this sha
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000184_source')" id="l_M000184_source">show</a>
                        
                    </p>
                    <div id="M000184_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 154</span>
154:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cat_file</span>(<span class="ruby-identifier">sha</span>)
155:         <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">raw_content</span>
156:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000183">
                    
                    <a name="M000183"></a><b>cat_file_size</b>(sha)
                    
                </div>
                
                <div class="description">
                  <p>
returns the file size (as an int) of this sha
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000183_source')" id="l_M000183_source">show</a>
                        
                    </p>
                    <div id="M000183_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 149</span>
149:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cat_file_size</span>(<span class="ruby-identifier">sha</span>)
150:         <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span>
151:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000182">
                    
                    <a name="M000182"></a><b>cat_file_type</b>(sha)
                    
                </div>
                
                <div class="description">
                  <p>
returns the file type (as a symbol) of this sha
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000182_source')" id="l_M000182_source">show</a>
                        
                    </p>
                    <div id="M000182_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 144</span>
144:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cat_file_type</span>(<span class="ruby-identifier">sha</span>)
145:         <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">type</span>
146:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000242">
                    
                    <a name="M000242"></a><b>close</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000242_source')" id="l_M000242_source">show</a>
                        
                    </p>
                    <div id="M000242_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 682</span>
682:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
683:         <span class="ruby-ivar">@packs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pack</span><span class="ruby-operator">|</span>
684:           <span class="ruby-identifier">pack</span>.<span class="ruby-identifier">close</span>
685:         <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@packs</span>
686:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000209">
                    
                    <a name="M000209"></a><b>diff</b>(commit1, commit2, options = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000209_source')" id="l_M000209_source">show</a>
                        
                    </p>
                    <div id="M000209_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 395</span>
395:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">diff</span>(<span class="ruby-identifier">commit1</span>, <span class="ruby-identifier">commit2</span>, <span class="ruby-identifier">options</span> = {})
396:         <span class="ruby-identifier">patch</span> = <span class="ruby-value str">''</span>
397: 
398:         <span class="ruby-identifier">commit_obj1</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit1</span>)
399:         <span class="ruby-identifier">tree1</span> = <span class="ruby-identifier">commit_obj1</span>.<span class="ruby-identifier">tree</span>
400:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">commit2</span>
401:           <span class="ruby-identifier">tree2</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit2</span>).<span class="ruby-identifier">tree</span>
402:         <span class="ruby-keyword kw">else</span>
403:           <span class="ruby-identifier">tree2</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit_obj1</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">first</span>).<span class="ruby-identifier">tree</span>
404:         <span class="ruby-keyword kw">end</span>
405: 
406:         <span class="ruby-identifier">qdiff</span> = <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">tree1</span>, <span class="ruby-identifier">tree2</span>)
407: 
408:         <span class="ruby-identifier">qdiff</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">diff_arr</span><span class="ruby-operator">|</span>
409:           <span class="ruby-identifier">path</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">treeSHA1</span>, <span class="ruby-identifier">treeSHA2</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">diff_arr</span>
410:           <span class="ruby-identifier">format</span>, <span class="ruby-identifier">lines</span>, <span class="ruby-identifier">output</span> = <span class="ruby-identifier">:unified</span>, <span class="ruby-value">3</span>, <span class="ruby-value str">''</span>
411:           <span class="ruby-identifier">file_length_difference</span> = <span class="ruby-value">0</span>
412: 
413:           <span class="ruby-identifier">fileA</span> = <span class="ruby-identifier">treeSHA1</span> <span class="ruby-value">? </span><span class="ruby-identifier">cat_file</span>(<span class="ruby-identifier">treeSHA1</span>) <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>
414:           <span class="ruby-identifier">fileB</span> = <span class="ruby-identifier">treeSHA2</span> <span class="ruby-value">? </span><span class="ruby-identifier">cat_file</span>(<span class="ruby-identifier">treeSHA2</span>) <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>
415: 
416:           <span class="ruby-identifier">sha1</span> = <span class="ruby-identifier">treeSHA1</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'0000000000000000000000000000000000000000'</span>
417:           <span class="ruby-identifier">sha2</span> = <span class="ruby-identifier">treeSHA2</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'0000000000000000000000000000000000000000'</span>
418: 
419:           <span class="ruby-identifier">data_old</span> = <span class="ruby-identifier">fileA</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\n/</span>).<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">chomp</span> }
420:           <span class="ruby-identifier">data_new</span> = <span class="ruby-identifier">fileB</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\n/</span>).<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">chomp</span> }
421: 
422:           <span class="ruby-identifier">diffs</span> = <span class="ruby-constant">Difference</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span>.<span class="ruby-identifier">diff</span>(<span class="ruby-identifier">data_old</span>, <span class="ruby-identifier">data_new</span>)
423:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">diffs</span>.<span class="ruby-identifier">empty?</span>
424: 
425:           <span class="ruby-identifier">a_path</span> = <span class="ruby-node">&quot;a/#{path.gsub('./', '')}&quot;</span>
426:           <span class="ruby-identifier">b_path</span> = <span class="ruby-node">&quot;b/#{path.gsub('./', '')}&quot;</span>
427: 
428:           <span class="ruby-identifier">header</span> = <span class="ruby-node">&quot;diff --git #{a_path} #{b_path}&quot;</span>
429:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:full_index</span>]
430:             <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'index '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sha1</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'..'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sha2</span>
431:             <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">' 100644'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">treeSHA2</span> <span class="ruby-comment cmt"># hard coding this because i don't think we use it</span>
432:           <span class="ruby-keyword kw">else</span>
433:             <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'index '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sha1</span>[<span class="ruby-value">0</span>,<span class="ruby-value">7</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">'..'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sha2</span>[<span class="ruby-value">0</span>,<span class="ruby-value">7</span>]
434:             <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">' 100644'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">treeSHA2</span> <span class="ruby-comment cmt"># hard coding this because i don't think we use it</span>
435:           <span class="ruby-keyword kw">end</span>
436:           <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n--- &quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">treeSHA1</span> <span class="ruby-value">? </span><span class="ruby-identifier">a_path</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'/dev/null'</span>)
437:           <span class="ruby-identifier">header</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n+++ &quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">treeSHA2</span> <span class="ruby-value">? </span><span class="ruby-identifier">b_path</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'/dev/null'</span>)
438:           <span class="ruby-identifier">header</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span>
439: 
440:           <span class="ruby-identifier">oldhunk</span> = <span class="ruby-identifier">hunk</span> = <span class="ruby-keyword kw">nil</span>
441: 
442:           <span class="ruby-identifier">diffs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">piece</span><span class="ruby-operator">|</span>
443:             <span class="ruby-keyword kw">begin</span>
444:               <span class="ruby-identifier">hunk</span> = <span class="ruby-constant">Difference</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span><span class="ruby-operator">::</span><span class="ruby-constant">Hunk</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">data_old</span>, <span class="ruby-identifier">data_new</span>, <span class="ruby-identifier">piece</span>, <span class="ruby-identifier">lines</span>, <span class="ruby-identifier">file_length_difference</span>)
445:               <span class="ruby-identifier">file_length_difference</span> = <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">file_length_difference</span>
446: 
447:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">oldhunk</span>
448: 
449:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lines</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">overlaps?</span>(<span class="ruby-identifier">oldhunk</span>)
450:                 <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">oldhunk</span>)
451:               <span class="ruby-keyword kw">else</span>
452:                 <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">oldhunk</span>.<span class="ruby-identifier">diff</span>(<span class="ruby-identifier">format</span>)
453:               <span class="ruby-keyword kw">end</span>
454:             <span class="ruby-keyword kw">ensure</span>
455:               <span class="ruby-identifier">oldhunk</span> = <span class="ruby-identifier">hunk</span>
456:               <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
457:             <span class="ruby-keyword kw">end</span>
458:           <span class="ruby-keyword kw">end</span>
459: 
460:           <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">oldhunk</span>.<span class="ruby-identifier">diff</span>(<span class="ruby-identifier">format</span>)
461:           <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
462: 
463:           <span class="ruby-identifier">patch</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">header</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">output</span>.<span class="ruby-identifier">lstrip</span>
464:         <span class="ruby-keyword kw">end</span>
465:         <span class="ruby-identifier">patch</span>
466:       <span class="ruby-keyword kw">rescue</span>
467:         <span class="ruby-value str">''</span> <span class="ruby-comment cmt"># one of the trees was bad or lcs isn't there - no diff</span>
468:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000220">
                    
                    <a name="M000220"></a><b>files_changed?</b>(tree_sha1, tree_sha2, path_limiter = nil)
                    
                </div>
                
                <div class="description">
                  <p>
returns true if the files in path_limiter were changed, or no path limiter
used by the log() function when passed with a path_limiter
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000220_source')" id="l_M000220_source">show</a>
                        
                    </p>
                    <div id="M000220_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 535</span>
535:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">files_changed?</span>(<span class="ruby-identifier">tree_sha1</span>, <span class="ruby-identifier">tree_sha2</span>, <span class="ruby-identifier">path_limiter</span> = <span class="ruby-keyword kw">nil</span>)
536:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path_limiter</span>
537:           <span class="ruby-identifier">mod</span> = <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">tree_sha1</span>, <span class="ruby-identifier">tree_sha2</span>)
538:           <span class="ruby-identifier">files</span> = <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">first</span> }
539:           <span class="ruby-identifier">path_limiter</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filepath</span><span class="ruby-operator">|</span>
540:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">filepath</span>)
541:               <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
542:             <span class="ruby-keyword kw">end</span>
543:           <span class="ruby-keyword kw">end</span>
544:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
545:         <span class="ruby-keyword kw">end</span>
546:         <span class="ruby-keyword kw">true</span>
547:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000175">
                    
                    <a name="M000175"></a><b>get_object_by_sha1</b>(sha1)
                    
                </div>
                
                <div class="description">
                  <p>
returns <a href="../GitRuby.html">GitRuby</a> object of any type given a
SHA1
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000175_source')" id="l_M000175_source">show</a>
                        
                    </p>
                    <div id="M000175_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 104</span>
104:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha1</span>)
105:         <span class="ruby-identifier">r</span> = <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha1</span>)
106:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>
107:         <span class="ruby-constant">GitObject</span>.<span class="ruby-identifier">from_raw</span>(<span class="ruby-identifier">r</span>)
108:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000173">
                    
                    <a name="M000173"></a><b>get_raw_object_by_sha1</b>(sha1o)
                    
                </div>
                
                <div class="description">
                  <p>
returns a raw object given a SHA1
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000173_source')" id="l_M000173_source">show</a>
                        
                    </p>
                    <div id="M000173_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 72</span>
72:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha1o</span>)
73:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchShaFound</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sha1o</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">sha1o</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sha1o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
74: 
75:         <span class="ruby-identifier">sha1</span> = [<span class="ruby-identifier">sha1o</span>.<span class="ruby-identifier">chomp</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;H*&quot;</span>)
76:         <span class="ruby-comment cmt"># try packs</span>
77:         <span class="ruby-identifier">packs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pack</span><span class="ruby-operator">|</span>
78:           <span class="ruby-identifier">o</span> = <span class="ruby-identifier">pack</span>[<span class="ruby-identifier">sha1</span>]
79:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pack</span>[<span class="ruby-identifier">sha1</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>
80:         <span class="ruby-keyword kw">end</span>
81: 
82:         <span class="ruby-comment cmt"># try loose storage</span>
83:         <span class="ruby-identifier">loose</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lsobj</span><span class="ruby-operator">|</span>
84:           <span class="ruby-identifier">o</span> = <span class="ruby-identifier">lsobj</span>[<span class="ruby-identifier">sha1</span>]
85:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">o</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>
86:         <span class="ruby-keyword kw">end</span>
87: 
88:         <span class="ruby-comment cmt"># try packs again, maybe the object got packed in the meantime</span>
89:         <span class="ruby-identifier">initpacks</span>
90:         <span class="ruby-identifier">packs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pack</span><span class="ruby-operator">|</span>
91:           <span class="ruby-identifier">o</span> = <span class="ruby-identifier">pack</span>[<span class="ruby-identifier">sha1</span>]
92:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">o</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>
93:         <span class="ruby-keyword kw">end</span>
94: 
95: <span class="ruby-comment cmt">#        puts &quot;*#{sha1o}*&quot;</span>
96:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchShaFound</span>
97:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000191">
                    
                    <a name="M000191"></a><b>get_raw_tree</b>(sha, recursive = false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000191_source')" id="l_M000191_source">show</a>
                        
                    </p>
                    <div id="M000191_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 186</span>
186:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_raw_tree</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">recursive</span> = <span class="ruby-keyword kw">false</span>)
187:         <span class="ruby-identifier">o</span> = <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha</span>)
188:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:commit</span>
189:           <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">tree</span>
190:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:tag</span>
191:           <span class="ruby-identifier">commit_sha</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">object</span>
192:           <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit_sha</span>).<span class="ruby-identifier">tree</span>
193:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:tree</span>
194:           <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">sha</span>
195:         <span class="ruby-keyword kw">else</span>
196:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
197:         <span class="ruby-keyword kw">end</span>
198: 
199:         <span class="ruby-identifier">recursive</span> <span class="ruby-value">? </span><span class="ruby-identifier">get_raw_trees</span>(<span class="ruby-identifier">tree</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">cat_file</span>(<span class="ruby-identifier">tree</span>)
200:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000192">
                    
                    <a name="M000192"></a><b>get_raw_trees</b>(sha, path = '')
                    
                </div>
                
                <div class="description">
                  <p>
Grabs tree contents recursively,
</p>
<pre>
  e.g. `git ls-tree -r sha`
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000192_source')" id="l_M000192_source">show</a>
                        
                    </p>
                    <div id="M000192_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 204</span>
204:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_raw_trees</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">path</span> = <span class="ruby-value str">''</span>)
205:         <span class="ruby-identifier">out</span> = <span class="ruby-value str">''</span>
206:         <span class="ruby-identifier">cat_file</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
207:           <span class="ruby-identifier">mode</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">sha</span>, <span class="ruby-identifier">name</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\s/</span>)
208: 
209:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'tree'</span>
210:             <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;#{path}/#{name}&quot;</span>
211:             <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">get_raw_trees</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">full_name</span>)
212:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span>
213:             <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
214:           <span class="ruby-keyword kw">else</span>
215:             <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">name</span>, <span class="ruby-node">&quot;#{path}/#{name}&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
216:           <span class="ruby-keyword kw">end</span>
217:         <span class="ruby-keyword kw">end</span>
218: 
219:         <span class="ruby-identifier">out</span>
220:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000225">
                    
                    <a name="M000225"></a><b>get_subtree</b>(commit_sha, path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000225_source')" id="l_M000225_source">show</a>
                        
                    </p>
                    <div id="M000225_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 549</span>
549:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_subtree</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>)
550:         <span class="ruby-identifier">tree_sha</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit_sha</span>).<span class="ruby-identifier">tree</span>
551: 
552:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'.'</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'./'</span>)
553:           <span class="ruby-identifier">paths</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>)
554:           <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
555:             <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">tree_sha</span>)
556:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">path</span> }.<span class="ruby-identifier">first</span>
557:               <span class="ruby-identifier">tree_sha</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">sha1</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
558:             <span class="ruby-keyword kw">else</span>
559:               <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
560:             <span class="ruby-keyword kw">end</span>
561:           <span class="ruby-keyword kw">end</span>
562:         <span class="ruby-keyword kw">end</span>
563: 
564:         <span class="ruby-identifier">tree_sha</span>
565:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000180">
                    
                    <a name="M000180"></a><b>in_loose?</b>(sha_hex)
                    
                </div>
                
                <div class="description">
                  <p>
returns true if the hex-packed sha is in the loose objects
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000180_source')" id="l_M000180_source">show</a>
                        
                    </p>
                    <div id="M000180_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 135</span>
135:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_loose?</span>(<span class="ruby-identifier">sha_hex</span>)
136:         <span class="ruby-identifier">loose</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lsobj</span><span class="ruby-operator">|</span>
137:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lsobj</span>[<span class="ruby-identifier">sha_hex</span>]
138:         <span class="ruby-keyword kw">end</span>
139:         <span class="ruby-keyword kw">false</span>
140:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000179">
                    
                    <a name="M000179"></a><b>in_packs?</b>(sha_hex)
                    
                </div>
                
                <div class="description">
                  <p>
returns true if the hex-packed sha is in the packfiles
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000179_source')" id="l_M000179_source">show</a>
                        
                    </p>
                    <div id="M000179_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 126</span>
126:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_packs?</span>(<span class="ruby-identifier">sha_hex</span>)
127:         <span class="ruby-comment cmt"># try packs</span>
128:         <span class="ruby-identifier">packs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pack</span><span class="ruby-operator">|</span>
129:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pack</span>[<span class="ruby-identifier">sha_hex</span>]
130:         <span class="ruby-keyword kw">end</span>
131:         <span class="ruby-keyword kw">false</span>
132:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000185">
                    
                    <a name="M000185"></a><b>list_tree</b>(sha)
                    
                </div>
                
                <div class="description">
                  <p>
returns a 2-d hash of the tree
</p>
<dl>
<dt>&#8216;blob&#8217;][&#8216;FILENAME&#8217;</dt><dd>= {:mode => &#8216;100644&#8217;, :sha => SHA}

</dd>
<dt>&#8216;tree&#8217;][&#8216;DIRNAME&#8217;</dt><dd>= {:mode => &#8216;040000&#8217;, :sha => SHA}

</dd>
</dl>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000185_source')" id="l_M000185_source">show</a>
                        
                    </p>
                    <div id="M000185_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 161</span>
161:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_tree</span>(<span class="ruby-identifier">sha</span>)
162:         <span class="ruby-identifier">data</span> = {<span class="ruby-value str">'blob'</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-value str">'tree'</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-value str">'link'</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-value str">'commit'</span> =<span class="ruby-operator">&gt;</span> {}}
163:         <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
164:           <span class="ruby-identifier">data</span>[<span class="ruby-identifier">e</span>.<span class="ruby-identifier">format_type</span>][<span class="ruby-identifier">e</span>.<span class="ruby-identifier">name</span>] = {<span class="ruby-identifier">:mode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">format_mode</span>, <span class="ruby-identifier">:sha</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">sha1</span>}
165:         <span class="ruby-keyword kw">end</span>
166:         <span class="ruby-identifier">data</span>
167:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000197">
                    
                    <a name="M000197"></a><b>log</b>(sha, options = {})
                    
                </div>
                
                <div class="description">
                  <p>
returns an array of <a href="../GitRuby.html">GitRuby</a> <a
href="Commit.html">Commit</a> objects
</p>
<dl>
<dt> [sha, raw_output], [sha, raw_output], [sha, raw_output</dt><dd>&#8230; ]

</dd>
</dl>
<p>
takes the following options:
</p>
<pre>
 :since - Time object specifying that you don't want commits BEFORE this
 :until - Time object specifying that you don't want commit AFTER this
 :first_parent - tells log to only walk first parent
 :path_limiter - string or array of strings to limit path
 :max_count - number to limit the output
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000197_source')" id="l_M000197_source">show</a>
                        
                    </p>
                    <div id="M000197_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 285</span>
285:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">options</span> = {})
286:         <span class="ruby-ivar">@already_searched</span> = {}
287:         <span class="ruby-identifier">walk_log</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">options</span>)
288:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000231">
                    
                    <a name="M000231"></a><b>look_for_commits</b>(commit_sha, path, looking_for, options = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000231_source')" id="l_M000231_source">show</a>
                        
                    </p>
                    <div id="M000231_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 589</span>
589:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">look_for_commits</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">looking_for</span>, <span class="ruby-identifier">options</span> = {})
590:         <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@already_searched</span>[<span class="ruby-identifier">commit_sha</span>] <span class="ruby-comment cmt"># to prevent rechecking branches</span>
591: 
592:         <span class="ruby-ivar">@already_searched</span>[<span class="ruby-identifier">commit_sha</span>] = <span class="ruby-keyword kw">true</span>
593: 
594:         <span class="ruby-identifier">commit</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit_sha</span>)
595:         <span class="ruby-identifier">tree_sha</span> = <span class="ruby-identifier">get_subtree</span>(<span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">path</span>)
596: 
597:         <span class="ruby-identifier">found_data</span> = []
598: 
599:         <span class="ruby-comment cmt"># at the beginning of the branch</span>
600:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">commit</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
601:           <span class="ruby-identifier">looking_for</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">search</span><span class="ruby-operator">|</span>
602:             <span class="ruby-comment cmt"># prevents the rare case of multiple branch starting points with</span>
603:             <span class="ruby-comment cmt"># files that have never changed</span>
604:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found_data</span>.<span class="ruby-identifier">assoc</span>(<span class="ruby-identifier">search</span>)
605:               <span class="ruby-identifier">found_data</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">search</span>, <span class="ruby-identifier">commit_sha</span>]
606:             <span class="ruby-keyword kw">end</span>
607:           <span class="ruby-keyword kw">end</span>
608:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">found_data</span>
609:         <span class="ruby-keyword kw">end</span>
610: 
611:         <span class="ruby-comment cmt"># go through the parents recursively, looking for somewhere this has been changed</span>
612:         <span class="ruby-identifier">commit</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pc</span><span class="ruby-operator">|</span>
613:           <span class="ruby-identifier">diff</span> = <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">tree_sha</span>, <span class="ruby-identifier">get_subtree</span>(<span class="ruby-identifier">pc</span>, <span class="ruby-identifier">path</span>), <span class="ruby-value str">'.'</span>, <span class="ruby-keyword kw">false</span>)
614: 
615:           <span class="ruby-comment cmt"># remove anything found</span>
616:           <span class="ruby-identifier">looking_for</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">search</span><span class="ruby-operator">|</span>
617:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">match</span> = <span class="ruby-identifier">diff</span>.<span class="ruby-identifier">assoc</span>(<span class="ruby-identifier">search</span>)
618:               <span class="ruby-identifier">found_data</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">search</span>, <span class="ruby-identifier">commit_sha</span>, <span class="ruby-identifier">match</span>]
619:               <span class="ruby-identifier">looking_for</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">search</span>)
620:             <span class="ruby-keyword kw">end</span>
621:           <span class="ruby-keyword kw">end</span>
622: 
623:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">looking_for</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>  <span class="ruby-comment cmt"># we're done</span>
624:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">found_data</span>
625:           <span class="ruby-keyword kw">end</span>
626: 
627:           <span class="ruby-identifier">found_data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">look_for_commits</span>(<span class="ruby-identifier">pc</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">looking_for</span>)  <span class="ruby-comment cmt"># recurse into parent</span>
628:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">found_data</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:first_parent</span>]
629:         <span class="ruby-keyword kw">end</span>
630: 
631:         <span class="ruby-comment cmt">## TODO : find most recent commit with change in any parent</span>
632:         <span class="ruby-identifier">found_data</span>
633:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000170">
                    
                    <a name="M000170"></a><b>loose</b>()
                    
                </div>
                
                <div class="description">
                  <p>
returns the loose objects object lazily
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000170_source')" id="l_M000170_source">show</a>
                        
                    </p>
                    <div id="M000170_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 44</span>
44:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">loose</span>
45:         <span class="ruby-ivar">@loose</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">initloose</span>
46:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000189">
                    
                    <a name="M000189"></a><b>ls_tree</b>(sha, paths = [], recursive = false)
                    
                </div>
                
                <div class="description">
                  <p>
returns the raw (cat-file) output for a tree if given a commit sha, it will
print the tree of that commit if given a path limiter array, it will limit
the output to those if asked for recrusive trees, will traverse trees
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000189_source')" id="l_M000189_source">show</a>
                        
                    </p>
                    <div id="M000189_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 173</span>
173:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ls_tree</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">paths</span> = [], <span class="ruby-identifier">recursive</span> = <span class="ruby-keyword kw">false</span>)
174:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
175:           <span class="ruby-comment cmt"># pathing</span>
176:           <span class="ruby-identifier">part</span> = []
177:           <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
178:             <span class="ruby-identifier">part</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">ls_tree_path</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">path</span>)
179:           <span class="ruby-keyword kw">end</span>
180:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">part</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
181:         <span class="ruby-keyword kw">else</span>
182:           <span class="ruby-identifier">get_raw_tree</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">recursive</span>)
183:         <span class="ruby-keyword kw">end</span>
184:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000194">
                    
                    <a name="M000194"></a><b>ls_tree_path</b>(sha, path, append = nil)
                    
                </div>
                
                <div class="description">
                  <p>
return array of tree entries
</p>
<pre>
 TODO : refactor this to remove the fugly
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000194_source')" id="l_M000194_source">show</a>
                        
                    </p>
                    <div id="M000194_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 224</span>
224:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ls_tree_path</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">append</span> = <span class="ruby-keyword kw">nil</span>)
225:         <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">get_raw_tree</span>(<span class="ruby-identifier">sha</span>)
226:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\//</span>
227:           <span class="ruby-identifier">paths</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>)
228:           <span class="ruby-identifier">last</span> = <span class="ruby-identifier">path</span>[<span class="ruby-identifier">path</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-value">1</span>]
229:           <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'/'</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)
230:             <span class="ruby-identifier">append</span> = <span class="ruby-identifier">append</span> <span class="ruby-value">? </span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">append</span>, <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">first</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">first</span>
231:             <span class="ruby-identifier">dir_name</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\t&quot;</span>)[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">first</span> }.<span class="ruby-identifier">first</span>
232:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchPath</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">dir_name</span>
233:             <span class="ruby-identifier">next_sha</span> = <span class="ruby-identifier">dir_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>)[<span class="ruby-value">2</span>]
234:             <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">get_raw_tree</span>(<span class="ruby-identifier">next_sha</span>)
235:             <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
236:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">append</span>
237:               <span class="ruby-identifier">mod_tree</span> = []
238:               <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ent</span><span class="ruby-operator">|</span>
239:                 (<span class="ruby-identifier">info</span>, <span class="ruby-identifier">fpath</span>) = <span class="ruby-identifier">ent</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\t&quot;</span>)
240:                 <span class="ruby-identifier">mod_tree</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">info</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">append</span>, <span class="ruby-identifier">fpath</span>)].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\t&quot;</span>)
241:               <span class="ruby-keyword kw">end</span>
242:               <span class="ruby-identifier">mod_tree</span>
243:             <span class="ruby-keyword kw">else</span>
244:               <span class="ruby-identifier">tree</span>
245:             <span class="ruby-keyword kw">end</span>
246:           <span class="ruby-keyword kw">else</span>
247:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchPath</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">nil?</span>
248:             <span class="ruby-identifier">next_path</span> = <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">shift</span>
249:             <span class="ruby-identifier">dir_name</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\t&quot;</span>)[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">next_path</span> }.<span class="ruby-identifier">first</span>
250:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchPath</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">dir_name</span>
251:             <span class="ruby-identifier">next_sha</span> = <span class="ruby-identifier">dir_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>)[<span class="ruby-value">2</span>]
252:             <span class="ruby-identifier">next_path</span> = <span class="ruby-identifier">append</span> <span class="ruby-value">? </span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">append</span>, <span class="ruby-identifier">next_path</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">next_path</span>
253:             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'/'</span>)
254:               <span class="ruby-identifier">ls_tree_path</span>(<span class="ruby-identifier">next_sha</span>, <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">'/'</span>, <span class="ruby-identifier">next_path</span>)
255:             <span class="ruby-keyword kw">else</span>
256:               <span class="ruby-identifier">ls_tree_path</span>(<span class="ruby-identifier">next_sha</span>, <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;/&quot;</span>), <span class="ruby-identifier">next_path</span>)
257:             <span class="ruby-keyword kw">end</span>
258:           <span class="ruby-keyword kw">end</span>
259:         <span class="ruby-keyword kw">else</span>
260:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSuchPath</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">nil?</span>
261:           <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
262:           <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\t&quot;</span>)[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">path</span> }
263:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">append</span>
264:             <span class="ruby-identifier">mod_tree</span> = []
265:             <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ent</span><span class="ruby-operator">|</span>
266:               (<span class="ruby-identifier">info</span>, <span class="ruby-identifier">fpath</span>) = <span class="ruby-identifier">ent</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\t&quot;</span>)
267:               <span class="ruby-identifier">mod_tree</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">info</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">append</span>, <span class="ruby-identifier">fpath</span>)].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\t&quot;</span>)
268:             <span class="ruby-keyword kw">end</span>
269:             <span class="ruby-identifier">mod_tree</span>
270:           <span class="ruby-keyword kw">else</span>
271:             <span class="ruby-identifier">tree</span>
272:           <span class="ruby-keyword kw">end</span>
273:         <span class="ruby-keyword kw">end</span>
274:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000177">
                    
                    <a name="M000177"></a><b>object_exists?</b>(sha1)
                    
                </div>
                
                <div class="description">
                  <p>
returns true or false if that sha exists in the db
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000177_source')" id="l_M000177_source">show</a>
                        
                    </p>
                    <div id="M000177_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 116</span>
116:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">object_exists?</span>(<span class="ruby-identifier">sha1</span>)
117:         <span class="ruby-identifier">sha_hex</span> = [<span class="ruby-identifier">sha1</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;H*&quot;</span>)
118:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_packs?</span>(<span class="ruby-identifier">sha_hex</span>)
119:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_loose?</span>(<span class="ruby-identifier">sha_hex</span>)
120:         <span class="ruby-identifier">initpacks</span>
121:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_packs?</span>(<span class="ruby-identifier">sha_hex</span>) <span class="ruby-comment cmt">#maybe the object got packed in the meantime</span>
122:         <span class="ruby-keyword kw">false</span>
123:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000171">
                    
                    <a name="M000171"></a><b>packs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
returns the array of pack list objects
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000171_source')" id="l_M000171_source">show</a>
                        
                    </p>
                    <div id="M000171_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 49</span>
49:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">packs</span>
50:         <span class="ruby-ivar">@packs</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">initpacks</span>
51:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000176">
                    
                    <a name="M000176"></a><b>put_raw_object</b>(content, type)
                    
                </div>
                
                <div class="description">
                  <p>
writes a raw object into the git repo
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000176_source')" id="l_M000176_source">show</a>
                        
                    </p>
                    <div id="M000176_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 111</span>
111:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">put_raw_object</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">type</span>)
112:         <span class="ruby-identifier">loose</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">put_raw_object</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">type</span>)
113:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000210">
                    
                    <a name="M000210"></a><b>quick_diff</b>(tree1, tree2, path = '.', recurse = true)
                    
                </div>
                
                <div class="description">
                  <p>
takes 2 tree shas and recursively walks them to find out what files or
directories have been modified in them and returns an array of changes [
[full_path, &#8216;added&#8217;, tree1_hash, nil],
</p>
<pre>
  [full_path, 'removed', nil, tree2_hash],
  [full_path, 'modified', tree1_hash, tree2_hash]
 ]
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000210_source')" id="l_M000210_source">show</a>
                        
                    </p>
                    <div id="M000210_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 477</span>
477:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">tree1</span>, <span class="ruby-identifier">tree2</span>, <span class="ruby-identifier">path</span> = <span class="ruby-value str">'.'</span>, <span class="ruby-identifier">recurse</span> = <span class="ruby-keyword kw">true</span>)
478:          <span class="ruby-comment cmt"># handle empty trees</span>
479:          <span class="ruby-identifier">changed</span> = []
480:          <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">changed</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tree1</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">tree2</span>
481: 
482:          <span class="ruby-identifier">t1</span> = <span class="ruby-identifier">list_tree</span>(<span class="ruby-identifier">tree1</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tree1</span>
483:          <span class="ruby-identifier">t2</span> = <span class="ruby-identifier">list_tree</span>(<span class="ruby-identifier">tree2</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tree2</span>
484: 
485:          <span class="ruby-comment cmt"># finding files that are different</span>
486:          <span class="ruby-identifier">t1</span>[<span class="ruby-value str">'blob'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">hsh</span><span class="ruby-operator">|</span>
487:            <span class="ruby-identifier">t2_file</span> = <span class="ruby-identifier">t2</span>[<span class="ruby-value str">'blob'</span>][<span class="ruby-identifier">file</span>] <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
488:            <span class="ruby-identifier">full</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">file</span>)
489:            <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_file</span>
490:              <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">full</span>, <span class="ruby-value str">'added'</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-keyword kw">nil</span>]      <span class="ruby-comment cmt"># not in parent</span>
491:            <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">t2_file</span>[<span class="ruby-identifier">:sha</span>])
492:              <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">full</span>, <span class="ruby-value str">'modified'</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-identifier">t2_file</span>[<span class="ruby-identifier">:sha</span>]]   <span class="ruby-comment cmt"># file changed</span>
493:            <span class="ruby-keyword kw">end</span>
494:          <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t1</span>
495:          <span class="ruby-identifier">t2</span>[<span class="ruby-value str">'blob'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">hsh</span><span class="ruby-operator">|</span>
496:            <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t1</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t1</span>[<span class="ruby-value str">'blob'</span>][<span class="ruby-identifier">file</span>]
497:              <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">file</span>), <span class="ruby-value str">'removed'</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>]]
498:            <span class="ruby-keyword kw">end</span>
499:          <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t2</span>
500: 
501:          <span class="ruby-identifier">t1</span>[<span class="ruby-value str">'tree'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span>, <span class="ruby-identifier">hsh</span><span class="ruby-operator">|</span>
502:            <span class="ruby-identifier">t2_tree</span> = <span class="ruby-identifier">t2</span>[<span class="ruby-value str">'tree'</span>][<span class="ruby-identifier">dir</span>] <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
503:            <span class="ruby-identifier">full</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">dir</span>)
504:            <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_tree</span>
505:              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recurse</span>
506:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">full</span>, <span class="ruby-keyword kw">true</span>)
507:              <span class="ruby-keyword kw">else</span>
508:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">full</span>, <span class="ruby-value str">'added'</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-keyword kw">nil</span>]      <span class="ruby-comment cmt"># not in parent</span>
509:              <span class="ruby-keyword kw">end</span>
510:            <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">t2_tree</span>[<span class="ruby-identifier">:sha</span>])
511:              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recurse</span>
512:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">quick_diff</span>(<span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-identifier">t2_tree</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-identifier">full</span>, <span class="ruby-keyword kw">true</span>)
513:              <span class="ruby-keyword kw">else</span>
514:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">full</span>, <span class="ruby-value str">'modified'</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-identifier">t2_tree</span>[<span class="ruby-identifier">:sha</span>]]   <span class="ruby-comment cmt"># file changed</span>
515:              <span class="ruby-keyword kw">end</span>
516:            <span class="ruby-keyword kw">end</span>
517:          <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t1</span>
518:          <span class="ruby-identifier">t2</span>[<span class="ruby-value str">'tree'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span>, <span class="ruby-identifier">hsh</span><span class="ruby-operator">|</span>
519:            <span class="ruby-identifier">t1_tree</span> = <span class="ruby-identifier">t1</span>[<span class="ruby-value str">'tree'</span>][<span class="ruby-identifier">dir</span>] <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
520:            <span class="ruby-identifier">full</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">dir</span>)
521:            <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t1_tree</span>
522:              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recurse</span>
523:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">quick_diff</span>(<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>], <span class="ruby-identifier">full</span>, <span class="ruby-keyword kw">true</span>)
524:              <span class="ruby-keyword kw">else</span>
525:                <span class="ruby-identifier">changed</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">full</span>, <span class="ruby-value str">'removed'</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">hsh</span>[<span class="ruby-identifier">:sha</span>]]
526:              <span class="ruby-keyword kw">end</span>
527:            <span class="ruby-keyword kw">end</span>
528:          <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t2</span>
529: 
530:          <span class="ruby-identifier">changed</span>
531:        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000199">
                    
                    <a name="M000199"></a><b>rev_list</b>(sha, options)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000199_source')" id="l_M000199_source">show</a>
                        
                    </p>
                    <div id="M000199_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 301</span>
301:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rev_list</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">options</span>)
302:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sha</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Array</span>
303:           (<span class="ruby-identifier">end_sha</span>, <span class="ruby-identifier">sha</span>) = <span class="ruby-identifier">sha</span>
304:         <span class="ruby-keyword kw">end</span>
305: 
306:         <span class="ruby-identifier">log</span> = <span class="ruby-identifier">log</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">options</span>)
307:         <span class="ruby-identifier">log</span> = <span class="ruby-identifier">log</span>.<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b</span>[<span class="ruby-value">2</span>] }.<span class="ruby-identifier">reverse</span>
308: 
309:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">end_sha</span>
310:           <span class="ruby-identifier">log</span> = <span class="ruby-identifier">truncate_arr</span>(<span class="ruby-identifier">log</span>, <span class="ruby-identifier">end_sha</span>)
311:         <span class="ruby-keyword kw">end</span>
312: 
313:         <span class="ruby-comment cmt"># shorten the list if it's longer than max_count (had to get everything in branches)</span>
314:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:max_count</span>]
315:           <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">opt_len</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:max_count</span>].<span class="ruby-identifier">to_i</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">log</span>.<span class="ruby-identifier">size</span>
316:             <span class="ruby-identifier">log</span> = <span class="ruby-identifier">log</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">opt_len</span>]
317:           <span class="ruby-keyword kw">end</span>
318:         <span class="ruby-keyword kw">end</span>
319: 
320:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:pretty</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'raw'</span>
321:           <span class="ruby-identifier">log</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
322:         <span class="ruby-keyword kw">else</span>
323:           <span class="ruby-identifier">log</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
324:         <span class="ruby-keyword kw">end</span>
325:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000172">
                    
                    <a name="M000172"></a><b>show</b>()
                    
                </div>
                
                <div class="description">
                  <p>
prints out the type, shas and content of all of the pack files
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000172_source')" id="l_M000172_source">show</a>
                        
                    </p>
                    <div id="M000172_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 55</span>
55:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
56:         <span class="ruby-identifier">packs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
57:           <span class="ruby-identifier">puts</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">name</span>
58:           <span class="ruby-identifier">puts</span>
59:           <span class="ruby-identifier">p</span>.<span class="ruby-identifier">each_sha1</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
60:             <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;**#{p[s].type}**&quot;</span>
61:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">p</span>[<span class="ruby-identifier">s</span>].<span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'commit'</span>
62:               <span class="ruby-identifier">puts</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'H*'</span>)
63:               <span class="ruby-identifier">puts</span> <span class="ruby-identifier">p</span>[<span class="ruby-identifier">s</span>].<span class="ruby-identifier">content</span>
64:             <span class="ruby-keyword kw">end</span>
65:           <span class="ruby-keyword kw">end</span>
66:           <span class="ruby-identifier">puts</span>
67:         <span class="ruby-keyword kw">end</span>
68:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000198">
                    
                    <a name="M000198"></a><b>truncate_arr</b>(arr, sha)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000198_source')" id="l_M000198_source">show</a>
                        
                    </p>
                    <div id="M000198_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 290</span>
290:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">truncate_arr</span>(<span class="ruby-identifier">arr</span>, <span class="ruby-identifier">sha</span>)
291:         <span class="ruby-identifier">new_arr</span> = []
292:         <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
293:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">sha</span>
294:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new_arr</span>
295:           <span class="ruby-keyword kw">end</span>
296:           <span class="ruby-identifier">new_arr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>
297:         <span class="ruby-keyword kw">end</span>
298:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new_arr</span>
299:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000202">
                    
                    <a name="M000202"></a><b>walk_log</b>(sha, opts, total_size = 0)
                    
                </div>
                
                <div class="description">
                  <p>
called by log() to recursively walk the tree
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000202_source')" id="l_M000202_source">show</a>
                        
                    </p>
                    <div id="M000202_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 328</span>
328:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">walk_log</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">total_size</span> = <span class="ruby-value">0</span>)
329:         <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@already_searched</span>[<span class="ruby-identifier">sha</span>] <span class="ruby-comment cmt"># to prevent rechecking branches</span>
330:         <span class="ruby-ivar">@already_searched</span>[<span class="ruby-identifier">sha</span>] = <span class="ruby-keyword kw">true</span>
331: 
332:         <span class="ruby-identifier">array</span> = []
333:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">sha</span>)
334:           <span class="ruby-identifier">o</span> = <span class="ruby-identifier">get_raw_object_by_sha1</span>(<span class="ruby-identifier">sha</span>)
335:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:tag</span>
336:             <span class="ruby-identifier">commit_sha</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">sha</span>).<span class="ruby-identifier">object</span>
337:             <span class="ruby-identifier">c</span> = <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">commit_sha</span>)
338:           <span class="ruby-keyword kw">else</span>
339:             <span class="ruby-identifier">c</span> = <span class="ruby-constant">GitObject</span>.<span class="ruby-identifier">from_raw</span>(<span class="ruby-identifier">o</span>)
340:           <span class="ruby-keyword kw">end</span>
341: 
342:           <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">:commit</span>
343: 
344:           <span class="ruby-identifier">add_sha</span> = <span class="ruby-keyword kw">true</span>
345: 
346:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:since</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:since</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Time</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:since</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">committer</span>.<span class="ruby-identifier">date</span>)
347:             <span class="ruby-identifier">add_sha</span> = <span class="ruby-keyword kw">false</span>
348:           <span class="ruby-keyword kw">end</span>
349:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:until</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:until</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Time</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:until</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">committer</span>.<span class="ruby-identifier">date</span>)
350:             <span class="ruby-identifier">add_sha</span> = <span class="ruby-keyword kw">false</span>
351:           <span class="ruby-keyword kw">end</span>
352: 
353:           <span class="ruby-comment cmt"># follow all parents unless '--first-parent' is specified #</span>
354:           <span class="ruby-identifier">subarray</span> = []
355: 
356:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">c</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:path_limiter</span>]  <span class="ruby-comment cmt"># check for the last commit</span>
357:             <span class="ruby-identifier">add_sha</span> = <span class="ruby-keyword kw">false</span>
358:           <span class="ruby-keyword kw">end</span>
359: 
360:           <span class="ruby-keyword kw">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max_count</span>] <span class="ruby-operator">||</span> ((<span class="ruby-identifier">array</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">total_size</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max_count</span>]))
361: 
362:             <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:path_limiter</span>]
363:               <span class="ruby-identifier">output</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">raw_log</span>(<span class="ruby-identifier">sha</span>)
364:               <span class="ruby-identifier">array</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">output</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">committer</span>.<span class="ruby-identifier">date</span>]
365:             <span class="ruby-keyword kw">end</span>
366: 
367:             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max_count</span>] <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">array</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">total_size</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max_count</span>])
368:               <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">array</span>
369:             <span class="ruby-keyword kw">end</span>
370: 
371:             <span class="ruby-identifier">c</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">psha</span><span class="ruby-operator">|</span>
372:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">psha</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">files_changed?</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">tree</span>, <span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">psha</span>).<span class="ruby-identifier">tree</span>,
373:                                         <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:path_limiter</span>])
374:                 <span class="ruby-identifier">add_sha</span> = <span class="ruby-keyword kw">false</span>
375:               <span class="ruby-keyword kw">end</span>
376:               <span class="ruby-identifier">subarray</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">walk_log</span>(<span class="ruby-identifier">psha</span>, <span class="ruby-identifier">opts</span>, (<span class="ruby-identifier">array</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">total_size</span>))
377:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:first_parent</span>]
378:             <span class="ruby-keyword kw">end</span>
379: 
380:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:path_limiter</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">add_sha</span>
381:               <span class="ruby-identifier">output</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">raw_log</span>(<span class="ruby-identifier">sha</span>)
382:               <span class="ruby-identifier">array</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">output</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">committer</span>.<span class="ruby-identifier">date</span>]
383:             <span class="ruby-keyword kw">end</span>
384: 
385:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">add_sha</span>
386:               <span class="ruby-identifier">array</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">subarray</span>
387:             <span class="ruby-keyword kw">end</span>
388:           <span class="ruby-keyword kw">end</span>
389: 
390:         <span class="ruby-keyword kw">end</span>
391: 
392:         <span class="ruby-identifier">array</span>
393:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000243">
                    
                    <a name="M000243"></a><b>git_path</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000243_source')" id="l_M000243_source">show</a>
                        
                    </p>
                    <div id="M000243_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 690</span>
690:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">git_path</span>(<span class="ruby-identifier">path</span>)
691:           <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#@git_dir/#{path}&quot;</span>
692:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000245">
                    
                    <a name="M000245"></a><b>each_alternate_path</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000245_source')" id="l_M000245_source">show</a>
                        
                    </p>
                    <div id="M000245_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 704</span>
704:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_alternate_path</span>(<span class="ruby-identifier">path</span>)
705:           <span class="ruby-identifier">alt</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">'info/alternates'</span>)
706:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">alt</span>)
707: 
708:           <span class="ruby-constant">File</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">alt</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
709:             <span class="ruby-identifier">path</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">chomp</span>
710:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>[<span class="ruby-value">0</span>, <span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'..'</span>
711:               <span class="ruby-keyword kw">yield</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@git_dir</span>, <span class="ruby-value str">'objects'</span>, <span class="ruby-identifier">path</span>))
712: 
713:               <span class="ruby-comment cmt"># XXX this is here for backward compatibility with grit &lt; 2.3.0</span>
714:               <span class="ruby-comment cmt"># relative alternate objects paths are expanded relative to the</span>
715:               <span class="ruby-comment cmt"># objects directory, not the git repository directory.</span>
716:               <span class="ruby-keyword kw">yield</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@git_dir</span>, <span class="ruby-identifier">path</span>))
717:             <span class="ruby-keyword kw">else</span>
718:               <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">path</span>
719:             <span class="ruby-keyword kw">end</span>
720:           <span class="ruby-keyword kw">end</span>
721:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000244">
                    
                    <a name="M000244"></a><b>initloose</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000244_source')" id="l_M000244_source">show</a>
                        
                    </p>
                    <div id="M000244_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 696</span>
696:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initloose</span>
697:           <span class="ruby-ivar">@loaded</span> = []
698:           <span class="ruby-ivar">@loose</span> = []
699:           <span class="ruby-identifier">load_loose</span>(<span class="ruby-identifier">git_path</span>(<span class="ruby-value str">'objects'</span>))
700:           <span class="ruby-identifier">load_alternate_loose</span>(<span class="ruby-identifier">git_path</span>(<span class="ruby-value str">'objects'</span>))
701:           <span class="ruby-ivar">@loose</span>
702:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000249">
                    
                    <a name="M000249"></a><b>initpacks</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000249_source')" id="l_M000249_source">show</a>
                        
                    </p>
                    <div id="M000249_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 739</span>
739:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initpacks</span>
740:           <span class="ruby-identifier">close</span>
741:           <span class="ruby-ivar">@loaded_packs</span> = []
742:           <span class="ruby-ivar">@packs</span> = []
743:           <span class="ruby-identifier">load_packs</span>(<span class="ruby-identifier">git_path</span>(<span class="ruby-value str">&quot;objects/pack&quot;</span>))
744:           <span class="ruby-identifier">load_alternate_packs</span>(<span class="ruby-identifier">git_path</span>(<span class="ruby-value str">'objects'</span>))
745:           <span class="ruby-ivar">@packs</span>
746:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000247">
                    
                    <a name="M000247"></a><b>load_alternate_loose</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000247_source')" id="l_M000247_source">show</a>
                        
                    </p>
                    <div id="M000247_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 723</span>
723:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_alternate_loose</span>(<span class="ruby-identifier">path</span>)
724:           <span class="ruby-comment cmt"># load alternate loose, too</span>
725:           <span class="ruby-identifier">each_alternate_path</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
726:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@loaded</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">path</span>)
727:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">path</span>)
728:             <span class="ruby-identifier">load_loose</span>(<span class="ruby-identifier">path</span>)
729:             <span class="ruby-identifier">load_alternate_loose</span>(<span class="ruby-identifier">path</span>)
730:           <span class="ruby-keyword kw">end</span>
731:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000250">
                    
                    <a name="M000250"></a><b>load_alternate_packs</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000250_source')" id="l_M000250_source">show</a>
                        
                    </p>
                    <div id="M000250_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 748</span>
748:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_alternate_packs</span>(<span class="ruby-identifier">path</span>)
749:           <span class="ruby-identifier">each_alternate_path</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
750:             <span class="ruby-identifier">full_pack</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">'pack'</span>)
751:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@loaded_packs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">full_pack</span>)
752:             <span class="ruby-identifier">load_packs</span>(<span class="ruby-identifier">full_pack</span>)
753:             <span class="ruby-identifier">load_alternate_packs</span>(<span class="ruby-identifier">path</span>)
754:           <span class="ruby-keyword kw">end</span>
755:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000248">
                    
                    <a name="M000248"></a><b>load_loose</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000248_source')" id="l_M000248_source">show</a>
                        
                    </p>
                    <div id="M000248_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 733</span>
733:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_loose</span>(<span class="ruby-identifier">path</span>)
734:           <span class="ruby-ivar">@loaded</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
735:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>)
736:           <span class="ruby-ivar">@loose</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">GitRuby</span><span class="ruby-operator">::</span><span class="ruby-constant">Internal</span><span class="ruby-operator">::</span><span class="ruby-constant">LooseStorage</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)
737:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000251">
                    
                    <a name="M000251"></a><b>load_packs</b>(path)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000251_source')" id="l_M000251_source">show</a>
                        
                    </p>
                    <div id="M000251_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 757</span>
757:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_packs</span>(<span class="ruby-identifier">path</span>)
758:           <span class="ruby-ivar">@loaded_packs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
759:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>)
760:            <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
761:             <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
762:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">entry</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.pack$/i</span>)
763:               <span class="ruby-identifier">pack</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">GitRuby</span><span class="ruby-operator">::</span><span class="ruby-constant">Internal</span><span class="ruby-operator">::</span><span class="ruby-constant">PackStorage</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">entry</span>))
764:               <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:map_packfile</span>]
765:                 <span class="ruby-identifier">pack</span>.<span class="ruby-identifier">cache_objects</span>
766:               <span class="ruby-keyword kw">end</span>
767:               <span class="ruby-ivar">@packs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pack</span>
768:             <span class="ruby-keyword kw">end</span>
769:           <span class="ruby-keyword kw">end</span>
770:         <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000241">
                    
                    <a name="M000241"></a><b>add_file</b>(name, contents)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000241_source')" id="l_M000241_source">show</a>
                        
                    </p>
                    <div id="M000241_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 676</span>
676:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_file</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">contents</span>)
677:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">name</span>, <span class="ruby-value str">'w'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
678:           <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">contents</span>
679:         <span class="ruby-keyword kw">end</span>
680:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000240">
                    
                    <a name="M000240"></a><b>create_initial_config</b>(bare = false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000240_source')" id="l_M000240_source">show</a>
                        
                    </p>
                    <div id="M000240_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 670</span>
670:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create_initial_config</span>(<span class="ruby-identifier">bare</span> = <span class="ruby-keyword kw">false</span>)
671:         <span class="ruby-identifier">bare</span> <span class="ruby-value">? </span><span class="ruby-identifier">bare_status</span> = <span class="ruby-value str">'true'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">bare_status</span> = <span class="ruby-value str">'false'</span>
672:         <span class="ruby-identifier">config</span> = <span class="ruby-node">&quot;[core]\n\trepositoryformatversion = 0\n\tfilemode = true\n\tbare = #{bare_status}\n\tlogallrefupdates = true&quot;</span>
673:         <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'config'</span>, <span class="ruby-identifier">config</span>)
674:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000237">
                    
                    <a name="M000237"></a><b>init</b>(dir, bare = true)
                    
                </div>
                
                <div class="description">
                  <p>
initialize a git repository
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000237_source')" id="l_M000237_source">show</a>
                        
                    </p>
                    <div id="M000237_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 636</span>
636:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">init</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">bare</span> = <span class="ruby-keyword kw">true</span>)
637: 
638:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">dir</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">dir</span>)
639: 
640:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cd</span>(<span class="ruby-identifier">dir</span>) <span class="ruby-keyword kw">do</span>
641:           <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-value str">'objects'</span>))
642:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-comment cmt"># already initialized</span>
643:           <span class="ruby-keyword kw">else</span>
644:             <span class="ruby-comment cmt"># initialize directory</span>
645:             <span class="ruby-identifier">create_initial_config</span>(<span class="ruby-identifier">bare</span>)
646:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'refs/heads'</span>)
647:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'refs/tags'</span>)
648:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'objects/info'</span>)
649:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'objects/pack'</span>)
650:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'branches'</span>)
651:             <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'description'</span>, <span class="ruby-value str">'Unnamed repository; edit this file to name it for gitweb.'</span>)
652:             <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'HEAD'</span>, <span class="ruby-value str">&quot;ref: refs/heads/master\n&quot;</span>)
653:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'hooks'</span>)
654:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cd</span>(<span class="ruby-value str">'hooks'</span>) <span class="ruby-keyword kw">do</span>
655:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'applypatch-msg'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
656:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'post-commit'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
657:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'post-receive'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
658:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'post-update'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
659:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'pre-applypatch'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
660:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'pre-commit'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
661:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'pre-rebase'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
662:               <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'update'</span>, <span class="ruby-value str">'# add shell script and make executable to enable'</span>)
663:             <span class="ruby-keyword kw">end</span>
664:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-value str">'info'</span>)
665:             <span class="ruby-identifier">add_file</span>(<span class="ruby-value str">'info/exclude'</span>, <span class="ruby-value str">&quot;# *.[oa]\n# *~&quot;</span>)
666:           <span class="ruby-keyword kw">end</span>
667:         <span class="ruby-keyword kw">end</span>
668:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000169">
                    
                    <a name="M000169"></a><b>new</b>(git_dir, options = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000169_source')" id="l_M000169_source">show</a>
                        
                    </p>
                    <div id="M000169_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/grit/git-ruby/repository.rb, line 37</span>
37:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">git_dir</span>, <span class="ruby-identifier">options</span> = {})
38:         <span class="ruby-ivar">@git_dir</span> = <span class="ruby-identifier">git_dir</span>
39:         <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
40:         <span class="ruby-ivar">@packs</span> = []
41:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    