<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Haml::Helpers</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            Haml::Helpers 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/haml/helpers/action_view_extensions_rb.html">lib/haml/helpers/action_view_extensions.rb</a></li>
            
            <li><a href="../../files/lib/haml/helpers/xss_mods_rb.html">lib/haml/helpers/xss_mods.rb</a></li>
            
            <li><a href="../../files/lib/haml/helpers_rb.html">lib/haml/helpers.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
This module contains various helpful methods to make it easier to do
various tasks. {Haml::Helpers} is automatically included in the context
that a <a href="../Haml.html">Haml</a> template is parsed in, so all these
methods are at your disposal from within the template.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000168">action_view?</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000211">block_is_haml?</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000195">capture_haml</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000208">escape_once</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000178">find_and_preserve</a>,</li>
                
                <li><a href="#M000186">flatten</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000220">haml_bind_proc</a>,</li>
                
                <li><a href="#M000219">haml_buffer</a>,</li>
                
                <li><a href="#M000196">haml_concat</a>,</li>
                
                <li><a href="#M000198">haml_indent</a>,</li>
                
                <li><a href="#M000199">haml_tag</a>,</li>
                
                <li><a href="#M000188">html_attrs</a>,</li>
                
                <li><a href="#M000207">html_escape</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000174">init_haml_helpers</a>,</li>
                
                <li><a href="#M000210">is_haml?</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000187">list_of</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000212">merge_name_and_attributes</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000175">non_haml</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000193">precede</a>,</li>
                
                <li><a href="#M000182">preserve</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000194">succeed</a>,</li>
                
                <li><a href="#M000192">surround</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000190">tab_down</a>,</li>
                
                <li><a href="#M000189">tab_up</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000217">with_haml_buffer</a>,</li>
                
                <li><a href="#M000191">with_tabs</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="Helpers.html">Haml::Helpers</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="Helpers/ActionViewExtensions.html">Haml::Helpers::ActionViewExtensions</a></li>
        
        <li><span class="type">MODULE</span> <a href="Helpers/XssMods.html">Haml::Helpers::XssMods</a></li>
        
        <li><span class="type">CLASS</span> <a href="Helpers/ErrorReturn.html">Haml::Helpers::ErrorReturn</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">HTML_ESCAPE</td>
            <td>=</td>
            <td class="attr-value">{ '&amp;'=&gt;'&amp;amp;', '&lt;'=&gt;'&amp;lt;', '&gt;'=&gt;'&amp;gt;', '&quot;'=&gt;'&amp;quot;', &quot;'&quot;=&gt;'&amp;#039;', }</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Characters that need to be escaped to <a href="HTML.html">HTML</a> entities
from user input
</p>
</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000168">
                    
                    <a name="M000168"></a><b>action_view?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return [Boolean] Whether or not <a
href="../ActionView.html">ActionView</a> is loaded
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000168_source')" id="l_M000168_source">show</a>
                        
                    </p>
                    <div id="M000168_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 54</span>
54:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">action_view?</span>
55:       <span class="ruby-ivar">@@action_view_defined</span>
56:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000211">
                    
                    <a name="M000211"></a><b>block_is_haml?</b>(block)
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether or not `block` is defined directly in a <a
href="../Haml.html">Haml</a> template.
</p>
<p>
@param block [Proc] A Ruby block @return [Boolean] Whether or not `block`
is defined directly in a <a href="../Haml.html">Haml</a> template
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000211_source')" id="l_M000211_source">show</a>
                        
                    </p>
                    <div id="M000211_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 543</span>
543:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">block_is_haml?</span>(<span class="ruby-identifier">block</span>)
544:       <span class="ruby-identifier">eval</span>(<span class="ruby-value str">'_hamlout'</span>, <span class="ruby-identifier">block</span>.<span class="ruby-identifier">binding</span>)
545:       <span class="ruby-keyword kw">true</span>
546:     <span class="ruby-keyword kw">rescue</span>
547:       <span class="ruby-keyword kw">false</span>
548:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000195">
                    
                    <a name="M000195"></a><b>capture_haml</b>(*args, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Captures the result of a block of <a href="../Haml.html">Haml</a> code,
gets rid of the excess indentation, and returns it as a string. For
example, after the following,
</p>
<pre>
    .foo
      - foo = capture_haml(13) do |a|
        %p= a
</pre>
<p>
the local variable `foo` would be assigned to `&#8221;<p>13</p>n&#8220;`.
</p>
<p>
@param args [Array] Arguments to pass into the block @yield [args] A block
of <a href="../Haml.html">Haml</a> code that will be converted to a string
@yieldparam args [Array] `args`
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000195_source')" id="l_M000195_source">show</a>
                        
                    </p>
                    <div id="M000195_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 340</span>
340:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
341:       <span class="ruby-identifier">buffer</span> = <span class="ruby-identifier">eval</span>(<span class="ruby-value str">'_hamlout'</span>, <span class="ruby-identifier">block</span>.<span class="ruby-identifier">binding</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-identifier">haml_buffer</span>
342:       <span class="ruby-identifier">with_haml_buffer</span>(<span class="ruby-identifier">buffer</span>) <span class="ruby-keyword kw">do</span>
343:         <span class="ruby-identifier">position</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">length</span>
344: 
345:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">capture_position</span> = <span class="ruby-identifier">position</span>
346:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
347: 
348:         <span class="ruby-identifier">captured</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-identifier">position</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>)
349:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">captured</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ugly</span>]
350:         <span class="ruby-identifier">captured</span> = <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/^/</span>)
351: 
352:         <span class="ruby-identifier">min_tabs</span> = <span class="ruby-keyword kw">nil</span>
353:         <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
354:           <span class="ruby-identifier">tabs</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">index</span>(<span class="ruby-regexp re">/[^ ]/</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">length</span>
355:           <span class="ruby-identifier">min_tabs</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">tabs</span>
356:           <span class="ruby-identifier">min_tabs</span> = <span class="ruby-identifier">min_tabs</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tabs</span> <span class="ruby-value">? </span><span class="ruby-identifier">tabs</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">min_tabs</span>
357:         <span class="ruby-keyword kw">end</span>
358: 
359:         <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
360:           <span class="ruby-identifier">line</span>[<span class="ruby-identifier">min_tabs</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
361:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">join</span>
362:       <span class="ruby-keyword kw">end</span>
363:     <span class="ruby-keyword kw">ensure</span>
364:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">capture_position</span> = <span class="ruby-keyword kw">nil</span>
365:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000208">
                    
                    <a name="M000208"></a><b>escape_once</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Escapes <a href="HTML.html">HTML</a> entities in `text`, but without
escaping an ampersand that is already part of an escaped entity.
</p>
<p>
@param text [String] The string to sanitize @return [String] The sanitized
string
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000208_source')" id="l_M000208_source">show</a>
                        
                    </p>
                    <div id="M000208_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 522</span>
522:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">escape_once</span>(<span class="ruby-identifier">text</span>)
523:       <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">silence_warnings</span> <span class="ruby-keyword kw">do</span>
524:         <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\&quot;&gt;&lt;]|&amp;(?!(?:[a-zA-Z]+|(#\d+));)/n</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">HTML_ESCAPE</span>[<span class="ruby-identifier">s</span>]}
525:       <span class="ruby-keyword kw">end</span>
526:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000178">
                    
                    <a name="M000178"></a><b>find_and_preserve</b>(input = nil, tags = haml_buffer.options[:preserve], &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Uses {#preserve} to convert any newlines inside whitespace-sensitive tags
into the <a href="HTML.html">HTML</a> entities for endlines.
</p>
<p>
@param tags [Array<String>] Tags that should have newlines escaped
</p>
<p>
@overload <a href="Helpers.html#M000178">find_and_preserve</a>(input, tags
= haml_buffer.options[:preserve])
</p>
<pre>
  Escapes newlines within a string.

  @param input [String] The string within which to escape newlines
</pre>
<p>
@overload <a href="Helpers.html#M000178">find_and_preserve</a>(tags =
haml_buffer.options[:preserve])
</p>
<pre>
  Escapes newlines within a block of Haml code.

  @yield The block within which to escape newlines
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000178_source')" id="l_M000178_source">show</a>
                        
                    </p>
                    <div id="M000178_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 109</span>
109:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_and_preserve</span>(<span class="ruby-identifier">input</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:preserve</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
110:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">find_and_preserve</span>(<span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>), <span class="ruby-identifier">input</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">tags</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
111:       <span class="ruby-identifier">re</span> = <span class="ruby-node">/&lt;(#{tags.map(&amp;Regexp.method(:escape)).join('|')})([^&gt;]*)&gt;(.*?)(&lt;\/\1&gt;)/i</span><span class="ruby-identifier">m</span>
112:       <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">re</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
113:         <span class="ruby-identifier">s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">re</span> <span class="ruby-comment cmt"># Can't rely on $1, etc. existing since Rails' SafeBuffer#gsub is incompatible</span>
114:         <span class="ruby-node">&quot;&lt;#{$1}#{$2}&gt;#{preserve($3)}&lt;/#{$1}&gt;&quot;</span>
115:       <span class="ruby-keyword kw">end</span>
116:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000186">
                    
                    <a name="M000186"></a><b>flatten</b>(input = nil, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Helpers.html#M000182">preserve</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000196">
                    
                    <a name="M000196"></a><b>haml_concat</b>(text = &quot;&quot;)
                    
                </div>
                
                <div class="description">
                  <p>
Outputs text directly to the <a href="../Haml.html">Haml</a> buffer, with
the proper indentation.
</p>
<p>
@param text [to_s] The text to output
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000196_source')" id="l_M000196_source">show</a>
                        
                    </p>
                    <div id="M000196_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 370</span>
370:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_concat</span>(<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>)
371:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ugly</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">haml_indent</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
372:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">haml_indent</span> <span class="ruby-operator">&lt;&lt;</span>
373:           <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">haml_indent</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
374:       <span class="ruby-keyword kw">else</span>
375:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
376:       <span class="ruby-keyword kw">end</span>
377:       <span class="ruby-constant">ErrorReturn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;haml_concat&quot;</span>)
378:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000198">
                    
                    <a name="M000198"></a><b>haml_indent</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return [String] The indentation string for the current line
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000198_source')" id="l_M000198_source">show</a>
                        
                    </p>
                    <div id="M000198_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 381</span>
381:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_indent</span>
382:       <span class="ruby-value str">'  '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span>
383:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000199">
                    
                    <a name="M000199"></a><b>haml_tag</b>(name, *rest, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Creates an <a href="HTML.html">HTML</a> tag with the given name and
optionally text and attributes. Can take a block that will run between the
opening and closing tags. If the block is a <a href="../Haml.html">Haml</a>
block or outputs text using {#haml_concat}, the text will be properly
indented.
</p>
<p>
`name` can be a string using the standard <a href="../Haml.html">Haml</a>
class/id shorthand (e.g. &#8220;spanfoo.bar&#8221;, &#8220;foo&#8220;).
Just like standard <a href="../Haml.html">Haml</a> tags, these class and id
values will be merged with manually-specified attributes.
</p>
<p>
`flags` is a list of symbol flags like those that can be put at the end of
a <a href="../Haml.html">Haml</a> tag (`:/`, `:<`, and `:>`). Currently,
only `:/` and `:<` are supported.
</p>
<p>
`<a href="Helpers.html#M000199">haml_tag</a>` outputs directly to the
buffer; its return value should not be used. If you need to get the results
as a string, use {#capture_haml}.
</p>
<p>
For example,
</p>
<pre>
    haml_tag :table do
      haml_tag :tr do
        haml_tag 'td.cell' do
          haml_tag :strong, &quot;strong!&quot;
          haml_concat &quot;data&quot;
        end
        haml_tag :td do
          haml_concat &quot;more_data&quot;
        end
      end
    end
</pre>
<p>
outputs
</p>
<pre>
    &lt;table&gt;
      &lt;tr&gt;
        &lt;td class='cell'&gt;
          &lt;strong&gt;
            strong!
          &lt;/strong&gt;
          data
        &lt;/td&gt;
        &lt;td&gt;
          more_data
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
</pre>
<p>
@param name [to_s] The name of the tag @param flags [Array<Symbol>] <a
href="../Haml.html">Haml</a> end-of-tag flags
</p>
<p>
@overload <a href="Helpers.html#M000199">haml_tag</a>(name, *flags,
attributes = {})
</p>
<pre>
  @yield The block of Haml code within the tag
</pre>
<p>
@overload <a href="Helpers.html#M000199">haml_tag</a>(name, text, *flags,
attributes = {})
</p>
<pre>
  @param text [#to_s] The text within the tag
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000199_source')" id="l_M000199_source">show</a>
                        
                    </p>
                    <div id="M000199_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 442</span>
442:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_tag</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rest</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
443:       <span class="ruby-identifier">ret</span> = <span class="ruby-constant">ErrorReturn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;haml_tag&quot;</span>)
444: 
445:       <span class="ruby-identifier">text</span> = <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-constant">Symbol</span>, <span class="ruby-constant">Hash</span>, <span class="ruby-constant">NilClass</span>].<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-identifier">t</span>}
446:       <span class="ruby-identifier">flags</span> = []
447:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span> <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Symbol</span>
448:       <span class="ruby-identifier">attrs</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">map_keys</span>(<span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> {}) {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>}
449:       <span class="ruby-identifier">name</span>, <span class="ruby-identifier">attrs</span> = <span class="ruby-identifier">merge_name_and_attributes</span>(<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">attrs</span>)
450: 
451:       <span class="ruby-identifier">attributes</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Compiler</span>.<span class="ruby-identifier">build_attributes</span>(<span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">html?</span>,
452:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:attr_wrapper</span>],
453:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_attrs</span>],
454:         <span class="ruby-identifier">attrs</span>)
455: 
456:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:autoclose</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:/</span>))
457:         <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;#{name}#{attributes} /&gt;&quot;</span>
458:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
459:       <span class="ruby-keyword kw">end</span>
460: 
461:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:/</span>)
462:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Self-closing tags can't have content.&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>
463:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Illegal nesting: nesting within a self-closing tag is illegal.&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
464:       <span class="ruby-keyword kw">end</span>
465: 
466:       <span class="ruby-identifier">tag</span> = <span class="ruby-node">&quot;&lt;#{name}#{attributes}&gt;&quot;</span>
467:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>
468:         <span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>
469:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
470:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
471:           <span class="ruby-identifier">tab_up</span>
472:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">text</span>
473:           <span class="ruby-identifier">tab_down</span>
474:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
475:         <span class="ruby-keyword kw">else</span>
476:           <span class="ruby-identifier">tag</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
477:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
478:         <span class="ruby-keyword kw">end</span>
479:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
480:       <span class="ruby-keyword kw">end</span>
481: 
482:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>
483:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;Illegal nesting: content can't be both given to haml_tag :#{name} and nested within it.&quot;</span>)
484:       <span class="ruby-keyword kw">end</span>
485: 
486:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:&lt;</span>)
487:         <span class="ruby-identifier">tag</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">strip</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
488:         <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
489:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
490:       <span class="ruby-keyword kw">end</span>
491: 
492:       <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
493:       <span class="ruby-identifier">tab_up</span>
494:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>
495:       <span class="ruby-identifier">tab_down</span>
496:       <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
497: 
498:       <span class="ruby-identifier">ret</span>
499:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000188">
                    
                    <a name="M000188"></a><b>html_attrs</b>(lang = 'en-US')
                    
                </div>
                
                <div class="description">
                  <p>
Returns a hash containing default assignments for the `xmlns`, `lang`, and
`xml:lang` attributes of the `html` <a href="HTML.html">HTML</a> element.
For example,
</p>
<pre>
    %html{html_attrs}
</pre>
<p>
becomes
</p>
<pre>
    &lt;html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en-US' lang='en-US'&gt;
</pre>
<p>
@param lang [String] The value of `xml:lang` and `lang` @return [{to_s =>
String}] The attribute hash
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000188_source')" id="l_M000188_source">show</a>
                        
                    </p>
                    <div id="M000188_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 199</span>
199:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">html_attrs</span>(<span class="ruby-identifier">lang</span> = <span class="ruby-value str">'en-US'</span>)
200:       {<span class="ruby-identifier">:xmlns</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;http://www.w3.org/1999/xhtml&quot;</span>, <span class="ruby-value str">'xml:lang'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>, <span class="ruby-identifier">:lang</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>}
201:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000207">
                    
                    <a name="M000207"></a><b>html_escape</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Returns a copy of `text` with ampersands, angle brackets and quotes escaped
into <a href="HTML.html">HTML</a> entities.
</p>
<p>
Note that if <a href="../ActionView.html">ActionView</a> is loaded and XSS
protection is enabled (as is the default for Rails 3.0+, and optional for
version 2.3.5+), this won&#8217;t escape text declared as
&#8220;safe&#8221;.
</p>
<p>
@param text [String] The string to sanitize @return [String] The sanitized
string
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000207_source')" id="l_M000207_source">show</a>
                        
                    </p>
                    <div id="M000207_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 513</span>
513:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">html_escape</span>(<span class="ruby-identifier">text</span>)
514:       <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">silence_warnings</span> {<span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\&quot;&gt;&lt;&amp;]/n</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">HTML_ESCAPE</span>[<span class="ruby-identifier">s</span>]}}
515:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000174">
                    
                    <a name="M000174"></a><b>init_haml_helpers</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Note: this does *<b>not</b>* need to be called when using <a
href="../Haml.html">Haml</a> helpers normally in Rails.
</p>
<p>
Initializes the current object as though it were in the same context as a
normal <a href="../ActionView.html">ActionView</a> instance using <a
href="../Haml.html">Haml</a>. This is useful if you want to use the helpers
in a context other than the normal setup with <a
href="../ActionView.html">ActionView</a>. For example:
</p>
<pre>
    context = Object.new
    class &lt;&lt; context
      include Haml::Helpers
    end
    context.init_haml_helpers
    context.haml_tag :p, &quot;Stuff&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000174_source')" id="l_M000174_source">show</a>
                        
                    </p>
                    <div id="M000174_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 74</span>
74:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_haml_helpers</span>
75:       <span class="ruby-ivar">@haml_buffer</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@haml_buffer</span>, <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">''</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:options_for_buffer</span>))
76:       <span class="ruby-keyword kw">nil</span>
77:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000210">
                    
                    <a name="M000210"></a><b>is_haml?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether or not the current template is a <a
href="../Haml.html">Haml</a> template.
</p>
<p>
This function, unlike other {Haml::Helpers} functions, also works in other
`ActionView` templates, where it will always return false.
</p>
<p>
@return [Boolean] Whether or not the current template is a <a
href="../Haml.html">Haml</a> template
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000210_source')" id="l_M000210_source">show</a>
                        
                    </p>
                    <div id="M000210_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 535</span>
535:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_haml?</span>
536:       <span class="ruby-operator">!</span><span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active?</span>
537:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000187">
                    
                    <a name="M000187"></a><b>list_of</b>(enum, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Takes an `Enumerable` object and a block and iterates over the enum,
yielding each element to a <a href="../Haml.html">Haml</a> block and
putting the result into `<li>` elements. This creates a list of the results
of the block. For example:
</p>
<pre>
    = list_of([['hello'], ['yall']]) do |i|
      = i[0]
</pre>
<p>
Produces:
</p>
<pre>
    &lt;li&gt;hello&lt;/li&gt;
    &lt;li&gt;yall&lt;/li&gt;
</pre>
<p>
And
</p>
<pre>
    = list_of({:title =&gt; 'All the stuff', :description =&gt; 'A book about all the stuff.'}) do |key, val|
      %h3= key.humanize
      %p= val
</pre>
<p>
Produces:
</p>
<pre>
    &lt;li&gt;
      &lt;h3&gt;Title&lt;/h3&gt;
      &lt;p&gt;All the stuff&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;h3&gt;Description&lt;/h3&gt;
      &lt;p&gt;A book about all the stuff.&lt;/p&gt;
    &lt;/li&gt;
</pre>
<p>
@param enum [Enumerable] The list of objects to iterate over @yield [item]
A block which contains <a href="../Haml.html">Haml</a> code that goes
within list items @yieldparam item An element of `enum`
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000187_source')" id="l_M000187_source">show</a>
                        
                    </p>
                    <div id="M000187_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 171</span>
171:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_of</span>(<span class="ruby-identifier">enum</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
172:       <span class="ruby-identifier">to_return</span> = <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
173:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">capture_haml</span>(<span class="ruby-identifier">i</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
174: 
175:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
176:           <span class="ruby-identifier">result</span> = <span class="ruby-identifier">result</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;\n  &quot;</span>)
177:           <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;\n  #{result.strip}\n&quot;</span>
178:         <span class="ruby-keyword kw">else</span>
179:           <span class="ruby-identifier">result</span> = <span class="ruby-identifier">result</span>.<span class="ruby-identifier">strip</span>
180:         <span class="ruby-keyword kw">end</span>
181: 
182:         <span class="ruby-node">&quot;&lt;li&gt;#{result}&lt;/li&gt;&quot;</span>
183:       <span class="ruby-keyword kw">end</span>
184:       <span class="ruby-identifier">to_return</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
185:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000175">
                    
                    <a name="M000175"></a><b>non_haml</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Runs a block of code in a non-<a href="../Haml.html">Haml</a> context (i.e.
{#is_haml?} will return false).
</p>
<p>
This is mainly useful for rendering sub-templates such as partials in a
non-<a href="../Haml.html">Haml</a> language, particularly where helpers
may behave differently when run from <a href="../Haml.html">Haml</a>.
</p>
<p>
Note that this is automatically applied to Rails partials.
</p>
<p>
@yield A block which won&#8217;t register as <a
href="../Haml.html">Haml</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000175_source')" id="l_M000175_source">show</a>
                        
                    </p>
                    <div id="M000175_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 88</span>
88:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">non_haml</span>
89:       <span class="ruby-identifier">was_active</span> = <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active?</span>
90:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-keyword kw">false</span>
91:       <span class="ruby-keyword kw">yield</span>
92:     <span class="ruby-keyword kw">ensure</span>
93:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-identifier">was_active</span>
94:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000193">
                    
                    <a name="M000193"></a><b>precede</b>(str, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Prepends a string to the beginning of a <a href="../Haml.html">Haml</a>
block, with no whitespace between. For example:
</p>
<pre>
    = precede '*' do
      %span.small Not really
</pre>
<p>
Produces:
</p>
<pre>
    *&lt;span class='small'&gt;Not really&lt;/span&gt;
</pre>
<p>
@param str [String] The string to add before the <a
href="../Haml.html">Haml</a> @yield A block of <a
href="../Haml.html">Haml</a> to prepend to
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000193_source')" id="l_M000193_source">show</a>
                        
                    </p>
                    <div id="M000193_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 303</span>
303:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">precede</span>(<span class="ruby-identifier">str</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
304:       <span class="ruby-node">&quot;#{str}#{capture_haml(&amp;block).chomp}\n&quot;</span>
305:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000182">
                    
                    <a name="M000182"></a><b>preserve</b>(input = nil, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Takes any string, finds all the newlines, and converts them to <a
href="HTML.html">HTML</a> entities so they&#8217;ll render correctly in
whitespace-sensitive tags without screwing up the indentation.
</p>
<p>
@overload perserve(input)
</p>
<pre>
  Escapes newlines within a string.

  @param input [String] The string within which to escape all newlines
</pre>
<p>
@overload perserve
</p>
<pre>
  Escapes newlines within a block of Haml code.

  @yield The block within which to escape newlines
</pre>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Helpers.html#M000186">flatten</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000182_source')" id="l_M000182_source">show</a>
                        
                    </p>
                    <div id="M000182_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 130</span>
130:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preserve</span>(<span class="ruby-identifier">input</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
131:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">preserve</span>(<span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
132:       <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\n/</span>, <span class="ruby-value str">'&amp;#x000A;'</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\r/</span>, <span class="ruby-value str">''</span>)
133:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000194">
                    
                    <a name="M000194"></a><b>succeed</b>(str, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Appends a string to the end of a <a href="../Haml.html">Haml</a> block,
with no whitespace between. For example:
</p>
<pre>
    click
    = succeed '.' do
      %a{:href=&gt;&quot;thing&quot;} here
</pre>
<p>
Produces:
</p>
<pre>
    click
    &lt;a href='thing'&gt;here&lt;/a&gt;.
</pre>
<p>
@param str [String] The string to add after the <a
href="../Haml.html">Haml</a> @yield A block of <a
href="../Haml.html">Haml</a> to append to
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000194_source')" id="l_M000194_source">show</a>
                        
                    </p>
                    <div id="M000194_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 322</span>
322:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">succeed</span>(<span class="ruby-identifier">str</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
323:       <span class="ruby-node">&quot;#{capture_haml(&amp;block).chomp}#{str}\n&quot;</span>
324:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000192">
                    
                    <a name="M000192"></a><b>surround</b>(front, back = front, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Surrounds a block of <a href="../Haml.html">Haml</a> code with strings,
with no whitespace in between. For example:
</p>
<pre>
    = surround '(', ')' do
      %a{:href =&gt; &quot;food&quot;} chicken
</pre>
<p>
Produces:
</p>
<pre>
    (&lt;a href='food'&gt;chicken&lt;/a&gt;)
</pre>
<p>
and
</p>
<pre>
    = surround '*' do
      %strong angry
</pre>
<p>
Produces:
</p>
<pre>
    *&lt;strong&gt;angry&lt;/strong&gt;*
</pre>
<p>
@param front [String] The string to add before the <a
href="../Haml.html">Haml</a> @param back [String] The string to add after
the <a href="../Haml.html">Haml</a> @yield A block of <a
href="../Haml.html">Haml</a> to surround
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000192_source')" id="l_M000192_source">show</a>
                        
                    </p>
                    <div id="M000192_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 284</span>
284:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">surround</span>(<span class="ruby-identifier">front</span>, <span class="ruby-identifier">back</span> = <span class="ruby-identifier">front</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
285:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
286: 
287:       <span class="ruby-node">&quot;#{front}#{output.chomp}#{back}\n&quot;</span>
288:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000190">
                    
                    <a name="M000190"></a><b>tab_down</b>(i = 1)
                    
                </div>
                
                <div class="description">
                  <p>
Decrements the number of tabs the buffer automatically adds to the lines of
the template.
</p>
<p>
@param i [Fixnum] The number of tabs by which to decrease the indentation
@see <a href="Helpers.html#M000189">tab_up</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000190_source')" id="l_M000190_source">show</a>
                        
                    </p>
                    <div id="M000190_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 230</span>
230:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tab_down</span>(<span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>)
231:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">i</span>
232:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000189">
                    
                    <a name="M000189"></a><b>tab_up</b>(i = 1)
                    
                </div>
                
                <div class="description">
                  <p>
Increments the number of tabs the buffer automatically adds to the lines of
the template. For example:
</p>
<pre>
    %h1 foo
    - tab_up
    %p bar
    - tab_down
    %strong baz
</pre>
<p>
Produces:
</p>
<pre>
    &lt;h1&gt;foo&lt;/h1&gt;
      &lt;p&gt;bar&lt;/p&gt;
    &lt;strong&gt;baz&lt;/strong&gt;
</pre>
<p>
@param i [Fixnum] The number of tabs by which to increase the indentation
@see <a href="Helpers.html#M000190">tab_down</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000189_source')" id="l_M000189_source">show</a>
                        
                    </p>
                    <div id="M000189_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 221</span>
221:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tab_up</span>(<span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>)
222:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">i</span>
223:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000191">
                    
                    <a name="M000191"></a><b>with_tabs</b>(i)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the number of tabs the buffer automatically adds to the lines of the
template, but only for the duration of the block. For example:
</p>
<pre>
    %h1 foo
    - with_tabs(2) do
      %p bar
    %strong baz
</pre>
<p>
Produces:
</p>
<pre>
    &lt;h1&gt;foo&lt;/h1&gt;
        &lt;p&gt;bar&lt;/p&gt;
    &lt;strong&gt;baz&lt;/strong&gt;
</pre>
<p>
@param i [Fixnum] The number of tabs to use @yield A block in which the
indentation will be `i` spaces
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000191_source')" id="l_M000191_source">show</a>
                        
                    </p>
                    <div id="M000191_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 253</span>
253:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_tabs</span>(<span class="ruby-identifier">i</span>)
254:       <span class="ruby-identifier">old_tabs</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span>
255:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> = <span class="ruby-identifier">i</span>
256:       <span class="ruby-keyword kw">yield</span>
257:     <span class="ruby-keyword kw">ensure</span>
258:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> = <span class="ruby-identifier">old_tabs</span>
259:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000220">
                    
                    <a name="M000220"></a><b>haml_bind_proc</b>(&amp;proc)
                    
                </div>
                
                <div class="description">
                  <p>
Gives a proc the same local `_hamlout` and `_erbout` variables that the
current template has.
</p>
<p>
@param proc [call] The proc to bind @return [Proc] A new proc with the new
variables bound
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000220_source')" id="l_M000220_source">show</a>
                        
                    </p>
                    <div id="M000220_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 589</span>
589:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_bind_proc</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)
590:       <span class="ruby-identifier">_hamlout</span> = <span class="ruby-identifier">haml_buffer</span>
591:       <span class="ruby-identifier">_erbout</span> = <span class="ruby-identifier">_hamlout</span>.<span class="ruby-identifier">buffer</span>
592:       <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">call</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) }
593:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000219">
                    
                    <a name="M000219"></a><b>haml_buffer</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The current {Haml::Buffer} object.
</p>
<p>
@return [Haml::Buffer]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000219_source')" id="l_M000219_source">show</a>
                        
                    </p>
                    <div id="M000219_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 580</span>
580:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_buffer</span>
581:       <span class="ruby-ivar">@haml_buffer</span>
582:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000212">
                    
                    <a name="M000212"></a><b>merge_name_and_attributes</b>(name, attributes_hash = {})
                    
                </div>
                
                <div class="description">
                  <p>
Parses the tag name used for {#haml_tag} and merges it with the Ruby
attributes hash.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000212_source')" id="l_M000212_source">show</a>
                        
                    </p>
                    <div id="M000212_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 554</span>
554:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge_name_and_attributes</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">attributes_hash</span> = {})
555:       <span class="ruby-comment cmt"># skip merging if no ids or classes found in name</span>
556:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">attributes_hash</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^(.+?)?([\.#].*)$/</span>
557: 
558:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">$1</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;div&quot;</span>, <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">merge_attrs</span>(
559:         <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parse_class_and_id</span>(<span class="ruby-identifier">$2</span>), <span class="ruby-identifier">attributes_hash</span>)
560:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000217">
                    
                    <a name="M000217"></a><b>with_haml_buffer</b>(buffer)
                    
                </div>
                
                <div class="description">
                  <p>
Runs a block of code with the given buffer as the currently active buffer.
</p>
<p>
@param buffer [Haml::Buffer] The <a href="../Haml.html">Haml</a> buffer to
use temporarily @yield A block in which the given buffer should be used
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000217_source')" id="l_M000217_source">show</a>
                        
                    </p>
                    <div id="M000217_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 566</span>
566:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_haml_buffer</span>(<span class="ruby-identifier">buffer</span>)
567:       <span class="ruby-ivar">@haml_buffer</span>, <span class="ruby-identifier">old_buffer</span> = <span class="ruby-identifier">buffer</span>, <span class="ruby-ivar">@haml_buffer</span>
568:       <span class="ruby-identifier">old_buffer</span>.<span class="ruby-identifier">active</span>, <span class="ruby-identifier">old_was_active</span> = <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">old_buffer</span>.<span class="ruby-identifier">active?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">old_buffer</span>
569:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span>, <span class="ruby-identifier">was_active</span> = <span class="ruby-keyword kw">true</span>, <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active?</span>
570:       <span class="ruby-keyword kw">yield</span>
571:     <span class="ruby-keyword kw">ensure</span>
572:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-identifier">was_active</span>
573:       <span class="ruby-identifier">old_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-identifier">old_was_active</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">old_buffer</span>
574:       <span class="ruby-ivar">@haml_buffer</span> = <span class="ruby-identifier">old_buffer</span>
575:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    