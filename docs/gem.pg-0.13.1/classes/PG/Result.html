<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>PG::Result</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            PG::Result 
            
                <span class="parent">&lt; 
                    
                    rb_cObject 
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/ext/pg_c.html">ext/pg.c</a></li>
            
            <li><a href="../../files/lib/pg/result_rb.html">lib/pg/result.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
call-seq:
</p>
<pre>
   res.fields() -&gt; Array
</pre>
<p>
Returns an array of Strings representing the names of the fields in the
result.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M000023">[]</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000004">clear</a>,</li>
                
                <li><a href="#M000020">cmd_status</a>,</li>
                
                <li><a href="#M000021">cmd_tuples</a>,</li>
                
                <li><a href="#M000033">cmdtuples</a>,</li>
                
                <li><a href="#M000027">column_values</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000024">each</a>,</li>
                
                <li><a href="#M000003">error_field</a>,</li>
                
                <li><a href="#M000002">error_message</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000011">fformat</a>,</li>
                
                <li><a href="#M000028">field_values</a>,</li>
                
                <li><a href="#M000025">fields</a>,</li>
                
                <li><a href="#M000013">fmod</a>,</li>
                
                <li><a href="#M000007">fname</a>,</li>
                
                <li><a href="#M000008">fnumber</a>,</li>
                
                <li><a href="#M000014">fsize</a>,</li>
                
                <li><a href="#M000009">ftable</a>,</li>
                
                <li><a href="#M000010">ftablecol</a>,</li>
                
                <li><a href="#M000012">ftype</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000016">getisnull</a>,</li>
                
                <li><a href="#M000017">getlength</a>,</li>
                
                <li><a href="#M000015">getvalue</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000006">nfields</a>,</li>
                
                <li><a href="#M000018">nparams</a>,</li>
                
                <li><a href="#M000005">ntuples</a>,</li>
                
                <li><a href="#M000032">num_fields</a>,</li>
                
                <li><a href="#M000031">num_tuples</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000022">oid_value</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000019">paramtype</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000001">res_status</a>,</li>
                
                <li><a href="#M000030">result_error_field</a>,</li>
                
                <li><a href="#M000029">result_error_message</a>,</li>
                
                <li><a href="#M000000">result_status</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M000026">values</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <span>Enumerable</span>
            
            START:includes
        </li>
        
        <li>
            
            <span>rb_mPGconstants</span>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000023">
                    
                    <a name="M000023"></a><b>res[ n ] &rarr; Hash
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns tuple <em>n</em> as a hash.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show</a>
                        
                    </p>
                    <div id="M000023_source" class="dyn-source">
                        <pre>static VALUE
pgresult_aref(VALUE self, VALUE index)
{
  PGresult *result = pgresult_get(self);
  int tuple_num = NUM2INT(index);
  int field_num;
  VALUE fname,val;
  VALUE tuple;

  if ( tuple_num &lt; 0 || tuple_num &gt;= PQntuples(result) )
    rb_raise( rb_eIndexError, &quot;Index %d is out of range&quot;, tuple_num );

  tuple = rb_hash_new();
  for ( field_num = 0; field_num &lt; PQnfields(result); field_num++ ) {
    fname = rb_tainted_str_new2( PQfname(result,field_num) );
    ASSOCIATE_INDEX(fname, self);
    if ( PQgetisnull(result, tuple_num, field_num) ) {
      rb_hash_aset( tuple, fname, Qnil );
    }
    else {
      val = rb_tainted_str_new( PQgetvalue(result, tuple_num, field_num ),
                                PQgetlength(result, tuple_num, field_num) );

#ifdef M17N_SUPPORTED
      /* associate client encoding for text format only */
      if ( 0 == PQfformat(result, field_num) ) {
        ASSOCIATE_INDEX( val, self );
      } else {
        rb_enc_associate( val, rb_ascii8bit_encoding() );
      }
#endif

      rb_hash_aset( tuple, fname, val );
    }
  }
  return tuple;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000004">
                    
                    <a name="M000004"></a><b>res.clear() &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Clears the PGresult object as the result of the query.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000004_source')" id="l_M000004_source">show</a>
                        
                    </p>
                    <div id="M000004_source" class="dyn-source">
                        <pre>VALUE
pg_result_clear(VALUE self)
{
  PQclear(pgresult_get(self));
  DATA_PTR(self) = NULL;
  return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000020">
                    
                    <a name="M000020"></a><b>res.cmd_status() &rarr; String
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the status string of the last query command.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000020_source')" id="l_M000020_source">show</a>
                        
                    </p>
                    <div id="M000020_source" class="dyn-source">
                        <pre>static VALUE
pgresult_cmd_status(VALUE self)
{
  VALUE ret = rb_tainted_str_new2(PQcmdStatus(pgresult_get(self)));
  ASSOCIATE_INDEX(ret, self);
  return ret;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000021">
                    
                    <a name="M000021"></a><b>res.cmd_tuples() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the number of tuples (rows) affected by the SQL command.
</p>
<p>
If the SQL command that generated the PGresult was not one of:
</p>
<ul>
<li><tt>INSERT</tt>

</li>
<li><tt>UPDATE</tt>

</li>
<li><tt>DELETE</tt>

</li>
<li><tt>MOVE</tt>

</li>
<li><tt>FETCH</tt>

</li>
</ul>
<p>
or if no tuples were affected, <tt>0</tt> is returned.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Result.html#M000033">cmdtuples</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000021_source')" id="l_M000021_source">show</a>
                        
                    </p>
                    <div id="M000021_source" class="dyn-source">
                        <pre>static VALUE
pgresult_cmd_tuples(VALUE self)
{
  long n;
  n = strtol(PQcmdTuples(pgresult_get(self)),NULL, 10);
  return INT2NUM(n);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000033">
                    
                    <a name="M000033"></a><b>cmdtuples</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Result.html#M000021">cmd_tuples</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000027">
                    
                    <a name="M000027"></a><b>res.column_values( n )   &rarr; array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns an Array of the values from the nth column of each tuple in the
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000027_source')" id="l_M000027_source">show</a>
                        
                    </p>
                    <div id="M000027_source" class="dyn-source">
                        <pre>static VALUE
pgresult_column_values(VALUE self, VALUE index)
{
  int col = NUM2INT( index );
  return make_column_result_array( self, col );
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000024">
                    
                    <a name="M000024"></a><b>res.each{ |tuple| ... }
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Invokes block for each tuple in the result set.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000024_source')" id="l_M000024_source">show</a>
                        
                    </p>
                    <div id="M000024_source" class="dyn-source">
                        <pre>static VALUE
pgresult_each(VALUE self)
{
  PGresult *result = pgresult_get(self);
  int tuple_num;

  for(tuple_num = 0; tuple_num &lt; PQntuples(result); tuple_num++) {
    rb_yield(pgresult_aref(self, INT2NUM(tuple_num)));
  }
  return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000003">
                    
                    <a name="M000003"></a><b>res.error_field(fieldcode) &rarr; String
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the individual field of an error.
</p>
<p>
<tt>fieldcode</tt> is one of:
</p>
<ul>
<li><tt>PG_DIAG_SEVERITY</tt>

</li>
<li><tt>PG_DIAG_SQLSTATE</tt>

</li>
<li><tt>PG_DIAG_MESSAGE_PRIMARY</tt>

</li>
<li><tt>PG_DIAG_MESSAGE_DETAIL</tt>

</li>
<li><tt>PG_DIAG_MESSAGE_HINT</tt>

</li>
<li><tt>PG_DIAG_STATEMENT_POSITION</tt>

</li>
<li><tt>PG_DIAG_INTERNAL_POSITION</tt>

</li>
<li><tt>PG_DIAG_INTERNAL_QUERY</tt>

</li>
<li><tt>PG_DIAG_CONTEXT</tt>

</li>
<li><tt>PG_DIAG_SOURCE_FILE</tt>

</li>
<li><tt>PG_DIAG_SOURCE_LINE</tt>

</li>
<li><tt>PG_DIAG_SOURCE_FUNCTION</tt>

</li>
</ul>
<p>
An example:
</p>
<pre>
  begin
      conn.exec( &quot;SELECT * FROM nonexistant_table&quot; )
  rescue PGError =&gt; err
      p [
          result.error_field( PGresult::PG_DIAG_SEVERITY ),
          result.error_field( PGresult::PG_DIAG_SQLSTATE ),
          result.error_field( PGresult::PG_DIAG_MESSAGE_PRIMARY ),
          result.error_field( PGresult::PG_DIAG_MESSAGE_DETAIL ),
          result.error_field( PGresult::PG_DIAG_MESSAGE_HINT ),
          result.error_field( PGresult::PG_DIAG_STATEMENT_POSITION ),
          result.error_field( PGresult::PG_DIAG_INTERNAL_POSITION ),
          result.error_field( PGresult::PG_DIAG_INTERNAL_QUERY ),
          result.error_field( PGresult::PG_DIAG_CONTEXT ),
          result.error_field( PGresult::PG_DIAG_SOURCE_FILE ),
          result.error_field( PGresult::PG_DIAG_SOURCE_LINE ),
          result.error_field( PGresult::PG_DIAG_SOURCE_FUNCTION ),
      ]
  end
</pre>
<p>
Outputs:
</p>
<pre>
  [&quot;ERROR&quot;, &quot;42P01&quot;, &quot;relation \&quot;nonexistant_table\&quot; does not exist&quot;, nil, nil,
   &quot;15&quot;, nil, nil, nil, &quot;path/to/parse_relation.c&quot;, &quot;857&quot;, &quot;parserOpenTable&quot;]
</pre>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Result.html#M000030">result_error_field</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000003_source')" id="l_M000003_source">show</a>
                        
                    </p>
                    <div id="M000003_source" class="dyn-source">
                        <pre>static VALUE
pgresult_error_field(VALUE self, VALUE field)
{
  PGresult *result = pgresult_get( self );
  int fieldcode = NUM2INT( field );
  char * fieldstr = PQresultErrorField( result, fieldcode );
  VALUE ret = Qnil;

  if ( fieldstr ) {
    ret = rb_tainted_str_new2( fieldstr );
    ASSOCIATE_INDEX( ret, self );
  }

  return ret;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000002">
                    
                    <a name="M000002"></a><b>res.error_message() &rarr; String
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the error message of the command as a string.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Result.html#M000029">result_error_message</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000002_source')" id="l_M000002_source">show</a>
                        
                    </p>
                    <div id="M000002_source" class="dyn-source">
                        <pre>static VALUE
pgresult_error_message(VALUE self)
{
  VALUE ret = rb_tainted_str_new2(PQresultErrorMessage(pgresult_get(self)));
  ASSOCIATE_INDEX(ret, self);
  return ret;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000011">
                    
                    <a name="M000011"></a><b>res.fformat( column_number ) &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the format (0 for text, 1 for binary) of column
<em>column_number</em>.
</p>
<p>
Raises ArgumentError if <em>column_number</em> is out of range.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fformat(VALUE self, VALUE column_number)
{
  PGresult *result = pgresult_get(self);
  int fnumber = NUM2INT(column_number);
  if (fnumber &lt; 0 || fnumber &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError, &quot;Column number is out of range: %d&quot;, 
      fnumber);
  }
  return INT2FIX(PQfformat(result, fnumber));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000028">
                    
                    <a name="M000028"></a><b>res.field_values( field )   &rarr; array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns an Array of the values from the given <em>field</em> of each tuple
in the result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000028_source')" id="l_M000028_source">show</a>
                        
                    </p>
                    <div id="M000028_source" class="dyn-source">
                        <pre>static VALUE
pgresult_field_values( VALUE self, VALUE field )
{
  PGresult *result = pgresult_get( self );
  const char *fieldname = RSTRING_PTR( field );
  int fnum = PQfnumber( result, fieldname );

  if ( fnum &lt; 0 )
    rb_raise( rb_eIndexError, &quot;no such field '%s' in result&quot;, fieldname );

  return make_column_result_array( self, fnum );
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000025">
                    
                    <a name="M000025"></a><b>res.fields() &rarr; Array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns an array of Strings representing the names of the fields in the
result.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show</a>
                        
                    </p>
                    <div id="M000025_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fields(VALUE self)
{
  PGresult *result;
  VALUE ary;
  int n, i;

  result = pgresult_get(self);
  n = PQnfields(result);
  ary = rb_ary_new2(n);
  for (i=0;i&lt;n;i++) {
    VALUE val = rb_tainted_str_new2(PQfname(result, i));
    ASSOCIATE_INDEX(val, self);
    rb_ary_push(ary, val);
  }
  return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000013">
                    
                    <a name="M000013"></a><b>res.fmod( column_number )
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the type modifier associated with column <em>column_number</em>.
See the <a href="Result.html#M000012">ftype</a> method for an example of
how to use this.
</p>
<p>
Raises an ArgumentError if <em>column_number</em> is out of range.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000013_source')" id="l_M000013_source">show</a>
                        
                    </p>
                    <div id="M000013_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fmod(VALUE self, VALUE column_number)
{
  PGresult *result = pgresult_get(self);
  int fnumber = NUM2INT(column_number);
  int modifier;
  if (fnumber &lt; 0 || fnumber &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError, &quot;Column number is out of range: %d&quot;, 
      fnumber);
  }
  modifier = PQfmod(result,fnumber);

  return INT2NUM(modifier);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000007">
                    
                    <a name="M000007"></a><b>res.fname( index ) &rarr; String
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the name of the column corresponding to <em>index</em>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fname(VALUE self, VALUE index)
{
  VALUE fname;
  PGresult *result;
  int i = NUM2INT(index);

  result = pgresult_get(self);
  if (i &lt; 0 || i &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError,&quot;invalid field number %d&quot;, i);
  }
  fname = rb_tainted_str_new2(PQfname(result, i));
  ASSOCIATE_INDEX(fname, self);
  return fname;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000008">
                    
                    <a name="M000008"></a><b>res.fnumber( name ) &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the index of the field specified by the string <em>name</em>.
</p>
<p>
Raises an ArgumentError if the specified <em>name</em> isn&#8217;t one of
the field names; raises a TypeError if <em>name</em> is not a String.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000008_source')" id="l_M000008_source">show</a>
                        
                    </p>
                    <div id="M000008_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fnumber(VALUE self, VALUE name)
{
  int n;

  Check_Type(name, T_STRING);

  n = PQfnumber(pgresult_get(self), StringValuePtr(name));
  if (n == -1) {
    rb_raise(rb_eArgError,&quot;Unknown field: %s&quot;, StringValuePtr(name));
  }
  return INT2FIX(n);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000014">
                    
                    <a name="M000014"></a><b>res.fsize( index )
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the size of the field type in bytes. Returns <tt>-1</tt> if the
field is variable sized.
</p>
<pre>
  res = conn.exec(&quot;SELECT myInt, myVarChar50 FROM foo&quot;)
  res.size(0) =&gt; 4
  res.size(1) =&gt; -1
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>static VALUE
pgresult_fsize(VALUE self, VALUE index)
{
  PGresult *result;
  int i = NUM2INT(index);

  result = pgresult_get(self);
  if (i &lt; 0 || i &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError,&quot;invalid field number %d&quot;, i);
  }
  return INT2NUM(PQfsize(result, i));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000009">
                    
                    <a name="M000009"></a><b>res.ftable( column_number ) &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the Oid of the table from which the column <em>column_number</em>
was fetched.
</p>
<p>
Raises ArgumentError if <em>column_number</em> is out of range or if the
Oid is undefined for that column.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000009_source')" id="l_M000009_source">show</a>
                        
                    </p>
                    <div id="M000009_source" class="dyn-source">
                        <pre>static VALUE
pgresult_ftable(VALUE self, VALUE column_number)
{
  Oid n ;
  int col_number = NUM2INT(column_number);
  PGresult *pgresult = pgresult_get(self);

  if( col_number &lt; 0 || col_number &gt;= PQnfields(pgresult)) 
    rb_raise(rb_eArgError,&quot;Invalid column index: %d&quot;, col_number);

  n = PQftable(pgresult, col_number);
  return INT2FIX(n);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000010">
                    
                    <a name="M000010"></a><b>res.ftablecol( column_number ) &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the column number (within its table) of the table from which the
column <em>column_number</em> is made up.
</p>
<p>
Raises ArgumentError if <em>column_number</em> is out of range or if the
column number from its table is undefined for that column.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000010_source')" id="l_M000010_source">show</a>
                        
                    </p>
                    <div id="M000010_source" class="dyn-source">
                        <pre>static VALUE
pgresult_ftablecol(VALUE self, VALUE column_number)
{
  int col_number = NUM2INT(column_number);
  PGresult *pgresult = pgresult_get(self);

  int n;

  if( col_number &lt; 0 || col_number &gt;= PQnfields(pgresult)) 
    rb_raise(rb_eArgError,&quot;Invalid column index: %d&quot;, col_number);

  n = PQftablecol(pgresult, col_number);
  return INT2FIX(n);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000012">
                    
                    <a name="M000012"></a><b>res.ftype( column_number )
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the data type associated with <em>column_number</em>.
</p>
<p>
The integer returned is the internal <tt>OID</tt> number (in PostgreSQL) of
the type. To get a human-readable value for the type, use the returned OID
and the field&#8217;s <a href="Result.html#M000013">fmod</a> value with the
format_type() SQL function:
</p>
<pre>
  # Get the type of the second column of the result 'res'
  typename = conn.
    exec( &quot;SELECT format_type($1,$2)&quot;, [res.ftype(1), res.fmod(1)] ).
    getvalue( 0, 0 )
</pre>
<p>
Raises an ArgumentError if <em>column_number</em> is out of range.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>static VALUE
pgresult_ftype(VALUE self, VALUE index)
{
  PGresult* result = pgresult_get(self);
  int i = NUM2INT(index);
  if (i &lt; 0 || i &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError, &quot;invalid field number %d&quot;, i);
  }
  return INT2NUM(PQftype(result, i));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000016">
                    
                    <a name="M000016"></a><b>res.getisnull(tuple_position, field_position) &rarr; boolean
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if the specified value is <tt>nil</tt>;
<tt>false</tt> otherwise.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000016_source')" id="l_M000016_source">show</a>
                        
                    </p>
                    <div id="M000016_source" class="dyn-source">
                        <pre>static VALUE
pgresult_getisnull(VALUE self, VALUE tup_num, VALUE field_num)
{
  PGresult *result;
  int i = NUM2INT(tup_num);
  int j = NUM2INT(field_num);

  result = pgresult_get(self);
  if (i &lt; 0 || i &gt;= PQntuples(result)) {
    rb_raise(rb_eArgError,&quot;invalid tuple number %d&quot;, i);
  }
  if (j &lt; 0 || j &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError,&quot;invalid field number %d&quot;, j);
  }
  return PQgetisnull(result, i, j) ? Qtrue : Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000017">
                    
                    <a name="M000017"></a><b>res.getlength( tup_num, field_num ) &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the (String) length of the field in bytes.
</p>
<p>
Equivalent to
<tt>res.value(<em>tup_num</em>,<em>field_num</em>).length</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000017_source')" id="l_M000017_source">show</a>
                        
                    </p>
                    <div id="M000017_source" class="dyn-source">
                        <pre>static VALUE
pgresult_getlength(VALUE self, VALUE tup_num, VALUE field_num)
{
  PGresult *result;
  int i = NUM2INT(tup_num);
  int j = NUM2INT(field_num);

  result = pgresult_get(self);
  if (i &lt; 0 || i &gt;= PQntuples(result)) {
    rb_raise(rb_eArgError,&quot;invalid tuple number %d&quot;, i);
  }
  if (j &lt; 0 || j &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError,&quot;invalid field number %d&quot;, j);
  }
  return INT2FIX(PQgetlength(result, i, j));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000015">
                    
                    <a name="M000015"></a><b>res.getvalue( tup_num, field_num )
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the value in tuple number <em>tup_num</em>, field
<em>field_num</em>, or <tt>nil</tt> if the field is <tt>NULL</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>static VALUE
pgresult_getvalue(VALUE self, VALUE tup_num, VALUE field_num)
{
  VALUE ret;
  PGresult *result;
  int i = NUM2INT(tup_num);
  int j = NUM2INT(field_num);

  result = pgresult_get(self);
  if(i &lt; 0 || i &gt;= PQntuples(result)) {
    rb_raise(rb_eArgError,&quot;invalid tuple number %d&quot;, i);
  }
  if(j &lt; 0 || j &gt;= PQnfields(result)) {
    rb_raise(rb_eArgError,&quot;invalid field number %d&quot;, j);
  }
  if(PQgetisnull(result, i, j))
    return Qnil;
  ret = rb_tainted_str_new(PQgetvalue(result, i, j), 
        PQgetlength(result, i, j));
  ASSOCIATE_INDEX(ret, self);
  return ret;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000006">
                    
                    <a name="M000006"></a><b>res.nfields() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the number of columns in the query result.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Result.html#M000032">num_fields</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000006_source')" id="l_M000006_source">show</a>
                        
                    </p>
                    <div id="M000006_source" class="dyn-source">
                        <pre>static VALUE
pgresult_nfields(VALUE self)
{
  return INT2NUM(PQnfields(pgresult_get(self)));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000018">
                    
                    <a name="M000018"></a><b>res.nparams() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the number of parameters of a prepared statement. Only useful for
the result returned by conn.describePrepared
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000018_source')" id="l_M000018_source">show</a>
                        
                    </p>
                    <div id="M000018_source" class="dyn-source">
                        <pre>static VALUE
pgresult_nparams(VALUE self)
{
  PGresult *result;

  result = pgresult_get(self);
  return INT2FIX(PQnparams(result));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000005">
                    
                    <a name="M000005"></a><b>res.ntuples() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the number of tuples in the query result.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Result.html#M000031">num_tuples</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000005_source')" id="l_M000005_source">show</a>
                        
                    </p>
                    <div id="M000005_source" class="dyn-source">
                        <pre>static VALUE
pgresult_ntuples(VALUE self)
{
  return INT2FIX(PQntuples(pgresult_get(self)));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000032">
                    
                    <a name="M000032"></a><b>num_fields</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Result.html#M000006">nfields</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000031">
                    
                    <a name="M000031"></a><b>num_tuples</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Result.html#M000005">ntuples</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000022">
                    
                    <a name="M000022"></a><b>res.oid_value() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the <tt>oid</tt> of the inserted row if applicable, otherwise
<tt>nil</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000022_source')" id="l_M000022_source">show</a>
                        
                    </p>
                    <div id="M000022_source" class="dyn-source">
                        <pre>static VALUE
pgresult_oid_value(VALUE self)
{
  Oid n = PQoidValue(pgresult_get(self));
  if (n == InvalidOid)
    return Qnil;
  else
    return INT2FIX(n);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000019">
                    
                    <a name="M000019"></a><b>res.paramtype( param_number ) &rarr; Oid
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the Oid of the data type of parameter <em>param_number</em>. Only
useful for the result returned by conn.describePrepared
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000019_source')" id="l_M000019_source">show</a>
                        
                    </p>
                    <div id="M000019_source" class="dyn-source">
                        <pre>static VALUE
pgresult_paramtype(VALUE self, VALUE param_number)
{
  PGresult *result;

  result = pgresult_get(self);
  return INT2FIX(PQparamtype(result,NUM2INT(param_number)));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000001">
                    
                    <a name="M000001"></a><b>res.res_status( status ) &rarr; String
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the string representation of status <tt>status</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000001_source')" id="l_M000001_source">show</a>
                        
                    </p>
                    <div id="M000001_source" class="dyn-source">
                        <pre>static VALUE
pgresult_res_status(VALUE self, VALUE status)
{
  VALUE ret = rb_tainted_str_new2(PQresStatus(NUM2INT(status)));
  ASSOCIATE_INDEX(ret, self);
  return ret;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000030">
                    
                    <a name="M000030"></a><b>result_error_field</b>(p1)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Result.html#M000003">error_field</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000029">
                    
                    <a name="M000029"></a><b>result_error_message</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Result.html#M000002">error_message</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000000">
                    
                    <a name="M000000"></a><b>res.result_status() &rarr; Fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the status of the query. The status value is one of:
</p>
<ul>
<li><tt>PGRES_EMPTY_QUERY</tt>

</li>
<li><tt>PGRES_COMMAND_OK</tt>

</li>
<li><tt>PGRES_TUPLES_OK</tt>

</li>
<li><tt>PGRES_COPY_OUT</tt>

</li>
<li><tt>PGRES_COPY_IN</tt>

</li>
<li><tt>PGRES_BAD_RESPONSE</tt>

</li>
<li><tt>PGRES_NONFATAL_ERROR</tt>

</li>
<li><tt>PGRES_FATAL_ERROR</tt>

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000000_source')" id="l_M000000_source">show</a>
                        
                    </p>
                    <div id="M000000_source" class="dyn-source">
                        <pre>static VALUE
pgresult_result_status(VALUE self)
{
  return INT2FIX(PQresultStatus(pgresult_get(self)));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000026">
                    
                    <a name="M000026"></a><b>res.values &rarr; Array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns all tuples as an array of arrays.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show</a>
                        
                    </p>
                    <div id="M000026_source" class="dyn-source">
                        <pre>static VALUE
pgresult_values(VALUE self)
{
  PGresult* result = (PGresult*) pgresult_get(self);
  int row;
  int field;
  int num_rows = PQntuples(result);
  int num_fields = PQnfields(result);
  VALUE ary = rb_ary_new2(num_rows);

  for ( row = 0; row &lt; num_rows; row++ ) {
    /* create new row */
    VALUE new_row = rb_ary_new2(num_fields);

    /* add to return array */
    rb_ary_store( ary, row, new_row );

    /* populate it */
    for ( field = 0; field &lt; num_fields; field++ ) {
      if ( PQgetisnull(result, row, field) ) {
        rb_ary_store( new_row, field, Qnil );
      }
      else {
        VALUE val = rb_tainted_str_new( PQgetvalue(result, row, field), 
                                        PQgetlength(result, row, field) );

#ifdef M17N_SUPPORTED
        /* associate client encoding for text format only */
        if ( 0 == PQfformat(result, field) ) {
          ASSOCIATE_INDEX( val, self );
        } else {
          rb_enc_associate( val, rb_ascii8bit_encoding() );
        }
#endif

        rb_ary_store( new_row, field, val );
      }
    }
  }
  return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    