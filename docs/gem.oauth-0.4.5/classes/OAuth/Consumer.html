<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>OAuth::Consumer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            OAuth::Consumer 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/oauth/consumer_rb.html">lib/oauth/consumer.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000078">access_token_path</a>,</li>
                
                <li><a href="#M000083">access_token_url</a>,</li>
                
                <li><a href="#M000084">access_token_url?</a>,</li>
                
                <li><a href="#M000077">authorize_path</a>,</li>
                
                <li><a href="#M000081">authorize_url</a>,</li>
                
                <li><a href="#M000082">authorize_url?</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000086">create_http</a>,</li>
                
                <li><a href="#M000087">create_http_request</a>,</li>
                
                <li><a href="#M000067">create_signed_request</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000064">get_access_token</a>,</li>
                
                <li><a href="#M000065">get_request_token</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000062">http</a>,</li>
                
                <li><a href="#M000061">http_method</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000090">marshal_dump</a>,</li>
                
                <li><a href="#M000091">marshal_load</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000060">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000085">proxy</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000066">request</a>,</li>
                
                <li><a href="#M000074">request_endpoint</a>,</li>
                
                <li><a href="#M000076">request_token_path</a>,</li>
                
                <li><a href="#M000079">request_token_url</a>,</li>
                
                <li><a href="#M000080">request_token_url?</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000075">scheme</a>,</li>
                
                <li><a href="#M000069">sign!</a>,</li>
                
                <li><a href="#M000070">signature_base_string</a>,</li>
                
                <li><a href="#M000073">site</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000068">token_request</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M000063">uri</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">CA_FILES</td>
            <td>=</td>
            <td class="attr-value">%w(/etc/ssl/certs/ca-certificates.crt /usr/share/curl/curl-ca-bundle.crt)</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
determine the certificate authority path to verify SSL certs
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">CA_FILE</td>
            <td>=</td>
            <td class="attr-value">ca_file</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">CA_FILE</td>
            <td>=</td>
            <td class="attr-value">nil unless defined?(CA_FILE)</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>key</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>secret</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [W]
            </td>
            <td class='attr-name'>site</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [W]
            </td>
            <td class='attr-name'>http</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000060">
                    
                    <a name="M000060"></a><b>new</b>(consumer_key, consumer_secret, options = {})
                    
                </div>
                
                <div class="description">
                  <p>
Create a new consumer instance by passing it a configuration hash:
</p>
<pre>
  @consumer = OAuth::Consumer.new(key, secret, {
    :site               =&gt; &quot;http://term.ie&quot;,
    :scheme             =&gt; :header,
    :http_method        =&gt; :post,
    :request_token_path =&gt; &quot;/oauth/example/request_token.php&quot;,
    :access_token_path  =&gt; &quot;/oauth/example/access_token.php&quot;,
    :authorize_path     =&gt; &quot;/oauth/example/authorize.php&quot;
   })
</pre>
<p>
Start the process by requesting a token
</p>
<pre>
  @request_token = @consumer.get_request_token
  session[:request_token] = @request_token
  redirect_to @request_token.authorize_url
</pre>
<p>
When user returns create an access_token
</p>
<pre>
  @access_token = @request_token.get_access_token
  @photos=@access_token.get('/photos.xml')
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000060_source')" id="l_M000060_source">show</a>
                        
                    </p>
                    <div id="M000060_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 77</span>
77:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">consumer_key</span>, <span class="ruby-identifier">consumer_secret</span>, <span class="ruby-identifier">options</span> = {})
78:       <span class="ruby-ivar">@key</span>    = <span class="ruby-identifier">consumer_key</span>
79:       <span class="ruby-ivar">@secret</span> = <span class="ruby-identifier">consumer_secret</span>
80: 
81:       <span class="ruby-comment cmt"># ensure that keys are symbols</span>
82:       <span class="ruby-ivar">@options</span> = <span class="ruby-ivar">@@default_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opts</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
83:         <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
84:         <span class="ruby-identifier">opts</span>
85:       <span class="ruby-keyword kw">end</span>)
86:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000078">
                    
                    <a name="M000078"></a><b>access_token_path</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000078_source')" id="l_M000078_source">show</a>
                        
                    </p>
                    <div id="M000078_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">access_token_path</span>
257:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:access_token_path</span>]
258:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000083">
                    
                    <a name="M000083"></a><b>access_token_url</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000083_source')" id="l_M000083_source">show</a>
                        
                    </p>
                    <div id="M000083_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 277</span>
277:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">access_token_url</span>
278:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:access_token_url</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">site</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">access_token_path</span>
279:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000084">
                    
                    <a name="M000084"></a><b>access_token_url?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000084_source')" id="l_M000084_source">show</a>
                        
                    </p>
                    <div id="M000084_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 281</span>
281:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">access_token_url?</span>
282:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:access_token_url</span>)
283:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000077">
                    
                    <a name="M000077"></a><b>authorize_path</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000077_source')" id="l_M000077_source">show</a>
                        
                    </p>
                    <div id="M000077_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 252</span>
252:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize_path</span>
253:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:authorize_path</span>]
254:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000081">
                    
                    <a name="M000081"></a><b>authorize_url</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000081_source')" id="l_M000081_source">show</a>
                        
                    </p>
                    <div id="M000081_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 269</span>
269:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize_url</span>
270:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:authorize_url</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">site</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">authorize_path</span>
271:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000082">
                    
                    <a name="M000082"></a><b>authorize_url?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000082_source')" id="l_M000082_source">show</a>
                        
                    </p>
                    <div id="M000082_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 273</span>
273:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize_url?</span>
274:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:authorize_url</span>)
275:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000067">
                    
                    <a name="M000067"></a><b>create_signed_request</b>(http_method, path, token = nil, request_options = {}, *arguments)
                    
                </div>
                
                <div class="description">
                  <p>
Creates and signs an http request. It&#8217;s recommended to use the <a
href="Token.html">Token</a> classes to set this up correctly
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000067_source')" id="l_M000067_source">show</a>
                        
                    </p>
                    <div id="M000067_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 189</span>
189:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_signed_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span> = {}, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
190:       <span class="ruby-identifier">request</span> = <span class="ruby-identifier">create_http_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
191:       <span class="ruby-identifier">sign!</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">request_options</span>)
192:       <span class="ruby-identifier">request</span>
193:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000064">
                    
                    <a name="M000064"></a><b>get_access_token</b>(request_token, request_options = {}, *arguments, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000064_source')" id="l_M000064_source">show</a>
                        
                    </p>
                    <div id="M000064_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 108</span>
108:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_access_token</span>(<span class="ruby-identifier">request_token</span>, <span class="ruby-identifier">request_options</span> = {}, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
109:       <span class="ruby-identifier">response</span> = <span class="ruby-identifier">token_request</span>(<span class="ruby-identifier">http_method</span>, (<span class="ruby-identifier">access_token_url?</span> <span class="ruby-value">? </span><span class="ruby-identifier">access_token_url</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">access_token_path</span>), <span class="ruby-identifier">request_token</span>, <span class="ruby-identifier">request_options</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
110:       <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">AccessToken</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">response</span>)
111:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000065">
                    
                    <a name="M000065"></a><b>get_request_token</b>(request_options = {}, *arguments, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Makes a request to the service for a new <a
href="RequestToken.html">OAuth::RequestToken</a>
</p>
<pre>
 @request_token = @consumer.get_request_token
</pre>
<p>
To include <a href="../OAuth.html">OAuth</a> parameters:
</p>
<pre>
 @request_token = @consumer.get_request_token      #    :oauth_callback =&gt; &quot;http://example.com/cb&quot;
</pre>
<p>
To include application-specific parameters:
</p>
<pre>
 @request_token = @consumer.get_request_token({}, :foo =&gt; &quot;bar&quot;)
</pre>
<p>
<a href="../../files/TODO.html">TODO</a> oauth_callback should be a
mandatory parameter
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000065_source')" id="l_M000065_source">show</a>
                        
                    </p>
                    <div id="M000065_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 127</span>
127:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_request_token</span>(<span class="ruby-identifier">request_options</span> = {}, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
128:       <span class="ruby-comment cmt"># if oauth_callback wasn't provided, it is assumed that oauth_verifiers</span>
129:       <span class="ruby-comment cmt"># will be exchanged out of band</span>
130:       <span class="ruby-identifier">request_options</span>[<span class="ruby-identifier">:oauth_callback</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">OUT_OF_BAND</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">request_options</span>[<span class="ruby-identifier">:exclude_callback</span>]
131: 
132:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
133:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">token_request</span>(<span class="ruby-identifier">http_method</span>,
134:         (<span class="ruby-identifier">request_token_url?</span> <span class="ruby-value">? </span><span class="ruby-identifier">request_token_url</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">request_token_path</span>),
135:         <span class="ruby-keyword kw">nil</span>,
136:         <span class="ruby-identifier">request_options</span>,
137:         <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
138:       <span class="ruby-keyword kw">else</span>
139:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">token_request</span>(<span class="ruby-identifier">http_method</span>, (<span class="ruby-identifier">request_token_url?</span> <span class="ruby-value">? </span><span class="ruby-identifier">request_token_url</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">request_token_path</span>), <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
140:       <span class="ruby-keyword kw">end</span>
141:       <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">RequestToken</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">response</span>)
142:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000062">
                    
                    <a name="M000062"></a><b>http</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The HTTP object for the site. The HTTP <a href="../Object.html">Object</a>
is what you get when you do Net::HTTP.new
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000062_source')" id="l_M000062_source">show</a>
                        
                    </p>
                    <div id="M000062_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 94</span>
94:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">http</span>
95:       <span class="ruby-ivar">@http</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">create_http</span>
96:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000061">
                    
                    <a name="M000061"></a><b>http_method</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The default http method
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000061_source')" id="l_M000061_source">show</a>
                        
                    </p>
                    <div id="M000061_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 89</span>
89:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">http_method</span>
90:       <span class="ruby-ivar">@http_method</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:http_method</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">:post</span>
91:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000085">
                    
                    <a name="M000085"></a><b>proxy</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000085_source')" id="l_M000085_source">show</a>
                        
                    </p>
                    <div id="M000085_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 285</span>
285:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy</span>
286:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:proxy</span>]
287:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000066">
                    
                    <a name="M000066"></a><b>request</b>(http_method, path, token = nil, request_options = {}, *arguments)
                    
                </div>
                
                <div class="description">
                  <p>
Creates, signs and performs an http request. It&#8217;s recommended to use
the <a href="Token.html">OAuth::Token</a> classes to set this up correctly.
request_options take precedence over consumer-wide options when signing
</p>
<pre>
  a request.
</pre>
<p>
arguments are POST and PUT bodies (a Hash, string-encoded parameters, or
</p>
<pre>
  absent), followed by additional HTTP headers.

  @consumer.request(:get,  '/people', @token, { :scheme =&gt; :query_string })
  @consumer.request(:post, '/people', @token, {}, @person.to_xml, { 'Content-Type' =&gt; 'application/xml' })
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000066_source')" id="l_M000066_source">show</a>
                        
                    </p>
                    <div id="M000066_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 154</span>
154:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span> = {}, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
155:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/^\//</span>
156:         <span class="ruby-ivar">@http</span> = <span class="ruby-identifier">create_http</span>(<span class="ruby-identifier">path</span>)
157:         <span class="ruby-identifier">_uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">path</span>)
158:         <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;#{_uri.path}#{_uri.query ? &quot;?#{_uri.query}&quot; : &quot;&quot;}&quot;</span>
159:       <span class="ruby-keyword kw">end</span>
160: 
161:       <span class="ruby-comment cmt"># override the request with your own, this is useful for file uploads which Net::HTTP does not do</span>
162:       <span class="ruby-identifier">req</span> = <span class="ruby-identifier">create_signed_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">request_options</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
163:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">req</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">:done</span>
164:       <span class="ruby-identifier">rsp</span> = <span class="ruby-identifier">http</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">req</span>)
165:       <span class="ruby-comment cmt"># check for an error reported by the Problem Reporting extension</span>
166:       <span class="ruby-comment cmt"># (http://wiki.oauth.net/ProblemReporting)</span>
167:       <span class="ruby-comment cmt"># note: a 200 may actually be an error; check for an oauth_problem key to be sure</span>
168:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">headers</span> = <span class="ruby-identifier">rsp</span>.<span class="ruby-identifier">to_hash</span>[<span class="ruby-value str">&quot;www-authenticate&quot;</span>]).<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span>
169:         (<span class="ruby-identifier">h</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">hdr</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hdr</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^OAuth /</span> }).<span class="ruby-identifier">any?</span> <span class="ruby-operator">&amp;&amp;</span>
170:         <span class="ruby-identifier">h</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/oauth_problem/</span>
171: 
172:         <span class="ruby-comment cmt"># puts &quot;Header: #{h.first}&quot;</span>
173: 
174:         <span class="ruby-comment cmt"># TODO doesn't handle broken responses from api.login.yahoo.com</span>
175:         <span class="ruby-comment cmt"># remove debug code when done</span>
176:         <span class="ruby-identifier">params</span> = <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">Helper</span>.<span class="ruby-identifier">parse_header</span>(<span class="ruby-identifier">h</span>.<span class="ruby-identifier">first</span>)
177: 
178:         <span class="ruby-comment cmt"># puts &quot;Params: #{params.inspect}&quot;</span>
179:         <span class="ruby-comment cmt"># puts &quot;Body: #{rsp.body}&quot;</span>
180: 
181:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">Problem</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">&quot;oauth_problem&quot;</span>), <span class="ruby-identifier">rsp</span>, <span class="ruby-identifier">params</span>)
182:       <span class="ruby-keyword kw">end</span>
183: 
184:       <span class="ruby-identifier">rsp</span>
185:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000074">
                    
                    <a name="M000074"></a><b>request_endpoint</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000074_source')" id="l_M000074_source">show</a>
                        
                    </p>
                    <div id="M000074_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 239</span>
239:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_endpoint</span>
240:   <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:request_endpoint</span>].<span class="ruby-identifier">nil?</span>
241:   <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:request_endpoint</span>].<span class="ruby-identifier">to_s</span>
242:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000076">
                    
                    <a name="M000076"></a><b>request_token_path</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000076_source')" id="l_M000076_source">show</a>
                        
                    </p>
                    <div id="M000076_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 248</span>
248:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_token_path</span>
249:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:request_token_path</span>]
250:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000079">
                    
                    <a name="M000079"></a><b>request_token_url</b>()
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../../files/TODO.html">TODO</a> this is ugly, rewrite
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000079_source')" id="l_M000079_source">show</a>
                        
                    </p>
                    <div id="M000079_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 261</span>
261:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_token_url</span>
262:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:request_token_url</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">site</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">request_token_path</span>
263:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000080">
                    
                    <a name="M000080"></a><b>request_token_url?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000080_source')" id="l_M000080_source">show</a>
                        
                    </p>
                    <div id="M000080_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 265</span>
265:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_token_url?</span>
266:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:request_token_url</span>)
267:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000075">
                    
                    <a name="M000075"></a><b>scheme</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000075_source')" id="l_M000075_source">show</a>
                        
                    </p>
                    <div id="M000075_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 244</span>
244:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scheme</span>
245:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:scheme</span>]
246:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000069">
                    
                    <a name="M000069"></a><b>sign!</b>(request, token = nil, request_options = {})
                    
                </div>
                
                <div class="description">
                  <p>
Sign the Request object. Use this if you have an externally generated http
request object you want to sign.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000069_source')" id="l_M000069_source">show</a>
                        
                    </p>
                    <div id="M000069_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 226</span>
226:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sign!</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span> = {})
227:       <span class="ruby-identifier">request</span>.<span class="ruby-identifier">oauth!</span>(<span class="ruby-identifier">http</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">request_options</span>))
228:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000070">
                    
                    <a name="M000070"></a><b>signature_base_string</b>(request, token = nil, request_options = {})
                    
                </div>
                
                <div class="description">
                  <p>
Return the <a href="Consumer.html#M000070">signature_base_string</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000070_source')" id="l_M000070_source">show</a>
                        
                    </p>
                    <div id="M000070_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 231</span>
231:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">signature_base_string</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span> = {})
232:       <span class="ruby-identifier">request</span>.<span class="ruby-identifier">signature_base_string</span>(<span class="ruby-identifier">http</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">request_options</span>))
233:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000073">
                    
                    <a name="M000073"></a><b>site</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000073_source')" id="l_M000073_source">show</a>
                        
                    </p>
                    <div id="M000073_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 235</span>
235:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">site</span>
236:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:site</span>].<span class="ruby-identifier">to_s</span>
237:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000068">
                    
                    <a name="M000068"></a><b>token_request</b>(http_method, path, token = nil, request_options = {}, *arguments)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a request and parses the result as url_encoded. This is used
internally for the <a href="RequestToken.html">RequestToken</a> and <a
href="AccessToken.html">AccessToken</a> requests.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000068_source')" id="l_M000068_source">show</a>
                        
                    </p>
                    <div id="M000068_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 196</span>
196:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">token_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">request_options</span> = {}, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
197:       <span class="ruby-identifier">response</span> = <span class="ruby-identifier">request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">request_options</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
198:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>.<span class="ruby-identifier">to_i</span>
199: 
200:       <span class="ruby-keyword kw">when</span> (<span class="ruby-value">200</span><span class="ruby-operator">..</span><span class="ruby-value">299</span>)
201:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
202:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
203:         <span class="ruby-keyword kw">else</span>
204:           <span class="ruby-comment cmt"># symbolize keys</span>
205:           <span class="ruby-comment cmt"># TODO this could be considered unexpected behavior; symbols or not?</span>
206:           <span class="ruby-comment cmt"># TODO this also drops subsequent values from multi-valued keys</span>
207:           <span class="ruby-constant">CGI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>).<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,(<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>)<span class="ruby-operator">|</span>
208:             <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">first</span>
209:             <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">strip</span>]        = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">first</span>
210:             <span class="ruby-identifier">h</span>
211:           <span class="ruby-keyword kw">end</span>
212:         <span class="ruby-keyword kw">end</span>
213:       <span class="ruby-keyword kw">when</span> (<span class="ruby-value">300</span><span class="ruby-operator">..</span><span class="ruby-value">399</span>)
214:         <span class="ruby-comment cmt"># this is a redirect</span>
215:         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'location'</span>])
216:         <span class="ruby-identifier">response</span>.<span class="ruby-identifier">error!</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">path</span> <span class="ruby-comment cmt"># careful of those infinite redirects</span>
217:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">token_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">request_options</span>, <span class="ruby-identifier">arguments</span>)
218:       <span class="ruby-keyword kw">when</span> (<span class="ruby-value">400</span><span class="ruby-operator">..</span><span class="ruby-value">499</span>)
219:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">OAuth</span><span class="ruby-operator">::</span><span class="ruby-constant">Unauthorized</span>, <span class="ruby-identifier">response</span>
220:       <span class="ruby-keyword kw">else</span>
221:         <span class="ruby-identifier">response</span>.<span class="ruby-identifier">error!</span>
222:       <span class="ruby-keyword kw">end</span>
223:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000063">
                    
                    <a name="M000063"></a><b>uri</b>(custom_uri = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Contains the root URI for this site
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000063_source')" id="l_M000063_source">show</a>
                        
                    </p>
                    <div id="M000063_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 99</span>
 99:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">uri</span>(<span class="ruby-identifier">custom_uri</span> = <span class="ruby-keyword kw">nil</span>)
100:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">custom_uri</span>
101:         <span class="ruby-ivar">@uri</span>  = <span class="ruby-identifier">custom_uri</span>
102:         <span class="ruby-ivar">@http</span> = <span class="ruby-identifier">create_http</span> <span class="ruby-comment cmt"># yike, oh well. less intrusive this way</span>
103:       <span class="ruby-keyword kw">else</span>  <span class="ruby-comment cmt"># if no custom passed, we use existing, which, if unset, is set to site uri</span>
104:         <span class="ruby-ivar">@uri</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">site</span>)
105:       <span class="ruby-keyword kw">end</span>
106:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000086">
                    
                    <a name="M000086"></a><b>create_http</b>(_url = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Instantiates the http object
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000086_source')" id="l_M000086_source">show</a>
                        
                    </p>
                    <div id="M000086_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 292</span>
292:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_http</span>(<span class="ruby-identifier">_url</span> = <span class="ruby-keyword kw">nil</span>)
293: 
294: 
295:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">request_endpoint</span>.<span class="ruby-identifier">nil?</span>
296:        <span class="ruby-identifier">_url</span> = <span class="ruby-identifier">request_endpoint</span>
297:       <span class="ruby-keyword kw">end</span>
298: 
299: 
300:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">_url</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">_url</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\//</span>
301:         <span class="ruby-identifier">our_uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">site</span>)
302:       <span class="ruby-keyword kw">else</span>
303:         <span class="ruby-identifier">our_uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">_url</span>)
304:       <span class="ruby-keyword kw">end</span>
305: 
306: 
307:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">nil?</span>
308:         <span class="ruby-identifier">http_object</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">our_uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">our_uri</span>.<span class="ruby-identifier">port</span>)
309:       <span class="ruby-keyword kw">else</span>
310:         <span class="ruby-identifier">proxy_uri</span> = <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">URI</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">proxy</span> <span class="ruby-operator">:</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">proxy</span>)
311:         <span class="ruby-identifier">http_object</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">our_uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">our_uri</span>.<span class="ruby-identifier">port</span>, <span class="ruby-identifier">proxy_uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">proxy_uri</span>.<span class="ruby-identifier">port</span>, <span class="ruby-identifier">proxy_uri</span>.<span class="ruby-identifier">user</span>, <span class="ruby-identifier">proxy_uri</span>.<span class="ruby-identifier">password</span>)
312:       <span class="ruby-keyword kw">end</span>
313: 
314:       <span class="ruby-identifier">http_object</span>.<span class="ruby-identifier">use_ssl</span> = (<span class="ruby-identifier">our_uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'https'</span>)
315: 
316:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ca_file</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">CA_FILE</span>
317:         <span class="ruby-identifier">http_object</span>.<span class="ruby-identifier">ca_file</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ca_file</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">CA_FILE</span>
318:         <span class="ruby-identifier">http_object</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_PEER</span>
319:         <span class="ruby-identifier">http_object</span>.<span class="ruby-identifier">verify_depth</span> = <span class="ruby-value">5</span>
320:       <span class="ruby-keyword kw">else</span>
321:         <span class="ruby-identifier">http_object</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
322:       <span class="ruby-keyword kw">end</span>
323:       <span class="ruby-identifier">http_object</span>
324:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000087">
                    
                    <a name="M000087"></a><b>create_http_request</b>(http_method, path, *arguments)
                    
                </div>
                
                <div class="description">
                  <p>
create the http request object for a given <a
href="Consumer.html#M000061">http_method</a> and path
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000087_source')" id="l_M000087_source">show</a>
                        
                    </p>
                    <div id="M000087_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 327</span>
327:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_http_request</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arguments</span>)
328:       <span class="ruby-identifier">http_method</span> = <span class="ruby-identifier">http_method</span>.<span class="ruby-identifier">to_sym</span>
329: 
330:       <span class="ruby-keyword kw">if</span> [<span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:put</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">http_method</span>)
331:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">arguments</span>.<span class="ruby-identifier">shift</span>
332:       <span class="ruby-keyword kw">end</span>
333: 
334:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">arguments</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">arguments</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">:</span> {}
335: 
336:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">http_method</span>
337:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:post</span>
338:         <span class="ruby-identifier">request</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Post</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">headers</span>)
339:         <span class="ruby-identifier">request</span>[<span class="ruby-value str">&quot;Content-Length&quot;</span>] = <span class="ruby-value str">'0'</span> <span class="ruby-comment cmt"># Default to 0</span>
340:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:put</span>
341:         <span class="ruby-identifier">request</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Put</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">headers</span>)
342:         <span class="ruby-identifier">request</span>[<span class="ruby-value str">&quot;Content-Length&quot;</span>] = <span class="ruby-value str">'0'</span> <span class="ruby-comment cmt"># Default to 0</span>
343:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:get</span>
344:         <span class="ruby-identifier">request</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Get</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">headers</span>)
345:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:delete</span>
346:         <span class="ruby-identifier">request</span> =  <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Delete</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">headers</span>)
347:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:head</span>
348:         <span class="ruby-identifier">request</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Head</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">headers</span>)
349:       <span class="ruby-keyword kw">else</span>
350:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Don't know how to handle http_method: :#{http_method.to_s}&quot;</span>
351:       <span class="ruby-keyword kw">end</span>
352: 
353:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
354:         <span class="ruby-identifier">form_data</span> = {}
355:         <span class="ruby-identifier">data</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">form_data</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-identifier">v</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>}
356:         <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_form_data</span>(<span class="ruby-identifier">form_data</span>)
357:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">data</span>
358:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:read</span>)
359:           <span class="ruby-identifier">request</span>.<span class="ruby-identifier">body_stream</span> = <span class="ruby-identifier">data</span>
360:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:length</span>)
361:             <span class="ruby-identifier">request</span>[<span class="ruby-value str">&quot;Content-Length&quot;</span>] = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>.<span class="ruby-identifier">to_s</span>
362:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:stat</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">stat</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:size</span>)
363:             <span class="ruby-identifier">request</span>[<span class="ruby-value str">&quot;Content-Length&quot;</span>] = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">stat</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span>
364:           <span class="ruby-keyword kw">else</span>
365:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;Don't know how to send a body_stream that doesn't respond to .length or .stat.size&quot;</span>
366:           <span class="ruby-keyword kw">end</span>
367:         <span class="ruby-keyword kw">else</span>
368:           <span class="ruby-identifier">request</span>.<span class="ruby-identifier">body</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>
369:           <span class="ruby-identifier">request</span>[<span class="ruby-value str">&quot;Content-Length&quot;</span>] = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">length</span>.<span class="ruby-identifier">to_s</span>
370:         <span class="ruby-keyword kw">end</span>
371:       <span class="ruby-keyword kw">end</span>
372: 
373:       <span class="ruby-identifier">request</span>
374:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000090">
                    
                    <a name="M000090"></a><b>marshal_dump</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000090_source')" id="l_M000090_source">show</a>
                        
                    </p>
                    <div id="M000090_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 376</span>
376:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">marshal_dump</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
377:       {<span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@key</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@secret</span>, <span class="ruby-identifier">:options</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@options</span>}
378:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000091">
                    
                    <a name="M000091"></a><b>marshal_load</b>(data)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000091_source')" id="l_M000091_source">show</a>
                        
                    </p>
                    <div id="M000091_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/oauth/consumer.rb, line 380</span>
380:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">marshal_load</span>(<span class="ruby-identifier">data</span>)
381:       <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">data</span>[<span class="ruby-identifier">:key</span>], <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:secret</span>], <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:options</span>])
382:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    