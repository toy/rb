<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>PhusionPassenger::PlatformInfo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            PhusionPassenger::PlatformInfo 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/apache_rb.html">lib/phusion_passenger/platform_info/apache.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/binary_compatibility_rb.html">lib/phusion_passenger/platform_info/binary_compatibility.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/compiler_rb.html">lib/phusion_passenger/platform_info/compiler.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/curl_rb.html">lib/phusion_passenger/platform_info/curl.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/documentation_tools_rb.html">lib/phusion_passenger/platform_info/documentation_tools.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/linux_rb.html">lib/phusion_passenger/platform_info/linux.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/operating_system_rb.html">lib/phusion_passenger/platform_info/operating_system.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/ruby_rb.html">lib/phusion_passenger/platform_info/ruby.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info/zlib_rb.html">lib/phusion_passenger/platform_info/zlib.rb</a></li>
            
            <li><a href="../../files/lib/phusion_passenger/platform_info_rb.html">lib/phusion_passenger/platform_info.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Users can change the detection behavior by setting the environment variable
<tt>APXS2</tt> to the correct &#8216;apxs&#8217; (or &#8216;apxs2&#8217;)
binary, as provided by Apache.
</p>
<hr size="1"></hr><p>
This module autodetects various platform-specific information, and provides
that information through constants.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000263">apache2_bindir</a>,</li>
                
                <li><a href="#M000265">apache2_module_cflags</a>,</li>
                
                <li><a href="#M000267">apache2_module_ldflags</a>,</li>
                
                <li><a href="#M000264">apache2_sbindir</a>,</li>
                
                <li><a href="#M000258">apache2ctl</a>,</li>
                
                <li><a href="#M000260">apr_config</a>,</li>
                
                <li><a href="#M000272">apr_config_needed_for_building_apache_modules?</a>,</li>
                
                <li><a href="#M000268">apr_flags</a>,</li>
                
                <li><a href="#M000269">apr_libs</a>,</li>
                
                <li><a href="#M000261">apu_config</a>,</li>
                
                <li><a href="#M000270">apu_flags</a>,</li>
                
                <li><a href="#M000271">apu_libs</a>,</li>
                
                <li><a href="#M000257">apxs2</a>,</li>
                
                <li><a href="#M000292">asciidoc</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000318">cache_dir=</a>,</li>
                
                <li><a href="#M000336">cc</a>,</li>
                
                <li><a href="#M000277">compiler_supports_architecture?</a>,</li>
                
                <li><a href="#M000281">compiler_supports_no_tls_direct_seg_refs_option?</a>,</li>
                
                <li><a href="#M000278">compiler_supports_visibility_flag?</a>,</li>
                
                <li><a href="#M000279">compiler_supports_wno_attributes_flag?</a>,</li>
                
                <li><a href="#M000280">compiler_supports_wno_missing_field_initializers_flag?</a>,</li>
                
                <li><a href="#M000282">compiler_visibility_flag_generates_warnings?</a>,</li>
                
                <li><a href="#M000297">cpu_architectures</a>,</li>
                
                <li><a href="#M000286">curl_flags</a>,</li>
                
                <li><a href="#M000287">curl_libs</a>,</li>
                
                <li><a href="#M000288">curl_supports_ssl?</a>,</li>
                
                <li><a href="#M000337">cxx</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000290">debugging_cflags</a>,</li>
                
                <li><a href="#M000274">determine_apr_info</a>,</li>
                
                <li><a href="#M000275">determine_apu_info</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000330">env_defined?</a>,</li>
                
                <li><a href="#M000291">export_dynamic_flags</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000273">find_apache2_executable</a>,</li>
                
                <li><a href="#M000329">find_command</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000304">gem_command</a>,</li>
                
                <li><a href="#M000276">gnu_make</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000284">has_alloca_h?</a>,</li>
                
                <li><a href="#M000283">has_math_library?</a>,</li>
                
                <li><a href="#M000259">httpd</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000308">in_rvm?</a>,</li>
                
                <li><a href="#M000316">is_ruby_program?</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000296">library_extension</a>,</li>
                
                <li><a href="#M000293">linux_distro</a>,</li>
                
                <li><a href="#M000294">linux_distro_tags</a>,</li>
                
                <li><a href="#M000314">locate_ruby_tool</a>,</li>
                
                <li><a href="#M000315">locate_ruby_tool_by_basename</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M000320">memoize</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000295">os_name</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000266">passenger_binary_compatibility_id</a>,</li>
                
                <li><a href="#M000285">portability_cflags</a>,</li>
                
                <li><a href="#M000289">portability_ldflags</a>,</li>
                
                <li><a href="#M000319">private_class_method</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000305">rake</a>,</li>
                
                <li><a href="#M000306">rake_command</a>,</li>
                
                <li><a href="#M000346">rb_config</a>,</li>
                
                <li><a href="#M000328">read_file</a>,</li>
                
                <li><a href="#M000301">requires_no_tls_direct_seg_refs?</a>,</li>
                
                <li><a href="#M000307">rspec</a>,</li>
                
                <li><a href="#M000298">ruby_command</a>,</li>
                
                <li><a href="#M000302">ruby_executable</a>,</li>
                
                <li><a href="#M000262">ruby_extension_binary_compatibility_ids</a>,</li>
                
                <li><a href="#M000313">ruby_sudo_command</a>,</li>
                
                <li><a href="#M000303">ruby_supports_fork?</a>,</li>
                
                <li><a href="#M000309">rvm_path</a>,</li>
                
                <li><a href="#M000310">rvm_ruby_string</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000326">select_executable</a>,</li>
                
                <li><a href="#M000300">supports_lfence_instruction?</a>,</li>
                
                <li><a href="#M000299">supports_sfence_instruction?</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000331">tmpdir</a>,</li>
                
                <li><a href="#M000332">tmpexedir</a>,</li>
                
                <li><a href="#M000317">transform_according_to_ruby_exec_format</a>,</li>
                
                <li><a href="#M000338">try_compile</a>,</li>
                
                <li><a href="#M000344">try_compile_and_run</a>,</li>
                
                <li><a href="#M000341">try_link</a></li>
                
            </ul>
        </dd>
    
        <dt>Z</dt>
        <dd>
            <ul>
                
                <li><a href="#M000311">zlib_flags</a>,</li>
                
                <li><a href="#M000312">zlib_libs</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="PlatformInfo/RuntimeError.html">PhusionPassenger::PlatformInfo::RuntimeError</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">GEM_HOME</td>
            <td>=</td>
            <td class="attr-value">gem_home</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RUBY_ENGINE</td>
            <td>=</td>
            <td class="attr-value">::RUBY_ENGINE</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RUBY_ENGINE</td>
            <td>=</td>
            <td class="attr-value">&quot;ruby&quot;</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000263">
                    
                    <a name="M000263"></a><b>apache2_bindir</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the Apache 2 &#8216;bin&#8217; directory, or nil if
unknown.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000263_source')" id="l_M000263_source">show</a>
                        
                    </p>
                    <div id="M000263_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 140</span>
140:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apache2_bindir</span>
141:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
142:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
143:     <span class="ruby-keyword kw">else</span>
144:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">`#{apxs2} -q BINDIR 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
145:     <span class="ruby-keyword kw">end</span>
146:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000265">
                    
                    <a name="M000265"></a><b>apache2_module_cflags</b>(with_apr_flags = true)
                    
                </div>
                
                <div class="description">
                  <p>
The C compiler flags that are necessary to compile an Apache module. Also
includes APR and APU compiler flags if with_apr_flags is true.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000265_source')" id="l_M000265_source">show</a>
                        
                    </p>
                    <div id="M000265_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apache2_module_cflags</span>(<span class="ruby-identifier">with_apr_flags</span> = <span class="ruby-keyword kw">true</span>)
165:     <span class="ruby-identifier">flags</span> = [<span class="ruby-value str">&quot;-fPIC&quot;</span>]
166:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compiler_supports_visibility_flag?</span>
167:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;-fvisibility=hidden -DVISIBILITY_ATTRIBUTE_SUPPORTED&quot;</span>
168:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compiler_visibility_flag_generates_warnings?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">compiler_supports_wno_attributes_flag?</span>
169:         <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;-Wno-attributes&quot;</span>
170:       <span class="ruby-keyword kw">end</span>
171:     <span class="ruby-keyword kw">end</span>
172:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">with_apr_flags</span>
173:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">apr_flags</span>
174:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">apu_flags</span>
175:     <span class="ruby-keyword kw">end</span>
176:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
177:       <span class="ruby-identifier">apxs2_flags</span> = <span class="ruby-node">`#{apxs2} -q CFLAGS`</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; -I&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">`#{apxs2} -q INCLUDEDIR`</span>.<span class="ruby-identifier">strip</span>
178:       <span class="ruby-identifier">apxs2_flags</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/-O\d? /</span>, <span class="ruby-value str">''</span>)
179: 
180:       <span class="ruby-comment cmt"># Remove flags not supported by GCC</span>
181:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris/</span> <span class="ruby-comment cmt"># TODO: Add support for people using SunStudio</span>
182:         <span class="ruby-comment cmt"># The big problem is Coolstack apxs includes a bunch of solaris -x directives.</span>
183:         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">apxs2_flags</span>.<span class="ruby-identifier">split</span>
184:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\-x/</span> }
185:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\-Xa/</span> }
186:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\-fast/</span> }
187:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\-mt/</span> }
188:         <span class="ruby-identifier">apxs2_flags</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)
189:       <span class="ruby-keyword kw">end</span>
190:       
191:       <span class="ruby-identifier">apxs2_flags</span>.<span class="ruby-identifier">strip!</span>
192:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">apxs2_flags</span>
193:     <span class="ruby-keyword kw">end</span>
194:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">httpd</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/darwin/</span>
195:       <span class="ruby-comment cmt"># The default Apache install on OS X is a universal binary.</span>
196:       <span class="ruby-comment cmt"># Figure out which architectures it's compiled for and do the same</span>
197:       <span class="ruby-comment cmt"># thing for mod_passenger. We use the 'file' utility to do this.</span>
198:       <span class="ruby-comment cmt">#</span>
199:       <span class="ruby-comment cmt"># Running 'file' on the Apache executable usually outputs something</span>
200:       <span class="ruby-comment cmt"># like this:</span>
201:       <span class="ruby-comment cmt">#</span>
202:       <span class="ruby-comment cmt">#   /usr/sbin/httpd: Mach-O universal binary with 4 architectures</span>
203:       <span class="ruby-comment cmt">#   /usr/sbin/httpd (for architecture ppc7400):     Mach-O executable ppc</span>
204:       <span class="ruby-comment cmt">#   /usr/sbin/httpd (for architecture ppc64):       Mach-O 64-bit executable ppc64</span>
205:       <span class="ruby-comment cmt">#   /usr/sbin/httpd (for architecture i386):        Mach-O executable i386</span>
206:       <span class="ruby-comment cmt">#   /usr/sbin/httpd (for architecture x86_64):      Mach-O 64-bit executable x86_64</span>
207:       <span class="ruby-comment cmt">#</span>
208:       <span class="ruby-comment cmt"># But on some machines, it may output just:</span>
209:       <span class="ruby-comment cmt">#</span>
210:       <span class="ruby-comment cmt">#   /usr/sbin/httpd: Mach-O fat file with 4 architectures</span>
211:       <span class="ruby-comment cmt">#</span>
212:       <span class="ruby-comment cmt"># (http://code.google.com/p/phusion-passenger/issues/detail?id=236)</span>
213:       <span class="ruby-identifier">output</span> = <span class="ruby-node">`file &quot;#{httpd}&quot;`</span>.<span class="ruby-identifier">strip</span>
214:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">output</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Mach-O fat file/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">output</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/for architecture/</span>
215:         <span class="ruby-identifier">architectures</span> = [<span class="ruby-value str">&quot;i386&quot;</span>, <span class="ruby-value str">&quot;ppc&quot;</span>, <span class="ruby-value str">&quot;x86_64&quot;</span>, <span class="ruby-value str">&quot;ppc64&quot;</span>]
216:       <span class="ruby-keyword kw">else</span>
217:         <span class="ruby-identifier">architectures</span> = []
218:         <span class="ruby-identifier">output</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">grep</span>(<span class="ruby-regexp re">/for architecture/</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
219:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/for architecture (.*?)\)/</span>
220:           <span class="ruby-identifier">architectures</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$1</span>
221:         <span class="ruby-keyword kw">end</span>
222:       <span class="ruby-keyword kw">end</span>
223:       <span class="ruby-comment cmt"># The compiler may not support all architectures in the binary.</span>
224:       <span class="ruby-comment cmt"># XCode 4 seems to have removed support for the PPC architecture</span>
225:       <span class="ruby-comment cmt"># even though there are still plenty of Apache binaries around</span>
226:       <span class="ruby-comment cmt"># containing PPC components.</span>
227:       <span class="ruby-identifier">architectures</span>.<span class="ruby-identifier">reject!</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arch</span><span class="ruby-operator">|</span>
228:         <span class="ruby-operator">!</span><span class="ruby-identifier">compiler_supports_architecture?</span>(<span class="ruby-identifier">arch</span>)
229:       <span class="ruby-keyword kw">end</span>
230:       <span class="ruby-identifier">architectures</span>.<span class="ruby-identifier">map!</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arch</span><span class="ruby-operator">|</span>
231:         <span class="ruby-node">&quot;-arch #{arch}&quot;</span>
232:       <span class="ruby-keyword kw">end</span>
233:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">architectures</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)
234:     <span class="ruby-keyword kw">end</span>
235:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>).<span class="ruby-identifier">strip</span>
236:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000267">
                    
                    <a name="M000267"></a><b>apache2_module_ldflags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Linker flags that are necessary for linking an Apache module. Already
includes APR and APU linker flags.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000267_source')" id="l_M000267_source">show</a>
                        
                    </p>
                    <div id="M000267_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 241</span>
241:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apache2_module_ldflags</span>
242:     <span class="ruby-identifier">flags</span> = <span class="ruby-node">&quot;-fPIC #{apr_libs} #{apu_libs}&quot;</span>
243:     <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">strip!</span>
244:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">flags</span>
245:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000264">
                    
                    <a name="M000264"></a><b>apache2_sbindir</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the Apache 2 &#8216;sbin&#8217; directory, or nil if
unknown.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000264_source')" id="l_M000264_source">show</a>
                        
                    </p>
                    <div id="M000264_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apache2_sbindir</span>
151:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
152:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
153:     <span class="ruby-keyword kw">else</span>
154:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">`#{apxs2} -q SBINDIR`</span>.<span class="ruby-identifier">strip</span>
155:     <span class="ruby-keyword kw">end</span>
156:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000258">
                    
                    <a name="M000258"></a><b>apache2ctl</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the &#8216;apachectl&#8217; or
&#8216;apache2ctl&#8217; binary, or nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000258_source')" id="l_M000258_source">show</a>
                        
                    </p>
                    <div id="M000258_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apache2ctl</span>
61:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">find_apache2_executable</span>(<span class="ruby-value str">'apache2ctl'</span>, <span class="ruby-value str">'apachectl2'</span>, <span class="ruby-value str">'apachectl'</span>)
62:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000260">
                    
                    <a name="M000260"></a><b>apr_config</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the &#8216;apr-config&#8217; or
&#8216;apr-1-config&#8217; executable, or nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000260_source')" id="l_M000260_source">show</a>
                        
                    </p>
                    <div id="M000260_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 86</span>
 86:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apr_config</span>
 87:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env_defined?</span>(<span class="ruby-value str">'APR_CONFIG'</span>)
 88:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'APR_CONFIG'</span>]
 89:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
 90:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
 91:     <span class="ruby-keyword kw">else</span>
 92:       <span class="ruby-identifier">filename</span> = <span class="ruby-node">`#{apxs2} -q APR_CONFIG 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
 93:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">empty?</span>
 94:         <span class="ruby-identifier">apr_bindir</span> = <span class="ruby-node">`#{apxs2} -q APR_BINDIR 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
 95:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apr_bindir</span>.<span class="ruby-identifier">empty?</span>
 96:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
 97:         <span class="ruby-keyword kw">else</span>
 98:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">select_executable</span>(<span class="ruby-identifier">apr_bindir</span>,
 99:             <span class="ruby-value str">&quot;apr-1-config&quot;</span>, <span class="ruby-value str">&quot;apr-config&quot;</span>)
100:         <span class="ruby-keyword kw">end</span>
101:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">filename</span>)
102:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
103:       <span class="ruby-keyword kw">else</span>
104:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
105:       <span class="ruby-keyword kw">end</span>
106:     <span class="ruby-keyword kw">end</span>
107:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000272">
                    
                    <a name="M000272"></a><b>apr_config_needed_for_building_apache_modules?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether it is necessary to use information outputted by
&#8216;apr-config&#8217; and &#8216;apu-config&#8217; in order to compile
an Apache module. When Apache is installed with &#8212;with-included-apr,
the APR/APU headers are placed into the same directory as the Apache
headers, and so &#8216;apr-config&#8217; and &#8216;apu-config&#8217;
won&#8217;t be necessary in that case.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000272_source')" id="l_M000272_source">show</a>
                        
                    </p>
                    <div id="M000272_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 276</span>
276:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apr_config_needed_for_building_apache_modules?</span>
277:     <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-node">&quot;#{tmpexedir}/passenger-platform-check-#{Process.pid}.c&quot;</span>)
278:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
279:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;#include &lt;apr.h&gt;&quot;</span>)
280:     <span class="ruby-keyword kw">end</span>
281:     <span class="ruby-keyword kw">begin</span>
282:       <span class="ruby-keyword kw">return</span> <span class="ruby-operator">!</span><span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;(gcc #{apache2_module_cflags(false)} -c '#{filename}' -o '#{filename}.o') &gt;/dev/null 2&gt;/dev/null&quot;</span>)
283:     <span class="ruby-keyword kw">ensure</span>
284:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
285:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-node">&quot;#{filename}.o&quot;</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
286:     <span class="ruby-keyword kw">end</span>
287:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000268">
                    
                    <a name="M000268"></a><b>apr_flags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The C compiler flags that are necessary for programs that use APR.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000268_source')" id="l_M000268_source">show</a>
                        
                    </p>
                    <div id="M000268_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 249</span>
249:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apr_flags</span>
250:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">determine_apr_info</span>[<span class="ruby-value">0</span>]
251:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000269">
                    
                    <a name="M000269"></a><b>apr_libs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The linker flags that are necessary for linking programs that use APR.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000269_source')" id="l_M000269_source">show</a>
                        
                    </p>
                    <div id="M000269_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 254</span>
254:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apr_libs</span>
255:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">determine_apr_info</span>[<span class="ruby-value">1</span>]
256:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000261">
                    
                    <a name="M000261"></a><b>apu_config</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the &#8216;apu-config&#8217; or
&#8216;apu-1-config&#8217; executable, or nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000261_source')" id="l_M000261_source">show</a>
                        
                    </p>
                    <div id="M000261_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 112</span>
112:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apu_config</span>
113:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env_defined?</span>(<span class="ruby-value str">'APU_CONFIG'</span>)
114:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'APU_CONFIG'</span>]
115:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
116:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
117:     <span class="ruby-keyword kw">else</span>
118:       <span class="ruby-identifier">filename</span> = <span class="ruby-node">`#{apxs2} -q APU_CONFIG 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
119:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">empty?</span>
120:         <span class="ruby-identifier">apu_bindir</span> = <span class="ruby-node">`#{apxs2} -q APU_BINDIR 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
121:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apu_bindir</span>.<span class="ruby-identifier">empty?</span>
122:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
123:         <span class="ruby-keyword kw">else</span>
124:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">select_executable</span>(<span class="ruby-identifier">apu_bindir</span>,
125:             <span class="ruby-value str">&quot;apu-1-config&quot;</span>, <span class="ruby-value str">&quot;apu-config&quot;</span>)
126:         <span class="ruby-keyword kw">end</span>
127:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">filename</span>)
128:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
129:       <span class="ruby-keyword kw">else</span>
130:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
131:       <span class="ruby-keyword kw">end</span>
132:     <span class="ruby-keyword kw">end</span>
133:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000270">
                    
                    <a name="M000270"></a><b>apu_flags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The C compiler flags that are necessary for programs that use APR-Util.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000270_source')" id="l_M000270_source">show</a>
                        
                    </p>
                    <div id="M000270_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 259</span>
259:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apu_flags</span>
260:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">determine_apu_info</span>[<span class="ruby-value">0</span>]
261:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000271">
                    
                    <a name="M000271"></a><b>apu_libs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The linker flags that are necessary for linking programs that use APR-Util.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000271_source')" id="l_M000271_source">show</a>
                        
                    </p>
                    <div id="M000271_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 264</span>
264:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apu_libs</span>
265:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">determine_apu_info</span>[<span class="ruby-value">1</span>]
266:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000257">
                    
                    <a name="M000257"></a><b>apxs2</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the &#8216;apxs&#8217; or &#8216;apxs2&#8217;
executable, or nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000257_source')" id="l_M000257_source">show</a>
                        
                    </p>
                    <div id="M000257_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">apxs2</span>
45:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env_defined?</span>(<span class="ruby-value str">&quot;APXS2&quot;</span>)
46:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">&quot;APXS2&quot;</span>]
47:     <span class="ruby-keyword kw">end</span>
48:     [<span class="ruby-value str">'apxs2'</span>, <span class="ruby-value str">'apxs'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
49:       <span class="ruby-identifier">command</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-identifier">name</span>)
50:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">command</span>.<span class="ruby-identifier">nil?</span>
51:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">command</span>
52:       <span class="ruby-keyword kw">end</span>
53:     <span class="ruby-keyword kw">end</span>
54:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
55:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000336">
                    
                    <a name="M000336"></a><b>cc</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000336_source')" id="l_M000336_source">show</a>
                        
                    </p>
                    <div id="M000336_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 250</span>
250:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cc</span>
251:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'CC'</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;gcc&quot;</span>
252:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000277">
                    
                    <a name="M000277"></a><b>compiler_supports_architecture?</b>(arch)
                    
                </div>
                
                <div class="description">
                  <p>
Checks whether the compiler supports &#8220;-arch #{arch}&#8221;.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000277_source')" id="l_M000277_source">show</a>
                        
                    </p>
                    <div id="M000277_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_supports_architecture?</span>(<span class="ruby-identifier">arch</span>)
51:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">''</span>, <span class="ruby-node">&quot;-arch #{arch}&quot;</span>)
52:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000281">
                    
                    <a name="M000281"></a><b>compiler_supports_no_tls_direct_seg_refs_option?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000281_source')" id="l_M000281_source">show</a>
                        
                    </p>
                    <div id="M000281_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 69</span>
69:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_supports_no_tls_direct_seg_refs_option?</span>
70:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'-mno-tls-direct-seg-refs'</span>)
71:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000278">
                    
                    <a name="M000278"></a><b>compiler_supports_visibility_flag?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000278_source')" id="l_M000278_source">show</a>
                        
                    </p>
                    <div id="M000278_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_supports_visibility_flag?</span>
55:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'-fvisibility=hidden'</span>)
56:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000279">
                    
                    <a name="M000279"></a><b>compiler_supports_wno_attributes_flag?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000279_source')" id="l_M000279_source">show</a>
                        
                    </p>
                    <div id="M000279_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 59</span>
59:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_supports_wno_attributes_flag?</span>
60:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'-Wno-attributes'</span>)
61:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000280">
                    
                    <a name="M000280"></a><b>compiler_supports_wno_missing_field_initializers_flag?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000280_source')" id="l_M000280_source">show</a>
                        
                    </p>
                    <div id="M000280_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_supports_wno_missing_field_initializers_flag?</span>
65:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'-Wno-missing-field-initializers'</span>)
66:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000282">
                    
                    <a name="M000282"></a><b>compiler_visibility_flag_generates_warnings?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether compiling C++ with -fvisibility=hidden might result in tons
of useless warnings, like this: <a
href="http://code.google.com/p/phusion-passenger/issues/detail?id=526">code.google.com/p/phusion-passenger/issues/detail?id=526</a>
This appears to be a bug in older g++ versions: <a
href="http://gcc.gnu.org/ml/gcc-patches/2006-07/msg00861.html">gcc.gnu.org/ml/gcc-patches/2006-07/msg00861.html</a>
Warnings should be suppressed with -Wno-attributes.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000282_source')" id="l_M000282_source">show</a>
                        
                    </p>
                    <div id="M000282_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 80</span>
80:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">compiler_visibility_flag_generates_warnings?</span>
81:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/linux/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">`#{cxx} -v 2&gt;&amp;1`</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/gcc version (.*?)/</span>
82:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">$1</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value str">&quot;4.1.2&quot;</span>
83:     <span class="ruby-keyword kw">else</span>
84:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
85:     <span class="ruby-keyword kw">end</span>
86:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000286">
                    
                    <a name="M000286"></a><b>curl_flags</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000286_source')" id="l_M000286_source">show</a>
                        
                    </p>
                    <div id="M000286_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/curl.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">curl_flags</span>
30:     <span class="ruby-identifier">result</span> = <span class="ruby-value">`(curl-config --cflags) 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
31:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span>
32:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
33:     <span class="ruby-keyword kw">else</span>
34:       <span class="ruby-identifier">version</span> = <span class="ruby-value">`curl-config --vernum`</span>.<span class="ruby-identifier">strip</span>
35:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">'070c01'</span>
36:         <span class="ruby-comment cmt"># Curl &gt;= 7.12.1 supports curl_easy_reset()</span>
37:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; -DHAS_CURL_EASY_RESET&quot;</span>
38:       <span class="ruby-keyword kw">end</span>
39:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
40:     <span class="ruby-keyword kw">end</span>
41:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000287">
                    
                    <a name="M000287"></a><b>curl_libs</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000287_source')" id="l_M000287_source">show</a>
                        
                    </p>
                    <div id="M000287_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/curl.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">curl_libs</span>
45:     <span class="ruby-identifier">result</span> = <span class="ruby-value">`(curl-config --libs) 2&gt;/dev/null`</span>.<span class="ruby-identifier">strip</span>
46:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span>
47:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
48:     <span class="ruby-keyword kw">else</span>
49:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
50:     <span class="ruby-keyword kw">end</span>
51:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000288">
                    
                    <a name="M000288"></a><b>curl_supports_ssl?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000288_source')" id="l_M000288_source">show</a>
                        
                    </p>
                    <div id="M000288_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/curl.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">curl_supports_ssl?</span>
55:     <span class="ruby-identifier">features</span> = <span class="ruby-value">`(curl-config --feature) 2&gt;/dev/null`</span>
56:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">features</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/SSL/</span>
57:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000337">
                    
                    <a name="M000337"></a><b>cxx</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000337_source')" id="l_M000337_source">show</a>
                        
                    </p>
                    <div id="M000337_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 254</span>
254:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cxx</span>
255:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'CXX'</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;g++&quot;</span>
256:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000290">
                    
                    <a name="M000290"></a><b>debugging_cflags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
C compiler flags that should be passed in order to enable debugging
information.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000290_source')" id="l_M000290_source">show</a>
                        
                    </p>
                    <div id="M000290_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">debugging_cflags</span>
185:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/openbsd/</span>
186:       <span class="ruby-comment cmt"># According to OpenBSD's pthreads man page, pthreads do not work</span>
187:       <span class="ruby-comment cmt"># correctly when an app is compiled with -g. It recommends using</span>
188:       <span class="ruby-comment cmt"># -ggdb instead.</span>
189:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'-ggdb'</span>
190:     <span class="ruby-keyword kw">else</span>
191:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'-g'</span>
192:     <span class="ruby-keyword kw">end</span>
193:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000330">
                    
                    <a name="M000330"></a><b>env_defined?</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000330_source')" id="l_M000330_source">show</a>
                        
                    </p>
                    <div id="M000330_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">env_defined?</span>(<span class="ruby-identifier">name</span>)
160:     <span class="ruby-keyword kw">return</span> <span class="ruby-operator">!</span><span class="ruby-constant">ENV</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">ENV</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">empty?</span>
161:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000291">
                    
                    <a name="M000291"></a><b>export_dynamic_flags</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000291_source')" id="l_M000291_source">show</a>
                        
                    </p>
                    <div id="M000291_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 195</span>
195:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">export_dynamic_flags</span>
196:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/linux/</span>
197:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'-rdynamic'</span>
198:     <span class="ruby-keyword kw">else</span>
199:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
200:     <span class="ruby-keyword kw">end</span>
201:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000329">
                    
                    <a name="M000329"></a><b>find_command</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Check whether the specified command is in $PATH, and return its absolute
filename. Returns nil if the command is not found.
</p>
<p>
This function exists because system(&#8216;which&#8217;) doesn&#8217;t
always behave correctly, for some weird reason.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000329_source')" id="l_M000329_source">show</a>
                        
                    </p>
                    <div id="M000329_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 148</span>
148:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">find_command</span>(<span class="ruby-identifier">name</span>)
149:     <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
150:     <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'PATH'</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>).<span class="ruby-identifier">detect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">directory</span><span class="ruby-operator">|</span>
151:       <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">directory</span>, <span class="ruby-identifier">name</span>)
152:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">path</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">path</span>)
153:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span>
154:       <span class="ruby-keyword kw">end</span>
155:     <span class="ruby-keyword kw">end</span>
156:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
157:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000276">
                    
                    <a name="M000276"></a><b>gnu_make</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000276_source')" id="l_M000276_source">show</a>
                        
                    </p>
                    <div id="M000276_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gnu_make</span>
31:     <span class="ruby-identifier">gmake</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'gmake'</span>)
32:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">gmake</span>
33:       <span class="ruby-identifier">gmake</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'make'</span>)
34:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gmake</span>
35:         <span class="ruby-keyword kw">if</span> <span class="ruby-node">`#{gmake} --version 2&gt;&amp;1`</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/GNU/</span>
36:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">gmake</span>
37:         <span class="ruby-keyword kw">else</span>
38:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
39:         <span class="ruby-keyword kw">end</span>
40:       <span class="ruby-keyword kw">else</span>
41:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
42:       <span class="ruby-keyword kw">end</span>
43:     <span class="ruby-keyword kw">else</span>
44:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">gmake</span>
45:     <span class="ruby-keyword kw">end</span>
46:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000284">
                    
                    <a name="M000284"></a><b>has_alloca_h?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000284_source')" id="l_M000284_source">show</a>
                        
                    </p>
                    <div id="M000284_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">has_alloca_h?</span>
95:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">'#include &lt;alloca.h&gt;'</span>)
96:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000283">
                    
                    <a name="M000283"></a><b>has_math_library?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000283_source')" id="l_M000283_source">show</a>
                        
                    </p>
                    <div id="M000283_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 89</span>
89:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">has_math_library?</span>
90:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">try_link</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">&quot;int main() { return 0; }\n&quot;</span>, <span class="ruby-value str">'-lmath'</span>)
91:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000259">
                    
                    <a name="M000259"></a><b>httpd</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The absolute path to the Apache binary (that is, &#8216;httpd&#8217;,
&#8216;httpd2&#8217;, &#8216;apache&#8217; or &#8216;apache2&#8217;), or
nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000259_source')" id="l_M000259_source">show</a>
                        
                    </p>
                    <div id="M000259_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 67</span>
67:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">httpd</span>
68:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env_defined?</span>(<span class="ruby-value str">'HTTPD'</span>)
69:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'HTTPD'</span>]
70:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">apxs2</span>.<span class="ruby-identifier">nil?</span>
71:       [<span class="ruby-value str">&quot;apache2&quot;</span>, <span class="ruby-value str">&quot;httpd2&quot;</span>, <span class="ruby-value str">&quot;apache&quot;</span>, <span class="ruby-value str">&quot;httpd&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
72:         <span class="ruby-identifier">command</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-identifier">name</span>)
73:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">command</span>.<span class="ruby-identifier">nil?</span>
74:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">command</span>
75:         <span class="ruby-keyword kw">end</span>
76:       <span class="ruby-keyword kw">end</span>
77:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
78:     <span class="ruby-keyword kw">else</span>
79:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">find_apache2_executable</span>(<span class="ruby-node">`#{apxs2} -q TARGET`</span>.<span class="ruby-identifier">strip</span>)
80:     <span class="ruby-keyword kw">end</span>
81:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000266">
                    
                    <a name="M000266"></a><b>passenger_binary_compatibility_id</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns an identifier string that describes the current platform&#8217;s
binary compatibility with regard to Phusion Passenger binaries, both the
Ruby extension and the C++ binaries. Two systems with the same binary
compatibility identifiers are able to run the same Phusion Passenger
binaries.
</p>
<p>
The the string depends on the following factors:
</p>
<ul>
<li>The Ruby extension binary compatibility identifiers.

</li>
<li>The operating system name.

</li>
<li>Operating system runtime identifier. This may include the kernel version,
libc version, C++ ABI version, etc. Everything that is of interest for
binary compatibility with Phusion Passenger&#8217;s C++ components.

</li>
<li>Operating system default runtime architecture. This is not the same as the
CPU architecture; some CPUs support multiple architectures, e.g. Intel Core
2 Duo supports x86 and x86_64. Some operating systems actually support
multiple runtime architectures: a lot of x86_64 Linux distributions also
include 32-bit runtimes, and OS X Snow Leopard is x86_64 by default but all
system libraries also support x86. This component identifies the
architecture that is used when compiling a binary with the system&#8217;s
C++ compiler with its default options.

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000266_source')" id="l_M000266_source">show</a>
                        
                    </p>
                    <div id="M000266_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/binary_compatibility.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">passenger_binary_compatibility_id</span>
104:     <span class="ruby-identifier">ruby_engine</span>, <span class="ruby-identifier">ruby_ext_version</span>, <span class="ruby-identifier">ruby_arch</span>, <span class="ruby-identifier">os_name</span> =
105:       <span class="ruby-identifier">ruby_extension_binary_compatibility_ids</span>
106:     
107:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">os_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;macosx&quot;</span>
108:       <span class="ruby-comment cmt"># RUBY_PLATFORM gives us the kernel version, but we want</span>
109:       <span class="ruby-comment cmt"># the OS X version.</span>
110:       <span class="ruby-identifier">os_version_string</span> = <span class="ruby-value">`sw_vers -productVersion`</span>.<span class="ruby-identifier">strip</span>
111:       <span class="ruby-comment cmt"># sw_vers returns something like &quot;10.6.2&quot;. We're only</span>
112:       <span class="ruby-comment cmt"># interested in the first two digits (MAJOR.MINOR) since</span>
113:       <span class="ruby-comment cmt"># tiny releases tend to be binary compatible with each</span>
114:       <span class="ruby-comment cmt"># other.</span>
115:       <span class="ruby-identifier">components</span> = <span class="ruby-identifier">os_version_string</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>)
116:       <span class="ruby-identifier">os_version</span> = <span class="ruby-node">&quot;#{components[0]}.#{components[1]}&quot;</span>
117:       <span class="ruby-identifier">os_runtime</span> = <span class="ruby-identifier">os_version</span>
118:       
119:       <span class="ruby-identifier">os_arch</span> = <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>]
120:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">os_version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">&quot;10.5&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">os_arch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^i.86$/</span>
121:         <span class="ruby-comment cmt"># On Snow Leopard, 'uname -m' returns i386 but</span>
122:         <span class="ruby-comment cmt"># we *know* that everything is x86_64 by default.</span>
123:         <span class="ruby-identifier">os_arch</span> = <span class="ruby-value str">&quot;x86_64&quot;</span>
124:       <span class="ruby-keyword kw">end</span>
125:     <span class="ruby-keyword kw">else</span>
126:       <span class="ruby-identifier">os_arch</span> = <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>]
127:       
128:       <span class="ruby-identifier">cpp</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'cpp'</span>)
129:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cpp</span>
130:         <span class="ruby-identifier">macros</span> = <span class="ruby-node">`#{cpp} -dM &lt; /dev/null`</span>
131:         
132:         <span class="ruby-comment cmt"># Can be something like &quot;4.3.2&quot;</span>
133:         <span class="ruby-comment cmt"># or &quot;4.2.1 20070719 (FreeBSD)&quot;</span>
134:         <span class="ruby-identifier">macros</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/__VERSION__ &quot;(.+)&quot;/</span>
135:         <span class="ruby-identifier">compiler_version</span> = <span class="ruby-identifier">$1</span>
136:         <span class="ruby-identifier">compiler_version</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/ .*/</span>, <span class="ruby-value str">''</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compiler_version</span>
137:         
138:         <span class="ruby-identifier">macros</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/__GXX_ABI_VERSION (.+)$/</span>
139:         <span class="ruby-identifier">cxx_abi_version</span> = <span class="ruby-identifier">$1</span>
140:       <span class="ruby-keyword kw">else</span>
141:         <span class="ruby-identifier">compiler_version</span> = <span class="ruby-keyword kw">nil</span>
142:         <span class="ruby-identifier">cxx_abi_version</span> = <span class="ruby-keyword kw">nil</span>
143:       <span class="ruby-keyword kw">end</span>
144:       
145:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">compiler_version</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cxx_abi_version</span>
146:         <span class="ruby-identifier">os_runtime</span> = <span class="ruby-node">&quot;gcc#{compiler_version}-#{cxx_abi_version}&quot;</span>
147:       <span class="ruby-keyword kw">else</span>
148:         <span class="ruby-identifier">os_runtime</span> = [<span class="ruby-identifier">compiler_version</span>, <span class="ruby-identifier">cxx_abi_version</span>].<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;-&quot;</span>)
149:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">os_runtime</span>.<span class="ruby-identifier">empty?</span>
150:           <span class="ruby-identifier">os_runtime</span> = <span class="ruby-value">`uname -r`</span>.<span class="ruby-identifier">strip</span>
151:         <span class="ruby-keyword kw">end</span>
152:       <span class="ruby-keyword kw">end</span>
153:     <span class="ruby-keyword kw">end</span>
154:     
155:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ruby_engine</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;jruby&quot;</span>
156:       <span class="ruby-comment cmt"># For JRuby it's kinda useless to prepend &quot;java&quot; as extension</span>
157:       <span class="ruby-comment cmt"># architecture because JRuby doesn't allow any other extension</span>
158:       <span class="ruby-comment cmt"># architecture.</span>
159:       <span class="ruby-identifier">identifier</span> = <span class="ruby-value str">&quot;&quot;</span>
160:     <span class="ruby-keyword kw">else</span>
161:       <span class="ruby-identifier">identifier</span> = <span class="ruby-node">&quot;#{ruby_arch}-&quot;</span>
162:     <span class="ruby-keyword kw">end</span>
163:     <span class="ruby-identifier">identifier</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{ruby_engine}#{ruby_ext_version}-&quot;</span>
164:     <span class="ruby-comment cmt"># If the extension architecture is the same as the OS architecture</span>
165:     <span class="ruby-comment cmt"># then there's no need to specify it twice.</span>
166:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ruby_arch</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">os_arch</span>
167:       <span class="ruby-identifier">identifier</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{os_arch}-&quot;</span>
168:     <span class="ruby-keyword kw">end</span>
169:     <span class="ruby-identifier">identifier</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{os_name}-#{os_runtime}&quot;</span>
170:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">identifier</span>
171:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000285">
                    
                    <a name="M000285"></a><b>portability_cflags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Compiler flags that should be used for compiling every C/C++ program, for
portability reasons. These flags should be specified as last when invoking
the compiler.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000285_source')" id="l_M000285_source">show</a>
                        
                    </p>
                    <div id="M000285_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 102</span>
102:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">portability_cflags</span>
103:     <span class="ruby-identifier">flags</span> = [<span class="ruby-value str">&quot;-D_REENTRANT -I/usr/local/include&quot;</span>]
104:     
105:     <span class="ruby-comment cmt"># Google SparseHash flags.</span>
106:     <span class="ruby-comment cmt"># Figure out header for hash function object and its namespace.</span>
107:     <span class="ruby-comment cmt"># Based on stl_hash.m4 and stl_hash_fun.m4 in the Google SparseHash sources.</span>
108:     <span class="ruby-identifier">hash_namespace</span> = <span class="ruby-keyword kw">nil</span>
109:     <span class="ruby-identifier">ok</span> = <span class="ruby-keyword kw">false</span>
110:     [<span class="ruby-value str">'__gnu_cxx'</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'std'</span>, <span class="ruby-value str">'stdext'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">namespace</span><span class="ruby-operator">|</span>
111:       [<span class="ruby-value str">'ext/hash_map'</span>, <span class="ruby-value str">'hash_map'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash_map_header</span><span class="ruby-operator">|</span>
112:         <span class="ruby-identifier">ok</span> = <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:cxx</span>, <span class="ruby-node">%Q{
113:           #include &lt;#{hash_map_header}&gt;
114:           int
115:           main() {
116:             #{namespace}::hash_map&lt;int, int&gt; m;
117:             return 0;
118:           }
119:         }</span>)
120:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ok</span>
121:           <span class="ruby-identifier">hash_namespace</span> = <span class="ruby-identifier">namespace</span>
122:           <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;-DHASH_NAMESPACE=\&quot;#{namespace}\&quot;&quot;</span>
123:         <span class="ruby-keyword kw">end</span>
124:       <span class="ruby-keyword kw">end</span>
125:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ok</span>
126:     <span class="ruby-keyword kw">end</span>
127:     [<span class="ruby-value str">'ext/hash_fun.h'</span>, <span class="ruby-value str">'functional'</span>, <span class="ruby-value str">'tr1/functional'</span>,
128:      <span class="ruby-value str">'ext/stl_hash_fun.h'</span>, <span class="ruby-value str">'hash_fun.h'</span>, <span class="ruby-value str">'stl_hash_fun.h'</span>,
129:      <span class="ruby-value str">'stl/_hash_fun.h'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash_function_header</span><span class="ruby-operator">|</span>
130:       <span class="ruby-identifier">ok</span> = <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">:cxx</span>, <span class="ruby-node">%Q{
131:         #include &lt;#{hash_function_header}&gt;
132:         int
133:         main() {
134:           #{hash_namespace}::hash&lt;int&gt;()(5);
135:           return 0;
136:         }
137:       }</span>)
138:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ok</span>
139:         <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;-DHASH_FUN_H=\&quot;&lt;#{hash_function_header}&gt;\&quot;&quot;</span>
140:         <span class="ruby-keyword kw">break</span>
141:       <span class="ruby-keyword kw">end</span>
142:     <span class="ruby-keyword kw">end</span>
143:     
144:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris/</span>
145:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-pthreads'</span>
146:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-D_XOPEN_SOURCE=500 -D_XPG4_2 -D__EXTENSIONS__ -D__SOLARIS__ -D_FILE_OFFSET_BITS=64'</span>
147:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DBOOST_HAS_STDINT_H'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris2.9/</span>
148:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-D__SOLARIS9__ -DBOOST__STDC_CONSTANT_MACROS_DEFINED'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris2.9/</span>
149:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-mcpu=ultrasparc'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/sparc/</span>
150:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/openbsd/</span>
151:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DBOOST_HAS_STDINT_H -D_GLIBCPP__PTHREADS'</span>
152:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/aix/</span>
153:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DOXT_DISABLE_BACKTRACES'</span>
154:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/(sparc-linux|arm-linux|^arm.*-linux|sh4-linux)/</span>
155:       <span class="ruby-comment cmt"># http://code.google.com/p/phusion-passenger/issues/detail?id=200</span>
156:       <span class="ruby-comment cmt"># http://groups.google.com/group/phusion-passenger/t/6b904a962ee28e5c</span>
157:       <span class="ruby-comment cmt"># http://groups.google.com/group/phusion-passenger/browse_thread/thread/aad4bd9d8d200561</span>
158:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DBOOST_SP_USE_PTHREADS'</span>
159:     <span class="ruby-keyword kw">end</span>
160:     
161:     <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DHAS_ALLOCA_H'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">has_alloca_h?</span>
162:     <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DHAS_SFENCE'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">supports_sfence_instruction?</span>
163:     <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'-DHAS_LFENCE'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">supports_lfence_instruction?</span>
164:     
165:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>).<span class="ruby-identifier">strip</span>
166:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000289">
                    
                    <a name="M000289"></a><b>portability_ldflags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Linker flags that should be used for linking every C/C++ program, for
portability reasons. These flags should be specified as last when invoking
the linker.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000289_source')" id="l_M000289_source">show</a>
                        
                    </p>
                    <div id="M000289_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/compiler.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">portability_ldflags</span>
173:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris/</span>
174:       <span class="ruby-identifier">result</span> = <span class="ruby-value str">'-lxnet -lrt -lsocket -lnsl -lpthread'</span>
175:     <span class="ruby-keyword kw">else</span>
176:       <span class="ruby-identifier">result</span> = <span class="ruby-value str">'-lpthread'</span>
177:     <span class="ruby-keyword kw">end</span>
178:     <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">' -lmath'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">has_math_library?</span>
179:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
180:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000262">
                    
                    <a name="M000262"></a><b>ruby_extension_binary_compatibility_ids</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns an array of identifiers that describe the current Ruby
interpreter&#8217;s extension binary compatibility. A Ruby extension
compiled for a certain Ruby interpreter can also be loaded on a different
Ruby interpreter with the same binary compatibility identifiers.
</p>
<p>
The identifiers depend on the following factors:
</p>
<ul>
<li>Ruby engine name.

</li>
<li>Ruby extension version. This is not the same as the Ruby language version,
which identifies language-level compatibility. This is rather about binary
compatibility of extensions. MRI seems to break source compatibility
between tiny releases, though patchlevel releases tend to be source and
binary compatible.

</li>
<li>Ruby extension architecture. This is not necessarily the same as the
operating system runtime architecture or the CPU architecture. For example,
in case of JRuby, the extension architecture is just &#8220;java&#8221;
because all extensions target the Java platform; the architecture the JVM
was compiled for has no effect on compatibility. On systems with universal
binaries support there may be multiple architectures. In this case the
architecture is &#8220;universal&#8221; because extensions must be able to
support all of the Ruby executable&#8217;s architectures.

</li>
<li>The operating system for which the Ruby interpreter was compiled.

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000262_source')" id="l_M000262_source">show</a>
                        
                    </p>
                    <div id="M000262_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/binary_compatibility.rb, line 59</span>
59:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ruby_extension_binary_compatibility_ids</span>
60:     <span class="ruby-identifier">ruby_engine</span> = <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">RUBY_ENGINE</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">RUBY_ENGINE</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;ruby&quot;</span>
61:     <span class="ruby-identifier">ruby_ext_version</span> = <span class="ruby-constant">RUBY_VERSION</span>
62:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/darwin/</span>
63:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/universal/</span>
64:         <span class="ruby-identifier">ruby_arch</span> = <span class="ruby-value str">&quot;universal&quot;</span>
65:       <span class="ruby-keyword kw">else</span>
66:         <span class="ruby-comment cmt"># Something like:</span>
67:         <span class="ruby-comment cmt"># &quot;/opt/ruby-enterprise/bin/ruby: Mach-O 64-bit executable x86_64&quot;</span>
68:         <span class="ruby-identifier">ruby_arch</span> = <span class="ruby-node">`file -L &quot;#{ruby_executable}&quot;`</span>.<span class="ruby-identifier">strip</span>
69:         <span class="ruby-identifier">ruby_arch</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/.* /</span>, <span class="ruby-value str">''</span>)
70:       <span class="ruby-keyword kw">end</span>
71:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;java&quot;</span>
72:       <span class="ruby-identifier">ruby_arch</span> = <span class="ruby-value str">&quot;java&quot;</span>
73:     <span class="ruby-keyword kw">else</span>
74:       <span class="ruby-identifier">ruby_arch</span> = <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>]
75:     <span class="ruby-keyword kw">end</span>
76:     <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">ruby_engine</span>, <span class="ruby-identifier">ruby_ext_version</span>, <span class="ruby-identifier">ruby_arch</span>, <span class="ruby-identifier">os_name</span>]
77:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000331">
                    
                    <a name="M000331"></a><b>tmpdir</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000331_source')" id="l_M000331_source">show</a>
                        
                    </p>
                    <div id="M000331_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 163</span>
163:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">tmpdir</span>
164:     <span class="ruby-identifier">result</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'TMPDIR'</span>]
165:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span>
166:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\/+\Z/</span>, <span class="ruby-value str">''</span>)
167:     <span class="ruby-keyword kw">else</span>
168:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'/tmp'</span>
169:     <span class="ruby-keyword kw">end</span>
170:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000332">
                    
                    <a name="M000332"></a><b>tmpexedir</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the directory in which test executables should be placed. The
returned directory is guaranteed to be writable and guaranteed to not be
mounted with the &#8216;noexec&#8217; option. If no such directory can be
found then it will raise a <a
href="PlatformInfo/RuntimeError.html">PlatformInfo::RuntimeError</a> with
an appropriate error message.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000332_source')" id="l_M000332_source">show</a>
                        
                    </p>
                    <div id="M000332_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">tmpexedir</span>
179:     <span class="ruby-identifier">basename</span> = <span class="ruby-node">&quot;test-exe.#{Process.pid}.#{Thread.current.object_id}&quot;</span>
180:     <span class="ruby-identifier">attempts</span> = []
181:     
182:     <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">tmpdir</span>
183:     <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{dir}/#{basename}&quot;</span>
184:     <span class="ruby-keyword kw">begin</span>
185:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">'w'</span>).<span class="ruby-identifier">close</span>
186:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">chmod</span>(<span class="ruby-value">0700</span>, <span class="ruby-identifier">filename</span>)
187:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
188:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">dir</span>
189:       <span class="ruby-keyword kw">else</span>
190:         <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>,
191:           <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This directory's filesystem is mounted with the 'noexec' option.&quot;</span> }
192:       <span class="ruby-keyword kw">end</span>
193:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOENT</span>
194:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This directory doesn't exist.&quot;</span> }
195:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EACCES</span>
196:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This program doesn't have permission to write to this directory.&quot;</span> }
197:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
198:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> }
199:     <span class="ruby-keyword kw">ensure</span>
200:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
201:     <span class="ruby-keyword kw">end</span>
202:     
203:     <span class="ruby-identifier">dir</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>
204:     <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{dir}/#{basename}&quot;</span>
205:     <span class="ruby-keyword kw">begin</span>
206:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">'w'</span>).<span class="ruby-identifier">close</span>
207:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">chmod</span>(<span class="ruby-value">0700</span>, <span class="ruby-identifier">filename</span>)
208:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
209:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">dir</span>
210:       <span class="ruby-keyword kw">else</span>
211:         <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>,
212:           <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This directory's filesystem is mounted with the 'noexec' option.&quot;</span> }
213:       <span class="ruby-keyword kw">end</span>
214:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOENT</span>
215:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This directory doesn't exist.&quot;</span> }
216:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EACCES</span>
217:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This program doesn't have permission to write to this directory.&quot;</span> }
218:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
219:       <span class="ruby-identifier">attempts</span> <span class="ruby-operator">&lt;&lt;</span> { <span class="ruby-identifier">:dir</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> }
220:     <span class="ruby-keyword kw">ensure</span>
221:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
222:     <span class="ruby-keyword kw">end</span>
223:     
224:     <span class="ruby-identifier">message</span> = <span class="ruby-value str">&quot;In order to run certain tests, this program &quot;</span> <span class="ruby-operator">+</span>
225:       <span class="ruby-value str">&quot;must be able to write temporary\n&quot;</span> <span class="ruby-operator">+</span>
226:       <span class="ruby-value str">&quot;executable files to some directory. However no such &quot;</span> <span class="ruby-operator">+</span>
227:       <span class="ruby-value str">&quot;directory can be found. \n&quot;</span> <span class="ruby-operator">+</span>
228:       <span class="ruby-value str">&quot;The following directories have been tried:\n\n&quot;</span>
229:     <span class="ruby-identifier">attempts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attempt</span><span class="ruby-operator">|</span>
230:       <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; * #{attempt[:dir]}\n&quot;</span>
231:       <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;   #{attempt[:error]}\n&quot;</span>
232:     <span class="ruby-keyword kw">end</span>
233:     <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\nYou can solve this problem by telling this program what directory to write\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
234:       <span class="ruby-value str">&quot;temporary executable files to.\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
235:       <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
236:       <span class="ruby-value str">&quot;  Set the $TMPDIR environment variable to the desired directory's filename and\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
237:       <span class="ruby-value str">&quot;  re-run this program.\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
238:       <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
239:       <span class="ruby-value str">&quot;Notes:\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
240:       <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
241:       <span class="ruby-value str">&quot; * If you're using 'sudo'/'rvmsudo', remember that 'sudo'/'rvmsudo' unsets all\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
242:       <span class="ruby-value str">&quot;   environment variables, so you must set the environment variable *after*\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
243:       <span class="ruby-value str">&quot;   having gained root privileges.\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
244:       <span class="ruby-value str">&quot; * The directory you choose must writeable and must not be mounted with the\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
245:       <span class="ruby-value str">&quot;   'noexec' option.&quot;</span>
246:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">RuntimeError</span>, <span class="ruby-identifier">message</span>
247:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Private methods</div>
            
            <div class="method">
                <div class="title" id="M000292">
                    
                    <a name="M000292"></a><b>asciidoc</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000292_source')" id="l_M000292_source">show</a>
                        
                    </p>
                    <div id="M000292_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/documentation_tools.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">asciidoc</span>
30:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'asciidoc'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'mizuho-asciidoc'</span>)
31:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000318">
                    
                    <a name="M000318"></a><b>cache_dir=</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000318_source')" id="l_M000318_source">show</a>
                        
                    </p>
                    <div id="M000318_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cache_dir=</span>(<span class="ruby-identifier">value</span>)
33:     <span class="ruby-ivar">@@cache_dir</span> = <span class="ruby-identifier">value</span>
34:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000297">
                    
                    <a name="M000297"></a><b>cpu_architectures</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns a list of all CPU architecture names that the current machine CPU
supports. If there are multiple such architectures then the first item in
the result denotes that OS runtime&#8217;s main/preferred architecture.
</p>
<p>
This function normalizes some names. For example x86 is always reported as
&#8220;x86&#8221; regardless of whether the OS reports it as
&#8220;i386&#8221; or &#8220;i686&#8221;. x86_64 is always reported as
&#8220;x86_64&#8220; even if the OS reports it as &#8220;amd64&#8221;.
</p>
<p>
Please note that even if the CPU supports multiple architectures, the
operating system might not. For example most x86 CPUs nowadays also support
x86_64, but x86_64 Linux systems require various x86 compatibility
libraries to be installed before x86 executables can be run. This function
does not detect whether these compatibility libraries are installed. The
only guarantee that you have is that the OS can run executables in the
architecture denoted by the first item in the result.
</p>
<p>
For example, on x86_64 Linux this function can return
[&#8220;x86_64&#8220;, &#8220;x86&#8221;]. This indicates that the CPU
supports both of these architectures, and that the OS&#8217;s
main/preferred architecture is x86_64. Most executables on the system are
thus be x86_64. It is guaranteed that the OS can run x86_64 executables,
but not x86 executables per se.
</p>
<p>
Another example: on MacOS X this function can return either
</p>
<dl>
<dt>&#8220;x86_64&#8220;, &#8220;x86&#8220;</dt><dd>or [&#8220;x86&#8221;, &#8220;x86_64&#8220;]. The former result indicates

</dd>
</dl>
<p>
OS X 10.6 (Snow Leopard) and beyond because starting from that version
everything is 64-bit by default. The latter result indicates an OS X
version older than 10.6.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000297_source')" id="l_M000297_source">show</a>
                        
                    </p>
                    <div id="M000297_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 77</span>
 77:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cpu_architectures</span>
 78:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">os_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;macosx&quot;</span>
 79:       <span class="ruby-identifier">arch</span> = <span class="ruby-value">`uname -p`</span>.<span class="ruby-identifier">strip</span>
 80:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;i386&quot;</span>
 81:         <span class="ruby-comment cmt"># Macs have been x86 since around 2007. I think all of them come with</span>
 82:         <span class="ruby-comment cmt"># a recent enough Intel CPU that supports both x86 and x86_64, and I</span>
 83:         <span class="ruby-comment cmt"># think every OS X version has both the x86 and x86_64 runtime installed.</span>
 84:         <span class="ruby-identifier">major</span>, <span class="ruby-identifier">minor</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rest</span> = <span class="ruby-value">`sw_vers -productVersion`</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>)
 85:         <span class="ruby-identifier">major</span> = <span class="ruby-identifier">major</span>.<span class="ruby-identifier">to_i</span>
 86:         <span class="ruby-identifier">minor</span> = <span class="ruby-identifier">minor</span>.<span class="ruby-identifier">to_i</span>
 87:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">major</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">10</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">major</span> <span class="ruby-operator">==</span> <span class="ruby-value">10</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">minor</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">6</span>)
 88:           <span class="ruby-comment cmt"># Since Snow Leopard x86_64 is the default.</span>
 89:           [<span class="ruby-value str">&quot;x86_64&quot;</span>, <span class="ruby-value str">&quot;x86&quot;</span>]
 90:         <span class="ruby-keyword kw">else</span>
 91:           <span class="ruby-comment cmt"># Before Snow Leopard x86 was the default.</span>
 92:           [<span class="ruby-value str">&quot;x86&quot;</span>, <span class="ruby-value str">&quot;x86_64&quot;</span>]
 93:         <span class="ruby-keyword kw">end</span>
 94:       <span class="ruby-keyword kw">else</span>
 95:         <span class="ruby-identifier">arch</span>
 96:       <span class="ruby-keyword kw">end</span>
 97:     <span class="ruby-keyword kw">else</span>
 98:       <span class="ruby-identifier">arch</span> = <span class="ruby-value">`uname -p`</span>.<span class="ruby-identifier">strip</span>
 99:       <span class="ruby-comment cmt"># On some systems 'uname -p' returns something like</span>
100:       <span class="ruby-comment cmt"># 'Intel(R) Pentium(R) M processor 1400MHz'.</span>
101:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;unknown&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/ /</span>
102:         <span class="ruby-identifier">arch</span> = <span class="ruby-value">`uname -m`</span>.<span class="ruby-identifier">strip</span>
103:       <span class="ruby-keyword kw">end</span>
104:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^i.86$/</span>
105:         <span class="ruby-identifier">arch</span> = <span class="ruby-value str">&quot;x86&quot;</span>
106:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;amd64&quot;</span>
107:         <span class="ruby-identifier">arch</span> = <span class="ruby-value str">&quot;x86_64&quot;</span>
108:       <span class="ruby-keyword kw">end</span>
109:       
110:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86&quot;</span>
111:         <span class="ruby-comment cmt"># Most x86 operating systems nowadays are probably running on</span>
112:         <span class="ruby-comment cmt"># a CPU that supports both x86 and x86_64, but we're not gonna</span>
113:         <span class="ruby-comment cmt"># go through the trouble of checking that. The main architecture</span>
114:         <span class="ruby-comment cmt"># is what we usually care about.</span>
115:         [<span class="ruby-value str">&quot;x86&quot;</span>]
116:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86_64&quot;</span>
117:         <span class="ruby-comment cmt"># I don't think there's a single x86_64 CPU out there</span>
118:         <span class="ruby-comment cmt"># that doesn't support x86 as well.</span>
119:         [<span class="ruby-value str">&quot;x86_64&quot;</span>, <span class="ruby-value str">&quot;x86&quot;</span>]
120:       <span class="ruby-keyword kw">else</span>
121:         [<span class="ruby-identifier">arch</span>]
122:       <span class="ruby-keyword kw">end</span>
123:     <span class="ruby-keyword kw">end</span>
124:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000274">
                    
                    <a name="M000274"></a><b>determine_apr_info</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000274_source')" id="l_M000274_source">show</a>
                        
                    </p>
                    <div id="M000274_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 309</span>
309:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">determine_apr_info</span>
310:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apr_config</span>.<span class="ruby-identifier">nil?</span>
311:       <span class="ruby-keyword kw">return</span> [<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>]
312:     <span class="ruby-keyword kw">else</span>
313:       <span class="ruby-identifier">flags</span> = <span class="ruby-node">`#{apr_config} --cppflags --includes`</span>.<span class="ruby-identifier">strip</span>
314:       <span class="ruby-identifier">libs</span> = <span class="ruby-node">`#{apr_config} --link-ld`</span>.<span class="ruby-identifier">strip</span>
315:       <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/-O\d? /</span>, <span class="ruby-value str">''</span>)
316:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/solaris/</span>
317:         <span class="ruby-comment cmt"># Remove flags not supported by GCC</span>
318:         <span class="ruby-identifier">flags</span> = <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/ +/</span>).<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\-mt/</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)
319:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/aix/</span>
320:         <span class="ruby-identifier">libs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; -Wl,-G -Wl,-brtl&quot;</span>
321:       <span class="ruby-keyword kw">end</span>
322:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">flags</span>, <span class="ruby-identifier">libs</span>]
323:     <span class="ruby-keyword kw">end</span>
324:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000275">
                    
                    <a name="M000275"></a><b>determine_apu_info</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000275_source')" id="l_M000275_source">show</a>
                        
                    </p>
                    <div id="M000275_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 328</span>
328:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">determine_apu_info</span>
329:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">apu_config</span>.<span class="ruby-identifier">nil?</span>
330:       <span class="ruby-keyword kw">return</span> [<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>]
331:     <span class="ruby-keyword kw">else</span>
332:       <span class="ruby-identifier">flags</span> = <span class="ruby-node">`#{apu_config} --includes`</span>.<span class="ruby-identifier">strip</span>
333:       <span class="ruby-identifier">libs</span> = <span class="ruby-node">`#{apu_config} --link-ld`</span>.<span class="ruby-identifier">strip</span>
334:       <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/-O\d? /</span>, <span class="ruby-value str">''</span>)
335:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">flags</span>, <span class="ruby-identifier">libs</span>]
336:     <span class="ruby-keyword kw">end</span>
337:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000273">
                    
                    <a name="M000273"></a><b>find_apache2_executable</b>(*possible_names)
                    
                </div>
                
                <div class="description">
                  <p>
Find an executable in the Apache &#8216;bin&#8217; and &#8216;sbin&#8217;
directories. Returns nil if not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000273_source')" id="l_M000273_source">show</a>
                        
                    </p>
                    <div id="M000273_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/apache.rb, line 293</span>
293:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">find_apache2_executable</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">possible_names</span>)
294:     [<span class="ruby-identifier">apache2_bindir</span>, <span class="ruby-identifier">apache2_sbindir</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">bindir</span><span class="ruby-operator">|</span>
295:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bindir</span>.<span class="ruby-identifier">nil?</span>
296:         <span class="ruby-keyword kw">next</span>
297:       <span class="ruby-keyword kw">end</span>
298:       <span class="ruby-identifier">possible_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
299:         <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{bindir}/#{name}&quot;</span>
300:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
301:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
302:         <span class="ruby-keyword kw">end</span>
303:       <span class="ruby-keyword kw">end</span>
304:     <span class="ruby-keyword kw">end</span>
305:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
306:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000304">
                    
                    <a name="M000304"></a><b>gem_command</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the correct &#8216;gem&#8217; command for this Ruby interpreter.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000304_source')" id="l_M000304_source">show</a>
                        
                    </p>
                    <div id="M000304_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 110</span>
110:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gem_command</span>
111:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">locate_ruby_tool</span>(<span class="ruby-value str">'gem'</span>)
112:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000308">
                    
                    <a name="M000308"></a><b>in_rvm?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether the current Ruby interpreter is managed by RVM.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000308_source')" id="l_M000308_source">show</a>
                        
                    </p>
                    <div id="M000308_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 154</span>
154:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">in_rvm?</span>
155:     <span class="ruby-identifier">bindir</span> = <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'bindir'</span>]
156:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">bindir</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'/.rvm/'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">bindir</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'/rvm/'</span>)
157:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000316">
                    
                    <a name="M000316"></a><b>is_ruby_program?</b>(filename)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000316_source')" id="l_M000316_source">show</a>
                        
                    </p>
                    <div id="M000316_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 313</span>
313:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">is_ruby_program?</span>(<span class="ruby-identifier">filename</span>)
314:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">'rb'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
315:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/ruby/</span>
316:     <span class="ruby-keyword kw">end</span>
317:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">EOFError</span>
318:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
319:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000296">
                    
                    <a name="M000296"></a><b>library_extension</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The current platform&#8217;s shared library extension (&#8216;so&#8217; on
most Unices).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000296_source')" id="l_M000296_source">show</a>
                        
                    </p>
                    <div id="M000296_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 42</span>
42:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">library_extension</span>
43:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/darwin/</span>
44:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;bundle&quot;</span>
45:     <span class="ruby-keyword kw">else</span>
46:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;so&quot;</span>
47:     <span class="ruby-keyword kw">end</span>
48:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000293">
                    
                    <a name="M000293"></a><b>linux_distro</b>()
                    
                </div>
                
                <div class="description">
                  <p>
An identifier for the current Linux distribution. nil if the operating
system is not Linux.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000293_source')" id="l_M000293_source">show</a>
                        
                    </p>
                    <div id="M000293_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/linux.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">linux_distro</span>
31:     <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">linux_distro_tags</span>
32:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tags</span>
33:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">tags</span>.<span class="ruby-identifier">first</span>
34:     <span class="ruby-keyword kw">else</span>
35:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
36:     <span class="ruby-keyword kw">end</span>
37:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000294">
                    
                    <a name="M000294"></a><b>linux_distro_tags</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Autodetects the current Linux distribution and return a number of
identifier tags. The first tag identifies the distribution while the other
tags indicate which distributions it is likely compatible with. Returns nil
if the operating system is not Linux.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000294_source')" id="l_M000294_source">show</a>
                        
                    </p>
                    <div id="M000294_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/linux.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">linux_distro_tags</span>
44:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/linux/</span>
45:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
46:     <span class="ruby-keyword kw">end</span>
47:     <span class="ruby-identifier">lsb_release</span> = <span class="ruby-identifier">read_file</span>(<span class="ruby-value str">&quot;/etc/lsb-release&quot;</span>)
48:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lsb_release</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Ubuntu/</span>
49:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:ubuntu</span>, <span class="ruby-identifier">:debian</span>]
50:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-value str">&quot;/etc/debian_version&quot;</span>)
51:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:debian</span>]
52:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-value str">&quot;/etc/redhat-release&quot;</span>)
53:       <span class="ruby-identifier">redhat_release</span> = <span class="ruby-identifier">read_file</span>(<span class="ruby-value str">&quot;/etc/redhat-release&quot;</span>)
54:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">redhat_release</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/CentOS/</span>
55:         <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:centos</span>, <span class="ruby-identifier">:redhat</span>]
56:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">redhat_release</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Fedora/</span>
57:         <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:fedora</span>, <span class="ruby-identifier">:redhat</span>]
58:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">redhat_release</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Mandriva/</span>
59:         <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:mandriva</span>, <span class="ruby-identifier">:redhat</span>]
60:       <span class="ruby-keyword kw">else</span>
61:         <span class="ruby-comment cmt"># On official RHEL distros, the content is in the form of</span>
62:         <span class="ruby-comment cmt"># &quot;Red Hat Enterprise Linux Server release 5.1 (Tikanga)&quot;</span>
63:         <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:rhel</span>, <span class="ruby-identifier">:redhat</span>]
64:       <span class="ruby-keyword kw">end</span>
65:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-value str">&quot;/etc/suse-release&quot;</span>)
66:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:suse</span>]
67:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-value str">&quot;/etc/gentoo-release&quot;</span>)
68:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:gentoo</span>]
69:     <span class="ruby-keyword kw">else</span>
70:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">:unknown</span>]
71:     <span class="ruby-keyword kw">end</span>
72:     <span class="ruby-comment cmt"># TODO: Slackware</span>
73:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000314">
                    
                    <a name="M000314"></a><b>locate_ruby_tool</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Locates a Ruby tool command, e.g. &#8216;gem&#8217;, &#8216;rake&#8217;,
&#8216;bundle&#8217;, etc. Instead of naively looking in $PATH, this
function uses a variety of search heuristics to find the command
that&#8217;s really associated with the current Ruby interpreter. It should
never locate a command that&#8217;s actually associated with a different
Ruby interpreter. Returns nil when nothing&#8217;s found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000314_source')" id="l_M000314_source">show</a>
                        
                    </p>
                    <div id="M000314_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 246</span>
246:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">locate_ruby_tool</span>(<span class="ruby-identifier">name</span>)
247:     <span class="ruby-identifier">result</span> = <span class="ruby-identifier">locate_ruby_tool_by_basename</span>(<span class="ruby-identifier">name</span>)
248:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">result</span>
249:       <span class="ruby-identifier">exeext</span> = <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'EXEEXT'</span>]
250:       <span class="ruby-identifier">exeext</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exeext</span>.<span class="ruby-identifier">empty?</span>
251:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exeext</span>
252:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">locate_ruby_tool_by_basename</span>(<span class="ruby-node">&quot;#{name}#{exeext}&quot;</span>)
253:       <span class="ruby-keyword kw">end</span>
254:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">result</span>
255:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">locate_ruby_tool_by_basename</span>(<span class="ruby-identifier">transform_according_to_ruby_exec_format</span>(<span class="ruby-identifier">name</span>))
256:       <span class="ruby-keyword kw">end</span>
257:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">result</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">exeext</span>
258:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">locate_ruby_tool_by_basename</span>(<span class="ruby-identifier">transform_according_to_ruby_exec_format</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">exeext</span>)
259:       <span class="ruby-keyword kw">end</span>
260:     <span class="ruby-keyword kw">end</span>
261:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
262:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000315">
                    
                    <a name="M000315"></a><b>locate_ruby_tool_by_basename</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000315_source')" id="l_M000315_source">show</a>
                        
                    </p>
                    <div id="M000315_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 265</span>
265:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">locate_ruby_tool_by_basename</span>(<span class="ruby-identifier">name</span>)
266:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/darwin/</span> <span class="ruby-operator">&amp;&amp;</span>
267:        <span class="ruby-identifier">ruby_command</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">%r(\A/System/Library/Frameworks/Ruby.framework/Versions/.*?/usr/bin/ruby\Z)</span>
268:       <span class="ruby-comment cmt"># On OS X we must look for Ruby binaries in /usr/bin.</span>
269:       <span class="ruby-comment cmt"># RubyGems puts executables (e.g. 'rake') in there, not in</span>
270:       <span class="ruby-comment cmt"># /System/Libraries/(...)/bin.</span>
271:       <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;/usr/bin/#{name}&quot;</span>
272:     <span class="ruby-keyword kw">else</span>
273:       <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">ruby_command</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/#{name}&quot;</span>
274:     <span class="ruby-keyword kw">end</span>
275: 
276:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
277:       <span class="ruby-comment cmt"># RubyGems might put binaries in a directory other</span>
278:       <span class="ruby-comment cmt"># than Ruby's bindir. Debian packaged RubyGems and</span>
279:       <span class="ruby-comment cmt"># DebGem packaged RubyGems are the prime examples.</span>
280:       <span class="ruby-keyword kw">begin</span>
281:         <span class="ruby-identifier">require</span> <span class="ruby-value str">'rubygems'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Gem</span>)
282:         <span class="ruby-identifier">filename</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">bindir</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/#{name}&quot;</span>
283:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">LoadError</span>
284:         <span class="ruby-identifier">filename</span> = <span class="ruby-keyword kw">nil</span>
285:       <span class="ruby-keyword kw">end</span>
286:     <span class="ruby-keyword kw">end</span>
287: 
288:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">filename</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
289:       <span class="ruby-comment cmt"># Looks like it's not in the RubyGems bindir. Search in $PATH, but</span>
290:       <span class="ruby-comment cmt"># be very careful about this because whatever we find might belong</span>
291:       <span class="ruby-comment cmt"># to a different Ruby interpreter than the current one.</span>
292:       <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'PATH'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">':'</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
293:         <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{dir}/#{name}&quot;</span>
294:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
295:           <span class="ruby-identifier">shebang</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">'rb'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
296:             <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">strip</span>
297:           <span class="ruby-keyword kw">end</span>
298:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">shebang</span> <span class="ruby-operator">==</span> <span class="ruby-node">&quot;#!#{ruby_command}&quot;</span>
299:             <span class="ruby-comment cmt"># Looks good.</span>
300:             <span class="ruby-keyword kw">break</span>
301:           <span class="ruby-keyword kw">end</span>
302:         <span class="ruby-keyword kw">end</span>
303: 
304:         <span class="ruby-comment cmt"># Not found. Try next path.</span>
305:         <span class="ruby-identifier">filename</span> = <span class="ruby-keyword kw">nil</span>
306:       <span class="ruby-keyword kw">end</span>
307:     <span class="ruby-keyword kw">end</span>
308: 
309:     <span class="ruby-identifier">filename</span>
310:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000320">
                    
                    <a name="M000320"></a><b>memoize</b>(method, cache_to_disk = false, cache_time = 3600)
                    
                </div>
                
                <div class="description">
                  <p>
Turn the specified class method into a memoized one. If the given class
method is called without arguments, then its result will be memoized,
frozen, and returned upon subsequent calls without arguments. Calls with
arguments are never memoized.
</p>
<p>
If <tt>cache_to_disk</tt> is true and a cache directory has been set with
<tt><a href="PlatformInfo.html#M000318">PlatformInfo.cache_dir=</a></tt>
then result is cached to a file on disk, so that memoized results persist
over multiple process runs. This cache file expires in <tt>cache_time</tt>
seconds (1 hour by default) after it has been written.
</p>
<pre>
  def self.foo(max = 10)
    rand(max)
  end
  memoize :foo

  foo        # =&gt; 3
  foo        # =&gt; 3
  foo(100)   # =&gt; 49
  foo(100)   # =&gt; 26
  foo        # =&gt; 3
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000320_source')" id="l_M000320_source">show</a>
                        
                    </p>
                    <div id="M000320_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 63</span>
 63:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">memoize</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">cache_to_disk</span> = <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">cache_time</span> = <span class="ruby-value">3600</span>)
 64:       <span class="ruby-comment cmt"># We use class_eval here because Ruby 1.8.5 doesn't support class_variable_get/set.</span>
 65:       <span class="ruby-identifier">metaclass</span> = <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>; <span class="ruby-keyword kw">self</span>; <span class="ruby-keyword kw">end</span>
 66:       <span class="ruby-identifier">metaclass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:alias_method</span>, <span class="ruby-node">&quot;_unmemoized_#{method}&quot;</span>, <span class="ruby-identifier">method</span>)
 67:       <span class="ruby-identifier">variable_name</span> = <span class="ruby-node">&quot;@@memoized_#{method}&quot;</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\?/</span>, <span class="ruby-value str">''</span>)
 68:       <span class="ruby-identifier">check_variable_name</span> = <span class="ruby-node">&quot;@@has_memoized_#{method}&quot;</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\?/</span>, <span class="ruby-value str">''</span>)
 69:       <span class="ruby-identifier">eval</span>(<span class="ruby-node">%Q{
 70:         #{variable_name} = nil
 71:         #{check_variable_name} = false
 72:       }</span>)
 73:       <span class="ruby-identifier">line</span> = <span class="ruby-keyword kw">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
 74:       <span class="ruby-identifier">source</span> = <span class="ruby-node">%Q{
 75:         def self.#{method}(*args)                                           # def self.httpd(*args)
 76:           if args.empty?                                                    #   if args.empty?
 77:             if !#{check_variable_name}                                      #     if !@@has_memoized_httpd
 78:               if @@cache_dir                                                #       if @@cache_dir
 79:                 cache_file = File.join(@@cache_dir, &quot;#{method}&quot;)            #         cache_file = File.join(@@cache_dir, &quot;httpd&quot;)
 80:               end                                                           #       end
 81:               read_from_cache_file = false                                  #       read_from_cache_file = false
 82:               if #{cache_to_disk} &amp;&amp; cache_file &amp;&amp; File.exist?(cache_file)  #       if #{cache_to_disk} &amp;&amp; File.exist?(cache_file)
 83:                 cache_file_stat = File.stat(cache_file)                     #         cache_file_stat = File.stat(cache_file)
 84:                 read_from_cache_file =                                      #         read_from_cache_file =
 85:                   Time.now - cache_file_stat.mtime &lt; #{cache_time}          #           Time.now - cache_file_stat.mtime &lt; #{cache_time}
 86:               end                                                           #       end
 87:               if read_from_cache_file                                       #       if read_from_cache_file
 88:                 data = File.read(cache_file)                                #         data = File.read(cache_file)
 89:                 #{variable_name} = Marshal.load(data).freeze                #         @@memoized_httpd = Marshal.load(data).freeze
 90:                 #{check_variable_name} = true                               #         @@has_memoized_httpd = true
 91:               else                                                          #       else
 92:                 #{variable_name} = _unmemoized_#{method}.freeze             #         @@memoized_httpd = _unmemoized_httpd.freeze
 93:                 #{check_variable_name} = true                               #         @@has_memoized_httpd = true
 94:                 if cache_file &amp;&amp; #{cache_to_disk}                           #         if cache_file &amp;&amp; #{cache_to_disk}
 95:                   begin                                                     #           begin
 96:                     if !File.directory?(@@cache_dir)                        #             if !File.directory?(@@cache_dir)
 97:                       Dir.mkdir(@@cache_dir)                                #               Dir.mkdir(@@cache_dir)
 98:                     end                                                     #             end
 99:                     File.open(cache_file, &quot;wb&quot;) do |f|                      #             File.open(cache_file, &quot;wb&quot;) do |f|
100:                       f.write(Marshal.dump(#{variable_name}))               #               f.write(Marshal.dump(@@memoized_httpd))
101:                     end                                                     #             end
102:                   rescue Errno::EACCES                                      #           rescue Errno::EACCES
103:                     # Ignore permission error.                              #             # Ignore permission error.
104:                   end                                                       #           end
105:                 end                                                         #         end
106:               end                                                           #       end
107:             end                                                             #     end
108:             #{variable_name}                                                #     @@memoized_httpd
109:           else                                                              #   else
110:             _unmemoized_#{method}(*args)                                    #     _unmemoized_httpd(*args)
111:           end                                                               #   end
112:         end                                                                 # end
113:       }</span>
114:       <span class="ruby-identifier">class_eval</span>(<span class="ruby-identifier">source</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-identifier">line</span>)
115:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000295">
                    
                    <a name="M000295"></a><b>os_name</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the operating system&#8217;s name. This name is in lowercase and
contains no spaces, and thus is suitable to be used in some kind of ID.
E.g. &#8220;linux&#8221;, &#8220;macosx&#8221;.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000295_source')" id="l_M000295_source">show</a>
                        
                    </p>
                    <div id="M000295_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">os_name</span>
33:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'target_os'</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/darwin/</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">sw_vers</span> = <span class="ruby-identifier">find_command</span>(<span class="ruby-value str">'sw_vers'</span>))
34:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;macosx&quot;</span>
35:     <span class="ruby-keyword kw">else</span>
36:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">RUBY_PLATFORM</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/.*?-/</span>, <span class="ruby-value str">''</span>)
37:     <span class="ruby-keyword kw">end</span>
38:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000319">
                    
                    <a name="M000319"></a><b>private_class_method</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000319_source')" id="l_M000319_source">show</a>
                        
                    </p>
                    <div id="M000319_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 36</span>
36:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">private_class_method</span>(<span class="ruby-identifier">name</span>)
37:     <span class="ruby-identifier">metaclass</span> = <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>; <span class="ruby-keyword kw">self</span>; <span class="ruby-keyword kw">end</span>
38:     <span class="ruby-identifier">metaclass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private</span>, <span class="ruby-identifier">name</span>)
39:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000305">
                    
                    <a name="M000305"></a><b>rake</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the absolute path to the Rake executable that belongs to the
current Ruby interpreter. Returns nil if it doesn&#8217;t exist.
</p>
<p>
The return value may not be the actual correct invocation for Rake. Use <a
href="PlatformInfo.html#M000306">rake_command</a> for that.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000305_source')" id="l_M000305_source">show</a>
                        
                    </p>
                    <div id="M000305_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rake</span>
122:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">locate_ruby_tool</span>(<span class="ruby-value str">'rake'</span>)
123:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000306">
                    
                    <a name="M000306"></a><b>rake_command</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the correct command string for invoking the Rake executable that
belongs to the current Ruby interpreter. Returns nil if Rake is not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000306_source')" id="l_M000306_source">show</a>
                        
                    </p>
                    <div id="M000306_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rake_command</span>
130:     <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">rake</span>
131:     <span class="ruby-comment cmt"># If the Rake executable is a Ruby program then we need to run</span>
132:     <span class="ruby-comment cmt"># it in the correct Ruby interpreter just in case Rake doesn't</span>
133:     <span class="ruby-comment cmt"># have the correct shebang line; we don't want a totally different</span>
134:     <span class="ruby-comment cmt"># Ruby than the current one to be invoked.</span>
135:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filename</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">is_ruby_program?</span>(<span class="ruby-identifier">filename</span>)
136:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{ruby_command} #{filename}&quot;</span>
137:     <span class="ruby-keyword kw">else</span>
138:       <span class="ruby-comment cmt"># If it's not a Ruby program then it's probably a wrapper</span>
139:       <span class="ruby-comment cmt"># script as is the case with e.g. RVM (~/.rvm/wrappers).</span>
140:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
141:     <span class="ruby-keyword kw">end</span>
142:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000346">
                    
                    <a name="M000346"></a><b>rb_config</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000346_source')" id="l_M000346_source">show</a>
                        
                    </p>
                    <div id="M000346_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 338</span>
338:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rb_config</span>
339:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">RbConfig</span>)
340:       <span class="ruby-keyword kw">return</span> <span class="ruby-operator">::</span><span class="ruby-constant">RbConfig</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>
341:     <span class="ruby-keyword kw">else</span>
342:       <span class="ruby-keyword kw">return</span> <span class="ruby-operator">::</span><span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>
343:     <span class="ruby-keyword kw">end</span>
344:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000328">
                    
                    <a name="M000328"></a><b>read_file</b>(filename)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000328_source')" id="l_M000328_source">show</a>
                        
                    </p>
                    <div id="M000328_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read_file</span>(<span class="ruby-identifier">filename</span>)
133:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">filename</span>)
134:   <span class="ruby-keyword kw">rescue</span>
135:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
136:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000301">
                    
                    <a name="M000301"></a><b>requires_no_tls_direct_seg_refs?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000301_source')" id="l_M000301_source">show</a>
                        
                    </p>
                    <div id="M000301_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 157</span>
157:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">requires_no_tls_direct_seg_refs?</span>
158:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-value str">&quot;/proc/xen/capabilities&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86&quot;</span>
159:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000307">
                    
                    <a name="M000307"></a><b>rspec</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the absolute path to the RSpec runner program that belongs to the
current Ruby interpreter. Returns nil if it doesn&#8217;t exist.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000307_source')" id="l_M000307_source">show</a>
                        
                    </p>
                    <div id="M000307_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 148</span>
148:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rspec</span>
149:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">locate_ruby_tool</span>(<span class="ruby-value str">'spec'</span>)
150:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000298">
                    
                    <a name="M000298"></a><b>ruby_command</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns correct command for invoking the current Ruby interpreter. In case
of RVM this function will return the path to the RVM wrapper script that
executes the current Ruby interpreter in the currently active gem set.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000298_source')" id="l_M000298_source">show</a>
                        
                    </p>
                    <div id="M000298_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ruby_command</span>
49:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_rvm?</span>
50:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">rvm_ruby_string</span>
51:       <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">rvm_path</span>
52:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">dir</span>
53:         <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{dir}/wrappers/#{name}/ruby&quot;</span>
54:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">filename</span>)
55:           <span class="ruby-identifier">contents</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">'rb'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
56:             <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>
57:           <span class="ruby-keyword kw">end</span>
58:           <span class="ruby-comment cmt"># Old wrapper scripts reference $HOME which causes</span>
59:           <span class="ruby-comment cmt"># things to blow up when run by a different user.</span>
60:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;$HOME&quot;</span>)
61:             <span class="ruby-identifier">filename</span> = <span class="ruby-keyword kw">nil</span>
62:           <span class="ruby-keyword kw">end</span>
63:         <span class="ruby-keyword kw">else</span>
64:           <span class="ruby-identifier">filename</span> = <span class="ruby-keyword kw">nil</span>
65:         <span class="ruby-keyword kw">end</span>
66:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filename</span>
67:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
68:         <span class="ruby-keyword kw">else</span>
69:           <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Your RVM wrapper scripts are too old. Please &quot;</span> <span class="ruby-operator">+</span>
70:             <span class="ruby-value str">&quot;update them first by running 'rvm update --head &amp;&amp; &quot;</span> <span class="ruby-operator">+</span>
71:             <span class="ruby-value str">&quot;rvm reload &amp;&amp; rvm repair all'.&quot;</span>
72:           <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
73:         <span class="ruby-keyword kw">end</span>
74:       <span class="ruby-keyword kw">else</span>
75:         <span class="ruby-comment cmt"># Something's wrong with the user's RVM installation.</span>
76:         <span class="ruby-comment cmt"># Raise an error so that the user knows this instead of</span>
77:         <span class="ruby-comment cmt"># having things fail randomly later on.</span>
78:         <span class="ruby-comment cmt"># 'name' is guaranteed to be non-nil because rvm_ruby_string</span>
79:         <span class="ruby-comment cmt"># already raises an exception on error.</span>
80:         <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Your RVM installation appears to be broken: the RVM &quot;</span> <span class="ruby-operator">+</span>
81:           <span class="ruby-value str">&quot;path cannot be found. Please fix your RVM installation &quot;</span> <span class="ruby-operator">+</span>
82:           <span class="ruby-value str">&quot;or contact the RVM developers for support.&quot;</span>
83:         <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
84:       <span class="ruby-keyword kw">end</span>
85:     <span class="ruby-keyword kw">else</span>
86:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ruby_executable</span>
87:     <span class="ruby-keyword kw">end</span>
88:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000302">
                    
                    <a name="M000302"></a><b>ruby_executable</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the full path to the current Ruby interpreter&#8217;s executable
file. This might not be the actual correct command to use for invoking the
Ruby interpreter; use <a href="PlatformInfo.html#M000298">ruby_command</a>
instead.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000302_source')" id="l_M000302_source">show</a>
                        
                    </p>
                    <div id="M000302_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ruby_executable</span>
95:     <span class="ruby-ivar">@@ruby_executable</span> <span class="ruby-operator">||=</span>
96:       <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'bindir'</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">'/'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'RUBY_INSTALL_NAME'</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'EXEEXT'</span>]
97:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000313">
                    
                    <a name="M000313"></a><b>ruby_sudo_command</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns either &#8216;sudo&#8217; or &#8216;rvmsudo&#8217; depending on
whether the current Ruby interpreter is managed by RVM.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000313_source')" id="l_M000313_source">show</a>
                        
                    </p>
                    <div id="M000313_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 232</span>
232:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ruby_sudo_command</span>
233:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_rvm?</span>
234:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;rvmsudo&quot;</span>
235:     <span class="ruby-keyword kw">else</span>
236:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;sudo&quot;</span>
237:     <span class="ruby-keyword kw">end</span>
238:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000303">
                    
                    <a name="M000303"></a><b>ruby_supports_fork?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether the Ruby interpreter supports process forking.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000303_source')" id="l_M000303_source">show</a>
                        
                    </p>
                    <div id="M000303_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 100</span>
100:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ruby_supports_fork?</span>
101:     <span class="ruby-comment cmt"># MRI &gt;= 1.9.2's respond_to? returns false for methods</span>
102:     <span class="ruby-comment cmt"># that are not implemented.</span>
103:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Process</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:fork</span>) <span class="ruby-operator">&amp;&amp;</span>
104:       <span class="ruby-constant">RUBY_ENGINE</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;jruby&quot;</span> <span class="ruby-operator">&amp;&amp;</span>
105:       <span class="ruby-constant">RUBY_ENGINE</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;macruby&quot;</span> <span class="ruby-operator">&amp;&amp;</span>
106:       <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'target_os'</span>] <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/mswin|windows|mingw/</span>
107:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000309">
                    
                    <a name="M000309"></a><b>rvm_path</b>()
                    
                </div>
                
                <div class="description">
                  <p>
If the current Ruby interpreter is managed by RVM, returns the directory in
which RVM places its working files. Otherwise returns nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000309_source')" id="l_M000309_source">show</a>
                        
                    </p>
                    <div id="M000309_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 162</span>
162:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rvm_path</span>
163:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_rvm?</span>
164:       [<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'rvm_path'</span>], <span class="ruby-value str">&quot;~/.rvm&quot;</span>, <span class="ruby-value str">&quot;/usr/local/rvm&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
165:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">nil?</span>
166:         <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">path</span>)
167:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">path</span>)
168:       <span class="ruby-keyword kw">end</span>
169:       <span class="ruby-comment cmt"># Failure to locate the RVM path is probably caused by the</span>
170:       <span class="ruby-comment cmt"># user customizing $rvm_path. Older RVM versions don't</span>
171:       <span class="ruby-comment cmt"># export $rvm_path, making us unable to detect its value.</span>
172:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Unable to locate the RVM path. Your RVM installation &quot;</span> <span class="ruby-operator">+</span>
173:         <span class="ruby-value str">&quot;is probably too old. Please update it with &quot;</span> <span class="ruby-operator">+</span>
174:         <span class="ruby-value str">&quot;'rvm update --head &amp;&amp; rvm reload &amp;&amp; rvm repair all'.&quot;</span>
175:       <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
176:     <span class="ruby-keyword kw">else</span>
177:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
178:     <span class="ruby-keyword kw">end</span>
179:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000310">
                    
                    <a name="M000310"></a><b>rvm_ruby_string</b>()
                    
                </div>
                
                <div class="description">
                  <p>
If the current Ruby interpreter is managed by RVM, returns the RVM name
which identifies the current Ruby interpreter plus the currently active
gemset, e.g. something like this: &#8220;ruby-1.9.2-p0@mygemset&#8220;
</p>
<p>
Returns nil otherwise.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000310_source')" id="l_M000310_source">show</a>
                        
                    </p>
                    <div id="M000310_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 188</span>
188:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">rvm_ruby_string</span>
189:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_rvm?</span>
190:       <span class="ruby-comment cmt"># RVM used to export the necessary information through</span>
191:       <span class="ruby-comment cmt"># environment variables, but doesn't always do that anymore</span>
192:       <span class="ruby-comment cmt"># in the latest versions in order to fight env var pollution.</span>
193:       <span class="ruby-comment cmt"># Scanning $LOAD_PATH seems to be the only way to obtain</span>
194:       <span class="ruby-comment cmt"># the information.</span>
195:       
196:       <span class="ruby-comment cmt"># Getting the RVM name of the Ruby interpreter (&quot;ruby-1.9.2&quot;)</span>
197:       <span class="ruby-comment cmt"># isn't so hard, we can extract it from the #ruby_executable</span>
198:       <span class="ruby-comment cmt"># string. Getting the gemset name is a bit harder, so let's</span>
199:       <span class="ruby-comment cmt"># try various strategies...</span>
200:       
201:       <span class="ruby-comment cmt"># $GEM_HOME usually contains the gem set name.</span>
202:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">GEM_HOME</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">GEM_HOME</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;rvm/gems/&quot;</span>)
203:         <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-constant">GEM_HOME</span>)
204:       <span class="ruby-keyword kw">end</span>
205:       
206:       <span class="ruby-comment cmt"># User somehow managed to nuke $GEM_HOME. Extract info</span>
207:       <span class="ruby-comment cmt"># from $LOAD_PATH.</span>
208:       <span class="ruby-identifier">matching_path</span> = <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">find_all</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>
209:         <span class="ruby-identifier">item</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;rvm/gems/&quot;</span>)
210:       <span class="ruby-keyword kw">end</span>
211:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matching_path</span>
212:         <span class="ruby-identifier">subpath</span> = <span class="ruby-identifier">matching_path</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^.*rvm\/gems\//</span>, <span class="ruby-value str">''</span>)
213:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">subpath</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>).<span class="ruby-identifier">first</span>
214:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>
215:       <span class="ruby-keyword kw">end</span>
216:       
217:       <span class="ruby-comment cmt"># On Ruby 1.9, $LOAD_PATH does not contain any gem paths until</span>
218:       <span class="ruby-comment cmt"># at least one gem has been required so the above can fail.</span>
219:       <span class="ruby-comment cmt"># We're out of options now, we can't detect the gem set.</span>
220:       <span class="ruby-comment cmt"># Raise an exception so that the user knows what's going on</span>
221:       <span class="ruby-comment cmt"># instead of having things fail in obscure ways later.</span>
222:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Unable to autodetect the currently active RVM gem &quot;</span> <span class="ruby-operator">+</span>
223:         <span class="ruby-value str">&quot;set name. Please contact this program's author for support.&quot;</span>
224:       <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
225:     <span class="ruby-keyword kw">end</span>
226:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
227:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000326">
                    
                    <a name="M000326"></a><b>select_executable</b>(dir, *possible_names)
                    
                </div>
                
                <div class="description">
                  <p>
Look in the directory <tt>dir</tt> and check whether there&#8217;s an
executable whose base name is equal to one of the elements in
<tt>possible_names</tt>. If so, returns the full filename. If not, returns
nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000326_source')" id="l_M000326_source">show</a>
                        
                    </p>
                    <div id="M000326_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">select_executable</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">possible_names</span>)
122:     <span class="ruby-identifier">possible_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
123:       <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{dir}/#{name}&quot;</span>
124:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
125:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filename</span>
126:       <span class="ruby-keyword kw">end</span>
127:     <span class="ruby-keyword kw">end</span>
128:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
129:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000300">
                    
                    <a name="M000300"></a><b>supports_lfence_instruction?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether the OS&#8217;s main CPU architecture supports the
x86/x86_64 lfence instruction.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000300_source')" id="l_M000300_source">show</a>
                        
                    </p>
                    <div id="M000300_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 144</span>
144:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">supports_lfence_instruction?</span>
145:     <span class="ruby-identifier">arch</span> = <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>]
146:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86_64&quot;</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86&quot;</span> <span class="ruby-operator">&amp;&amp;</span>
147:       <span class="ruby-identifier">try_compile_and_run</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">%Q{
148:         int
149:         main() {
150:           __asm__ __volatile__ (&quot;lfence&quot; ::: &quot;memory&quot;);
151:           return 0;
152:         }
153:       }</span>))
154:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000299">
                    
                    <a name="M000299"></a><b>supports_sfence_instruction?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns whether the OS&#8217;s main CPU architecture supports the
x86/x86_64 sfence instruction.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000299_source')" id="l_M000299_source">show</a>
                        
                    </p>
                    <div id="M000299_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/operating_system.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">supports_sfence_instruction?</span>
130:     <span class="ruby-identifier">arch</span> = <span class="ruby-identifier">cpu_architectures</span>[<span class="ruby-value">0</span>]
131:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86_64&quot;</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">arch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;x86&quot;</span> <span class="ruby-operator">&amp;&amp;</span>
132:       <span class="ruby-identifier">try_compile_and_run</span>(<span class="ruby-identifier">:c</span>, <span class="ruby-value str">%Q{
133:         int
134:         main() {
135:           __asm__ __volatile__ (&quot;sfence&quot; ::: &quot;memory&quot;);
136:           return 0;
137:         }
138:       }</span>))
139:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000317">
                    
                    <a name="M000317"></a><b>transform_according_to_ruby_exec_format</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Deduce Ruby&#8217;s &#8212;program-prefix and &#8212;program-suffix from
its install name and transforms the given input name accordingly.
</p>
<pre>
  transform_according_to_ruby_exec_format(&quot;rake&quot;)    =&gt; &quot;jrake&quot;, &quot;rake1.8&quot;, etc
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000317_source')" id="l_M000317_source">show</a>
                        
                    </p>
                    <div id="M000317_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/ruby.rb, line 326</span>
326:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">transform_according_to_ruby_exec_format</span>(<span class="ruby-identifier">name</span>)
327:     <span class="ruby-identifier">install_name</span> = <span class="ruby-identifier">rb_config</span>[<span class="ruby-value str">'RUBY_INSTALL_NAME'</span>]
328:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">install_name</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'ruby'</span>)
329:       <span class="ruby-identifier">format</span> = <span class="ruby-identifier">install_name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">'ruby'</span>, <span class="ruby-value str">'%s'</span>)
330:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sprintf</span>(<span class="ruby-identifier">format</span>, <span class="ruby-identifier">name</span>)
331:     <span class="ruby-keyword kw">else</span>
332:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span>
333:     <span class="ruby-keyword kw">end</span>
334:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000338">
                    
                    <a name="M000338"></a><b>try_compile</b>(language, source, flags = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000338_source')" id="l_M000338_source">show</a>
                        
                    </p>
                    <div id="M000338_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 258</span>
258:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">language</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">flags</span> = <span class="ruby-keyword kw">nil</span>)
259:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:c</span>
260:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cc</span>
261:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:cxx</span>
262:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cxx</span>
263:     <span class="ruby-keyword kw">else</span>
264:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,<span class="ruby-node">&quot;Unsupported language '#{language}'&quot;</span>
265:     <span class="ruby-keyword kw">end</span>
266:     <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-node">&quot;#{tmpexedir}/passenger-compile-check-#{Process.pid}.c&quot;</span>)
267:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
268:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">source</span>)
269:     <span class="ruby-keyword kw">end</span>
270:     <span class="ruby-keyword kw">begin</span>
271:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;(#{compiler} #{flags} -c '#{filename}' -o '#{filename}.o') &gt;/dev/null 2&gt;/dev/null&quot;</span>)
272:     <span class="ruby-keyword kw">ensure</span>
273:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
274:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-node">&quot;#{filename}.o&quot;</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
275:     <span class="ruby-keyword kw">end</span>
276:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000344">
                    
                    <a name="M000344"></a><b>try_compile_and_run</b>(language, source, flags = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000344_source')" id="l_M000344_source">show</a>
                        
                    </p>
                    <div id="M000344_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 300</span>
300:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">try_compile_and_run</span>(<span class="ruby-identifier">language</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">flags</span> = <span class="ruby-keyword kw">nil</span>)
301:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:c</span>
302:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cc</span>
303:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:cxx</span>
304:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cxx</span>
305:     <span class="ruby-keyword kw">else</span>
306:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,<span class="ruby-node">&quot;Unsupported language '#{language}'&quot;</span>
307:     <span class="ruby-keyword kw">end</span>
308:     <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-node">&quot;#{tmpexedir}/passenger-compile-check-#{Process.pid}.c&quot;</span>)
309:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
310:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">source</span>)
311:     <span class="ruby-keyword kw">end</span>
312:     <span class="ruby-keyword kw">begin</span>
313:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;(#{compiler} #{flags} '#{filename}' -o '#{filename}.out') &gt;/dev/null 2&gt;/dev/null&quot;</span>)
314:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Process</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:spawn</span>)
315:           <span class="ruby-identifier">pid</span> = <span class="ruby-constant">Process</span>.<span class="ruby-identifier">spawn</span>(<span class="ruby-node">&quot;#{filename}.out&quot;</span>,
316:             <span class="ruby-identifier">:out</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;/dev/null&quot;</span>, <span class="ruby-value str">&quot;w&quot;</span>],
317:             <span class="ruby-identifier">:err</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;/dev/null&quot;</span>, <span class="ruby-value str">&quot;w&quot;</span>])
318:           
319:         <span class="ruby-keyword kw">else</span>
320:           <span class="ruby-identifier">pid</span> = <span class="ruby-identifier">fork</span> <span class="ruby-keyword kw">do</span>
321:             <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">reopen</span>(<span class="ruby-value str">&quot;/dev/null&quot;</span>, <span class="ruby-value str">&quot;w&quot;</span>)
322:             <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">reopen</span>(<span class="ruby-value str">&quot;/dev/null&quot;</span>, <span class="ruby-value str">&quot;w&quot;</span>)
323:             <span class="ruby-identifier">exec</span>(<span class="ruby-node">&quot;#{filename}.out&quot;</span>)
324:           <span class="ruby-keyword kw">end</span>
325:         <span class="ruby-keyword kw">end</span>
326:         <span class="ruby-identifier">pid</span> = <span class="ruby-constant">Process</span>.<span class="ruby-identifier">waitpid</span>(<span class="ruby-identifier">pid</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
327:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pid</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
328:       <span class="ruby-keyword kw">else</span>
329:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
330:       <span class="ruby-keyword kw">end</span>
331:     <span class="ruby-keyword kw">ensure</span>
332:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
333:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-node">&quot;#{filename}.out&quot;</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
334:     <span class="ruby-keyword kw">end</span>
335:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000341">
                    
                    <a name="M000341"></a><b>try_link</b>(language, source, flags = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000341_source')" id="l_M000341_source">show</a>
                        
                    </p>
                    <div id="M000341_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info.rb, line 279</span>
279:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">try_link</span>(<span class="ruby-identifier">language</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">flags</span> = <span class="ruby-keyword kw">nil</span>)
280:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:c</span>
281:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cc</span>
282:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">language</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:cxx</span>
283:       <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">cxx</span>
284:     <span class="ruby-keyword kw">else</span>
285:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,<span class="ruby-node">&quot;Unsupported language '#{language}'&quot;</span>
286:     <span class="ruby-keyword kw">end</span>
287:     <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-node">&quot;#{tmpexedir}/passenger-link-check-#{Process.pid}.c&quot;</span>)
288:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
289:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">source</span>)
290:     <span class="ruby-keyword kw">end</span>
291:     <span class="ruby-keyword kw">begin</span>
292:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;(#{compiler} #{flags} '#{filename}' -o '#{filename}.out') &gt;/dev/null 2&gt;/dev/null&quot;</span>)
293:     <span class="ruby-keyword kw">ensure</span>
294:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
295:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-node">&quot;#{filename}.out&quot;</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
296:     <span class="ruby-keyword kw">end</span>
297:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000311">
                    
                    <a name="M000311"></a><b>zlib_flags</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000311_source')" id="l_M000311_source">show</a>
                        
                    </p>
                    <div id="M000311_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/zlib.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">zlib_flags</span>
30:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
31:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000312">
                    
                    <a name="M000312"></a><b>zlib_libs</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000312_source')" id="l_M000312_source">show</a>
                        
                    </p>
                    <div id="M000312_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/platform_info/zlib.rb, line 33</span>
33:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">zlib_libs</span>
34:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'-lz'</span>
35:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    