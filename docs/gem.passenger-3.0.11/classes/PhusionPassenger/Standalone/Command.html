<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>PhusionPassenger::Standalone::Command</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            PhusionPassenger::Standalone::Command 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/phusion_passenger/standalone/command_rb.html">lib/phusion_passenger/standalone/command.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000425">create_nginx_controller</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000399">debugging?</a>,</li>
                
                <li><a href="#M000393">description</a>,</li>
                
                <li><a href="#M000421">determine_nginx_start_command</a>,</li>
                
                <li><a href="#M000405">determine_various_resource_locations</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000401">error</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000394">new</a>,</li>
                
                <li><a href="#M000422">nginx_ping_port</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000400">parse_options!</a>,</li>
                
                <li><a href="#M000424">ping_nginx</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000398">require_app_finder</a>,</li>
                
                <li><a href="#M000395">require_daemon_controller</a>,</li>
                
                <li><a href="#M000396">require_erb</a>,</li>
                
                <li><a href="#M000397">require_optparse</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000392">show_in_command_list</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000402">wrap_desc</a>,</li>
                
                <li><a href="#M000416">write_nginx_config_file</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../Rack.html">PhusionPassenger::Rack</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">DEFAULT_OPTIONS</td>
            <td>=</td>
            <td class="attr-value">{     :address       =&gt; '0.0.0.0',     :port          =&gt; 3000,     :env           =&gt; ENV['RAILS_ENV'] || ENV['RACK_ENV'] || 'development',     :max_pool_size =&gt; 6,     :min_instances =&gt; 1,     :spawn_method  =&gt; 'smart-lv2',     :nginx_version =&gt; PREFERRED_NGINX_VERSION</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000393">
                    
                    <a name="M000393"></a><b>description</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000393_source')" id="l_M000393_source">show</a>
                        
                    </p>
                    <div id="M000393_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 47</span>
47:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">description</span>
48:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
49:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000394">
                    
                    <a name="M000394"></a><b>new</b>(args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000394_source')" id="l_M000394_source">show</a>
                        
                    </p>
                    <div id="M000394_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">args</span>)
52:     <span class="ruby-ivar">@args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">dup</span>
53:     <span class="ruby-ivar">@original_args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">dup</span>
54:     <span class="ruby-ivar">@options</span> = <span class="ruby-constant">DEFAULT_OPTIONS</span>.<span class="ruby-identifier">dup</span>
55:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000392">
                    
                    <a name="M000392"></a><b>show_in_command_list</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000392_source')" id="l_M000392_source">show</a>
                        
                    </p>
                    <div id="M000392_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">show_in_command_list</span>
44:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
45:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000425">
                    
                    <a name="M000425"></a><b>create_nginx_controller</b>(extra_options = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000425_source')" id="l_M000425_source">show</a>
                        
                    </p>
                    <div id="M000425_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_nginx_controller</span>(<span class="ruby-identifier">extra_options</span> = {})
223:     <span class="ruby-identifier">require_daemon_controller</span>
224:     <span class="ruby-ivar">@temp_dir</span>        = <span class="ruby-node">&quot;/tmp/passenger-standalone.#{$$}&quot;</span>
225:     <span class="ruby-ivar">@config_filename</span> = <span class="ruby-node">&quot;#{@temp_dir}/config&quot;</span>
226:     <span class="ruby-identifier">opts</span> = {
227:       <span class="ruby-identifier">:identifier</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Nginx'</span>,
228:       <span class="ruby-identifier">:before_start</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span>(<span class="ruby-identifier">:write_nginx_config_file</span>),
229:       <span class="ruby-identifier">:start_command</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span>(<span class="ruby-identifier">:determine_nginx_start_command</span>),
230:       <span class="ruby-identifier">:ping_command</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span>(<span class="ruby-identifier">:ping_nginx</span>),
231:       <span class="ruby-identifier">:pid_file</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:pid_file</span>],
232:       <span class="ruby-identifier">:log_file</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:log_file</span>],
233:       <span class="ruby-identifier">:timeout</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>
234:     }
235:     <span class="ruby-ivar">@nginx</span> = <span class="ruby-constant">DaemonController</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">extra_options</span>))
236:     <span class="ruby-ivar">@nginx_mutex</span> = <span class="ruby-constant">Mutex</span>.<span class="ruby-identifier">new</span>
237:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000399">
                    
                    <a name="M000399"></a><b>debugging?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000399_source')" id="l_M000399_source">show</a>
                        
                    </p>
                    <div id="M000399_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 96</span>
96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debugging?</span>
97:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'PASSENGER_DEBUG'</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">ENV</span>[<span class="ruby-value str">'PASSENGER_DEBUG'</span>].<span class="ruby-identifier">empty?</span>
98:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000421">
                    
                    <a name="M000421"></a><b>determine_nginx_start_command</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000421_source')" id="l_M000421_source">show</a>
                        
                    </p>
                    <div id="M000421_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 195</span>
195:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">determine_nginx_start_command</span>
196:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:nginx_bin</span>]
197:       <span class="ruby-identifier">nginx_bin</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:nginx_bin</span>]
198:     <span class="ruby-keyword kw">else</span>
199:       <span class="ruby-identifier">nginx_bin</span> = <span class="ruby-node">&quot;#{nginx_dir}/sbin/nginx&quot;</span>
200:     <span class="ruby-keyword kw">end</span>
201:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{nginx_bin} -c '#{@config_filename}' -p '#{@temp_dir}/'&quot;</span>
202:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000405">
                    
                    <a name="M000405"></a><b>determine_various_resource_locations</b>(create_subdirs = true)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000405_source')" id="l_M000405_source">show</a>
                        
                    </p>
                    <div id="M000405_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 146</span>
146:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">determine_various_resource_locations</span>(<span class="ruby-identifier">create_subdirs</span> = <span class="ruby-keyword kw">true</span>)
147:     <span class="ruby-identifier">require_app_finder</span>
148:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:socket_file</span>]
149:       <span class="ruby-identifier">pid_basename</span> = <span class="ruby-value str">&quot;passenger.pid&quot;</span>
150:       <span class="ruby-identifier">log_basename</span> = <span class="ruby-value str">&quot;passenger.log&quot;</span>
151:     <span class="ruby-keyword kw">else</span>
152:       <span class="ruby-identifier">pid_basename</span> = <span class="ruby-node">&quot;passenger.#{@options[:port]}.pid&quot;</span>
153:       <span class="ruby-identifier">log_basename</span> = <span class="ruby-node">&quot;passenger.#{@options[:port]}.log&quot;</span>
154:     <span class="ruby-keyword kw">end</span>
155:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@args</span>.<span class="ruby-identifier">empty?</span>
156:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">AppFinder</span>.<span class="ruby-identifier">looks_like_app_directory?</span>(<span class="ruby-value str">&quot;.&quot;</span>)
157:         <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:pid_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-node">&quot;tmp/pids/#{pid_basename}&quot;</span>)
158:         <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:log_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-node">&quot;log/#{log_basename}&quot;</span>)
159:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">create_subdirs</span>
160:           <span class="ruby-identifier">ensure_directory_exists</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:pid_file</span>]))
161:           <span class="ruby-identifier">ensure_directory_exists</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:log_file</span>]))
162:         <span class="ruby-keyword kw">end</span>
163:       <span class="ruby-keyword kw">else</span>
164:         <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:pid_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">pid_basename</span>)
165:         <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:log_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">log_basename</span>)
166:       <span class="ruby-keyword kw">end</span>
167:     <span class="ruby-keyword kw">else</span>
168:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:pid_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@args</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">pid_basename</span>))
169:       <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:log_file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@args</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">log_basename</span>))
170:     <span class="ruby-keyword kw">end</span>
171:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000401">
                    
                    <a name="M000401"></a><b>error</b>(message)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000401_source')" id="l_M000401_source">show</a>
                        
                    </p>
                    <div id="M000401_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>(<span class="ruby-identifier">message</span>)
129:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\n/</span>
130:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;*** ERROR ***\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">wrap_desc</span>(<span class="ruby-identifier">message</span>, <span class="ruby-value">80</span>, <span class="ruby-value">0</span>))
131:     <span class="ruby-keyword kw">else</span>
132:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">wrap_desc</span>(<span class="ruby-node">&quot;*** ERROR: #{message}&quot;</span>, <span class="ruby-value">80</span>, <span class="ruby-value">0</span>))
133:     <span class="ruby-keyword kw">end</span>
134:     <span class="ruby-ivar">@plugin</span>.<span class="ruby-identifier">call_hook</span>(<span class="ruby-identifier">:error</span>, <span class="ruby-identifier">message</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@plugin</span>
135:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000422">
                    
                    <a name="M000422"></a><b>nginx_ping_port</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the port on which to ping Nginx.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000422_source')" id="l_M000422_source">show</a>
                        
                    </p>
                    <div id="M000422_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 205</span>
205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nginx_ping_port</span>
206:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ping_port</span>]
207:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:ping_port</span>]
208:     <span class="ruby-keyword kw">else</span>
209:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:port</span>]
210:     <span class="ruby-keyword kw">end</span>
211:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000400">
                    
                    <a name="M000400"></a><b>parse_options!</b>(command_name, description = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000400_source')" id="l_M000400_source">show</a>
                        
                    </p>
                    <div id="M000400_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 100</span>
100:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_options!</span>(<span class="ruby-identifier">command_name</span>, <span class="ruby-identifier">description</span> = <span class="ruby-keyword kw">nil</span>)
101:     <span class="ruby-identifier">help</span> = <span class="ruby-keyword kw">false</span>
102:     
103:     <span class="ruby-identifier">global_config_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'HOME'</span>], <span class="ruby-constant">LOCAL_DIR</span>, <span class="ruby-value str">&quot;standalone&quot;</span>, <span class="ruby-value str">&quot;config&quot;</span>)
104:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">global_config_file</span>)
105:       <span class="ruby-identifier">require</span> <span class="ruby-value str">'phusion_passenger/standalone/config_file'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">ConfigFile</span>)
106:       <span class="ruby-identifier">global_options</span> = <span class="ruby-constant">ConfigFile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:global_config</span>, <span class="ruby-identifier">global_config_file</span>).<span class="ruby-identifier">options</span>
107:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">global_options</span>)
108:     <span class="ruby-keyword kw">end</span>
109:     
110:     <span class="ruby-identifier">require_optparse</span>
111:     <span class="ruby-identifier">parser</span> = <span class="ruby-constant">OptionParser</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opts</span><span class="ruby-operator">|</span>
112:       <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">banner</span> = <span class="ruby-node">&quot;Usage: passenger #{command_name} [options]&quot;</span>
113:       <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">separator</span> <span class="ruby-identifier">description</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">description</span>
114:       <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">separator</span> <span class="ruby-value str">&quot; &quot;</span>
115:       <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">separator</span> <span class="ruby-value str">&quot;Options:&quot;</span>
116:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">opts</span>
117:       <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;-h&quot;</span>, <span class="ruby-value str">&quot;--help&quot;</span>, <span class="ruby-value str">&quot;Show this help message&quot;</span>) <span class="ruby-keyword kw">do</span>
118:         <span class="ruby-identifier">help</span> = <span class="ruby-keyword kw">true</span>
119:       <span class="ruby-keyword kw">end</span>
120:     <span class="ruby-keyword kw">end</span>
121:     <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">parse!</span>(<span class="ruby-ivar">@args</span>)
122:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">help</span>
123:       <span class="ruby-identifier">puts</span> <span class="ruby-identifier">parser</span>
124:       <span class="ruby-identifier">exit</span> <span class="ruby-value">0</span>
125:     <span class="ruby-keyword kw">end</span>
126:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000424">
                    
                    <a name="M000424"></a><b>ping_nginx</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000424_source')" id="l_M000424_source">show</a>
                        
                    </p>
                    <div id="M000424_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 213</span>
213:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ping_nginx</span>
214:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'socket'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">UNIXSocket</span>)
215:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:socket_file</span>]
216:       <span class="ruby-constant">UNIXSocket</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:socket_file</span>])
217:     <span class="ruby-keyword kw">else</span>
218:       <span class="ruby-constant">TCPSocket</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:address</span>], <span class="ruby-identifier">nginx_ping_port</span>)
219:     <span class="ruby-keyword kw">end</span>
220:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000398">
                    
                    <a name="M000398"></a><b>require_app_finder</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000398_source')" id="l_M000398_source">show</a>
                        
                    </p>
                    <div id="M000398_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">require_app_finder</span>
93:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'phusion_passenger/standalone/app_finder'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">AppFinder</span>)
94:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000395">
                    
                    <a name="M000395"></a><b>require_daemon_controller</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000395_source')" id="l_M000395_source">show</a>
                        
                    </p>
                    <div id="M000395_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 58</span>
58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">require_daemon_controller</span>
59:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">DaemonController</span>)
60:       <span class="ruby-keyword kw">begin</span>
61:         <span class="ruby-identifier">require</span> <span class="ruby-value str">'daemon_controller'</span>
62:         <span class="ruby-keyword kw">begin</span>
63:           <span class="ruby-identifier">require</span> <span class="ruby-value str">'daemon_controller/version'</span>
64:           <span class="ruby-identifier">too_old</span> = <span class="ruby-constant">DaemonController</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION_STRING</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value str">'0.2.5'</span>
65:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">LoadError</span>
66:           <span class="ruby-identifier">too_old</span> = <span class="ruby-keyword kw">true</span>
67:         <span class="ruby-keyword kw">end</span>
68:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">too_old</span>
69:           <span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;Your version of daemon_controller is too old. &quot;</span> <span class="ruby-operator">&lt;&lt;</span>
70:                 <span class="ruby-value str">&quot;You must install 0.2.5 or later. Please upgrade:\n\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
71:                 
72:                 <span class="ruby-value str">&quot; sudo gem uninstall FooBarWidget-daemon_controller\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
73:                 <span class="ruby-value str">&quot; sudo gem install daemon_controller&quot;</span>
74:           <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
75:         <span class="ruby-keyword kw">end</span>
76:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">LoadError</span>
77:         <span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;Please install daemon_controller first:\n\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span>
78:               <span class="ruby-value str">&quot; sudo gem install daemon_controller&quot;</span>
79:         <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
80:       <span class="ruby-keyword kw">end</span>
81:     <span class="ruby-keyword kw">end</span>
82:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000396">
                    
                    <a name="M000396"></a><b>require_erb</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000396_source')" id="l_M000396_source">show</a>
                        
                    </p>
                    <div id="M000396_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 84</span>
84:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">require_erb</span>
85:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'erb'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">ERB</span>)
86:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000397">
                    
                    <a name="M000397"></a><b>require_optparse</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000397_source')" id="l_M000397_source">show</a>
                        
                    </p>
                    <div id="M000397_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">require_optparse</span>
89:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'optparse'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">OptionParser</span>)
90:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000402">
                    
                    <a name="M000402"></a><b>wrap_desc</b>(description_text, max_width = 43, newline_prefix_size = 37)
                    
                </div>
                
                <div class="description">
                  <p>
Word wrap the given option description text so that it is formatted nicely
in the &#8212;help output.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000402_source')" id="l_M000402_source">show</a>
                        
                    </p>
                    <div id="M000402_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrap_desc</span>(<span class="ruby-identifier">description_text</span>, <span class="ruby-identifier">max_width</span> = <span class="ruby-value">43</span>, <span class="ruby-identifier">newline_prefix_size</span> = <span class="ruby-value">37</span>)
140:     <span class="ruby-identifier">line_prefix</span> = <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-value str">' '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">newline_prefix_size</span>)
141:     <span class="ruby-identifier">result</span> = <span class="ruby-identifier">description_text</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/(.{1,#{max_width}})( +|$\n?)|(.{1,#{max_width}})/</span>, <span class="ruby-node">&quot;\\1\\3#{line_prefix}&quot;</span>)
142:     <span class="ruby-identifier">result</span>.<span class="ruby-identifier">strip!</span>
143:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
144:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000416">
                    
                    <a name="M000416"></a><b>write_nginx_config_file</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000416_source')" id="l_M000416_source">show</a>
                        
                    </p>
                    <div id="M000416_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/phusion_passenger/standalone/command.rb, line 173</span>
173:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_nginx_config_file</span>
174:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'phusion_passenger/platform_info/ruby'</span>
175:     <span class="ruby-identifier">ensure_directory_exists</span>(<span class="ruby-ivar">@temp_dir</span>)
176:     
177:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-ivar">@config_filename</span>, <span class="ruby-value str">'w'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
178:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">chmod</span>(<span class="ruby-value">0644</span>)
179:       <span class="ruby-identifier">template_filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">TEMPLATES_DIR</span>, <span class="ruby-value str">&quot;standalone&quot;</span>, <span class="ruby-value str">&quot;config.erb&quot;</span>)
180:       <span class="ruby-identifier">require_erb</span>
181:       <span class="ruby-identifier">erb</span> = <span class="ruby-constant">ERB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">template_filename</span>))
182:       
183:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">debugging?</span>
184:         <span class="ruby-identifier">passenger_root</span> = <span class="ruby-constant">SOURCE_ROOT</span>
185:       <span class="ruby-keyword kw">else</span>
186:         <span class="ruby-identifier">passenger_root</span> = <span class="ruby-identifier">passenger_support_files_dir</span>
187:       <span class="ruby-keyword kw">end</span>
188:       <span class="ruby-comment cmt"># The template requires some helper methods which are defined in start_command.rb.</span>
189:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">erb</span>.<span class="ruby-identifier">result</span>(<span class="ruby-identifier">binding</span>)
190:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">output</span>)
191:       <span class="ruby-identifier">puts</span> <span class="ruby-identifier">output</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">debugging?</span>
192:     <span class="ruby-keyword kw">end</span>
193:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    