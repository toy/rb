<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActiveRecord::QueryMethods</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            ActiveRecord::QueryMethods 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/activerecord-3_1_3/lib/active_record/relation/query_methods_rb.html">activerecord-3.1.3/lib/active_record/relation/query_methods.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M001667">apply_modules</a>,</li>
                
                <li><a href="#M001656">arel</a>,</li>
                
                <li><a href="#M001669">array_of_strings?</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M001643">bind</a>,</li>
                
                <li><a href="#M001659">build_arel</a>,</li>
                
                <li><a href="#M001664">build_joins</a>,</li>
                
                <li><a href="#M001666">build_select</a>,</li>
                
                <li><a href="#M001663">build_where</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M001662">collapse_wheres</a>,</li>
                
                <li><a href="#M001651">create_with</a>,</li>
                
                <li><a href="#M001661">custom_join_ast</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M001633">eager_load</a>,</li>
                
                <li><a href="#M001654">extending</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M001653">from</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M001638">group</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M001646">having</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M001631">includes</a></li>
                
            </ul>
        </dd>
    
        <dt>J</dt>
        <dd>
            <ul>
                
                <li><a href="#M001642">joins</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M001647">limit</a>,</li>
                
                <li><a href="#M001649">lock</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M001648">offset</a>,</li>
                
                <li><a href="#M001639">order</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M001634">preload</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M001650">readonly</a>,</li>
                
                <li><a href="#M001641">reorder</a>,</li>
                
                <li><a href="#M001655">reverse_order</a>,</li>
                
                <li><a href="#M001668">reverse_sql_order</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M001637">select</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M001644">where</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>includes_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>eager_load_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>preload_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>select_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>group_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>order_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>joins_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>where_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>having_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>bind_values</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>limit_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>offset_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>lock_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>readonly_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>create_with_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>from_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>reorder_value</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>reverse_order_value</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M001656">
                    
                    <a name="M001656"></a><b>arel</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001656_source')" id="l_M001656_source">show</a>
                        
                    </p>
                    <div id="M001656_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arel</span>
196:       <span class="ruby-ivar">@arel</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">with_default_scope</span>.<span class="ruby-identifier">build_arel</span>
197:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001643">
                    
                    <a name="M001643"></a><b>bind</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001643_source')" id="l_M001643_source">show</a>
                        
                    </p>
                    <div id="M001643_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">bind</span>(<span class="ruby-identifier">value</span>)
115:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
116:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">bind_values</span> <span class="ruby-operator">+=</span> [<span class="ruby-identifier">value</span>]
117:       <span class="ruby-identifier">relation</span>
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001659">
                    
                    <a name="M001659"></a><b>build_arel</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001659_source')" id="l_M001659_source">show</a>
                        
                    </p>
                    <div id="M001659_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 199</span>
199:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build_arel</span>
200:       <span class="ruby-identifier">arel</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">from</span> <span class="ruby-identifier">table</span>
201: 
202:       <span class="ruby-identifier">build_joins</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-ivar">@joins_values</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@joins_values</span>.<span class="ruby-identifier">empty?</span>
203: 
204:       <span class="ruby-identifier">collapse_wheres</span>(<span class="ruby-identifier">arel</span>, (<span class="ruby-ivar">@where_values</span> <span class="ruby-operator">-</span> [<span class="ruby-value str">''</span>]).<span class="ruby-identifier">uniq</span>)
205: 
206:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">having</span>(<span class="ruby-operator">*</span><span class="ruby-ivar">@having_values</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">blank?</span>}) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@having_values</span>.<span class="ruby-identifier">empty?</span>
207: 
208:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">take</span>(<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">sanitize_limit</span>(<span class="ruby-ivar">@limit_value</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@limit_value</span>
209:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">skip</span>(<span class="ruby-ivar">@offset_value</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@offset_value</span>
210: 
211:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-ivar">@group_values</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">g</span><span class="ruby-operator">|</span> <span class="ruby-identifier">g</span>.<span class="ruby-identifier">blank?</span>}) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@group_values</span>.<span class="ruby-identifier">empty?</span>
212: 
213:       <span class="ruby-identifier">order</span> = <span class="ruby-ivar">@reorder_value</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@reorder_value</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@order_values</span>
214:       <span class="ruby-identifier">order</span> = <span class="ruby-identifier">reverse_sql_order</span>(<span class="ruby-identifier">order</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@reverse_order_value</span>
215:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">blank?</span>}) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span>
216: 
217:       <span class="ruby-identifier">build_select</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-ivar">@select_values</span>.<span class="ruby-identifier">uniq</span>)
218: 
219:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">from</span>(<span class="ruby-ivar">@from_value</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@from_value</span>
220:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">lock</span>(<span class="ruby-ivar">@lock_value</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lock_value</span>
221: 
222:       <span class="ruby-identifier">arel</span>
223:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001651">
                    
                    <a name="M001651"></a><b>create_with</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001651_source')" id="l_M001651_source">show</a>
                        
                    </p>
                    <div id="M001651_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_with</span>(<span class="ruby-identifier">value</span>)
168:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
169:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">create_with_value</span> = <span class="ruby-identifier">value</span> <span class="ruby-value">? </span><span class="ruby-identifier">create_with_value</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">value</span>) <span class="ruby-operator">:</span> {}
170:       <span class="ruby-identifier">relation</span>
171:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001633">
                    
                    <a name="M001633"></a><b>eager_load</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001633_source')" id="l_M001633_source">show</a>
                        
                    </p>
                    <div id="M001633_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 24</span>
24:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eager_load</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
25:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">blank?</span>
26: 
27:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
28:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">eager_load_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">args</span>
29:       <span class="ruby-identifier">relation</span>
30:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001654">
                    
                    <a name="M001654"></a><b>extending</b>(*modules)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001654_source')" id="l_M001654_source">show</a>
                        
                    </p>
                    <div id="M001654_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 179</span>
179:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">extending</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">modules</span>)
180:       <span class="ruby-identifier">modules</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">&amp;</span><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
181: 
182:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">empty?</span>
183: 
184:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
185:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:apply_modules</span>, <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">flatten</span>)
186:       <span class="ruby-identifier">relation</span>
187:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001653">
                    
                    <a name="M001653"></a><b>from</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001653_source')" id="l_M001653_source">show</a>
                        
                    </p>
                    <div id="M001653_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 173</span>
173:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from</span>(<span class="ruby-identifier">value</span>)
174:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
175:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">from_value</span> = <span class="ruby-identifier">value</span>
176:       <span class="ruby-identifier">relation</span>
177:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001638">
                    
                    <a name="M001638"></a><b>group</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001638_source')" id="l_M001638_source">show</a>
                        
                    </p>
                    <div id="M001638_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 79</span>
79:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
80:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">blank?</span>
81: 
82:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
83:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">group_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>
84:       <span class="ruby-identifier">relation</span>
85:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001646">
                    
                    <a name="M001646"></a><b>having</b>(opts, *rest)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001646_source')" id="l_M001646_source">show</a>
                        
                    </p>
                    <div id="M001646_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 128</span>
128:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">having</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rest</span>)
129:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">blank?</span>
130: 
131:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
132:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">having_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">build_where</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">rest</span>)
133:       <span class="ruby-identifier">relation</span>
134:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001631">
                    
                    <a name="M001631"></a><b>includes</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001631_source')" id="l_M001631_source">show</a>
                        
                    </p>
                    <div id="M001631_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 14</span>
14:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">includes</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
15:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">reject!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">blank?</span> }
16: 
17:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
18: 
19:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
20:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">includes_values</span> = (<span class="ruby-identifier">relation</span>.<span class="ruby-identifier">includes_values</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">args</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
21:       <span class="ruby-identifier">relation</span>
22:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001642">
                    
                    <a name="M001642"></a><b>joins</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001642_source')" id="l_M001642_source">show</a>
                        
                    </p>
                    <div id="M001642_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 103</span>
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">joins</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
104:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">blank?</span>
105: 
106:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
107: 
108:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten!</span>
109:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">joins_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">args</span>
110: 
111:       <span class="ruby-identifier">relation</span>
112:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001647">
                    
                    <a name="M001647"></a><b>limit</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001647_source')" id="l_M001647_source">show</a>
                        
                    </p>
                    <div id="M001647_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 136</span>
136:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">value</span>)
137:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
138:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">limit_value</span> = <span class="ruby-identifier">value</span>
139:       <span class="ruby-identifier">relation</span>
140:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001649">
                    
                    <a name="M001649"></a><b>lock</b>(locks = true)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001649_source')" id="l_M001649_source">show</a>
                        
                    </p>
                    <div id="M001649_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 148</span>
148:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lock</span>(<span class="ruby-identifier">locks</span> = <span class="ruby-keyword kw">true</span>)
149:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
150: 
151:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">locks</span>
152:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">TrueClass</span>, <span class="ruby-constant">NilClass</span>
153:         <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">lock_value</span> = <span class="ruby-identifier">locks</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">true</span>
154:       <span class="ruby-keyword kw">else</span>
155:         <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">lock_value</span> = <span class="ruby-keyword kw">false</span>
156:       <span class="ruby-keyword kw">end</span>
157: 
158:       <span class="ruby-identifier">relation</span>
159:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001648">
                    
                    <a name="M001648"></a><b>offset</b>(value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001648_source')" id="l_M001648_source">show</a>
                        
                    </p>
                    <div id="M001648_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 142</span>
142:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">offset</span>(<span class="ruby-identifier">value</span>)
143:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
144:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">offset_value</span> = <span class="ruby-identifier">value</span>
145:       <span class="ruby-identifier">relation</span>
146:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001639">
                    
                    <a name="M001639"></a><b>order</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001639_source')" id="l_M001639_source">show</a>
                        
                    </p>
                    <div id="M001639_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 87</span>
87:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
88:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">blank?</span>
89: 
90:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
91:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">order_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>
92:       <span class="ruby-identifier">relation</span>
93:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001634">
                    
                    <a name="M001634"></a><b>preload</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001634_source')" id="l_M001634_source">show</a>
                        
                    </p>
                    <div id="M001634_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 32</span>
32:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preload</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
33:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">blank?</span>
34: 
35:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
36:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">preload_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">args</span>
37:       <span class="ruby-identifier">relation</span>
38:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001650">
                    
                    <a name="M001650"></a><b>readonly</b>(value = true)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001650_source')" id="l_M001650_source">show</a>
                        
                    </p>
                    <div id="M001650_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 161</span>
161:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readonly</span>(<span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">true</span>)
162:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
163:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">readonly_value</span> = <span class="ruby-identifier">value</span>
164:       <span class="ruby-identifier">relation</span>
165:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001641">
                    
                    <a name="M001641"></a><b>reorder</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001641_source')" id="l_M001641_source">show</a>
                        
                    </p>
                    <div id="M001641_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 95</span>
 95:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reorder</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
 96:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">blank?</span>
 97: 
 98:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
 99:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">reorder_value</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>
100:       <span class="ruby-identifier">relation</span>
101:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001655">
                    
                    <a name="M001655"></a><b>reverse_order</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001655_source')" id="l_M001655_source">show</a>
                        
                    </p>
                    <div id="M001655_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 189</span>
189:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reverse_order</span>
190:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
191:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">reverse_order_value</span> = <span class="ruby-operator">!</span><span class="ruby-identifier">relation</span>.<span class="ruby-identifier">reverse_order_value</span>
192:       <span class="ruby-identifier">relation</span>
193:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001637">
                    
                    <a name="M001637"></a><b>select</b>(value = Proc.new)
                    
                </div>
                
                <div class="description">
                  <p>
Works in two unique ways.
</p>
<p>
First: takes a block so it can be used just like Array#select.
</p>
<pre>
  Model.scoped.select { |m| m.field == value }
</pre>
<p>
This will build an array of objects from the database for the scope,
converting them into an array and iterating through them using
Array#select.
</p>
<p>
Second: Modifies the SELECT statement for the query so that only certain
fields are retrieved:
</p>
<pre>
  &gt;&gt; Model.select(:field)
  =&gt; [#&lt;Model field:value&gt;]
</pre>
<p>
Although in the above example it looks as though this method returns an
array, it actually returns a relation object and can have other query
methods appended to it, such as the other methods in <a
href="QueryMethods.html">ActiveRecord::QueryMethods</a>.
</p>
<p>
This method will also take multiple parameters:
</p>
<pre>
  &gt;&gt; Model.select(:field, :other_field, :and_one_more)
  =&gt; [#&lt;Model field: &quot;value&quot;, other_field: &quot;value&quot;, and_one_more: &quot;value&quot;&gt;]
</pre>
<p>
Any attributes that do not have fields retrieved by a select will return
`nil` when the getter method for that attribute is used:
</p>
<pre>
  &gt;&gt; Model.select(:field).first.other_field
  =&gt; nil
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001637_source')" id="l_M001637_source">show</a>
                        
                    </p>
                    <div id="M001637_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 69</span>
69:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-identifier">value</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>)
70:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
71:         <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">select</span> {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">block_args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">call</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">block_args</span>) }
72:       <span class="ruby-keyword kw">else</span>
73:         <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
74:         <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">select_values</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">value</span>)
75:         <span class="ruby-identifier">relation</span>
76:       <span class="ruby-keyword kw">end</span>
77:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001644">
                    
                    <a name="M001644"></a><b>where</b>(opts, *rest)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001644_source')" id="l_M001644_source">show</a>
                        
                    </p>
                    <div id="M001644_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">where</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rest</span>)
121:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">blank?</span>
122: 
123:       <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">clone</span>
124:       <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">where_values</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">build_where</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">rest</span>)
125:       <span class="ruby-identifier">relation</span>
126:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M001667">
                    
                    <a name="M001667"></a><b>apply_modules</b>(modules)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001667_source')" id="l_M001667_source">show</a>
                        
                    </p>
                    <div id="M001667_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 322</span>
322:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">apply_modules</span>(<span class="ruby-identifier">modules</span>)
323:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">empty?</span>
324:         <span class="ruby-ivar">@extensions</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">modules</span>
325:         <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">extension</span><span class="ruby-operator">|</span> <span class="ruby-identifier">extend</span>(<span class="ruby-identifier">extension</span>) }
326:       <span class="ruby-keyword kw">end</span>
327:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001669">
                    
                    <a name="M001669"></a><b>array_of_strings?</b>(o)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001669_source')" id="l_M001669_source">show</a>
                        
                    </p>
                    <div id="M001669_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 346</span>
346:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">array_of_strings?</span>(<span class="ruby-identifier">o</span>)
347:       <span class="ruby-identifier">o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)}
348:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001664">
                    
                    <a name="M001664"></a><b>build_joins</b>(manager, joins)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001664_source')" id="l_M001664_source">show</a>
                        
                    </p>
                    <div id="M001664_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 268</span>
268:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build_joins</span>(<span class="ruby-identifier">manager</span>, <span class="ruby-identifier">joins</span>)
269:       <span class="ruby-identifier">buckets</span> = <span class="ruby-identifier">joins</span>.<span class="ruby-identifier">group_by</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">join</span><span class="ruby-operator">|</span>
270:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">join</span>
271:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
272:           <span class="ruby-value str">'string_join'</span>
273:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>, <span class="ruby-constant">Symbol</span>, <span class="ruby-constant">Array</span>
274:           <span class="ruby-value str">'association_join'</span>
275:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinDependency</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinAssociation</span>
276:           <span class="ruby-value str">'stashed_join'</span>
277:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Join</span>
278:           <span class="ruby-value str">'join_node'</span>
279:         <span class="ruby-keyword kw">else</span>
280:           <span class="ruby-identifier">raise</span> <span class="ruby-value str">'unknown class: %s'</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">join</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>
281:         <span class="ruby-keyword kw">end</span>
282:       <span class="ruby-keyword kw">end</span>
283: 
284:       <span class="ruby-identifier">association_joins</span>         = <span class="ruby-identifier">buckets</span>[<span class="ruby-value str">'association_join'</span>] <span class="ruby-operator">||</span> []
285:       <span class="ruby-identifier">stashed_association_joins</span> = <span class="ruby-identifier">buckets</span>[<span class="ruby-value str">'stashed_join'</span>] <span class="ruby-operator">||</span> []
286:       <span class="ruby-identifier">join_nodes</span>                = (<span class="ruby-identifier">buckets</span>[<span class="ruby-value str">'join_node'</span>] <span class="ruby-operator">||</span> []).<span class="ruby-identifier">uniq</span>
287:       <span class="ruby-identifier">string_joins</span>              = (<span class="ruby-identifier">buckets</span>[<span class="ruby-value str">'string_join'</span>] <span class="ruby-operator">||</span> []).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
288:         <span class="ruby-identifier">x</span>.<span class="ruby-identifier">strip</span>
289:       }.<span class="ruby-identifier">uniq</span>
290: 
291:       <span class="ruby-identifier">join_list</span> = <span class="ruby-identifier">join_nodes</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">custom_join_ast</span>(<span class="ruby-identifier">manager</span>, <span class="ruby-identifier">string_joins</span>)
292: 
293:       <span class="ruby-identifier">join_dependency</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinDependency</span>.<span class="ruby-identifier">new</span>(
294:         <span class="ruby-ivar">@klass</span>,
295:         <span class="ruby-identifier">association_joins</span>,
296:         <span class="ruby-identifier">join_list</span>
297:       )
298: 
299:       <span class="ruby-identifier">join_dependency</span>.<span class="ruby-identifier">graft</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">stashed_association_joins</span>)
300: 
301:       <span class="ruby-ivar">@implicit_readonly</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">association_joins</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stashed_association_joins</span>.<span class="ruby-identifier">empty?</span>
302: 
303:       <span class="ruby-comment cmt"># FIXME: refactor this to build an AST</span>
304:       <span class="ruby-identifier">join_dependency</span>.<span class="ruby-identifier">join_associations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">association</span><span class="ruby-operator">|</span>
305:         <span class="ruby-identifier">association</span>.<span class="ruby-identifier">join_to</span>(<span class="ruby-identifier">manager</span>)
306:       <span class="ruby-keyword kw">end</span>
307: 
308:       <span class="ruby-identifier">manager</span>.<span class="ruby-identifier">join_sources</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">join_list</span>
309: 
310:       <span class="ruby-identifier">manager</span>
311:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001666">
                    
                    <a name="M001666"></a><b>build_select</b>(arel, selects)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001666_source')" id="l_M001666_source">show</a>
                        
                    </p>
                    <div id="M001666_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 313</span>
313:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build_select</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-identifier">selects</span>)
314:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">selects</span>.<span class="ruby-identifier">empty?</span>
315:         <span class="ruby-ivar">@implicit_readonly</span> = <span class="ruby-keyword kw">false</span>
316:         <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">project</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">selects</span>)
317:       <span class="ruby-keyword kw">else</span>
318:         <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">project</span>(<span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">arel_table</span>[<span class="ruby-constant">Arel</span>.<span class="ruby-identifier">star</span>])
319:       <span class="ruby-keyword kw">end</span>
320:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001663">
                    
                    <a name="M001663"></a><b>build_where</b>(opts, other = [])
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001663_source')" id="l_M001663_source">show</a>
                        
                    </p>
                    <div id="M001663_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build_where</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">other</span> = [])
257:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">opts</span>
258:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Array</span>
259:         [<span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:sanitize_sql</span>, <span class="ruby-identifier">other</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">opts</span> <span class="ruby-operator">:</span> ([<span class="ruby-identifier">opts</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">other</span>))]
260:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
261:         <span class="ruby-identifier">attributes</span> = <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:expand_hash_conditions_for_aggregates</span>, <span class="ruby-identifier">opts</span>)
262:         <span class="ruby-constant">PredicateBuilder</span>.<span class="ruby-identifier">build_from_hash</span>(<span class="ruby-identifier">table</span>.<span class="ruby-identifier">engine</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">table</span>)
263:       <span class="ruby-keyword kw">else</span>
264:         [<span class="ruby-identifier">opts</span>]
265:       <span class="ruby-keyword kw">end</span>
266:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001662">
                    
                    <a name="M001662"></a><b>collapse_wheres</b>(arel, wheres)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001662_source')" id="l_M001662_source">show</a>
                        
                    </p>
                    <div id="M001662_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 245</span>
245:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collapse_wheres</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-identifier">wheres</span>)
246:       <span class="ruby-identifier">equalities</span> = <span class="ruby-identifier">wheres</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Equality</span>)
247: 
248:       <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">And</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">equalities</span>)) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">equalities</span>.<span class="ruby-identifier">empty?</span>
249: 
250:       (<span class="ruby-identifier">wheres</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">equalities</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">where</span><span class="ruby-operator">|</span>
251:         <span class="ruby-identifier">where</span> = <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-identifier">where</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">where</span>
252:         <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Grouping</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">where</span>))
253:       <span class="ruby-keyword kw">end</span>
254:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001661">
                    
                    <a name="M001661"></a><b>custom_join_ast</b>(table, joins)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001661_source')" id="l_M001661_source">show</a>
                        
                    </p>
                    <div id="M001661_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 227</span>
227:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">custom_join_ast</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">joins</span>)
228:       <span class="ruby-identifier">joins</span> = <span class="ruby-identifier">joins</span>.<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">join</span><span class="ruby-operator">|</span> <span class="ruby-identifier">join</span>.<span class="ruby-identifier">blank?</span> }
229: 
230:       <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">joins</span>.<span class="ruby-identifier">empty?</span>
231: 
232:       <span class="ruby-ivar">@implicit_readonly</span> = <span class="ruby-keyword kw">true</span>
233: 
234:       <span class="ruby-identifier">joins</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">join</span><span class="ruby-operator">|</span>
235:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">join</span>
236:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
237:           <span class="ruby-identifier">join</span> = <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-identifier">join</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">array_of_strings?</span>(<span class="ruby-identifier">join</span>)
238:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
239:           <span class="ruby-identifier">join</span> = <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-identifier">join</span>)
240:         <span class="ruby-keyword kw">end</span>
241:         <span class="ruby-identifier">table</span>.<span class="ruby-identifier">create_string_join</span>(<span class="ruby-identifier">join</span>)
242:       <span class="ruby-keyword kw">end</span>
243:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001668">
                    
                    <a name="M001668"></a><b>reverse_sql_order</b>(order_query)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001668_source')" id="l_M001668_source">show</a>
                        
                    </p>
                    <div id="M001668_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File activerecord-3.1.3/lib/active_record/relation/query_methods.rb, line 329</span>
329:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reverse_sql_order</span>(<span class="ruby-identifier">order_query</span>)
330:       <span class="ruby-identifier">order_query</span> = [<span class="ruby-node">&quot;#{quoted_table_name}.#{quoted_primary_key} ASC&quot;</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">order_query</span>.<span class="ruby-identifier">empty?</span>
331: 
332:       <span class="ruby-identifier">order_query</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span>
333:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">o</span>
334:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Ascending</span>, <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Descending</span>
335:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">reverse</span>
336:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Symbol</span>
337:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>).<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
338:             <span class="ruby-identifier">s</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\sasc\Z/i</span>, <span class="ruby-value str">' DESC'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\sdesc\Z/i</span>, <span class="ruby-value str">' ASC'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-value str">' DESC'</span>)
339:           <span class="ruby-keyword kw">end</span>
340:         <span class="ruby-keyword kw">else</span>
341:           <span class="ruby-identifier">o</span>
342:         <span class="ruby-keyword kw">end</span>
343:       <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">flatten</span>
344:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    