<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>WEBrick::HTTPServlet::FileHandler</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            WEBrick::HTTPServlet::FileHandler 
            
                <span class="parent">&lt; 
                    
                    AbstractServlet
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/webrick/httpservlet/filehandler_rb.html">lib/webrick/httpservlet/filehandler.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M007498">add_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M007526">call_callback</a>,</li>
                
                <li><a href="#M007522">check_filename</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M007506">do_GET</a>,</li>
                
                <li><a href="#M007508">do_OPTIONS</a>,</li>
                
                <li><a href="#M007507">do_POST</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M007514">exec_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M007520">get_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M007500">new</a>,</li>
                
                <li><a href="#M007528">nondisclosure_name?</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M007510">prevent_directory_traversal</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M007499">remove_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M007525">search_file</a>,</li>
                
                <li><a href="#M007524">search_index_file</a>,</li>
                
                <li><a href="#M007504">service</a>,</li>
                
                <li><a href="#M007529">set_dir_list</a>,</li>
                
                <li><a href="#M007521">set_filename</a>,</li>
                
                <li><a href="#M007523">shift_path_info</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M007509">trailing_pathsep?</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M007527">windows_ambiguous_name?</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">HandlerTable</td>
            <td>=</td>
            <td class="attr-value">Hash.new</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M007506">
                    
                    <a name="M007506"></a><b>do_GET</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007506_source')" id="l_M007506_source">show</a>
                        
                    </p>
                    <div id="M007506_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 170</span>
170:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_GET</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
171:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">exec_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
172:           <span class="ruby-identifier">set_dir_list</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
173:         <span class="ruby-keyword kw">end</span>
174:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007508">
                    
                    <a name="M007508"></a><b>do_OPTIONS</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007508_source')" id="l_M007508_source">show</a>
                        
                    </p>
                    <div id="M007508_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 182</span>
182:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_OPTIONS</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
183:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">exec_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
184:           <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
185:         <span class="ruby-keyword kw">end</span>
186:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007507">
                    
                    <a name="M007507"></a><b>do_POST</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007507_source')" id="l_M007507_source">show</a>
                        
                    </p>
                    <div id="M007507_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 176</span>
176:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_POST</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
177:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">exec_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
178:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">HTTPStatus</span><span class="ruby-operator">::</span><span class="ruby-constant">NotFound</span>, <span class="ruby-node">&quot;`#{req.path}' not found.&quot;</span>
179:         <span class="ruby-keyword kw">end</span>
180:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007504">
                    
                    <a name="M007504"></a><b>service</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007504_source')" id="l_M007504_source">show</a>
                        
                    </p>
                    <div id="M007504_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 149</span>
149:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">service</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
150:         <span class="ruby-comment cmt"># if this class is mounted on &quot;/&quot; and /~username is requested.</span>
151:         <span class="ruby-comment cmt"># we're going to override path informations before invoking service.</span>
152:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Etc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:UserDir</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">script_name</span>.<span class="ruby-identifier">empty?</span>
153:           <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">%r|^(/~([^/]+))|</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span>
154:             <span class="ruby-identifier">script_name</span>, <span class="ruby-identifier">user</span> = <span class="ruby-identifier">$1</span>, <span class="ruby-identifier">$2</span>
155:             <span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">$'</span>
156:             <span class="ruby-keyword kw">begin</span>
157:               <span class="ruby-identifier">passwd</span> = <span class="ruby-constant">Etc</span><span class="ruby-operator">::</span><span class="ruby-identifier">getpwnam</span>(<span class="ruby-identifier">user</span>)
158:               <span class="ruby-ivar">@root</span> = <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">join</span>(<span class="ruby-identifier">passwd</span>.<span class="ruby-identifier">dir</span>, <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:UserDir</span>])
159:               <span class="ruby-identifier">req</span>.<span class="ruby-identifier">script_name</span> = <span class="ruby-identifier">script_name</span>
160:               <span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">path_info</span>
161:             <span class="ruby-keyword kw">rescue</span>
162:               <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;#{self.class}#do_GET: getpwnam(#{user}) failed&quot;</span>
163:             <span class="ruby-keyword kw">end</span>
164:           <span class="ruby-keyword kw">end</span>
165:         <span class="ruby-keyword kw">end</span>
166:         <span class="ruby-identifier">prevent_directory_traversal</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
167:         <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
168:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M007526">
                    
                    <a name="M007526"></a><b>call_callback</b>(callback_name, req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007526_source')" id="l_M007526_source">show</a>
                        
                    </p>
                    <div id="M007526_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 335</span>
335:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">callback_name</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
336:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cb</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">callback_name</span>]
337:           <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
338:         <span class="ruby-keyword kw">end</span>
339:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007522">
                    
                    <a name="M007522"></a><b>check_filename</b>(req, res, name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007522_source')" id="l_M007522_source">show</a>
                        
                    </p>
                    <div id="M007522_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 288</span>
288:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_filename</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">name</span>)
289:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nondisclosure_name?</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">windows_ambiguous_name?</span>(<span class="ruby-identifier">name</span>)
290:           <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-node">&quot;the request refers nondisclosure name `#{name}'.&quot;</span>)
291:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">HTTPStatus</span><span class="ruby-operator">::</span><span class="ruby-constant">NotFound</span>, <span class="ruby-node">&quot;`#{req.path}' not found.&quot;</span>
292:         <span class="ruby-keyword kw">end</span>
293:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007514">
                    
                    <a name="M007514"></a><b>exec_handler</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007514_source')" id="l_M007514_source">show</a>
                        
                    </p>
                    <div id="M007514_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 230</span>
230:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exec_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
231:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">HTTPStatus</span><span class="ruby-operator">::</span><span class="ruby-constant">NotFound</span>, <span class="ruby-node">&quot;`#{req.path}' not found&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@root</span>
232:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">set_filename</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
233:           <span class="ruby-identifier">handler</span> = <span class="ruby-identifier">get_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
234:           <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">:HandlerCallback</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
235:           <span class="ruby-identifier">h</span> = <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">get_instance</span>(<span class="ruby-ivar">@config</span>, <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span>)
236:           <span class="ruby-identifier">h</span>.<span class="ruby-identifier">service</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
237:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
238:         <span class="ruby-keyword kw">end</span>
239:         <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">:HandlerCallback</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
240:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
241:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007520">
                    
                    <a name="M007520"></a><b>get_handler</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007520_source')" id="l_M007520_source">show</a>
                        
                    </p>
                    <div id="M007520_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 243</span>
243:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_handler</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
244:         <span class="ruby-identifier">suffix1</span> = (<span class="ruby-regexp re">/\.(\w+)\z/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">downcase</span>
245:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\.(\w+)\.([\w\-]+)\z/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span>
246:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:AcceptableLanguages</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">$2</span>.<span class="ruby-identifier">downcase</span>)
247:             <span class="ruby-identifier">suffix2</span> = <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">downcase</span>
248:           <span class="ruby-keyword kw">end</span>
249:         <span class="ruby-keyword kw">end</span>
250:         <span class="ruby-identifier">handler_table</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:HandlerTable</span>]
251:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">handler_table</span>[<span class="ruby-identifier">suffix1</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">handler_table</span>[<span class="ruby-identifier">suffix2</span>] <span class="ruby-operator">||</span>
252:                <span class="ruby-constant">HandlerTable</span>[<span class="ruby-identifier">suffix1</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">HandlerTable</span>[<span class="ruby-identifier">suffix2</span>] <span class="ruby-operator">||</span>
253:                <span class="ruby-constant">DefaultFileHandler</span>
254:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007528">
                    
                    <a name="M007528"></a><b>nondisclosure_name?</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007528_source')" id="l_M007528_source">show</a>
                        
                    </p>
                    <div id="M007528_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 347</span>
347:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nondisclosure_name?</span>(<span class="ruby-identifier">name</span>)
348:         <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:NondisclosureName</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">pattern</span><span class="ruby-operator">|</span>
349:           <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">fnmatch</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">name</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">FNM_CASEFOLD</span>)
350:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
351:           <span class="ruby-keyword kw">end</span>
352:         }
353:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
354:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007510">
                    
                    <a name="M007510"></a><b>prevent_directory_traversal</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007510_source')" id="l_M007510_source">show</a>
                        
                    </p>
                    <div id="M007510_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 211</span>
211:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prevent_directory_traversal</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
212:         <span class="ruby-comment cmt"># Preventing directory traversal on Windows platforms;</span>
213:         <span class="ruby-comment cmt"># Backslashes (0x5c) in path_info are not interpreted as special</span>
214:         <span class="ruby-comment cmt"># character in URI notation. So the value of path_info should be</span>
215:         <span class="ruby-comment cmt"># normalize before accessing to the filesystem.</span>
216: 
217:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trailing_pathsep?</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span>)
218:           <span class="ruby-comment cmt"># File.expand_path removes the trailing path separator.</span>
219:           <span class="ruby-comment cmt"># Adding a character is a workaround to save it.</span>
220:           <span class="ruby-comment cmt">#  File.expand_path(&quot;/aaa/&quot;)        #=&gt; &quot;/aaa&quot;</span>
221:           <span class="ruby-comment cmt">#  File.expand_path(&quot;/aaa/&quot; + &quot;x&quot;)  #=&gt; &quot;/aaa/x&quot;</span>
222:           <span class="ruby-identifier">expanded</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;x&quot;</span>)
223:           <span class="ruby-identifier">expanded</span>.<span class="ruby-identifier">chop!</span>  <span class="ruby-comment cmt"># remove trailing &quot;x&quot;</span>
224:         <span class="ruby-keyword kw">else</span>
225:           <span class="ruby-identifier">expanded</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span>)
226:         <span class="ruby-keyword kw">end</span>
227:         <span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">expanded</span>
228:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007525">
                    
                    <a name="M007525"></a><b>search_file</b>(req, res, basename)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007525_source')" id="l_M007525_source">show</a>
                        
                    </p>
                    <div id="M007525_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 313</span>
313:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_file</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">basename</span>)
314:         <span class="ruby-identifier">langs</span> = <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:AcceptableLanguages</span>]
315:         <span class="ruby-identifier">path</span> = <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">basename</span>
316:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">path</span>)
317:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">basename</span>
318:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">langs</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
319:           <span class="ruby-identifier">req</span>.<span class="ruby-identifier">accept_language</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">lang</span><span class="ruby-operator">|</span>
320:             <span class="ruby-identifier">path_with_lang</span> = <span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;.#{lang}&quot;</span>
321:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">langs</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">lang</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">path_with_lang</span>)
322:               <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">basename</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;.#{lang}&quot;</span>
323:             <span class="ruby-keyword kw">end</span>
324:           }
325:           (<span class="ruby-identifier">langs</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">accept_language</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">lang</span><span class="ruby-operator">|</span>
326:             <span class="ruby-identifier">path_with_lang</span> = <span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;.#{lang}&quot;</span>
327:             <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">path_with_lang</span>)
328:               <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">basename</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;.#{lang}&quot;</span>
329:             <span class="ruby-keyword kw">end</span>
330:           }
331:         <span class="ruby-keyword kw">end</span>
332:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
333:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007524">
                    
                    <a name="M007524"></a><b>search_index_file</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007524_source')" id="l_M007524_source">show</a>
                        
                    </p>
                    <div id="M007524_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 304</span>
304:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_index_file</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
305:         <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:DirectoryIndex</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
306:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span> = <span class="ruby-identifier">search_file</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-value str">&quot;/&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">index</span>)
307:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">file</span>
308:           <span class="ruby-keyword kw">end</span>
309:         }
310:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
311:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007529">
                    
                    <a name="M007529"></a><b>set_dir_list</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007529_source')" id="l_M007529_source">show</a>
                        
                    </p>
                    <div id="M007529_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 356</span>
356:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_dir_list</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
357:         <span class="ruby-identifier">redirect_to_directory_uri</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
358:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>[<span class="ruby-identifier">:FancyIndexing</span>]
359:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">HTTPStatus</span><span class="ruby-operator">::</span><span class="ruby-constant">Forbidden</span>, <span class="ruby-node">&quot;no access permission to `#{req.path}'&quot;</span>
360:         <span class="ruby-keyword kw">end</span>
361:         <span class="ruby-identifier">local_path</span> = <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span>
362:         <span class="ruby-identifier">list</span> = <span class="ruby-constant">Dir</span><span class="ruby-operator">::</span><span class="ruby-identifier">entries</span>(<span class="ruby-identifier">local_path</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
363:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;..&quot;</span>
364:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nondisclosure_name?</span>(<span class="ruby-identifier">name</span>)
365:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">windows_ambiguous_name?</span>(<span class="ruby-identifier">name</span>)
366:           <span class="ruby-identifier">st</span> = (<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">stat</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">local_path</span>, <span class="ruby-identifier">name</span>)) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>)
367:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">st</span>.<span class="ruby-identifier">nil?</span>
368:             [ <span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value">-1</span> ]
369:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">st</span>.<span class="ruby-identifier">directory?</span>
370:             [ <span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/&quot;</span>, <span class="ruby-identifier">st</span>.<span class="ruby-identifier">mtime</span>, <span class="ruby-value">-1</span> ]
371:           <span class="ruby-keyword kw">else</span>
372:             [ <span class="ruby-identifier">name</span>, <span class="ruby-identifier">st</span>.<span class="ruby-identifier">mtime</span>, <span class="ruby-identifier">st</span>.<span class="ruby-identifier">size</span> ]
373:           <span class="ruby-keyword kw">end</span>
374:         }
375:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">compact!</span>
376: 
377:         <span class="ruby-keyword kw">if</span>    <span class="ruby-identifier">d0</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">query</span>[<span class="ruby-value str">&quot;N&quot;</span>]; <span class="ruby-identifier">idx</span> = <span class="ruby-value">0</span>
378:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">d0</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">query</span>[<span class="ruby-value str">&quot;M&quot;</span>]; <span class="ruby-identifier">idx</span> = <span class="ruby-value">1</span>
379:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">d0</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">query</span>[<span class="ruby-value str">&quot;S&quot;</span>]; <span class="ruby-identifier">idx</span> = <span class="ruby-value">2</span>
380:         <span class="ruby-keyword kw">else</span>  <span class="ruby-identifier">d0</span> = <span class="ruby-value str">&quot;A&quot;</span>           ; <span class="ruby-identifier">idx</span> = <span class="ruby-value">0</span>
381:         <span class="ruby-keyword kw">end</span>
382:         <span class="ruby-identifier">d1</span> = (<span class="ruby-identifier">d0</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;A&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;D&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;A&quot;</span>
383: 
384:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">d0</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;A&quot;</span>
385:           <span class="ruby-identifier">list</span>.<span class="ruby-identifier">sort!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>[<span class="ruby-identifier">idx</span>] <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b</span>[<span class="ruby-identifier">idx</span>] }
386:         <span class="ruby-keyword kw">else</span>
387:           <span class="ruby-identifier">list</span>.<span class="ruby-identifier">sort!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">b</span>[<span class="ruby-identifier">idx</span>] <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">a</span>[<span class="ruby-identifier">idx</span>] }
388:         <span class="ruby-keyword kw">end</span>
389: 
390:         <span class="ruby-identifier">res</span>[<span class="ruby-value str">'content-type'</span>] = <span class="ruby-value str">&quot;text/html&quot;</span>
391: 
392:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> = <span class="ruby-value str">&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 3.2 Final//EN\&quot;&gt;\n&lt;HTML&gt;\n&lt;HEAD&gt;&lt;TITLE&gt;Index of \#{HTMLUtils::escape(req.path)}&lt;/TITLE&gt;&lt;/HEAD&gt;\n&lt;BODY&gt;\n&lt;H1&gt;Index of \#{HTMLUtils::escape(req.path)}&lt;/H1&gt;\n&quot;</span>
393: 
394:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;PRE&gt;\n&quot;</span>
395:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; &lt;A HREF=\&quot;?N=#{d1}\&quot;&gt;Name&lt;/A&gt;                          &quot;</span>
396:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;A HREF=\&quot;?M=#{d1}\&quot;&gt;Last modified&lt;/A&gt;         &quot;</span>
397:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;A HREF=\&quot;?S=#{d1}\&quot;&gt;Size&lt;/A&gt;\n&quot;</span>
398:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;HR&gt;\n&quot;</span>
399:        
400:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">unshift</span> [ <span class="ruby-value str">&quot;..&quot;</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">mtime</span>(<span class="ruby-identifier">local_path</span><span class="ruby-operator">+</span><span class="ruby-value str">&quot;/..&quot;</span>), <span class="ruby-value">-1</span> ]
401:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">time</span>, <span class="ruby-identifier">size</span><span class="ruby-operator">|</span>
402:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;..&quot;</span>
403:             <span class="ruby-identifier">dname</span> = <span class="ruby-value str">&quot;Parent Directory&quot;</span>
404:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>
405:             <span class="ruby-identifier">dname</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^(.{23})(.*)/</span>){ <span class="ruby-identifier">$1</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;..&quot;</span> }
406:           <span class="ruby-keyword kw">else</span>
407:             <span class="ruby-identifier">dname</span> = <span class="ruby-identifier">name</span>
408:           <span class="ruby-keyword kw">end</span>
409:           <span class="ruby-identifier">s</span> =  <span class="ruby-node">&quot; &lt;A HREF=\&quot;#{HTTPUtils::escape(name)}\&quot;&gt;#{dname}&lt;/A&gt;&quot;</span>
410:           <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">*</span> (<span class="ruby-value">30</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dname</span>.<span class="ruby-identifier">size</span>)
411:           <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">time</span> <span class="ruby-value">? </span><span class="ruby-identifier">time</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y/%m/%d %H:%M      &quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">*</span> <span class="ruby-value">22</span>)
412:           <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;-&quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
413:           <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>
414:         }
415:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;/PRE&gt;&lt;HR&gt;&quot;</span>
416: 
417:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;ADDRESS&gt;\n\#{HTMLUtils::escape(@config[:ServerSoftware])}&lt;BR&gt;\nat \#{req.host}:\#{req.port}\n&lt;/ADDRESS&gt;\n&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;</span>    
418:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007521">
                    
                    <a name="M007521"></a><b>set_filename</b>(req, res)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007521_source')" id="l_M007521_source">show</a>
                        
                    </p>
                    <div id="M007521_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 256</span>
256:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_filename</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
257:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span> = <span class="ruby-ivar">@root</span>.<span class="ruby-identifier">dup</span>
258:         <span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">%r|/[^/]*|</span>)
259: 
260:         <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-value str">&quot;&quot;</span>)  <span class="ruby-comment cmt"># dummy for checking @root dir</span>
261:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">base</span> = <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">first</span>
262:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;/&quot;</span>
263:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">base</span>))
264:           <span class="ruby-identifier">shift_path_info</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">path_info</span>)
265:           <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">:DirectoryCallback</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
266:         <span class="ruby-keyword kw">end</span>
267: 
268:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base</span> = <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">first</span>
269:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;/&quot;</span>
270:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span> = <span class="ruby-identifier">search_index_file</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
271:               <span class="ruby-identifier">shift_path_info</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">path_info</span>, <span class="ruby-identifier">file</span>)
272:               <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">:FileCallback</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
273:               <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
274:             <span class="ruby-keyword kw">end</span>
275:             <span class="ruby-identifier">shift_path_info</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">path_info</span>)
276:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">file</span> = <span class="ruby-identifier">search_file</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">base</span>)
277:             <span class="ruby-identifier">shift_path_info</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">path_info</span>, <span class="ruby-identifier">file</span>)
278:             <span class="ruby-identifier">call_callback</span>(<span class="ruby-identifier">:FileCallback</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>)
279:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
280:           <span class="ruby-keyword kw">else</span>
281:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">HTTPStatus</span><span class="ruby-operator">::</span><span class="ruby-constant">NotFound</span>, <span class="ruby-node">&quot;`#{req.path}' not found.&quot;</span>
282:           <span class="ruby-keyword kw">end</span>
283:         <span class="ruby-keyword kw">end</span>
284: 
285:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
286:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007523">
                    
                    <a name="M007523"></a><b>shift_path_info</b>(req, res, path_info, base=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007523_source')" id="l_M007523_source">show</a>
                        
                    </p>
                    <div id="M007523_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 295</span>
295:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">shift_path_info</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-identifier">path_info</span>, <span class="ruby-identifier">base</span>=<span class="ruby-keyword kw">nil</span>)
296:         <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">shift</span>
297:         <span class="ruby-identifier">base</span> = <span class="ruby-identifier">base</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">tmp</span>
298:         <span class="ruby-identifier">req</span>.<span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">join</span>
299:         <span class="ruby-identifier">req</span>.<span class="ruby-identifier">script_name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">base</span>
300:         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">base</span>)
301:         <span class="ruby-identifier">check_filename</span>(<span class="ruby-identifier">req</span>, <span class="ruby-identifier">res</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">res</span>.<span class="ruby-identifier">filename</span>))
302:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007509">
                    
                    <a name="M007509"></a><b>trailing_pathsep?</b>(path)
                    
                </div>
                
                <div class="description">
                  <p>
RFC3253: Versioning Extensions to WebDAV
</p>
<pre>
         (Web Distributed Authoring and Versioning)
</pre>
<p>
VERSION-CONTROL REPORT CHECKOUT CHECK_IN UNCHECKOUT MKWORKSPACE UPDATE
LABEL MERGE ACTIVITY
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007509_source')" id="l_M007509_source">show</a>
                        
                    </p>
                    <div id="M007509_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 202</span>
202:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">trailing_pathsep?</span>(<span class="ruby-identifier">path</span>)
203:         <span class="ruby-comment cmt"># check for trailing path separator:</span>
204:         <span class="ruby-comment cmt">#   File.dirname(&quot;/aaaa/bbbb/&quot;)      #=&gt; &quot;/aaaa&quot;)</span>
205:         <span class="ruby-comment cmt">#   File.dirname(&quot;/aaaa/bbbb/x&quot;)     #=&gt; &quot;/aaaa/bbbb&quot;)</span>
206:         <span class="ruby-comment cmt">#   File.dirname(&quot;/aaaa/bbbb&quot;)       #=&gt; &quot;/aaaa&quot;)</span>
207:         <span class="ruby-comment cmt">#   File.dirname(&quot;/aaaa/bbbbx&quot;)      #=&gt; &quot;/aaaa&quot;)</span>
208:         <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">path</span>) <span class="ruby-operator">!=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-value str">&quot;x&quot;</span>)
209:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007527">
                    
                    <a name="M007527"></a><b>windows_ambiguous_name?</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007527_source')" id="l_M007527_source">show</a>
                        
                    </p>
                    <div id="M007527_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 341</span>
341:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">windows_ambiguous_name?</span>(<span class="ruby-identifier">name</span>)
342:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/[. ]+\z/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">name</span>
343:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/::\$DATA\z/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">name</span>
344:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
345:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M007498">
                    
                    <a name="M007498"></a><b>add_handler</b>(suffix, handler)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007498_source')" id="l_M007498_source">show</a>
                        
                    </p>
                    <div id="M007498_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 131</span>
131:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_handler</span>(<span class="ruby-identifier">suffix</span>, <span class="ruby-identifier">handler</span>)
132:         <span class="ruby-constant">HandlerTable</span>[<span class="ruby-identifier">suffix</span>] = <span class="ruby-identifier">handler</span>
133:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007500">
                    
                    <a name="M007500"></a><b>new</b>(server, root, options={}, default=Config::FileHandler)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007500_source')" id="l_M007500_source">show</a>
                        
                    </p>
                    <div id="M007500_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 139</span>
139:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">server</span>, <span class="ruby-identifier">root</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-identifier">default</span>=<span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-constant">FileHandler</span>)
140:         <span class="ruby-ivar">@config</span> = <span class="ruby-identifier">server</span>.<span class="ruby-identifier">config</span>
141:         <span class="ruby-ivar">@logger</span> = <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:Logger</span>]
142:         <span class="ruby-ivar">@root</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">root</span>)
143:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
144:           <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">:FancyIndexing</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span> }
145:         <span class="ruby-keyword kw">end</span>
146:         <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">default</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">options</span>)
147:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007499">
                    
                    <a name="M007499"></a><b>remove_handler</b>(suffix)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007499_source')" id="l_M007499_source">show</a>
                        
                    </p>
                    <div id="M007499_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/webrick/httpservlet/filehandler.rb, line 135</span>
135:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remove_handler</span>(<span class="ruby-identifier">suffix</span>)
136:         <span class="ruby-constant">HandlerTable</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">suffix</span>)
137:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    