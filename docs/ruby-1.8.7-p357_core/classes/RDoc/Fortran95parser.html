<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::Fortran95parser</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::Fortran95parser 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rdoc/parsers/parse_f95_rb.html">lib/rdoc/parsers/parse_f95.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
See rdoc/parsers/parse_f95.rb
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M003903">block_end?</a>,</li>
                
                <li><a href="#M003901">block_start?</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M003891">check_external_aliases</a>,</li>
                
                <li><a href="#M003892">check_public_methods</a>,</li>
                
                <li><a href="#M003878">collect_first_comment</a>,</li>
                
                <li><a href="#M003898">comment_out?</a>,</li>
                
                <li><a href="#M003897">continuous_line?</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M003914">definition_info</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M003879">find_arguments</a>,</li>
                
                <li><a href="#M003882">find_comments</a>,</li>
                
                <li><a href="#M003880">find_namelists</a>,</li>
                
                <li><a href="#M003889">find_visibility</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M003885">initialize_external_method</a>,</li>
                
                <li><a href="#M003884">initialize_public_method</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M003841">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M003843">parse_program_or_module</a>,</li>
                
                <li><a href="#M003877">parse_subprogram</a>,</li>
                
                <li><a href="#M003886">parse_visibility</a>,</li>
                
                <li><a href="#M003883">progress</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M003907">remove_empty_head_lines</a>,</li>
                
                <li><a href="#M003908">remove_header_marker</a>,</li>
                
                <li><a href="#M003909">remove_private_comments</a>,</li>
                
                <li><a href="#M003905">remove_trailing_alias</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M003842">scan</a>,</li>
                
                <li><a href="#M003899">semicolon_to_linefeed</a>,</li>
                
                <li><a href="#M003887">set_visibility</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M003893">united_to_one_line</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="Fortran95parser/Fortran95Definition.html">RDoc::Fortran95parser::Fortran95Definition</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">COMMENTS_ARE_UPPER</td>
            <td>=</td>
            <td class="attr-value">false</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><table>
<tr><td valign="top">&#8220;false&#8221;:</td><td>Comments are below source code

</td></tr>
<tr><td valign="top">&#8220;true&#8221; :</td><td>Comments are upper source code

</td></tr>
</table>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">INTERNAL_ALIAS_MES</td>
            <td>=</td>
            <td class="attr-value">&quot;Alias for&quot;</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Internal alias message
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">EXTERNAL_ALIAS_MES</td>
            <td>=</td>
            <td class="attr-value">&quot;The entity is&quot;</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
External alias message
</p>
</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M003842">
                    
                    <a name="M003842"></a><b>scan</b>()
                    
                </div>
                
                <div class="description">
                  <p>
define code constructs
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003842_source')" id="l_M003842_source">show</a>
                        
                    </p>
                    <div id="M003842_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 205</span>
205:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scan</span>
206: 
207:       <span class="ruby-comment cmt"># remove private comment</span>
208:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">remove_private_comments</span>(<span class="ruby-ivar">@body</span>)
209: 
210:       <span class="ruby-comment cmt"># continuation lines are united to one line</span>
211:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">united_to_one_line</span>(<span class="ruby-identifier">remaining_code</span>)
212: 
213:       <span class="ruby-comment cmt"># semicolons are replaced to line feed</span>
214:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">semicolon_to_linefeed</span>(<span class="ruby-identifier">remaining_code</span>)
215: 
216:       <span class="ruby-comment cmt"># collect comment for file entity</span>
217:       <span class="ruby-identifier">whole_comment</span>, <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">collect_first_comment</span>(<span class="ruby-identifier">remaining_code</span>)
218:       <span class="ruby-ivar">@top_level</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">whole_comment</span>
219: 
220:       <span class="ruby-comment cmt"># String &quot;remaining_code&quot; is converted to Array &quot;remaining_lines&quot;</span>
221:       <span class="ruby-identifier">remaining_lines</span> = <span class="ruby-identifier">remaining_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
222: 
223:       <span class="ruby-comment cmt"># &quot;module&quot; or &quot;program&quot; parts are parsed (new)</span>
224:       <span class="ruby-comment cmt">#</span>
225:       <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
226:       <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
227:       <span class="ruby-identifier">block_searching_lines</span> = []
228:       <span class="ruby-identifier">pre_comment</span> = []
229:       <span class="ruby-identifier">module_program_trailing</span> = <span class="ruby-value str">&quot;&quot;</span>
230:       <span class="ruby-identifier">module_program_name</span> = <span class="ruby-value str">&quot;&quot;</span>
231:       <span class="ruby-identifier">other_block_level_depth</span> = <span class="ruby-value">0</span>
232:       <span class="ruby-identifier">other_block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
233:       <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">collect!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
234:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_searching_flag</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">other_block_searching_flag</span>
235:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?module\s+(\w+)\s*?(!.*?)?$/i</span>
236:             <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-identifier">:module</span>
237:             <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
238:             <span class="ruby-identifier">module_program_name</span> = <span class="ruby-identifier">$1</span>
239:             <span class="ruby-identifier">module_program_trailing</span> = <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$2</span>)
240:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
241:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?program\s+(\w+)\s*?(!.*?)?$/i</span> <span class="ruby-operator">||</span>
242:                  <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?\w/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
243:             <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-identifier">:program</span>
244:             <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
245:             <span class="ruby-identifier">module_program_name</span> = <span class="ruby-identifier">$1</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
246:             <span class="ruby-identifier">module_program_trailing</span> = <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$2</span>)
247:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
248: 
249:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
250:             <span class="ruby-identifier">other_block_searching_flag</span> = <span class="ruby-keyword kw">true</span>
251:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
252: 
253:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?!\s?(.*)/</span>
254:             <span class="ruby-identifier">pre_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
255:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
256:           <span class="ruby-keyword kw">else</span>
257:             <span class="ruby-identifier">pre_comment</span> = []
258:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
259:           <span class="ruby-keyword kw">end</span>
260:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">other_block_searching_flag</span>
261:           <span class="ruby-identifier">other_block_level_depth</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
262:           <span class="ruby-identifier">other_block_level_depth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_end?</span>(<span class="ruby-identifier">line</span>)
263:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">other_block_level_depth</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
264:             <span class="ruby-identifier">other_block_level_depth</span> = <span class="ruby-value">0</span>
265:             <span class="ruby-identifier">other_block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
266:           <span class="ruby-keyword kw">end</span>
267:           <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
268:         <span class="ruby-keyword kw">end</span>
269: 
270:         <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
271:         <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
272:         <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_end?</span>(<span class="ruby-identifier">line</span>)
273:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
274:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
275:         <span class="ruby-keyword kw">end</span>
276: 
277:         <span class="ruby-comment cmt"># &quot;module_program_code&quot; is formatted.</span>
278:         <span class="ruby-comment cmt"># &quot;:nodoc:&quot; flag is checked.</span>
279:         <span class="ruby-comment cmt">#</span>
280:         <span class="ruby-identifier">module_program_code</span> = <span class="ruby-identifier">block_searching_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
281:         <span class="ruby-identifier">module_program_code</span> = <span class="ruby-identifier">remove_empty_head_lines</span>(<span class="ruby-identifier">module_program_code</span>)
282:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">module_program_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^:nodoc:/</span>
283:           <span class="ruby-comment cmt"># next loop to search next block</span>
284:           <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
285:           <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">false</span>
286:           <span class="ruby-identifier">block_searching_lines</span> = []
287:           <span class="ruby-identifier">pre_comment</span> = []
288:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
289:         <span class="ruby-keyword kw">end</span>
290: 
291:         <span class="ruby-comment cmt"># NormalClass is created, and added to @top_level</span>
292:         <span class="ruby-comment cmt">#</span>
293:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_searching_flag</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:module</span>
294:           <span class="ruby-identifier">module_name</span> = <span class="ruby-identifier">module_program_name</span>
295:           <span class="ruby-identifier">module_code</span> = <span class="ruby-identifier">module_program_code</span>
296:           <span class="ruby-identifier">module_trailing</span> = <span class="ruby-identifier">module_program_trailing</span>
297:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;m&quot;</span>
298:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_modules</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
299:           <span class="ruby-identifier">f9x_module</span> = <span class="ruby-ivar">@top_level</span>.<span class="ruby-identifier">add_module</span> <span class="ruby-constant">NormalClass</span>, <span class="ruby-identifier">module_name</span>
300:           <span class="ruby-identifier">f9x_module</span>.<span class="ruby-identifier">record_location</span> <span class="ruby-ivar">@top_level</span>
301: 
302:           <span class="ruby-identifier">f9x_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">? </span>
303:             <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">pre_comment</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>))  <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">module_trailing</span> <span class="ruby-operator">:</span>
304:               <span class="ruby-identifier">module_trailing</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">module_code</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^.*$\n/i</span>, <span class="ruby-value str">''</span>))
305:           <span class="ruby-identifier">f9x_module</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">f9x_comment</span>
306:           <span class="ruby-identifier">parse_program_or_module</span>(<span class="ruby-identifier">f9x_module</span>, <span class="ruby-identifier">module_code</span>)
307: 
308:           <span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">all_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">toplevel</span><span class="ruby-operator">|</span>
309:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">include_includes?</span>(<span class="ruby-identifier">module_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
310:               <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">include_requires?</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
311:                 <span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">add_require</span>(<span class="ruby-constant">Require</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-value str">&quot;&quot;</span>))
312:               <span class="ruby-keyword kw">end</span>
313:             <span class="ruby-keyword kw">end</span>
314:             <span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">each_classmodule</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
315:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">include_includes?</span>(<span class="ruby-identifier">module_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
316:                 <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">m</span>.<span class="ruby-identifier">include_requires?</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
317:                   <span class="ruby-identifier">m</span>.<span class="ruby-identifier">add_require</span>(<span class="ruby-constant">Require</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-value str">&quot;&quot;</span>))
318:                 <span class="ruby-keyword kw">end</span>
319:               <span class="ruby-keyword kw">end</span>
320:             }
321:           <span class="ruby-keyword kw">end</span>
322:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_searching_flag</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:program</span>
323:           <span class="ruby-identifier">program_name</span> = <span class="ruby-identifier">module_program_name</span>
324:           <span class="ruby-identifier">program_code</span> = <span class="ruby-identifier">module_program_code</span>
325:           <span class="ruby-identifier">program_trailing</span> = <span class="ruby-identifier">module_program_trailing</span>
326:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;p&quot;</span>
327:           <span class="ruby-identifier">program_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">? </span>
328:             <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">pre_comment</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">program_trailing</span> <span class="ruby-operator">:</span> 
329:               <span class="ruby-identifier">program_trailing</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">program_code</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^.*$\n/i</span>, <span class="ruby-value str">''</span>))
330:           <span class="ruby-identifier">program_comment</span> = <span class="ruby-node">&quot;\n\n= &lt;i&gt;Program&lt;/i&gt; &lt;tt&gt;#{program_name}&lt;/tt&gt;\n\n&quot;</span> \
331:                             <span class="ruby-operator">+</span> <span class="ruby-identifier">program_comment</span>
332:           <span class="ruby-ivar">@top_level</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">program_comment</span>
333:           <span class="ruby-identifier">parse_program_or_module</span>(<span class="ruby-ivar">@top_level</span>, <span class="ruby-identifier">program_code</span>, <span class="ruby-identifier">:private</span>)
334:         <span class="ruby-keyword kw">end</span>
335: 
336:         <span class="ruby-comment cmt"># next loop to search next block</span>
337:         <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
338:         <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">false</span>
339:         <span class="ruby-identifier">block_searching_lines</span> = []
340:         <span class="ruby-identifier">pre_comment</span> = []
341:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
342:       }
343: 
344:       <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">delete_if</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
345:         <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
346:       }
347: 
348:       <span class="ruby-comment cmt"># External subprograms and functions are parsed</span>
349:       <span class="ruby-comment cmt">#</span>
350:       <span class="ruby-identifier">parse_program_or_module</span>(<span class="ruby-ivar">@top_level</span>, <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>),
351:                               <span class="ruby-identifier">:public</span>, <span class="ruby-keyword kw">true</span>)
352: 
353:       <span class="ruby-ivar">@top_level</span>
354:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M003903">
                    
                    <a name="M003903"></a><b>block_end?</b>(line)
                    
                </div>
                
                <div class="description">
                  <p>
Which &#8220;line&#8221; is end of block (module, program, block data,
subroutine, function) statement ?
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003903_source')" id="l_M003903_source">show</a>
                        
                    </p>
                    <div id="M003903_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1582</span>
1582:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">block_end?</span>(<span class="ruby-identifier">line</span>)
1583:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">line</span>
1584: 
1585:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s*?(!.*?)?$/i</span>                 <span class="ruby-operator">||</span>
1586:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s+module(\s+\w+)?\s*?(!.*?)?$/i</span>       <span class="ruby-operator">||</span>
1587:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s+program(\s+\w+)?\s*?(!.*?)?$/i</span>      <span class="ruby-operator">||</span>
1588:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s+block\s+data(\s+\w+)?\s*?(!.*?)?$/i</span>  <span class="ruby-operator">||</span>
1589:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s+subroutine(\s+\w+)?\s*?(!.*?)?$/i</span>   <span class="ruby-operator">||</span>
1590:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?end\s+function(\s+\w+)?\s*?(!.*?)?$/i</span>
1591:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
1592:       <span class="ruby-keyword kw">end</span>
1593: 
1594:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1595:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003901">
                    
                    <a name="M003901"></a><b>block_start?</b>(line)
                    
                </div>
                
                <div class="description">
                  <p>
Which &#8220;line&#8221; is start of block (module, program, block data,
subroutine, function) statement ?
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003901_source')" id="l_M003901_source">show</a>
                        
                    </p>
                    <div id="M003901_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1546</span>
1546:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
1547:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">line</span>
1548: 
1549:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?module\s+(\w+)\s*?(!.*?)?$/i</span>    <span class="ruby-operator">||</span>
1550:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?program\s+(\w+)\s*?(!.*?)?$/i</span>  <span class="ruby-operator">||</span>
1551:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?block\s+data(\s+\w+)?\s*?(!.*?)?$/i</span>     <span class="ruby-operator">||</span>
1552:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> \
1553:                   <span class="ruby-regexp re">/^\s*?
1554:                    (recursive|pure|elemental)?\s*?
1555:                    subroutine\s+(\w+)\s*?(\(.*?\))?\s*?(!.*?)?$
1556:                   /i</span><span class="ruby-identifier">x</span> <span class="ruby-operator">||</span>
1557:           <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> \
1558:                   <span class="ruby-regexp re">/^\s*?
1559:                    (recursive|pure|elemental)?\s*?
1560:                    (
1561:                        character\s*?(\([\w\s\=\(\)\*]+?\))?\s+
1562:                      | type\s*?\([\w\s]+?\)\s+
1563:                      | integer\s*?(\([\w\s\=\(\)\*]+?\))?\s+
1564:                      | real\s*?(\([\w\s\=\(\)\*]+?\))?\s+
1565:                      | double\s+precision\s+
1566:                      | logical\s*?(\([\w\s\=\(\)\*]+?\))?\s+
1567:                      | complex\s*?(\([\w\s\=\(\)\*]+?\))?\s+
1568:                    )?
1569:                    function\s+(\w+)\s*?
1570:                    (\(.*?\))?(\s+result\((.*?)\))?\s*?(!.*?)?$
1571:                   /i</span><span class="ruby-identifier">x</span>
1572:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
1573:       <span class="ruby-keyword kw">end</span>
1574: 
1575:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1576:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003891">
                    
                    <a name="M003891"></a><b>check_external_aliases</b>(subname, params, comment, test=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Check external aliases
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003891_source')" id="l_M003891_source">show</a>
                        
                    </p>
                    <div id="M003891_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1330</span>
1330:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_external_aliases</span>(<span class="ruby-identifier">subname</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">test</span>=<span class="ruby-keyword kw">nil</span>)
1331:       <span class="ruby-ivar">@@external_aliases</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">alias_item</span><span class="ruby-operator">|</span>
1332:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">subname</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;old_name&quot;</span>] <span class="ruby-operator">||</span>
1333:                     <span class="ruby-identifier">subname</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;old_name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
1334:                             <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
1335: 
1336:           <span class="ruby-identifier">new_meth</span> = <span class="ruby-identifier">initialize_external_method</span>(<span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;new_name&quot;</span>], 
1337:                                                 <span class="ruby-identifier">subname</span>, <span class="ruby-identifier">params</span>, <span class="ruby-ivar">@file_name</span>, 
1338:                                                 <span class="ruby-identifier">comment</span>)
1339:           <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">visibility</span> = <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;visibility&quot;</span>]
1340: 
1341:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;e&quot;</span>
1342:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1343:           <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">add_method</span>(<span class="ruby-identifier">new_meth</span>)
1344: 
1345:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">include_requires?</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
1346:             <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">add_require</span>(<span class="ruby-constant">Require</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@file_name</span>, <span class="ruby-value str">&quot;&quot;</span>))
1347:           <span class="ruby-keyword kw">end</span>
1348:         <span class="ruby-keyword kw">end</span>
1349:       }
1350:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003892">
                    
                    <a name="M003892"></a><b>check_public_methods</b>(method, parent)
                    
                </div>
                
                <div class="description">
                  <p>
Check public_methods
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003892_source')" id="l_M003892_source">show</a>
                        
                    </p>
                    <div id="M003892_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1355</span>
1355:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">parent</span>)
1356:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">method</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent</span>
1357:       <span class="ruby-ivar">@@public_methods</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">alias_item</span><span class="ruby-operator">|</span>
1358:         <span class="ruby-identifier">parent_is_used_module</span> = <span class="ruby-keyword kw">nil</span>
1359:         <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;used_modules&quot;</span>].<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">used_module</span><span class="ruby-operator">|</span>
1360:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">used_module</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">parent</span> <span class="ruby-operator">||</span>
1361:               <span class="ruby-identifier">used_module</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
1362:               <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
1363:             <span class="ruby-identifier">parent_is_used_module</span> = <span class="ruby-keyword kw">true</span>
1364:           <span class="ruby-keyword kw">end</span>
1365:         }
1366:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent_is_used_module</span>
1367: 
1368:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">||</span>
1369:             <span class="ruby-identifier">method</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
1370:             <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
1371: 
1372:           <span class="ruby-identifier">new_meth</span> = <span class="ruby-identifier">initialize_public_method</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">parent</span>)
1373:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;local_name&quot;</span>]
1374:             <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;local_name&quot;</span>]
1375:           <span class="ruby-keyword kw">end</span>
1376: 
1377:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;e&quot;</span>
1378:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1379:           <span class="ruby-identifier">alias_item</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">new_meth</span>
1380:         <span class="ruby-keyword kw">end</span>
1381:       }
1382:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003878">
                    
                    <a name="M003878"></a><b>collect_first_comment</b>(body)
                    
                </div>
                
                <div class="description">
                  <p>
Collect comment for file entity
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003878_source')" id="l_M003878_source">show</a>
                        
                    </p>
                    <div id="M003878_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1039</span>
1039:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collect_first_comment</span>(<span class="ruby-identifier">body</span>)
1040:       <span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1041:       <span class="ruby-identifier">not_comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1042:       <span class="ruby-identifier">comment_start</span> = <span class="ruby-keyword kw">false</span>
1043:       <span class="ruby-identifier">comment_end</span>   = <span class="ruby-keyword kw">false</span>
1044:       <span class="ruby-identifier">body</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1045:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">comment_end</span>
1046:           <span class="ruby-identifier">not_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
1047:           <span class="ruby-identifier">not_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
1048:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^\s*?!\s?(.*)$/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1049:           <span class="ruby-identifier">comment_start</span> = <span class="ruby-keyword kw">true</span>
1050:           <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$1</span>
1051:           <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
1052:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^\s*?$/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1053:           <span class="ruby-identifier">comment_end</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">comment_start</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">COMMENTS_ARE_UPPER</span>
1054:         <span class="ruby-keyword kw">else</span>
1055:           <span class="ruby-identifier">comment_end</span> = <span class="ruby-keyword kw">true</span>
1056:           <span class="ruby-identifier">not_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
1057:           <span class="ruby-identifier">not_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
1058:         <span class="ruby-keyword kw">end</span>
1059:       }
1060:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">not_comment</span>
1061:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003898">
                    
                    <a name="M003898"></a><b>comment_out?</b>(line)
                    
                </div>
                
                <div class="description">
                  <p>
Comment out checker
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003898_source')" id="l_M003898_source">show</a>
                        
                    </p>
                    <div id="M003898_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1477</span>
1477:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">comment_out?</span>(<span class="ruby-identifier">line</span>)
1478:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">line</span>
1479:       <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">false</span>
1480:       <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span>
1481:       <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
1482:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">squote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">dquote</span>)
1483:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1484:           <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span> ; <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">true</span> ; <span class="ruby-keyword kw">break</span>
1485:           <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">true</span>
1486:           <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">true</span>
1487:           <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span>
1488:           <span class="ruby-keyword kw">end</span>
1489:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">squote</span>
1490:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1491:           <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span>
1492:           <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span>
1493:           <span class="ruby-keyword kw">end</span>
1494:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dquote</span>
1495:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1496:           <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span>
1497:           <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span>
1498:           <span class="ruby-keyword kw">end</span>
1499:         <span class="ruby-keyword kw">end</span>
1500:       }
1501:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">commentout</span>
1502:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003897">
                    
                    <a name="M003897"></a><b>continuous_line?</b>(line)
                    
                </div>
                
                <div class="description">
                  <p>
Continuous line checker
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003897_source')" id="l_M003897_source">show</a>
                        
                    </p>
                    <div id="M003897_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1463</span>
1463:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">continuous_line?</span>(<span class="ruby-identifier">line</span>)
1464:       <span class="ruby-identifier">continuous</span> = <span class="ruby-keyword kw">false</span>
1465:       <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/&amp;\s*?(!.*)?$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1466:         <span class="ruby-identifier">continuous</span> = <span class="ruby-keyword kw">true</span>
1467:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">comment_out?</span>(<span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>)
1468:           <span class="ruby-identifier">continuous</span> = <span class="ruby-keyword kw">false</span>
1469:         <span class="ruby-keyword kw">end</span>
1470:       <span class="ruby-keyword kw">end</span>
1471:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">continuous</span>
1472:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003914">
                    
                    <a name="M003914"></a><b>definition_info</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Parse string argument &#8220;text&#8221;, and Return <a
href="../Array.html">Array</a> of <a
href="Fortran95parser/Fortran95Definition.html">Fortran95Definition</a>
object
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003914_source')" id="l_M003914_source">show</a>
                        
                    </p>
                    <div id="M003914_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1712</span>
1712:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">definition_info</span>(<span class="ruby-identifier">text</span>)
1713:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">text</span>
1714:       <span class="ruby-identifier">lines</span> = <span class="ruby-node">&quot;#{text}&quot;</span>
1715:       <span class="ruby-identifier">defs</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
1716:       <span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1717:       <span class="ruby-identifier">trailing_comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1718:       <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">false</span>
1719:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1720:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?!\s?(.*)/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1721:           <span class="ruby-keyword kw">if</span> <span class="ruby-constant">COMMENTS_ARE_UPPER</span>
1722:             <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">remove_header_marker</span>(<span class="ruby-identifier">$1</span>)
1723:             <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
1724:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">defs</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">under_comment_valid</span>
1725:             <span class="ruby-identifier">defs</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
1726:             <span class="ruby-identifier">defs</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">remove_header_marker</span>(<span class="ruby-identifier">$1</span>)
1727:           <span class="ruby-keyword kw">end</span>
1728:           <span class="ruby-keyword kw">next</span>
1729:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^\s*?$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1730:           <span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1731:           <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">false</span>
1732:           <span class="ruby-keyword kw">next</span>
1733:         <span class="ruby-keyword kw">end</span>
1734:         <span class="ruby-identifier">type</span> = <span class="ruby-value str">&quot;&quot;</span>
1735:         <span class="ruby-identifier">characters</span> = <span class="ruby-value str">&quot;&quot;</span>
1736:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
1737:                     (
1738:                         character\s*?(\([\w\s\=\(\)\*]+?\))?[\s\,]*
1739:                       | type\s*?\([\w\s]+?\)[\s\,]*
1740:                       | integer\s*?(\([\w\s\=\(\)\*]+?\))?[\s\,]*
1741:                       | real\s*?(\([\w\s\=\(\)\*]+?\))?[\s\,]*
1742:                       | double\s+precision[\s\,]*
1743:                       | logical\s*?(\([\w\s\=\(\)\*]+?\))?[\s\,]*
1744:                       | complex\s*?(\([\w\s\=\(\)\*]+?\))?[\s\,]*
1745:                     )
1746:                     (.*?::)?
1747:                     (.+)$
1748:                    /i</span><span class="ruby-identifier">x</span>
1749:           <span class="ruby-identifier">characters</span> = <span class="ruby-identifier">$8</span>
1750:           <span class="ruby-identifier">type</span> = <span class="ruby-identifier">$1</span>
1751:           <span class="ruby-identifier">type</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$7</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/::/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^\s*?\,/</span>, <span class="ruby-value str">''</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$7</span>
1752:         <span class="ruby-keyword kw">else</span>
1753:           <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">false</span>
1754:           <span class="ruby-keyword kw">next</span>
1755:         <span class="ruby-keyword kw">end</span>
1756:         <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">bracket</span> = <span class="ruby-value">0</span>
1757:         <span class="ruby-identifier">iniflag</span> = <span class="ruby-keyword kw">false</span>; <span class="ruby-identifier">commentflag</span> = <span class="ruby-keyword kw">false</span>
1758:         <span class="ruby-identifier">varname</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">arraysuffix</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">inivalue</span> = <span class="ruby-value str">&quot;&quot;</span>
1759:         <span class="ruby-identifier">start_pos</span> = <span class="ruby-identifier">defs</span>.<span class="ruby-identifier">size</span>
1760:         <span class="ruby-identifier">characters</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
1761:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">squote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">dquote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">bracket</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">iniflag</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">commentflag</span>)
1762:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1763:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span> ; <span class="ruby-identifier">commentflag</span> = <span class="ruby-keyword kw">true</span>
1764:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;(&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>       ; <span class="ruby-identifier">arraysuffix</span> = <span class="ruby-identifier">char</span>
1765:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">true</span>
1766:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">true</span>
1767:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;=&quot;</span> ; <span class="ruby-identifier">iniflag</span> = <span class="ruby-keyword kw">true</span>     ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1768:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;,&quot;</span>
1769:               <span class="ruby-identifier">defs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Fortran95Definition</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">varname</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">inivalue</span>, <span class="ruby-identifier">arraysuffix</span>, <span class="ruby-identifier">comment</span>)
1770:               <span class="ruby-identifier">varname</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">arraysuffix</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">inivalue</span> = <span class="ruby-value str">&quot;&quot;</span>
1771:               <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">true</span>
1772:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot; &quot;</span> ; <span class="ruby-keyword kw">next</span>
1773:             <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">varname</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1774:             <span class="ruby-keyword kw">end</span>
1775:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">commentflag</span>
1776:             <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">remove_header_marker</span>(<span class="ruby-identifier">char</span>)
1777:             <span class="ruby-identifier">trailing_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">remove_header_marker</span>(<span class="ruby-identifier">char</span>)
1778:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">iniflag</span>
1779:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dquote</span>
1780:               <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1781:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span> ; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1782:               <span class="ruby-keyword kw">else</span>      ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1783:               <span class="ruby-keyword kw">end</span>
1784:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">squote</span>
1785:               <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1786:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span> ; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1787:               <span class="ruby-keyword kw">else</span>      ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1788:               <span class="ruby-keyword kw">end</span>
1789:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">bracket</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
1790:               <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1791:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;(&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1792:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;)&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1793:               <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1794:               <span class="ruby-keyword kw">end</span>
1795:             <span class="ruby-keyword kw">else</span>
1796:               <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1797:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;,&quot;</span>
1798:                 <span class="ruby-identifier">defs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Fortran95Definition</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">varname</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">inivalue</span>, <span class="ruby-identifier">arraysuffix</span>, <span class="ruby-identifier">comment</span>)
1799:                 <span class="ruby-identifier">varname</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">arraysuffix</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">inivalue</span> = <span class="ruby-value str">&quot;&quot;</span>
1800:                 <span class="ruby-identifier">iniflag</span> = <span class="ruby-keyword kw">false</span>
1801:                 <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">true</span>
1802:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;(&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1803:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">true</span>  ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1804:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">true</span>  ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1805:               <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span> ; <span class="ruby-identifier">commentflag</span> = <span class="ruby-keyword kw">true</span>
1806:               <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1807:               <span class="ruby-keyword kw">end</span>
1808:             <span class="ruby-keyword kw">end</span>
1809:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">squote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">dquote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">bracket</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
1810:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1811:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;(&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> ; <span class="ruby-identifier">arraysuffix</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1812:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;)&quot;</span> ; <span class="ruby-identifier">bracket</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> ; <span class="ruby-identifier">arraysuffix</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1813:             <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">arraysuffix</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1814:             <span class="ruby-keyword kw">end</span>
1815:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">squote</span>
1816:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1817:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1818:             <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1819:             <span class="ruby-keyword kw">end</span>
1820:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dquote</span>
1821:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1822:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1823:             <span class="ruby-keyword kw">else</span>     ; <span class="ruby-identifier">inivalue</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>
1824:             <span class="ruby-keyword kw">end</span>
1825:           <span class="ruby-keyword kw">end</span>
1826:         }
1827:         <span class="ruby-identifier">defs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Fortran95Definition</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">varname</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">inivalue</span>, <span class="ruby-identifier">arraysuffix</span>, <span class="ruby-identifier">comment</span>)
1828:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trailing_comment</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^:nodoc:/</span>
1829:           <span class="ruby-identifier">defs</span>[<span class="ruby-identifier">start_pos</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">collect!</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">defitem</span><span class="ruby-operator">|</span>
1830:             <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">nodoc</span> = <span class="ruby-keyword kw">true</span>
1831:           }
1832:         <span class="ruby-keyword kw">end</span>
1833:         <span class="ruby-identifier">varname</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">arraysuffix</span> = <span class="ruby-value str">&quot;&quot;</span> ; <span class="ruby-identifier">inivalue</span> = <span class="ruby-value str">&quot;&quot;</span>
1834:         <span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1835:         <span class="ruby-identifier">under_comment_valid</span> = <span class="ruby-keyword kw">true</span>
1836:         <span class="ruby-identifier">trailing_comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1837:       }
1838:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">defs</span>
1839:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003879">
                    
                    <a name="M003879"></a><b>find_arguments</b>(args, text, all=nil, indent=nil, modified_params=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Return comments of definitions of arguments
</p>
<p>
If &#8220;all&#8221; argument is true, information of all arguments are
returned. If &#8220;modified_params&#8220; is true, list of arguments are
decorated, for example, optional arguments are parenthetic as
&#8220;[arg]&#8221;.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003879_source')" id="l_M003879_source">show</a>
                        
                    </p>
                    <div id="M003879_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1070</span>
1070:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_arguments</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">text</span>, <span class="ruby-identifier">all</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">indent</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">modified_params</span>=<span class="ruby-keyword kw">nil</span>)
1071:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">all</span>
1072:       <span class="ruby-identifier">indent</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">indent</span>
1073:       <span class="ruby-identifier">args</span> = [<span class="ruby-value str">&quot;all&quot;</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">all</span>
1074:       <span class="ruby-identifier">params</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">modified_params</span>
1075:       <span class="ruby-identifier">comma</span> = <span class="ruby-value str">&quot;&quot;</span>
1076:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">text</span>
1077:       <span class="ruby-identifier">args_rdocforms</span> = <span class="ruby-value str">&quot;\n&quot;</span>
1078:       <span class="ruby-identifier">remaining_lines</span> = <span class="ruby-node">&quot;#{text}&quot;</span>
1079:       <span class="ruby-identifier">definitions</span> = <span class="ruby-identifier">definition_info</span>(<span class="ruby-identifier">remaining_lines</span>)
1080:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
1081:         <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">strip!</span>
1082:         <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">chomp!</span>
1083:         <span class="ruby-identifier">definitions</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">defitem</span><span class="ruby-operator">|</span>
1084:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">all</span>
1085:             <span class="ruby-identifier">args_rdocforms</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\#{indent}&lt;tt&gt;&lt;b&gt;\#{defitem.varname.chomp.strip}\#{defitem.arraysuffix}&lt;/b&gt; \#{defitem.inivalue}&lt;/tt&gt; ::\n\#{indent}   &lt;tt&gt;\#{defitem.types.chomp.strip}&lt;/tt&gt;\n&quot;</span>
1086:             <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">comment</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
1087:               <span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&quot;</span>
1088:               <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">comment</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1089:                 <span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;       &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
1090:               }
1091:               <span class="ruby-identifier">args_rdocforms</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\#{indent}   &lt;tt&gt;&lt;/tt&gt; ::\n\#{indent}       &lt;tt&gt;&lt;/tt&gt;\n\#{indent}       \#{comment.chomp.strip}\n&quot;</span>
1092:             <span class="ruby-keyword kw">end</span>
1093: 
1094:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">modified_params</span>
1095:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;optional&quot;</span>)
1096:                 <span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{comma}[#{arg}]&quot;</span>
1097:               <span class="ruby-keyword kw">else</span>
1098:                 <span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{comma}#{arg}&quot;</span>
1099:               <span class="ruby-keyword kw">end</span>
1100:               <span class="ruby-identifier">comma</span> = <span class="ruby-value str">&quot;, &quot;</span>
1101:             <span class="ruby-keyword kw">end</span>
1102:           <span class="ruby-keyword kw">end</span>
1103:         }
1104:       }
1105:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">modified_params</span>
1106:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">args_rdocforms</span>, <span class="ruby-identifier">params</span>
1107:       <span class="ruby-keyword kw">else</span>
1108:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">args_rdocforms</span>
1109:       <span class="ruby-keyword kw">end</span>
1110:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003882">
                    
                    <a name="M003882"></a><b>find_comments</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Comments just after module or subprogram, or arguments are returned. If
&#8220;<a
href="Fortran95parser.html#COMMENTS_ARE_UPPER">COMMENTS_ARE_UPPER</a>&#8220;
is true, comments just before modules or subprograms are returned
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003882_source')" id="l_M003882_source">show</a>
                        
                    </p>
                    <div id="M003882_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1151</span>
1151:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_comments</span> <span class="ruby-identifier">text</span>
1152:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">text</span>
1153:       <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1154:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">reverse!</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">COMMENTS_ARE_UPPER</span>
1155:       <span class="ruby-identifier">comment_block</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
1156:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1157:         <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?\w/</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?$/</span>
1158:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">COMMENTS_ARE_UPPER</span>
1159:           <span class="ruby-identifier">comment_block</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\s*?!\s?/</span>,<span class="ruby-value str">&quot;&quot;</span>)
1160:         <span class="ruby-keyword kw">else</span>
1161:           <span class="ruby-identifier">comment_block</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\s*?!\s?/</span>,<span class="ruby-value str">&quot;&quot;</span>)
1162:         <span class="ruby-keyword kw">end</span>
1163:       <span class="ruby-keyword kw">end</span>
1164:       <span class="ruby-identifier">nice_lines</span> = <span class="ruby-identifier">comment_block</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">split</span> <span class="ruby-value str">&quot;\n\s*?\n&quot;</span>
1165:       <span class="ruby-identifier">nice_lines</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">||=</span> <span class="ruby-value str">&quot;&quot;</span>
1166:       <span class="ruby-identifier">nice_lines</span>.<span class="ruby-identifier">shift</span>
1167:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003880">
                    
                    <a name="M003880"></a><b>find_namelists</b>(text, before_contains=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Return comments of definitions of namelists
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003880_source')" id="l_M003880_source">show</a>
                        
                    </p>
                    <div id="M003880_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1125</span>
1125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_namelists</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">before_contains</span>=<span class="ruby-keyword kw">nil</span>)
1126:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">text</span>
1127:       <span class="ruby-identifier">result</span> = <span class="ruby-value str">&quot;&quot;</span>
1128:       <span class="ruby-identifier">lines</span> = <span class="ruby-node">&quot;#{text}&quot;</span>
1129:       <span class="ruby-identifier">before_contains</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">before_contains</span>
1130:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">lines</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?namelist\s+\/\s*?(\w+)\s*?\/([\s\w\,]+)$/i</span>
1131:         <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
1132:         <span class="ruby-identifier">nml_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">? </span>
1133:             <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>)
1134:         <span class="ruby-identifier">nml_name</span> = <span class="ruby-identifier">$1</span>
1135:         <span class="ruby-identifier">nml_args</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>)
1136:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n\n=== NAMELIST &lt;tt&gt;&lt;b&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">nml_name</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;&lt;/tt&gt;&lt;/b&gt;\n\n&quot;</span>
1137:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">nml_comment</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nml_comment</span>
1138:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\//i</span>
1139:           <span class="ruby-identifier">lines</span> = <span class="ruby-value str">&quot;namelist &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">lines</span>
1140:         <span class="ruby-keyword kw">end</span>
1141:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">find_arguments</span>(<span class="ruby-identifier">nml_args</span>, <span class="ruby-node">&quot;#{text}&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">before_contains</span>)
1142:       <span class="ruby-keyword kw">end</span>
1143:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
1144:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003889">
                    
                    <a name="M003889"></a><b>find_visibility</b>(container, subname, visibility_info)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Find.html">Find</a> visibility
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003889_source')" id="l_M003889_source">show</a>
                        
                    </p>
                    <div id="M003889_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1314</span>
1314:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">subname</span>, <span class="ruby-identifier">visibility_info</span>)
1315:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">subname</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">visibility_info</span>
1316:       <span class="ruby-identifier">visibility_info</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
1317:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">subname</span> <span class="ruby-operator">||</span>
1318:             <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">subname</span>.<span class="ruby-identifier">upcase</span>
1319:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;parent&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>
1320:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;visibility&quot;</span>]
1321:           <span class="ruby-keyword kw">end</span>
1322:         <span class="ruby-keyword kw">end</span>
1323:       }
1324:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1325:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003885">
                    
                    <a name="M003885"></a><b>initialize_external_method</b>(new, old, params, file, comment, token=nil, internal=nil, nolink=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Create method for external alias
</p>
<p>
If argument &#8220;internal&#8221; is true, file is ignored.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003885_source')" id="l_M003885_source">show</a>
                        
                    </p>
                    <div id="M003885_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1196</span>
1196:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_external_method</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">old</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">file</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">token</span>=<span class="ruby-keyword kw">nil</span>,
1197:                                    <span class="ruby-identifier">internal</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">nolink</span>=<span class="ruby-keyword kw">nil</span>)
1198:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">new</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">old</span>
1199: 
1200:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">internal</span>
1201:         <span class="ruby-identifier">external_alias_header</span> = <span class="ruby-node">&quot;#{INTERNAL_ALIAS_MES} &quot;</span>
1202:         <span class="ruby-identifier">external_alias_text</span>   = <span class="ruby-identifier">external_alias_header</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">old</span> 
1203:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">file</span>
1204:         <span class="ruby-identifier">external_alias_header</span> = <span class="ruby-node">&quot;#{EXTERNAL_ALIAS_MES} &quot;</span>
1205:         <span class="ruby-identifier">external_alias_text</span>   = <span class="ruby-identifier">external_alias_header</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">file</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;#&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">old</span>
1206:       <span class="ruby-keyword kw">else</span>
1207:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1208:       <span class="ruby-keyword kw">end</span>
1209:       <span class="ruby-identifier">external_meth</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">external_alias_text</span>, <span class="ruby-identifier">new</span>)
1210:       <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">singleton</span>    = <span class="ruby-keyword kw">false</span>
1211:       <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">params</span>       = <span class="ruby-identifier">params</span>
1212:       <span class="ruby-identifier">external_comment</span> = <span class="ruby-identifier">remove_trailing_alias</span>(<span class="ruby-identifier">comment</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">comment</span>
1213:       <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">external_comment</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
1214:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nolink</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">token</span>
1215:         <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">start_collecting_tokens</span>
1216:         <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">add_token</span> <span class="ruby-constant">Token</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>,<span class="ruby-value">1</span>).<span class="ruby-identifier">set_text</span>(<span class="ruby-identifier">token</span>)
1217:       <span class="ruby-keyword kw">else</span>
1218:         <span class="ruby-identifier">external_meth</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">external_alias_text</span>
1219:       <span class="ruby-keyword kw">end</span>
1220: 
1221:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">external_meth</span>
1222:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003884">
                    
                    <a name="M003884"></a><b>initialize_public_method</b>(method, parent)
                    
                </div>
                
                <div class="description">
                  <p>
Create method for internal alias
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003884_source')" id="l_M003884_source">show</a>
                        
                    </p>
                    <div id="M003884_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1179</span>
1179:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_public_method</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">parent</span>)
1180:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">method</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent</span>
1181: 
1182:       <span class="ruby-identifier">new_meth</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;External Alias for module&quot;</span>, <span class="ruby-identifier">method</span>.<span class="ruby-identifier">name</span>)
1183:       <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">singleton</span>    = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">singleton</span>
1184:       <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">params</span>       = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">clone</span>
1185:       <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">comment</span>      = <span class="ruby-identifier">remove_trailing_alias</span>(<span class="ruby-identifier">method</span>.<span class="ruby-identifier">comment</span>.<span class="ruby-identifier">clone</span>)
1186:       <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">comment</span>      <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;\n\n#{EXTERNAL_ALIAS_MES} #{parent.strip.chomp}\##{method.name}&quot;</span>
1187: 
1188:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new_meth</span>
1189:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003843">
                    
                    <a name="M003843"></a><b>parse_program_or_module</b>(container, code, visibility=:public, external=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003843_source')" id="l_M003843_source">show</a>
                        
                    </p>
                    <div id="M003843_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 358</span>
 358:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_program_or_module</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">code</span>,
 359:                                 <span class="ruby-identifier">visibility</span>=<span class="ruby-identifier">:public</span>, <span class="ruby-identifier">external</span>=<span class="ruby-keyword kw">nil</span>)
 360:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">container</span>
 361:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code</span>
 362:       <span class="ruby-identifier">remaining_lines</span> = <span class="ruby-identifier">code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 363:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-node">&quot;#{code}&quot;</span>
 364: 
 365:       <span class="ruby-comment cmt">#</span>
 366:       <span class="ruby-comment cmt"># Parse variables before &quot;contains&quot; in module</span>
 367:       <span class="ruby-comment cmt">#</span>
 368:       <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
 369:       <span class="ruby-identifier">before_contains_lines</span> = []
 370:       <span class="ruby-identifier">before_contains_code</span> = <span class="ruby-keyword kw">nil</span>
 371:       <span class="ruby-identifier">before_contains_flag</span> = <span class="ruby-keyword kw">nil</span>
 372:       <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
 373:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">before_contains_flag</span>
 374:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?module\s+\w+\s*?(!.*?)?$/i</span>
 375:             <span class="ruby-identifier">before_contains_flag</span> = <span class="ruby-keyword kw">true</span>
 376:           <span class="ruby-keyword kw">end</span>
 377:         <span class="ruby-keyword kw">else</span>
 378:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?contains\s*?(!.*?)?$/i</span>
 379:           <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
 380:           <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_end?</span>(<span class="ruby-identifier">line</span>)
 381:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
 382:           <span class="ruby-identifier">before_contains_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
 383:         <span class="ruby-keyword kw">end</span>
 384:       }
 385:       <span class="ruby-identifier">before_contains_code</span> = <span class="ruby-identifier">before_contains_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 386:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_contains_code</span>
 387:         <span class="ruby-identifier">before_contains_code</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^\s*?interface\s+.*?\s+end\s+interface.*?$/i</span><span class="ruby-identifier">m</span>, <span class="ruby-value str">&quot;&quot;</span>)
 388:         <span class="ruby-identifier">before_contains_code</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^\s*?type[\s\,]+.*?\s+end\s+type.*?$/i</span><span class="ruby-identifier">m</span>, <span class="ruby-value str">&quot;&quot;</span>)
 389:       <span class="ruby-keyword kw">end</span>
 390: 
 391:       <span class="ruby-comment cmt">#</span>
 392:       <span class="ruby-comment cmt"># Parse global &quot;use&quot;</span>
 393:       <span class="ruby-comment cmt">#</span>
 394:       <span class="ruby-identifier">use_check_code</span> = <span class="ruby-node">&quot;#{before_contains_code}&quot;</span>
 395:       <span class="ruby-identifier">cascaded_modules_list</span> = []
 396:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?use\s+(\w+)(.*?)(!.*?)?$/i</span>
 397:         <span class="ruby-identifier">use_check_code</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>
 398:         <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
 399:         <span class="ruby-identifier">used_mod_name</span> = <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span>
 400:         <span class="ruby-identifier">used_list</span> = <span class="ruby-identifier">$2</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 401:         <span class="ruby-identifier">used_trailing</span> = <span class="ruby-identifier">$3</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 402:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">used_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/!:nodoc:/</span>
 403:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">container</span>.<span class="ruby-identifier">include_includes?</span>(<span class="ruby-identifier">used_mod_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 404:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;.&quot;</span>
 405:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_include</span> <span class="ruby-constant">Include</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">used_mod_name</span>, <span class="ruby-value str">&quot;&quot;</span>)
 406:         <span class="ruby-keyword kw">end</span>
 407:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span> (<span class="ruby-identifier">used_list</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\,\s*?only\s*?:/i</span> )
 408:           <span class="ruby-identifier">cascaded_modules_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\#&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">used_mod_name</span>
 409:         <span class="ruby-keyword kw">end</span>
 410:       <span class="ruby-keyword kw">end</span>
 411: 
 412:       <span class="ruby-comment cmt">#</span>
 413:       <span class="ruby-comment cmt"># Parse public and private, and store information.</span>
 414:       <span class="ruby-comment cmt"># This information is used when &quot;add_method&quot; and</span>
 415:       <span class="ruby-comment cmt"># &quot;set_visibility_for&quot; are called.</span>
 416:       <span class="ruby-comment cmt">#</span>
 417:       <span class="ruby-identifier">visibility_default</span>, <span class="ruby-identifier">visibility_info</span> = 
 418:                 <span class="ruby-identifier">parse_visibility</span>(<span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>), <span class="ruby-identifier">visibility</span>, <span class="ruby-identifier">container</span>)
 419:       <span class="ruby-ivar">@@public_methods</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">visibility_info</span>
 420:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">visibility_default</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:public</span>
 421:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">cascaded_modules_list</span>.<span class="ruby-identifier">empty?</span>
 422:           <span class="ruby-identifier">cascaded_modules</span> = 
 423:             <span class="ruby-constant">Attr</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Cascaded Modules&quot;</span>,
 424:                      <span class="ruby-value str">&quot;Imported modules all of whose components are published again&quot;</span>,
 425:                      <span class="ruby-value str">&quot;&quot;</span>,
 426:                      <span class="ruby-identifier">cascaded_modules_list</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;, &quot;</span>))
 427:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-identifier">cascaded_modules</span>)
 428:         <span class="ruby-keyword kw">end</span>
 429:       <span class="ruby-keyword kw">end</span>
 430: 
 431:       <span class="ruby-comment cmt">#</span>
 432:       <span class="ruby-comment cmt"># Check rename elements</span>
 433:       <span class="ruby-comment cmt">#</span>
 434:       <span class="ruby-identifier">use_check_code</span> = <span class="ruby-node">&quot;#{before_contains_code}&quot;</span>
 435:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?use\s+(\w+)\s*?\,(.+)$/i</span>
 436:         <span class="ruby-identifier">use_check_code</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>
 437:         <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
 438:         <span class="ruby-identifier">used_mod_name</span> = <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span>
 439:         <span class="ruby-identifier">used_elements</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\s*?only\s*?:\s*?/i</span>, <span class="ruby-value str">''</span>)
 440:         <span class="ruby-identifier">used_elements</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">used</span><span class="ruby-operator">|</span>
 441:           <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\s*?(\w+)\s*?=&gt;\s*?(\w+)\s*?/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">used</span>
 442:             <span class="ruby-identifier">local</span> = <span class="ruby-identifier">$1</span>
 443:             <span class="ruby-identifier">org</span> = <span class="ruby-identifier">$2</span>
 444:             <span class="ruby-ivar">@@public_methods</span>.<span class="ruby-identifier">collect!</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">pub_meth</span><span class="ruby-operator">|</span>
 445:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">local</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">||</span>
 446:                   <span class="ruby-identifier">local</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
 447:                   <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
 448:                 <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;name&quot;</span>] = <span class="ruby-identifier">org</span>
 449:                 <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;local_name&quot;</span>] = <span class="ruby-identifier">local</span>
 450:               <span class="ruby-keyword kw">end</span>
 451:               <span class="ruby-identifier">pub_meth</span>
 452:             }
 453:           <span class="ruby-keyword kw">end</span>
 454:         }
 455:       <span class="ruby-keyword kw">end</span>
 456: 
 457:       <span class="ruby-comment cmt">#</span>
 458:       <span class="ruby-comment cmt"># Parse private &quot;use&quot;</span>
 459:       <span class="ruby-comment cmt">#</span>
 460:       <span class="ruby-identifier">use_check_code</span> = <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 461:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?use\s+(\w+)(.*?)(!.*?)?$/i</span>
 462:         <span class="ruby-identifier">use_check_code</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>
 463:         <span class="ruby-identifier">use_check_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
 464:         <span class="ruby-identifier">used_mod_name</span> = <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span>
 465:         <span class="ruby-identifier">used_trailing</span> = <span class="ruby-identifier">$3</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 466:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">used_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/!:nodoc:/</span>
 467:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">container</span>.<span class="ruby-identifier">include_includes?</span>(<span class="ruby-identifier">used_mod_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 468:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;.&quot;</span>
 469:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_include</span> <span class="ruby-constant">Include</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">used_mod_name</span>, <span class="ruby-value str">&quot;&quot;</span>)
 470:         <span class="ruby-keyword kw">end</span>
 471:       <span class="ruby-keyword kw">end</span>
 472: 
 473:       <span class="ruby-identifier">container</span>.<span class="ruby-identifier">each_includes</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">inc</span><span class="ruby-operator">|</span>
 474:         <span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">all_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">toplevel</span><span class="ruby-operator">|</span>
 475:           <span class="ruby-identifier">indicated_mod</span> = <span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">find_symbol</span>(<span class="ruby-identifier">inc</span>.<span class="ruby-identifier">name</span>,
 476:                                                <span class="ruby-keyword kw">nil</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 477:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">indicated_mod</span>
 478:             <span class="ruby-identifier">indicated_name</span> = <span class="ruby-identifier">indicated_mod</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">file_relative_name</span>
 479:             <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">container</span>.<span class="ruby-identifier">include_requires?</span>(<span class="ruby-identifier">indicated_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 480:               <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_require</span>(<span class="ruby-constant">Require</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">indicated_name</span>, <span class="ruby-value str">&quot;&quot;</span>))
 481:             <span class="ruby-keyword kw">end</span>
 482:             <span class="ruby-keyword kw">break</span>
 483:           <span class="ruby-keyword kw">end</span>
 484:         <span class="ruby-keyword kw">end</span>
 485:       }
 486: 
 487:       <span class="ruby-comment cmt">#</span>
 488:       <span class="ruby-comment cmt"># Parse derived-types definitions</span>
 489:       <span class="ruby-comment cmt">#</span>
 490:       <span class="ruby-identifier">derived_types_comment</span> = <span class="ruby-value str">&quot;&quot;</span>
 491:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 492:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">remaining_code</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 493:                                     type[\s\,]+(public|private)?\s*?(::)?\s*?
 494:                                     (\w+)\s*?(!.*?)?$
 495:                                     (.*?)
 496:                                     ^\s*?end\s+type.*?$
 497:                               /i</span><span class="ruby-identifier">mx</span>
 498:         <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>
 499:         <span class="ruby-identifier">remaining_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
 500:         <span class="ruby-identifier">typename</span> = <span class="ruby-identifier">$3</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
 501:         <span class="ruby-identifier">type_elements</span> = <span class="ruby-identifier">$5</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 502:         <span class="ruby-identifier">type_code</span> = <span class="ruby-identifier">remove_empty_head_lines</span>(<span class="ruby-identifier">$&amp;</span>)
 503:         <span class="ruby-identifier">type_trailing</span> = <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$4</span>)
 504:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^:nodoc:/</span>
 505:         <span class="ruby-identifier">type_visibility</span> = <span class="ruby-identifier">$1</span>
 506:         <span class="ruby-identifier">type_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">? </span>
 507:           <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">type_trailing</span> <span class="ruby-operator">:</span>
 508:             <span class="ruby-identifier">type_trailing</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">find_comments</span>(<span class="ruby-identifier">type_code</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^.*$\n/i</span>, <span class="ruby-value str">''</span>))
 509:         <span class="ruby-identifier">type_element_visibility_public</span> = <span class="ruby-keyword kw">true</span>
 510:         <span class="ruby-identifier">type_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
 511:           <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?private\s*?$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
 512:             <span class="ruby-identifier">type_element_visibility_public</span> = <span class="ruby-keyword kw">nil</span>
 513:             <span class="ruby-keyword kw">break</span>
 514:           <span class="ruby-keyword kw">end</span>
 515:         } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type_code</span>
 516: 
 517:         <span class="ruby-identifier">args_comment</span> = <span class="ruby-value str">&quot;&quot;</span>
 518:         <span class="ruby-identifier">type_args_info</span> = <span class="ruby-keyword kw">nil</span>
 519: 
 520:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">show_all</span>
 521:           <span class="ruby-identifier">args_comment</span> = <span class="ruby-identifier">find_arguments</span>(<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">type_code</span>, <span class="ruby-keyword kw">true</span>)
 522:         <span class="ruby-keyword kw">else</span>
 523:           <span class="ruby-identifier">type_public_args_list</span> = []
 524:           <span class="ruby-identifier">type_args_info</span> = <span class="ruby-identifier">definition_info</span>(<span class="ruby-identifier">type_code</span>)
 525:           <span class="ruby-identifier">type_args_info</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
 526:             <span class="ruby-identifier">arg_is_public</span> = <span class="ruby-identifier">type_element_visibility_public</span>
 527:             <span class="ruby-identifier">arg_is_public</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;public&quot;</span>)
 528:             <span class="ruby-identifier">arg_is_public</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;private&quot;</span>)
 529:             <span class="ruby-identifier">type_public_args_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">varname</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg_is_public</span>
 530:           }
 531:           <span class="ruby-identifier">args_comment</span> = <span class="ruby-identifier">find_arguments</span>(<span class="ruby-identifier">type_public_args_list</span>, <span class="ruby-identifier">type_code</span>)
 532:         <span class="ruby-keyword kw">end</span>
 533: 
 534:         <span class="ruby-identifier">type</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;type #{typename}&quot;</span>, <span class="ruby-identifier">typename</span>)
 535:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">singleton</span> = <span class="ruby-keyword kw">false</span>
 536:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">params</span> = <span class="ruby-value str">&quot;&quot;</span>
 537:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&lt;b&gt;&lt;em&gt; Derived Type &lt;/em&gt;&lt;/b&gt; :: &lt;tt&gt;&lt;/tt&gt;\n&quot;</span>
 538:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">args_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args_comment</span>
 539:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">type_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type_comment</span>
 540:         <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;t&quot;</span>
 541:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 542:         <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">type</span>
 543: 
 544:         <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">typename</span>, <span class="ruby-identifier">visibility_default</span>, <span class="ruby-ivar">@@public_methods</span>)
 545: 
 546:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type_visibility</span>
 547:           <span class="ruby-identifier">type_visibility</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\s/</span>,<span class="ruby-value str">''</span>)
 548:           <span class="ruby-identifier">type_visibility</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\,/</span>,<span class="ruby-value str">''</span>)
 549:           <span class="ruby-identifier">type_visibility</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/:/</span>,<span class="ruby-value str">''</span>)
 550:           <span class="ruby-identifier">type_visibility</span>.<span class="ruby-identifier">downcase!</span>
 551:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type_visibility</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;public&quot;</span>
 552:             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">typename</span>], <span class="ruby-identifier">:public</span>)
 553:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">type_visibility</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;private&quot;</span>
 554:             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">typename</span>], <span class="ruby-identifier">:private</span>)
 555:           <span class="ruby-keyword kw">end</span>
 556:         <span class="ruby-keyword kw">end</span>
 557: 
 558:         <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>)
 559: 
 560:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">show_all</span>
 561:           <span class="ruby-identifier">derived_types_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;, &quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">derived_types_comment</span>.<span class="ruby-identifier">empty?</span>
 562:           <span class="ruby-identifier">derived_types_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">typename</span>
 563:         <span class="ruby-keyword kw">else</span>
 564:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">visibility</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:public</span>
 565:           <span class="ruby-identifier">derived_types_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;, &quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">derived_types_comment</span>.<span class="ruby-identifier">empty?</span>
 566:           <span class="ruby-identifier">derived_types_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">typename</span>
 567:           <span class="ruby-keyword kw">end</span>
 568:         <span class="ruby-keyword kw">end</span>
 569: 
 570:       <span class="ruby-keyword kw">end</span>
 571: 
 572:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">derived_types_comment</span>.<span class="ruby-identifier">empty?</span>
 573:         <span class="ruby-identifier">derived_types_table</span> = 
 574:           <span class="ruby-constant">Attr</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Derived Types&quot;</span>, <span class="ruby-value str">&quot;Derived_Types&quot;</span>, <span class="ruby-value str">&quot;&quot;</span>, 
 575:                    <span class="ruby-identifier">derived_types_comment</span>)
 576:         <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-identifier">derived_types_table</span>)
 577:       <span class="ruby-keyword kw">end</span>
 578: 
 579:       <span class="ruby-comment cmt">#</span>
 580:       <span class="ruby-comment cmt"># move interface scope</span>
 581:       <span class="ruby-comment cmt">#</span>
 582:       <span class="ruby-identifier">interface_code</span> = <span class="ruby-value str">&quot;&quot;</span>
 583:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">remaining_code</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 584:                                    interface(
 585:                                               \s+\w+                      |
 586:                                               \s+operator\s*?\(.*?\)       |
 587:                                               \s+assignment\s*?\(\s*?=\s*?\)
 588:                                             )?\s*?$
 589:                                    (.*?)
 590:                                    ^\s*?end\s+interface.*?$
 591:                               /i</span><span class="ruby-identifier">mx</span>
 592:         <span class="ruby-identifier">interface_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">remove_empty_head_lines</span>(<span class="ruby-identifier">$&amp;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
 593:         <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">pre_match</span>
 594:         <span class="ruby-identifier">remaining_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">post_match</span>
 595:       <span class="ruby-keyword kw">end</span>
 596: 
 597:       <span class="ruby-comment cmt">#</span>
 598:       <span class="ruby-comment cmt"># Parse global constants or variables in modules</span>
 599:       <span class="ruby-comment cmt">#</span>
 600:       <span class="ruby-identifier">const_var_defs</span> = <span class="ruby-identifier">definition_info</span>(<span class="ruby-identifier">before_contains_code</span>)
 601:       <span class="ruby-identifier">const_var_defs</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">defitem</span><span class="ruby-operator">|</span>
 602:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">nodoc</span>
 603:         <span class="ruby-identifier">const_or_var_type</span> = <span class="ruby-value str">&quot;Variable&quot;</span>
 604:         <span class="ruby-identifier">const_or_var_progress</span> = <span class="ruby-value str">&quot;v&quot;</span>
 605:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;parameter&quot;</span>)
 606:           <span class="ruby-identifier">const_or_var_type</span> = <span class="ruby-value str">&quot;Constant&quot;</span>
 607:           <span class="ruby-identifier">const_or_var_progress</span> = <span class="ruby-value str">&quot;c&quot;</span>
 608:         <span class="ruby-keyword kw">end</span>
 609:         <span class="ruby-identifier">const_or_var</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">const_or_var_type</span>, <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>)
 610:         <span class="ruby-identifier">const_or_var</span>.<span class="ruby-identifier">singleton</span> = <span class="ruby-keyword kw">false</span>
 611:         <span class="ruby-identifier">const_or_var</span>.<span class="ruby-identifier">params</span> = <span class="ruby-value str">&quot;&quot;</span>
 612:         <span class="ruby-identifier">self_comment</span> = <span class="ruby-identifier">find_arguments</span>([<span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>], <span class="ruby-identifier">before_contains_code</span>)
 613:         <span class="ruby-identifier">const_or_var</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-value str">&quot;&lt;b&gt;&lt;em&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">const_or_var_type</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;&lt;/em&gt;&lt;/b&gt; :: &lt;tt&gt;&lt;/tt&gt;\n&quot;</span>
 614:         <span class="ruby-identifier">const_or_var</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">self_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">self_comment</span>
 615:         <span class="ruby-identifier">progress</span> <span class="ruby-identifier">const_or_var_progress</span>
 616:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 617:         <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">const_or_var</span>
 618: 
 619:         <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>, <span class="ruby-identifier">visibility_default</span>, <span class="ruby-ivar">@@public_methods</span>)
 620: 
 621:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;public&quot;</span>)
 622:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>], <span class="ruby-identifier">:public</span>)
 623:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">include_attr?</span>(<span class="ruby-value str">&quot;private&quot;</span>)
 624:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">defitem</span>.<span class="ruby-identifier">varname</span>], <span class="ruby-identifier">:private</span>)
 625:         <span class="ruby-keyword kw">end</span>
 626: 
 627:         <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">const_or_var</span>, <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>)
 628: 
 629:       } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">const_var_defs</span>
 630: 
 631:       <span class="ruby-identifier">remaining_lines</span> = <span class="ruby-identifier">remaining_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 632: 
 633:       <span class="ruby-comment cmt"># &quot;subroutine&quot; or &quot;function&quot; parts are parsed (new)</span>
 634:       <span class="ruby-comment cmt">#</span>
 635:       <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
 636:       <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
 637:       <span class="ruby-identifier">block_searching_lines</span> = []
 638:       <span class="ruby-identifier">pre_comment</span> = []
 639:       <span class="ruby-identifier">procedure_trailing</span> = <span class="ruby-value str">&quot;&quot;</span>
 640:       <span class="ruby-identifier">procedure_name</span> = <span class="ruby-value str">&quot;&quot;</span>
 641:       <span class="ruby-identifier">procedure_params</span> = <span class="ruby-value str">&quot;&quot;</span>
 642:       <span class="ruby-identifier">procedure_prefix</span> = <span class="ruby-value str">&quot;&quot;</span>
 643:       <span class="ruby-identifier">procedure_result_arg</span> = <span class="ruby-value str">&quot;&quot;</span>
 644:       <span class="ruby-identifier">procedure_type</span> = <span class="ruby-value str">&quot;&quot;</span>
 645:       <span class="ruby-identifier">contains_lines</span> = []
 646:       <span class="ruby-identifier">contains_flag</span> = <span class="ruby-keyword kw">nil</span>
 647:       <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">collect!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
 648:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_searching_flag</span>
 649:           <span class="ruby-comment cmt"># subroutine</span>
 650:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 651:                            (recursive|pure|elemental)?\s*?
 652:                            subroutine\s+(\w+)\s*?(\(.*?\))?\s*?(!.*?)?$
 653:                      /i</span><span class="ruby-identifier">x</span>
 654:             <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-identifier">:subroutine</span>
 655:             <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
 656: 
 657:             <span class="ruby-identifier">procedure_name</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
 658:             <span class="ruby-identifier">procedure_params</span> = <span class="ruby-identifier">$3</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 659:             <span class="ruby-identifier">procedure_prefix</span> = <span class="ruby-identifier">$1</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 660:             <span class="ruby-identifier">procedure_trailing</span> = <span class="ruby-identifier">$4</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 661:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
 662: 
 663:           <span class="ruby-comment cmt"># function</span>
 664:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 665:                          (recursive|pure|elemental)?\s*?
 666:                          (
 667:                              character\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 668:                            | type\s*?\([\w\s]+?\)\s+
 669:                            | integer\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 670:                            | real\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 671:                            | double\s+precision\s+
 672:                            | logical\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 673:                            | complex\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 674:                          )?
 675:                          function\s+(\w+)\s*?
 676:                          (\(.*?\))?(\s+result\((.*?)\))?\s*?(!.*?)?$
 677:                         /i</span><span class="ruby-identifier">x</span>
 678:             <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-identifier">:function</span>
 679:             <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
 680: 
 681:             <span class="ruby-identifier">procedure_prefix</span> = <span class="ruby-identifier">$1</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 682:             <span class="ruby-identifier">procedure_type</span> = <span class="ruby-identifier">$2</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
 683:             <span class="ruby-identifier">procedure_name</span> = <span class="ruby-identifier">$8</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
 684:             <span class="ruby-identifier">procedure_params</span> = <span class="ruby-identifier">$9</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 685:             <span class="ruby-identifier">procedure_result_arg</span> = <span class="ruby-identifier">$11</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">$11</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">procedure_name</span>
 686:             <span class="ruby-identifier">procedure_trailing</span> = <span class="ruby-identifier">$12</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 687:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
 688:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?!\s?(.*)/</span>
 689:             <span class="ruby-identifier">pre_comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
 690:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
 691:           <span class="ruby-keyword kw">else</span>
 692:             <span class="ruby-identifier">pre_comment</span> = []
 693:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">line</span>
 694:           <span class="ruby-keyword kw">end</span>
 695:         <span class="ruby-keyword kw">end</span>
 696:         <span class="ruby-identifier">contains_flag</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?contains\s*?(!.*?)?$/</span>
 697:         <span class="ruby-identifier">block_searching_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
 698:         <span class="ruby-identifier">contains_lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">contains_flag</span>
 699: 
 700:         <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_start?</span>(<span class="ruby-identifier">line</span>)
 701:         <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_end?</span>(<span class="ruby-identifier">line</span>)
 702:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">level_depth</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
 703:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
 704:         <span class="ruby-keyword kw">end</span>
 705: 
 706:         <span class="ruby-comment cmt"># &quot;procedure_code&quot; is formatted.</span>
 707:         <span class="ruby-comment cmt"># &quot;:nodoc:&quot; flag is checked.</span>
 708:         <span class="ruby-comment cmt">#</span>
 709:         <span class="ruby-identifier">procedure_code</span> = <span class="ruby-identifier">block_searching_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 710:         <span class="ruby-identifier">procedure_code</span> = <span class="ruby-identifier">remove_empty_head_lines</span>(<span class="ruby-identifier">procedure_code</span>)
 711:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procedure_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^!:nodoc:/</span>
 712:           <span class="ruby-comment cmt"># next loop to search next block</span>
 713:           <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
 714:           <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
 715:           <span class="ruby-identifier">block_searching_lines</span> = []
 716:           <span class="ruby-identifier">pre_comment</span> = []
 717:           <span class="ruby-identifier">procedure_trailing</span> = <span class="ruby-value str">&quot;&quot;</span>
 718:           <span class="ruby-identifier">procedure_name</span> = <span class="ruby-value str">&quot;&quot;</span>
 719:           <span class="ruby-identifier">procedure_params</span> = <span class="ruby-value str">&quot;&quot;</span>
 720:           <span class="ruby-identifier">procedure_prefix</span> = <span class="ruby-value str">&quot;&quot;</span>
 721:           <span class="ruby-identifier">procedure_result_arg</span> = <span class="ruby-value str">&quot;&quot;</span>
 722:           <span class="ruby-identifier">procedure_type</span> = <span class="ruby-value str">&quot;&quot;</span>
 723:           <span class="ruby-identifier">contains_lines</span> = []
 724:           <span class="ruby-identifier">contains_flag</span> = <span class="ruby-keyword kw">nil</span>
 725:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
 726:         <span class="ruby-keyword kw">end</span>
 727: 
 728:         <span class="ruby-comment cmt"># AnyMethod is created, and added to container</span>
 729:         <span class="ruby-comment cmt">#</span>
 730:         <span class="ruby-identifier">subroutine_function</span> = <span class="ruby-keyword kw">nil</span>
 731:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_searching_flag</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:subroutine</span>
 732:           <span class="ruby-identifier">subroutine_prefix</span>   = <span class="ruby-identifier">procedure_prefix</span>
 733:           <span class="ruby-identifier">subroutine_name</span>     = <span class="ruby-identifier">procedure_name</span>
 734:           <span class="ruby-identifier">subroutine_params</span>   = <span class="ruby-identifier">procedure_params</span>
 735:           <span class="ruby-identifier">subroutine_trailing</span> = <span class="ruby-identifier">procedure_trailing</span>
 736:           <span class="ruby-identifier">subroutine_code</span>     = <span class="ruby-identifier">procedure_code</span>
 737: 
 738:           <span class="ruby-identifier">subroutine_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">? </span>
 739:             <span class="ruby-identifier">pre_comment</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">subroutine_trailing</span> <span class="ruby-operator">:</span> 
 740:               <span class="ruby-identifier">subroutine_trailing</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">subroutine_code</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^.*$\n/i</span>, <span class="ruby-value str">''</span>)
 741:           <span class="ruby-identifier">subroutine</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;subroutine&quot;</span>, <span class="ruby-identifier">subroutine_name</span>)
 742:           <span class="ruby-identifier">parse_subprogram</span>(<span class="ruby-identifier">subroutine</span>, <span class="ruby-identifier">subroutine_params</span>,
 743:                            <span class="ruby-identifier">subroutine_comment</span>, <span class="ruby-identifier">subroutine_code</span>,
 744:                            <span class="ruby-identifier">before_contains_code</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">subroutine_prefix</span>)
 745:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;s&quot;</span>
 746:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 747:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">subroutine</span>
 748:           <span class="ruby-identifier">subroutine_function</span> = <span class="ruby-identifier">subroutine</span>
 749: 
 750:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_searching_flag</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:function</span>
 751:           <span class="ruby-identifier">function_prefix</span>     = <span class="ruby-identifier">procedure_prefix</span>
 752:           <span class="ruby-identifier">function_type</span>       = <span class="ruby-identifier">procedure_type</span>
 753:           <span class="ruby-identifier">function_name</span>       = <span class="ruby-identifier">procedure_name</span>
 754:           <span class="ruby-identifier">function_params_org</span> = <span class="ruby-identifier">procedure_params</span>
 755:           <span class="ruby-identifier">function_result_arg</span> = <span class="ruby-identifier">procedure_result_arg</span>
 756:           <span class="ruby-identifier">function_trailing</span>   = <span class="ruby-identifier">procedure_trailing</span>
 757:           <span class="ruby-identifier">function_code_org</span>   = <span class="ruby-identifier">procedure_code</span>
 758: 
 759:           <span class="ruby-identifier">function_comment</span> = <span class="ruby-constant">COMMENTS_ARE_UPPER</span> <span class="ruby-value">?
 760: </span>            <span class="ruby-identifier">pre_comment</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">function_trailing</span> <span class="ruby-operator">:</span>
 761:               <span class="ruby-identifier">function_trailing</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">function_code_org</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^.*$\n/i</span>, <span class="ruby-value str">''</span>)
 762: 
 763:           <span class="ruby-identifier">function_code</span> = <span class="ruby-node">&quot;#{function_code_org}&quot;</span>
 764:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">function_type</span>
 765:             <span class="ruby-identifier">function_code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">function_type</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; :: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">function_result_arg</span>
 766:           <span class="ruby-keyword kw">end</span>
 767: 
 768:           <span class="ruby-identifier">function_params</span> =
 769:             <span class="ruby-identifier">function_params_org</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\(/</span>, <span class="ruby-node">&quot;\(#{function_result_arg}, &quot;</span>)
 770: 
 771:           <span class="ruby-identifier">function</span> = <span class="ruby-constant">AnyMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;function&quot;</span>, <span class="ruby-identifier">function_name</span>)
 772:           <span class="ruby-identifier">parse_subprogram</span>(<span class="ruby-identifier">function</span>, <span class="ruby-identifier">function_params</span>,
 773:                            <span class="ruby-identifier">function_comment</span>, <span class="ruby-identifier">function_code</span>,
 774:                            <span class="ruby-identifier">before_contains_code</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">function_prefix</span>)
 775: 
 776:           <span class="ruby-comment cmt"># Specific modification due to function</span>
 777:           <span class="ruby-identifier">function</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-node">/\(\s*?#{function_result_arg}\s*?,\s*?/</span>, <span class="ruby-value str">&quot;\( &quot;</span>)
 778:           <span class="ruby-identifier">function</span>.<span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; result(&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">function_result_arg</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;)&quot;</span>
 779:           <span class="ruby-identifier">function</span>.<span class="ruby-identifier">start_collecting_tokens</span>
 780:           <span class="ruby-identifier">function</span>.<span class="ruby-identifier">add_token</span> <span class="ruby-constant">Token</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>,<span class="ruby-value">1</span>).<span class="ruby-identifier">set_text</span>(<span class="ruby-identifier">function_code_org</span>)
 781: 
 782:           <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;f&quot;</span>
 783:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 784:           <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">function</span>
 785:           <span class="ruby-identifier">subroutine_function</span> = <span class="ruby-identifier">function</span>
 786: 
 787:         <span class="ruby-keyword kw">end</span>
 788: 
 789:         <span class="ruby-comment cmt"># The visibility of procedure is specified</span>
 790:         <span class="ruby-comment cmt">#</span>
 791:         <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">procedure_name</span>, 
 792:                        <span class="ruby-identifier">visibility_default</span>, <span class="ruby-ivar">@@public_methods</span>)
 793: 
 794:         <span class="ruby-comment cmt"># The alias for this procedure from external modules</span>
 795:         <span class="ruby-comment cmt">#</span>
 796:         <span class="ruby-identifier">check_external_aliases</span>(<span class="ruby-identifier">procedure_name</span>,
 797:                                <span class="ruby-identifier">subroutine_function</span>.<span class="ruby-identifier">params</span>,
 798:                                <span class="ruby-identifier">subroutine_function</span>.<span class="ruby-identifier">comment</span>, <span class="ruby-identifier">subroutine_function</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">external</span>
 799:         <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">subroutine_function</span>, <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>)
 800: 
 801: 
 802:         <span class="ruby-comment cmt"># contains_lines are parsed as private procedures</span>
 803:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">contains_flag</span>
 804:           <span class="ruby-identifier">parse_program_or_module</span>(<span class="ruby-identifier">container</span>,
 805:                                   <span class="ruby-identifier">contains_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>), <span class="ruby-identifier">:private</span>)
 806:         <span class="ruby-keyword kw">end</span>
 807: 
 808:         <span class="ruby-comment cmt"># next loop to search next block</span>
 809:         <span class="ruby-identifier">level_depth</span> = <span class="ruby-value">0</span>
 810:         <span class="ruby-identifier">block_searching_flag</span> = <span class="ruby-keyword kw">nil</span>
 811:         <span class="ruby-identifier">block_searching_lines</span> = []
 812:         <span class="ruby-identifier">pre_comment</span> = []
 813:         <span class="ruby-identifier">procedure_trailing</span> = <span class="ruby-value str">&quot;&quot;</span>
 814:         <span class="ruby-identifier">procedure_name</span> = <span class="ruby-value str">&quot;&quot;</span>
 815:         <span class="ruby-identifier">procedure_params</span> = <span class="ruby-value str">&quot;&quot;</span>
 816:         <span class="ruby-identifier">procedure_prefix</span> = <span class="ruby-value str">&quot;&quot;</span>
 817:         <span class="ruby-identifier">procedure_result_arg</span> = <span class="ruby-value str">&quot;&quot;</span>
 818:         <span class="ruby-identifier">contains_lines</span> = []
 819:         <span class="ruby-identifier">contains_flag</span> = <span class="ruby-keyword kw">nil</span>
 820:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">false</span>
 821:       } <span class="ruby-comment cmt"># End of remaining_lines.collect!{|line|</span>
 822: 
 823:       <span class="ruby-comment cmt"># Array remains_lines is converted to String remains_code again</span>
 824:       <span class="ruby-comment cmt">#</span>
 825:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
 826: 
 827:       <span class="ruby-comment cmt">#</span>
 828:       <span class="ruby-comment cmt"># Parse interface</span>
 829:       <span class="ruby-comment cmt">#</span>
 830:       <span class="ruby-identifier">interface_scope</span> = <span class="ruby-keyword kw">false</span>
 831:       <span class="ruby-identifier">generic_name</span> = <span class="ruby-value str">&quot;&quot;</span>
 832:       <span class="ruby-identifier">interface_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
 833:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?
 834:                  interface(
 835:                             \s+\w+|
 836:                             \s+operator\s*?\(.*?\)|
 837:                             \s+assignment\s*?\(\s*?=\s*?\)
 838:                           )?
 839:                  \s*?(!.*?)?$
 840:            /i</span><span class="ruby-identifier">x</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
 841:           <span class="ruby-identifier">generic_name</span> = <span class="ruby-identifier">$1</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
 842:           <span class="ruby-identifier">interface_trailing</span> = <span class="ruby-identifier">$2</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 843:           <span class="ruby-identifier">interface_scope</span> = <span class="ruby-keyword kw">true</span>
 844:           <span class="ruby-identifier">interface_scope</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">interface_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/!:nodoc:/</span>
 845: <span class="ruby-comment cmt">#          if generic_name =~ /operator\s*?\((.*?)\)/i</span>
 846: <span class="ruby-comment cmt">#            operator_name = $1</span>
 847: <span class="ruby-comment cmt">#            if operator_name &amp;&amp; !operator_name.empty?</span>
 848: <span class="ruby-comment cmt">#              generic_name = &quot;#{operator_name}&quot;</span>
 849: <span class="ruby-comment cmt">#            end</span>
 850: <span class="ruby-comment cmt">#          end</span>
 851: <span class="ruby-comment cmt">#          if generic_name =~ /assignment\s*?\((.*?)\)/i</span>
 852: <span class="ruby-comment cmt">#            assignment_name = $1</span>
 853: <span class="ruby-comment cmt">#            if assignment_name &amp;&amp; !assignment_name.empty?</span>
 854: <span class="ruby-comment cmt">#              generic_name = &quot;#{assignment_name}&quot;</span>
 855: <span class="ruby-comment cmt">#            end</span>
 856: <span class="ruby-comment cmt">#          end</span>
 857:         <span class="ruby-keyword kw">end</span>
 858:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?end\s+interface/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
 859:           <span class="ruby-identifier">interface_scope</span> = <span class="ruby-keyword kw">false</span>
 860:           <span class="ruby-identifier">generic_name</span> = <span class="ruby-keyword kw">nil</span>
 861:         <span class="ruby-keyword kw">end</span>
 862:         <span class="ruby-comment cmt"># internal alias</span>
 863:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">interface_scope</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-regexp re">/^\s*?module\s+procedure\s+(.*?)(!.*?)?$/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
 864:           <span class="ruby-identifier">procedures</span> = <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span>
 865:           <span class="ruby-identifier">procedures_trailing</span> = <span class="ruby-identifier">$2</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 866:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procedures_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/!:nodoc:/</span>
 867:           <span class="ruby-identifier">procedures</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">proc</span><span class="ruby-operator">|</span>
 868:             <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">strip!</span>
 869:             <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">chomp!</span>
 870:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">generic_name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">proc</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">generic_name</span>
 871:             <span class="ruby-identifier">old_meth</span> = <span class="ruby-identifier">container</span>.<span class="ruby-identifier">find_symbol</span>(<span class="ruby-identifier">proc</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 872:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">old_meth</span>
 873:             <span class="ruby-identifier">nolink</span> = <span class="ruby-identifier">old_meth</span>.<span class="ruby-identifier">visibility</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:private</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
 874:             <span class="ruby-identifier">nolink</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">show_all</span>
 875:             <span class="ruby-identifier">new_meth</span> = 
 876:                <span class="ruby-identifier">initialize_external_method</span>(<span class="ruby-identifier">generic_name</span>, <span class="ruby-identifier">proc</span>, 
 877:                                           <span class="ruby-identifier">old_meth</span>.<span class="ruby-identifier">params</span>, <span class="ruby-keyword kw">nil</span>, 
 878:                                           <span class="ruby-identifier">old_meth</span>.<span class="ruby-identifier">comment</span>, 
 879:                                           <span class="ruby-identifier">old_meth</span>.<span class="ruby-identifier">clone</span>.<span class="ruby-identifier">token_stream</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">text</span>, 
 880:                                           <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">nolink</span>)
 881:             <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">singleton</span> = <span class="ruby-identifier">old_meth</span>.<span class="ruby-identifier">singleton</span>
 882: 
 883:             <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;i&quot;</span>
 884:             <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 885:             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">new_meth</span>
 886: 
 887:             <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">generic_name</span>, <span class="ruby-identifier">visibility_default</span>, <span class="ruby-ivar">@@public_methods</span>)
 888: 
 889:             <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">new_meth</span>, <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>)
 890: 
 891:           }
 892:         <span class="ruby-keyword kw">end</span>
 893: 
 894:         <span class="ruby-comment cmt"># external aliases</span>
 895:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">interface_scope</span>
 896:           <span class="ruby-comment cmt"># subroutine</span>
 897:           <span class="ruby-identifier">proc</span> = <span class="ruby-keyword kw">nil</span>
 898:           <span class="ruby-identifier">params</span> = <span class="ruby-keyword kw">nil</span>
 899:           <span class="ruby-identifier">procedures_trailing</span> = <span class="ruby-keyword kw">nil</span>
 900:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 901:                            (recursive|pure|elemental)?\s*?
 902:                            subroutine\s+(\w+)\s*?(\(.*?\))?\s*?(!.*?)?$
 903:                      /i</span><span class="ruby-identifier">x</span>
 904:             <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
 905:             <span class="ruby-identifier">generic_name</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">generic_name</span>
 906:             <span class="ruby-identifier">params</span> = <span class="ruby-identifier">$3</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 907:             <span class="ruby-identifier">procedures_trailing</span> = <span class="ruby-identifier">$4</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 908: 
 909:           <span class="ruby-comment cmt"># function</span>
 910:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*?
 911:                          (recursive|pure|elemental)?\s*?
 912:                          (
 913:                              character\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 914:                            | type\s*?\([\w\s]+?\)\s+
 915:                            | integer\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 916:                            | real\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 917:                            | double\s+precision\s+
 918:                            | logical\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 919:                            | complex\s*?(\([\w\s\=\(\)\*]+?\))?\s+
 920:                          )?
 921:                          function\s+(\w+)\s*?
 922:                          (\(.*?\))?(\s+result\((.*?)\))?\s*?(!.*?)?$
 923:                         /i</span><span class="ruby-identifier">x</span>
 924:             <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">$8</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
 925:             <span class="ruby-identifier">generic_name</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">generic_name</span>
 926:             <span class="ruby-identifier">params</span> = <span class="ruby-identifier">$9</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 927:             <span class="ruby-identifier">procedures_trailing</span> = <span class="ruby-identifier">$12</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;!&quot;</span>
 928:           <span class="ruby-keyword kw">else</span>
 929:             <span class="ruby-keyword kw">next</span>
 930:           <span class="ruby-keyword kw">end</span>
 931:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procedures_trailing</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/!:nodoc:/</span>
 932:           <span class="ruby-identifier">indicated_method</span> = <span class="ruby-keyword kw">nil</span>
 933:           <span class="ruby-identifier">indicated_file</span>   = <span class="ruby-keyword kw">nil</span>
 934:           <span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">all_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">toplevel</span><span class="ruby-operator">|</span>
 935:             <span class="ruby-identifier">indicated_method</span> = <span class="ruby-identifier">toplevel</span>.<span class="ruby-identifier">find_local_symbol</span>(<span class="ruby-identifier">proc</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 936:             <span class="ruby-identifier">indicated_file</span> = <span class="ruby-identifier">name</span>
 937:             <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">indicated_method</span>
 938:           <span class="ruby-keyword kw">end</span>
 939: 
 940:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">indicated_method</span>
 941:             <span class="ruby-identifier">external_method</span> = 
 942:               <span class="ruby-identifier">initialize_external_method</span>(<span class="ruby-identifier">generic_name</span>, <span class="ruby-identifier">proc</span>, 
 943:                                          <span class="ruby-identifier">indicated_method</span>.<span class="ruby-identifier">params</span>, 
 944:                                          <span class="ruby-identifier">indicated_file</span>, 
 945:                                          <span class="ruby-identifier">indicated_method</span>.<span class="ruby-identifier">comment</span>)
 946: 
 947:             <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;e&quot;</span>
 948:             <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 949:             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">external_method</span>
 950:             <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">generic_name</span>, <span class="ruby-identifier">visibility_default</span>, <span class="ruby-ivar">@@public_methods</span>)
 951:             <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">container</span>.<span class="ruby-identifier">include_requires?</span>(<span class="ruby-identifier">indicated_file</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>)
 952:               <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_require</span>(<span class="ruby-constant">Require</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">indicated_file</span>, <span class="ruby-value str">&quot;&quot;</span>))
 953:             <span class="ruby-keyword kw">end</span>
 954:             <span class="ruby-identifier">check_public_methods</span>(<span class="ruby-identifier">external_method</span>, <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>)
 955: 
 956:           <span class="ruby-keyword kw">else</span>
 957:             <span class="ruby-ivar">@@external_aliases</span> <span class="ruby-operator">&lt;&lt;</span> {
 958:               <span class="ruby-value str">&quot;new_name&quot;</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">generic_name</span>,
 959:               <span class="ruby-value str">&quot;old_name&quot;</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">proc</span>,
 960:               <span class="ruby-value str">&quot;file_or_module&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">container</span>,
 961:               <span class="ruby-value str">&quot;visibility&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">find_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">generic_name</span>, <span class="ruby-ivar">@@public_methods</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">visibility_default</span>
 962:             }
 963:           <span class="ruby-keyword kw">end</span>
 964:         <span class="ruby-keyword kw">end</span>
 965: 
 966:       } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">interface_code</span> <span class="ruby-comment cmt"># End of interface_code.split(&quot;\n&quot;).each ...</span>
 967: 
 968:       <span class="ruby-comment cmt">#</span>
 969:       <span class="ruby-comment cmt"># Already imported methods are removed from @@public_methods.</span>
 970:       <span class="ruby-comment cmt"># Remainders are assumed to be imported from other modules.</span>
 971:       <span class="ruby-comment cmt">#</span>
 972:       <span class="ruby-ivar">@@public_methods</span>.<span class="ruby-identifier">delete_if</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span> <span class="ruby-identifier">method</span>[<span class="ruby-value str">&quot;entity_is_discovered&quot;</span>]}
 973: 
 974:       <span class="ruby-ivar">@@public_methods</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">pub_meth</span><span class="ruby-operator">|</span>
 975:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>
 976:         <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;used_modules&quot;</span>].<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">used_mod</span><span class="ruby-operator">|</span>
 977:           <span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">all_classes_and_modules</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">modules</span><span class="ruby-operator">|</span>
 978:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">used_mod</span> <span class="ruby-operator">||</span>
 979:                 <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">used_mod</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
 980:                 <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
 981:               <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">method_list</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
 982:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">||</span>
 983:                     <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">&amp;&amp;</span>
 984:                     <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span>
 985:                   <span class="ruby-identifier">new_meth</span> = <span class="ruby-identifier">initialize_public_method</span>(<span class="ruby-identifier">meth</span>,
 986:                                                       <span class="ruby-identifier">modules</span>.<span class="ruby-identifier">name</span>)
 987:                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;local_name&quot;</span>]
 988:                     <span class="ruby-identifier">new_meth</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">pub_meth</span>[<span class="ruby-value str">&quot;local_name&quot;</span>]
 989:                   <span class="ruby-keyword kw">end</span>
 990:                   <span class="ruby-identifier">progress</span> <span class="ruby-value str">&quot;e&quot;</span>
 991:                   <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">num_methods</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 992:                   <span class="ruby-identifier">container</span>.<span class="ruby-identifier">add_method</span> <span class="ruby-identifier">new_meth</span>
 993:                 <span class="ruby-keyword kw">end</span>
 994:               }
 995:             <span class="ruby-keyword kw">end</span>
 996:           }
 997:         }
 998:       }
 999: 
1000:       <span class="ruby-identifier">container</span>
1001:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003877">
                    
                    <a name="M003877"></a><b>parse_subprogram</b>(subprogram, params, comment, code, before_contains=nil, function=nil, prefix=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Parse arguments, comment, code of subroutine and function. Return <a
href="AnyMethod.html">AnyMethod</a> object.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003877_source')" id="l_M003877_source">show</a>
                        
                    </p>
                    <div id="M003877_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1007</span>
1007:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_subprogram</span>(<span class="ruby-identifier">subprogram</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">code</span>, 
1008:                          <span class="ruby-identifier">before_contains</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">function</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">prefix</span>=<span class="ruby-keyword kw">nil</span>)
1009:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">singleton</span> = <span class="ruby-keyword kw">false</span>
1010:       <span class="ruby-identifier">prefix</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">prefix</span>
1011:       <span class="ruby-identifier">arguments</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\(/</span>, <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\)/</span>, <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>
1012:       <span class="ruby-identifier">args_comment</span>, <span class="ruby-identifier">params_opt</span> = 
1013:         <span class="ruby-identifier">find_arguments</span>(<span class="ruby-identifier">arguments</span>, <span class="ruby-identifier">code</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^s*?contains\s*?(!.*?)?$.*/i</span><span class="ruby-identifier">m</span>, <span class="ruby-value str">&quot;&quot;</span>),
1014:                        <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">true</span>)
1015:       <span class="ruby-identifier">params_opt</span> = <span class="ruby-value str">&quot;( &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params_opt</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; ) &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params_opt</span>
1016:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">params_opt</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
1017:       <span class="ruby-identifier">namelist_comment</span> = <span class="ruby-identifier">find_namelists</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">before_contains</span>)
1018: 
1019:       <span class="ruby-identifier">block_comment</span> = <span class="ruby-identifier">find_comments</span> <span class="ruby-identifier">comment</span>
1020:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">function</span>
1021:         <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-node">&quot;&lt;b&gt;&lt;em&gt; Function &lt;/em&gt;&lt;/b&gt; :: &lt;em&gt;#{prefix}&lt;/em&gt;\n&quot;</span>
1022:       <span class="ruby-keyword kw">else</span>
1023:         <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-node">&quot;&lt;b&gt;&lt;em&gt; Subroutine &lt;/em&gt;&lt;/b&gt; :: &lt;em&gt;#{prefix}&lt;/em&gt;\n&quot;</span>
1024:       <span class="ruby-keyword kw">end</span>
1025:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">args_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args_comment</span>
1026:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_comment</span>
1027:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">comment</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">namelist_comment</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">namelist_comment</span>
1028: 
1029:       <span class="ruby-comment cmt"># For output source code</span>
1030:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">start_collecting_tokens</span>
1031:       <span class="ruby-identifier">subprogram</span>.<span class="ruby-identifier">add_token</span> <span class="ruby-constant">Token</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>,<span class="ruby-value">1</span>).<span class="ruby-identifier">set_text</span>(<span class="ruby-identifier">code</span>)
1032: 
1033:       <span class="ruby-identifier">subprogram</span>
1034:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003886">
                    
                    <a name="M003886"></a><b>parse_visibility</b>(code, default, container)
                    
                </div>
                
                <div class="description">
                  <p>
Parse visibility
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003886_source')" id="l_M003886_source">show</a>
                        
                    </p>
                    <div id="M003886_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1229</span>
1229:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_visibility</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">default</span>, <span class="ruby-identifier">container</span>)
1230:       <span class="ruby-identifier">result</span> = []
1231:       <span class="ruby-identifier">visibility_default</span> = <span class="ruby-identifier">default</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">:public</span>
1232: 
1233:       <span class="ruby-identifier">used_modules</span> = []
1234:       <span class="ruby-identifier">container</span>.<span class="ruby-identifier">includes</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">used_modules</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">name</span>} <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">container</span>
1235: 
1236:       <span class="ruby-identifier">remaining_code</span> = <span class="ruby-identifier">code</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^\s*?type[\s\,]+.*?\s+end\s+type.*?$/i</span><span class="ruby-identifier">m</span>, <span class="ruby-value str">&quot;&quot;</span>)
1237:       <span class="ruby-identifier">remaining_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1238:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?private\s*?$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1239:           <span class="ruby-identifier">visibility_default</span> = <span class="ruby-identifier">:private</span>
1240:           <span class="ruby-keyword kw">break</span>
1241:         <span class="ruby-keyword kw">end</span>
1242:       } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remaining_code</span>
1243: 
1244:       <span class="ruby-identifier">remaining_code</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1245:         <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^\s*?private\s*?(::)?\s+(.*)\s*?(!.*?)?/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1246:           <span class="ruby-identifier">methods</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/!.*$/</span>, <span class="ruby-value str">''</span>)
1247:           <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
1248:             <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/!.*$/</span>, <span class="ruby-value str">''</span>)
1249:             <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/:/</span>, <span class="ruby-value str">''</span>)
1250:             <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> {
1251:               <span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>,
1252:               <span class="ruby-value str">&quot;visibility&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:private</span>,
1253:               <span class="ruby-value str">&quot;used_modules&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">used_modules</span>.<span class="ruby-identifier">clone</span>,
1254:               <span class="ruby-value str">&quot;file_or_module&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">container</span>,
1255:               <span class="ruby-value str">&quot;entity_is_discovered&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
1256:               <span class="ruby-value str">&quot;local_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>
1257:             }
1258:           }
1259:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^\s*?public\s*?(::)?\s+(.*)\s*?(!.*?)?/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1260:           <span class="ruby-identifier">methods</span> = <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/!.*$/</span>, <span class="ruby-value str">''</span>)
1261:           <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
1262:             <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/!.*$/</span>, <span class="ruby-value str">''</span>)
1263:             <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/:/</span>, <span class="ruby-value str">''</span>)
1264:             <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> {
1265:               <span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>,
1266:               <span class="ruby-value str">&quot;visibility&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:public</span>,
1267:               <span class="ruby-value str">&quot;used_modules&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">used_modules</span>.<span class="ruby-identifier">clone</span>,
1268:               <span class="ruby-value str">&quot;file_or_module&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">container</span>,
1269:               <span class="ruby-value str">&quot;entity_is_discovered&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
1270:               <span class="ruby-value str">&quot;local_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>
1271:             }
1272:           }
1273:         <span class="ruby-keyword kw">end</span>
1274:       } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remaining_code</span>
1275: 
1276:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">container</span>
1277:         <span class="ruby-identifier">result</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">vis_info</span><span class="ruby-operator">|</span>
1278:           <span class="ruby-identifier">vis_info</span>[<span class="ruby-value str">&quot;parent&quot;</span>] = <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>
1279:         }
1280:       <span class="ruby-keyword kw">end</span>
1281: 
1282:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">visibility_default</span>, <span class="ruby-identifier">result</span>
1283:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003883">
                    
                    <a name="M003883"></a><b>progress</b>(char)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003883_source')" id="l_M003883_source">show</a>
                        
                    </p>
                    <div id="M003883_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1169</span>
1169:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">progress</span>(<span class="ruby-identifier">char</span>)
1170:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
1171:         <span class="ruby-ivar">@progress</span>.<span class="ruby-identifier">print</span>(<span class="ruby-identifier">char</span>)
1172:         <span class="ruby-ivar">@progress</span>.<span class="ruby-identifier">flush</span>
1173:       <span class="ruby-keyword kw">end</span>
1174:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003907">
                    
                    <a name="M003907"></a><b>remove_empty_head_lines</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Empty lines in header are removed
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003907_source')" id="l_M003907_source">show</a>
                        
                    </p>
                    <div id="M003907_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1621</span>
1621:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_empty_head_lines</span>(<span class="ruby-identifier">text</span>)
1622:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">text</span>
1623:       <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1624:       <span class="ruby-identifier">header</span> = <span class="ruby-keyword kw">true</span>
1625:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">delete_if</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1626:         <span class="ruby-identifier">header</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\S/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1627:         <span class="ruby-identifier">header</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-regexp re">/^\s*?$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1628:       }
1629:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1630:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003908">
                    
                    <a name="M003908"></a><b>remove_header_marker</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
header marker &#8220;=&#8221;, &#8220;==&#8221;, &#8230; are removed
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003908_source')" id="l_M003908_source">show</a>
                        
                    </p>
                    <div id="M003908_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1634</span>
1634:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_header_marker</span>(<span class="ruby-identifier">text</span>)
1635:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^\s?(=+)/</span>, <span class="ruby-value str">'&lt;tt&gt;&lt;/tt&gt;\1'</span>)
1636:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003909">
                    
                    <a name="M003909"></a><b>remove_private_comments</b>(body)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003909_source')" id="l_M003909_source">show</a>
                        
                    </p>
                    <div id="M003909_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1638</span>
1638:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_private_comments</span>(<span class="ruby-identifier">body</span>)
1639:       <span class="ruby-identifier">body</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^\s*!--\s*?$.*?^\s*!\+\+\s*?$/</span><span class="ruby-identifier">m</span>, <span class="ruby-value str">''</span>)
1640:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">body</span>
1641:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003905">
                    
                    <a name="M003905"></a><b>remove_trailing_alias</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Remove &#8220;<a href="Alias.html">Alias</a> for&#8221; in end of comments
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003905_source')" id="l_M003905_source">show</a>
                        
                    </p>
                    <div id="M003905_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1600</span>
1600:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_trailing_alias</span>(<span class="ruby-identifier">text</span>)
1601:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">text</span>
1602:       <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">reverse</span>
1603:       <span class="ruby-identifier">comment_block</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
1604:       <span class="ruby-identifier">checked</span> = <span class="ruby-keyword kw">false</span>
1605:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1606:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">checked</span> 
1607:           <span class="ruby-keyword kw">if</span> <span class="ruby-node">/^\s?#{INTERNAL_ALIAS_MES}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">||</span>
1608:               <span class="ruby-node">/^\s?#{EXTERNAL_ALIAS_MES}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
1609:             <span class="ruby-identifier">checked</span> = <span class="ruby-keyword kw">true</span>
1610:             <span class="ruby-keyword kw">next</span>
1611:           <span class="ruby-keyword kw">end</span>
1612:         <span class="ruby-keyword kw">end</span>
1613:         <span class="ruby-identifier">comment_block</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">line</span>
1614:       <span class="ruby-keyword kw">end</span>
1615:       <span class="ruby-identifier">nice_lines</span> = <span class="ruby-identifier">comment_block</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1616:       <span class="ruby-identifier">nice_lines</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">&quot;&quot;</span>
1617:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">nice_lines</span>
1618:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003899">
                    
                    <a name="M003899"></a><b>semicolon_to_linefeed</b>(text)
                    
                </div>
                
                <div class="description">
                  <p>
Semicolons are replaced to line feed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003899_source')" id="l_M003899_source">show</a>
                        
                    </p>
                    <div id="M003899_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1507</span>
1507:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">semicolon_to_linefeed</span>(<span class="ruby-identifier">text</span>)
1508:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">text</span>
1509:       <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1510:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">collect!</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1511:         <span class="ruby-identifier">words</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&quot;</span>)
1512:         <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">false</span>
1513:         <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span>
1514:         <span class="ruby-identifier">words</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
1515:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">squote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">dquote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">commentout</span>)
1516:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1517:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span> ; <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">true</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1518:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">true</span>     ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1519:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">true</span>     ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1520:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;;&quot;</span> ;                     <span class="ruby-value str">&quot;\n&quot;</span>
1521:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1522:             <span class="ruby-keyword kw">end</span>
1523:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">commentout</span>
1524:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1525:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">squote</span>
1526:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1527:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1528:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1529:             <span class="ruby-keyword kw">end</span>
1530:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dquote</span>
1531:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1532:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1533:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1534:             <span class="ruby-keyword kw">end</span>
1535:           <span class="ruby-keyword kw">end</span>
1536:         }
1537:         <span class="ruby-identifier">words</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&quot;</span>)
1538:       }
1539:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1540:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003887">
                    
                    <a name="M003887"></a><b>set_visibility</b>(container, subname, visibility_default, visibility_info)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> visibility
</p>
<p>
&#8220;subname&#8221; element of &#8220;visibility_info&#8220; is deleted.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003887_source')" id="l_M003887_source">show</a>
                        
                    </p>
                    <div id="M003887_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1290</span>
1290:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_visibility</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">subname</span>, <span class="ruby-identifier">visibility_default</span>, <span class="ruby-identifier">visibility_info</span>)
1291:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">container</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">subname</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">visibility_default</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">visibility_info</span>
1292:       <span class="ruby-identifier">not_found</span> = <span class="ruby-keyword kw">true</span>
1293:       <span class="ruby-identifier">visibility_info</span>.<span class="ruby-identifier">collect!</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
1294:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">subname</span> <span class="ruby-operator">||</span>
1295:             <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">ignore_case</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;name&quot;</span>].<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">subname</span>.<span class="ruby-identifier">upcase</span>
1296:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;file_or_module&quot;</span>].<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">name</span>
1297:             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">subname</span>], <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;visibility&quot;</span>])
1298:             <span class="ruby-identifier">info</span>[<span class="ruby-value str">&quot;entity_is_discovered&quot;</span>] = <span class="ruby-keyword kw">true</span>
1299:             <span class="ruby-identifier">not_found</span> = <span class="ruby-keyword kw">false</span>
1300:           <span class="ruby-keyword kw">end</span>
1301:         <span class="ruby-keyword kw">end</span>
1302:         <span class="ruby-identifier">info</span>
1303:       }
1304:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">not_found</span>
1305:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">set_visibility_for</span>([<span class="ruby-identifier">subname</span>], <span class="ruby-identifier">visibility_default</span>)
1306:       <span class="ruby-keyword kw">else</span>
1307:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">container</span>
1308:       <span class="ruby-keyword kw">end</span>
1309:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003893">
                    
                    <a name="M003893"></a><b>united_to_one_line</b>(f90src)
                    
                </div>
                
                <div class="description">
                  <p>
Continuous lines are united.
</p>
<p>
Comments in continuous lines are removed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003893_source')" id="l_M003893_source">show</a>
                        
                    </p>
                    <div id="M003893_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 1389</span>
1389:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">united_to_one_line</span>(<span class="ruby-identifier">f90src</span>)
1390:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">f90src</span>
1391:       <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">f90src</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
1392:       <span class="ruby-identifier">previous_continuing</span> = <span class="ruby-keyword kw">false</span>
1393:       <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">false</span>
1394:       <span class="ruby-identifier">body</span> = <span class="ruby-value str">&quot;&quot;</span>
1395:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
1396:         <span class="ruby-identifier">words</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&quot;</span>)
1397:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">words</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">previous_continuing</span>
1398:         <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">false</span>
1399:         <span class="ruby-identifier">brank_flag</span> = <span class="ruby-keyword kw">true</span> ; <span class="ruby-identifier">brank_char</span> = <span class="ruby-value str">&quot;&quot;</span>
1400:         <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span>    ; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span>
1401:         <span class="ruby-identifier">ignore</span> = <span class="ruby-keyword kw">false</span>
1402:         <span class="ruby-identifier">words</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
1403:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">previous_continuing</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">brank_flag</span>
1404:             <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">true</span>
1405:             <span class="ruby-identifier">ignore</span>         = <span class="ruby-keyword kw">true</span>
1406:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1407:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span>                       ; <span class="ruby-keyword kw">break</span>
1408:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot; &quot;</span> ; <span class="ruby-identifier">brank_char</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">char</span>  ; <span class="ruby-keyword kw">next</span> <span class="ruby-value str">&quot;&quot;</span>
1409:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;&amp;&quot;</span>
1410:               <span class="ruby-identifier">brank_flag</span> = <span class="ruby-keyword kw">false</span>
1411:               <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">false</span>
1412:               <span class="ruby-keyword kw">next</span> <span class="ruby-value str">&quot;&quot;</span>
1413:             <span class="ruby-keyword kw">else</span> 
1414:               <span class="ruby-identifier">brank_flag</span>     = <span class="ruby-keyword kw">false</span>
1415:               <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">false</span>
1416:               <span class="ruby-identifier">ignore</span>         = <span class="ruby-keyword kw">false</span>
1417:               <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">brank_char</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">char</span>
1418:             <span class="ruby-keyword kw">end</span>
1419:           <span class="ruby-keyword kw">end</span>
1420:           <span class="ruby-identifier">ignore</span> = <span class="ruby-keyword kw">false</span>
1421: 
1422:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">now_continuing</span>
1423:             <span class="ruby-keyword kw">next</span> <span class="ruby-value str">&quot;&quot;</span>
1424:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">squote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">dquote</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">commentout</span>)
1425:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1426:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;!&quot;</span> ; <span class="ruby-identifier">commentout</span> = <span class="ruby-keyword kw">true</span>     ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1427:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">true</span>         ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1428:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">true</span>         ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1429:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;&amp;&quot;</span> ; <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">true</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-value str">&quot;&quot;</span>
1430:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1431:             <span class="ruby-keyword kw">end</span>
1432:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">commentout</span>
1433:             <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1434:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">squote</span>
1435:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1436:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\'&quot;</span>; <span class="ruby-identifier">squote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1437:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1438:             <span class="ruby-keyword kw">end</span>
1439:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dquote</span>
1440:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">char</span>
1441:             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\&quot;&quot;</span>; <span class="ruby-identifier">dquote</span> = <span class="ruby-keyword kw">false</span> ; <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1442:             <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">char</span>
1443:             <span class="ruby-keyword kw">end</span>
1444:           <span class="ruby-keyword kw">end</span>
1445:         }
1446:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">ignore</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">previous_continuing</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">brank_flag</span>
1447:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">previous_continuing</span>
1448:             <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">words</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&quot;</span>)
1449:           <span class="ruby-keyword kw">else</span>
1450:             <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">words</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&quot;</span>)
1451:           <span class="ruby-keyword kw">end</span>
1452:         <span class="ruby-keyword kw">end</span>
1453:         <span class="ruby-identifier">previous_continuing</span> = <span class="ruby-identifier">now_continuing</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1454:         <span class="ruby-identifier">now_continuing</span> = <span class="ruby-keyword kw">nil</span>
1455:       }
1456:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">body</span>
1457:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M003841">
                    
                    <a name="M003841"></a><b>new</b>(top_level, file_name, body, options, stats)
                    
                </div>
                
                <div class="description">
                  <p>
prepare to parse a Fortran 95 file
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003841_source')" id="l_M003841_source">show</a>
                        
                    </p>
                    <div id="M003841_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parsers/parse_f95.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">body</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">stats</span>)
196:       <span class="ruby-ivar">@body</span> = <span class="ruby-identifier">body</span>
197:       <span class="ruby-ivar">@stats</span> = <span class="ruby-identifier">stats</span>
198:       <span class="ruby-ivar">@file_name</span>  = <span class="ruby-identifier">file_name</span>
199:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
200:       <span class="ruby-ivar">@top_level</span> = <span class="ruby-identifier">top_level</span>
201:       <span class="ruby-ivar">@progress</span> = <span class="ruby-identifier">$stderr</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">quiet</span>
202:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    