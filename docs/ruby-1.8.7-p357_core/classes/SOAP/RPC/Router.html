<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>SOAP::RPC::Router</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            SOAP::RPC::Router 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/soap/rpc/router_rb.html">lib/soap/rpc/router.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M006629">add_document_method</a>,</li>
                
                <li><a href="#M006627">add_document_operation</a>,</li>
                
                <li><a href="#M006630">add_document_request_operation</a>,</li>
                
                <li><a href="#M006614">add_headerhandler</a>,</li>
                
                <li><a href="#M006624">add_method</a>,</li>
                
                <li><a href="#M006610">add_request_headerhandler</a>,</li>
                
                <li><a href="#M006625">add_rpc_method</a>,</li>
                
                <li><a href="#M006623">add_rpc_operation</a>,</li>
                
                <li><a href="#M006626">add_rpc_request_operation</a>,</li>
                
                <li><a href="#M006615">add_rpc_request_servant</a>,</li>
                
                <li><a href="#M006616">add_rpc_servant</a>,</li>
                
                <li><a href="#M006622">add_servant</a>,</li>
                
                <li><a href="#M006644">assign_operation</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M006647">call_headers</a>,</li>
                
                <li><a href="#M006637">create_fault_response</a>,</li>
                
                <li><a href="#M006658">create_mapping_opt</a>,</li>
                
                <li><a href="#M006640">create_styleuse_option</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M006641">ensure_styleuse_option</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M006657">fault</a>,</li>
                
                <li><a href="#M006639">first_input_part_qname</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M006645">lookup_operation</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M006652">marshal</a>,</li>
                
                <li><a href="#M006655">mimeize</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M006609">new</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M006649">receive_headers</a>,</li>
                
                <li><a href="#M006632">route</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M006650">unmarshal</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../../RSS/Utils.html">RSS::Utils</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="Router/ApplicationScopeOperation.html">SOAP::RPC::Router::ApplicationScopeOperation</a></li>
        
        <li><span class="type">CLASS</span> <a href="Router/Operation.html">SOAP::RPC::Router::Operation</a></li>
        
        <li><span class="type">CLASS</span> <a href="Router/RequestScopeOperation.html">SOAP::RPC::Router::RequestScopeOperation</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>actor</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>mapping_registry</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>literal_mapping_registry</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>generate_explicit_type</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>external_ces</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M006629">
                    
                    <a name="M006629"></a><b>add_document_method</b>(receiver, soapaction, name, param_def, opt = {})
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Router.html#M006627">add_document_operation</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M006627">
                    
                    <a name="M006627"></a><b>add_document_operation</b>(receiver, soapaction, name, param_def, opt = {})
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Router.html#M006629">add_document_method</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006627_source')" id="l_M006627_source">show</a>
                        
                    </p>
                    <div id="M006627_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 119</span>
119:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_document_operation</span>(<span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
120:     <span class="ruby-comment cmt">#</span>
121:     <span class="ruby-comment cmt"># adopt workaround for doc/lit wrapper method</span>
122:     <span class="ruby-comment cmt"># (you should consider to simply use rpc/lit service)</span>
123:     <span class="ruby-comment cmt">#</span>
124:     <span class="ruby-comment cmt">#unless soapaction</span>
125:     <span class="ruby-comment cmt">#  raise RPCRoutingError.new(&quot;soapaction is a must for document method&quot;)</span>
126:     <span class="ruby-comment cmt">#end</span>
127:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:document</span>, <span class="ruby-identifier">:literal</span>)
128:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">ApplicationScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>,
129:       <span class="ruby-identifier">opt</span>)
130:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:document</span>
131:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
132:     <span class="ruby-keyword kw">end</span>
133:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">first_input_part_qname</span>(<span class="ruby-identifier">param_def</span>), <span class="ruby-identifier">op</span>)
134:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006630">
                    
                    <a name="M006630"></a><b>add_document_request_operation</b>(factory, soapaction, name, param_def, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006630_source')" id="l_M006630_source">show</a>
                        
                    </p>
                    <div id="M006630_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_document_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
138:     <span class="ruby-comment cmt">#</span>
139:     <span class="ruby-comment cmt"># adopt workaround for doc/lit wrapper method</span>
140:     <span class="ruby-comment cmt"># (you should consider to simply use rpc/lit service)</span>
141:     <span class="ruby-comment cmt">#</span>
142:     <span class="ruby-comment cmt">#unless soapaction</span>
143:     <span class="ruby-comment cmt">#  raise RPCRoutingError.new(&quot;soapaction is a must for document method&quot;)</span>
144:     <span class="ruby-comment cmt">#end</span>
145:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:document</span>, <span class="ruby-identifier">:literal</span>)
146:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">RequestScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
147:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:document</span>
148:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
149:     <span class="ruby-keyword kw">end</span>
150:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">first_input_part_qname</span>(<span class="ruby-identifier">param_def</span>), <span class="ruby-identifier">op</span>)
151:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006614">
                    
                    <a name="M006614"></a><b>add_headerhandler</b>(handler)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006614_source')" id="l_M006614_source">show</a>
                        
                    </p>
                    <div id="M006614_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_headerhandler</span>(<span class="ruby-identifier">handler</span>)
56:     <span class="ruby-ivar">@headerhandler</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">handler</span>)
57:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006624">
                    
                    <a name="M006624"></a><b>add_method</b>(receiver, qname, soapaction, name, param_def, opt = {})
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Router.html#M006623">add_rpc_operation</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M006610">
                    
                    <a name="M006610"></a><b>add_request_headerhandler</b>(factory)
                    
                </div>
                
                <div class="description">
                  <p>
header handler interface
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006610_source')" id="l_M006610_source">show</a>
                        
                    </p>
                    <div id="M006610_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_request_headerhandler</span>(<span class="ruby-identifier">factory</span>)
49:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:create</span>)
50:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;factory must respond to 'create'&quot;</span>)
51:     <span class="ruby-keyword kw">end</span>
52:     <span class="ruby-ivar">@headerhandlerfactory</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">factory</span>
53:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006625">
                    
                    <a name="M006625"></a><b>add_rpc_method</b>(receiver, qname, soapaction, name, param_def, opt = {})
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Router.html#M006623">add_rpc_operation</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M006623">
                    
                    <a name="M006623"></a><b>add_rpc_operation</b>(receiver, qname, soapaction, name, param_def, opt = {})
                    
                </div>
                
                <div class="description">
                  <p>
operation definition interface
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Router.html#M006624">add_method</a>
                    
                    <a href="Router.html#M006625">add_rpc_method</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006623_source')" id="l_M006623_source">show</a>
                        
                    </p>
                    <div id="M006623_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 96</span>
 96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_operation</span>(<span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
 97:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
 98:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_qname</span>] = <span class="ruby-identifier">qname</span>
 99:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">ApplicationScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>,
100:       <span class="ruby-identifier">opt</span>)
101:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:rpc</span>
102:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
103:     <span class="ruby-keyword kw">end</span>
104:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">op</span>)
105:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006626">
                    
                    <a name="M006626"></a><b>add_rpc_request_operation</b>(factory, qname, soapaction, name, param_def, opt = {})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006626_source')" id="l_M006626_source">show</a>
                        
                    </p>
                    <div id="M006626_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
110:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
111:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_qname</span>] = <span class="ruby-identifier">qname</span>
112:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">RequestScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">factory</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
113:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:rpc</span>
114:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
115:     <span class="ruby-keyword kw">end</span>
116:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">op</span>)
117:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006615">
                    
                    <a name="M006615"></a><b>add_rpc_request_servant</b>(factory, namespace)
                    
                </div>
                
                <div class="description">
                  <p>
servant definition interface
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006615_source')" id="l_M006615_source">show</a>
                        
                    </p>
                    <div id="M006615_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_request_servant</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">namespace</span>)
63:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:create</span>)
64:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;factory must respond to 'create'&quot;</span>)
65:     <span class="ruby-keyword kw">end</span>
66:     <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">create</span>        <span class="ruby-comment cmt"># a dummy instance for introspection</span>
67:     <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span>.<span class="ruby-identifier">defined_methods</span>(<span class="ruby-identifier">obj</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
68:       <span class="ruby-keyword kw">begin</span>
69:         <span class="ruby-identifier">qname</span> = <span class="ruby-constant">XSD</span><span class="ruby-operator">::</span><span class="ruby-constant">QName</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">namespace</span>, <span class="ruby-identifier">name</span>)
70:         <span class="ruby-identifier">param_def</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPMethod</span>.<span class="ruby-identifier">derive_rpc_param_def</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">name</span>)
71:         <span class="ruby-identifier">opt</span> = <span class="ruby-identifier">create_styleuse_option</span>(<span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
72:         <span class="ruby-identifier">add_rpc_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
73:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">MethodDefinitionError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
74:         <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
75:       <span class="ruby-keyword kw">end</span>
76:     <span class="ruby-keyword kw">end</span>
77:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006616">
                    
                    <a name="M006616"></a><b>add_rpc_servant</b>(obj, namespace)
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Router.html#M006622">add_servant</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006616_source')" id="l_M006616_source">show</a>
                        
                    </p>
                    <div id="M006616_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_servant</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">namespace</span>)
80:     <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span>.<span class="ruby-identifier">defined_methods</span>(<span class="ruby-identifier">obj</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
81:       <span class="ruby-keyword kw">begin</span>
82:         <span class="ruby-identifier">qname</span> = <span class="ruby-constant">XSD</span><span class="ruby-operator">::</span><span class="ruby-constant">QName</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">namespace</span>, <span class="ruby-identifier">name</span>)
83:         <span class="ruby-identifier">param_def</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPMethod</span>.<span class="ruby-identifier">derive_rpc_param_def</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">name</span>)
84:         <span class="ruby-identifier">opt</span> = <span class="ruby-identifier">create_styleuse_option</span>(<span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
85:         <span class="ruby-identifier">add_rpc_operation</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
86:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">MethodDefinitionError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
87:         <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
88:       <span class="ruby-keyword kw">end</span>
89:     <span class="ruby-keyword kw">end</span>
90:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006622">
                    
                    <a name="M006622"></a><b>add_servant</b>(obj, namespace)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Router.html#M006616">add_rpc_servant</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M006637">
                    
                    <a name="M006637"></a><b>create_fault_response</b>(e)
                    
                </div>
                
                <div class="description">
                  <p>
Create fault response string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006637_source')" id="l_M006637_source">show</a>
                        
                    </p>
                    <div id="M006637_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_fault_response</span>(<span class="ruby-identifier">e</span>)
184:     <span class="ruby-identifier">env</span> = <span class="ruby-constant">SOAPEnvelope</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">SOAPHeader</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">SOAPBody</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fault</span>(<span class="ruby-identifier">e</span>)))
185:     <span class="ruby-identifier">opt</span> = {}
186:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>] = <span class="ruby-keyword kw">nil</span>
187:     <span class="ruby-identifier">response_string</span> = <span class="ruby-constant">Processor</span>.<span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">env</span>, <span class="ruby-identifier">opt</span>)
188:     <span class="ruby-identifier">conn_data</span> = <span class="ruby-constant">StreamHandler</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response_string</span>)
189:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">is_fault</span> = <span class="ruby-keyword kw">true</span>
190:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ext</span> = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>]
191:       <span class="ruby-identifier">mimeize</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">ext</span>)
192:     <span class="ruby-keyword kw">end</span>
193:     <span class="ruby-identifier">conn_data</span>
194:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006632">
                    
                    <a name="M006632"></a><b>route</b>(conn_data)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006632_source')" id="l_M006632_source">show</a>
                        
                    </p>
                    <div id="M006632_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 153</span>
153:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">route</span>(<span class="ruby-identifier">conn_data</span>)
154:     <span class="ruby-comment cmt"># we cannot set request_default_encodingsyle before parsing the content.</span>
155:     <span class="ruby-identifier">env</span> = <span class="ruby-identifier">unmarshal</span>(<span class="ruby-identifier">conn_data</span>)
156:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env</span>.<span class="ruby-identifier">nil?</span>
157:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal SOAP marshal format&quot;</span>)
158:     <span class="ruby-keyword kw">end</span>
159:     <span class="ruby-identifier">op</span> = <span class="ruby-identifier">lookup_operation</span>(<span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">env</span>.<span class="ruby-identifier">body</span>)
160:     <span class="ruby-identifier">headerhandler</span> = <span class="ruby-ivar">@headerhandler</span>.<span class="ruby-identifier">dup</span>
161:     <span class="ruby-ivar">@headerhandlerfactory</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
162:       <span class="ruby-identifier">headerhandler</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">create</span>)
163:     <span class="ruby-keyword kw">end</span>
164:     <span class="ruby-identifier">receive_headers</span>(<span class="ruby-identifier">headerhandler</span>, <span class="ruby-identifier">env</span>.<span class="ruby-identifier">header</span>)
165:     <span class="ruby-identifier">soap_response</span> = <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-keyword kw">nil</span>
166:     <span class="ruby-keyword kw">begin</span>
167:       <span class="ruby-identifier">soap_response</span> =
168:         <span class="ruby-identifier">op</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">env</span>.<span class="ruby-identifier">body</span>, <span class="ruby-ivar">@mapping_registry</span>, <span class="ruby-ivar">@literal_mapping_registry</span>,
169:           <span class="ruby-identifier">create_mapping_opt</span>)
170:       <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-identifier">op</span>.<span class="ruby-identifier">response_default_encodingstyle</span>
171:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span>
172:       <span class="ruby-identifier">soap_response</span> = <span class="ruby-identifier">fault</span>(<span class="ruby-identifier">$!</span>)
173:       <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-keyword kw">nil</span>
174:     <span class="ruby-keyword kw">end</span>
175:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">is_fault</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">soap_response</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SOAPFault</span>)
176:     <span class="ruby-identifier">header</span> = <span class="ruby-identifier">call_headers</span>(<span class="ruby-identifier">headerhandler</span>)
177:     <span class="ruby-identifier">body</span> = <span class="ruby-constant">SOAPBody</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soap_response</span>)
178:     <span class="ruby-identifier">env</span> = <span class="ruby-constant">SOAPEnvelope</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">header</span>, <span class="ruby-identifier">body</span>)
179:     <span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">env</span>, <span class="ruby-identifier">default_encodingstyle</span>)
180:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M006644">
                    
                    <a name="M006644"></a><b>assign_operation</b>(soapaction, qname, op)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006644_source')" id="l_M006644_source">show</a>
                        
                    </p>
                    <div id="M006644_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">op</span>)
223:     <span class="ruby-identifier">assigned</span> = <span class="ruby-keyword kw">false</span>
224:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">soapaction</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">soapaction</span>.<span class="ruby-identifier">empty?</span>
225:       <span class="ruby-ivar">@operation_by_soapaction</span>[<span class="ruby-identifier">soapaction</span>] = <span class="ruby-identifier">op</span>
226:       <span class="ruby-identifier">assigned</span> = <span class="ruby-keyword kw">true</span>
227:     <span class="ruby-keyword kw">end</span>
228:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">qname</span>
229:       <span class="ruby-ivar">@operation_by_qname</span>[<span class="ruby-identifier">qname</span>] = <span class="ruby-identifier">op</span>
230:       <span class="ruby-identifier">assigned</span> = <span class="ruby-keyword kw">true</span>
231:     <span class="ruby-keyword kw">end</span>
232:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">assigned</span>
233:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;cannot assign operation&quot;</span>)
234:     <span class="ruby-keyword kw">end</span>
235:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006647">
                    
                    <a name="M006647"></a><b>call_headers</b>(headerhandler)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006647_source')" id="l_M006647_source">show</a>
                        
                    </p>
                    <div id="M006647_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 253</span>
253:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call_headers</span>(<span class="ruby-identifier">headerhandler</span>)
254:     <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headerhandler</span>.<span class="ruby-identifier">on_outbound</span>
255:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">empty?</span>
256:       <span class="ruby-keyword kw">nil</span>
257:     <span class="ruby-keyword kw">else</span>
258:       <span class="ruby-identifier">h</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPHeader</span>.<span class="ruby-identifier">new</span>
259:       <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">header</span><span class="ruby-operator">|</span>
260:         <span class="ruby-identifier">h</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">header</span>.<span class="ruby-identifier">elename</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">header</span>)
261:       <span class="ruby-keyword kw">end</span>
262:       <span class="ruby-identifier">h</span>
263:     <span class="ruby-keyword kw">end</span>
264:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006658">
                    
                    <a name="M006658"></a><b>create_mapping_opt</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006658_source')" id="l_M006658_source">show</a>
                        
                    </p>
                    <div id="M006658_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 330</span>
330:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_mapping_opt</span>
331:     { <span class="ruby-identifier">:external_ces</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@external_ces</span> }
332:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006640">
                    
                    <a name="M006640"></a><b>create_styleuse_option</b>(style, use)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006640_source')" id="l_M006640_source">show</a>
                        
                    </p>
                    <div id="M006640_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 208</span>
208:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_styleuse_option</span>(<span class="ruby-identifier">style</span>, <span class="ruby-identifier">use</span>)
209:     <span class="ruby-identifier">opt</span> = {}
210:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:response_style</span>] = <span class="ruby-identifier">style</span>
211:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_use</span>] = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:response_use</span>] = <span class="ruby-identifier">use</span>
212:     <span class="ruby-identifier">opt</span>
213:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006641">
                    
                    <a name="M006641"></a><b>ensure_styleuse_option</b>(opt, style, use)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006641_source')" id="l_M006641_source">show</a>
                        
                    </p>
                    <div id="M006641_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 215</span>
215:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">style</span>, <span class="ruby-identifier">use</span>)
216:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">style</span>
217:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:response_style</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">style</span>
218:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_use</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">use</span>
219:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:response_use</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">use</span>
220:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006657">
                    
                    <a name="M006657"></a><b>fault</b>(e)
                    
                </div>
                
                <div class="description">
                  <p>
Create fault response.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006657_source')" id="l_M006657_source">show</a>
                        
                    </p>
                    <div id="M006657_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 321</span>
321:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fault</span>(<span class="ruby-identifier">e</span>)
322:     <span class="ruby-identifier">detail</span> = <span class="ruby-constant">Mapping</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">e</span>)
323:     <span class="ruby-constant">SOAPFault</span>.<span class="ruby-identifier">new</span>(
324:       <span class="ruby-constant">SOAPString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Server'</span>),
325:       <span class="ruby-constant">SOAPString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>),
326:       <span class="ruby-constant">SOAPString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@actor</span>),
327:       <span class="ruby-constant">Mapping</span>.<span class="ruby-identifier">obj2soap</span>(<span class="ruby-identifier">detail</span>, <span class="ruby-ivar">@mapping_registry</span>))
328:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006639">
                    
                    <a name="M006639"></a><b>first_input_part_qname</b>(param_def)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006639_source')" id="l_M006639_source">show</a>
                        
                    </p>
                    <div id="M006639_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 198</span>
198:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first_input_part_qname</span>(<span class="ruby-identifier">param_def</span>)
199:     <span class="ruby-identifier">param_def</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inout</span>, <span class="ruby-identifier">paramname</span>, <span class="ruby-identifier">typeinfo</span><span class="ruby-operator">|</span>
200:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">inout</span> <span class="ruby-operator">==</span> <span class="ruby-constant">SOAPMethod</span><span class="ruby-operator">::</span><span class="ruby-constant">IN</span>
201:         <span class="ruby-identifier">klass</span>, <span class="ruby-identifier">nsdef</span>, <span class="ruby-identifier">namedef</span> = <span class="ruby-identifier">typeinfo</span>
202:         <span class="ruby-keyword kw">return</span> <span class="ruby-constant">XSD</span><span class="ruby-operator">::</span><span class="ruby-constant">QName</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">nsdef</span>, <span class="ruby-identifier">namedef</span>)
203:       <span class="ruby-keyword kw">end</span>
204:     <span class="ruby-keyword kw">end</span>
205:     <span class="ruby-keyword kw">nil</span>
206:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006645">
                    
                    <a name="M006645"></a><b>lookup_operation</b>(soapaction, body)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006645_source')" id="l_M006645_source">show</a>
                        
                    </p>
                    <div id="M006645_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 237</span>
237:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lookup_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">body</span>)
238:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">op</span> = <span class="ruby-ivar">@operation_by_soapaction</span>[<span class="ruby-identifier">soapaction</span>]
239:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">op</span>
240:     <span class="ruby-keyword kw">end</span>
241:     <span class="ruby-identifier">qname</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">root_node</span>.<span class="ruby-identifier">elename</span>
242:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">op</span> = <span class="ruby-ivar">@operation_by_qname</span>[<span class="ruby-identifier">qname</span>]
243:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">op</span>
244:     <span class="ruby-keyword kw">end</span>
245:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">soapaction</span>
246:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(
247:         <span class="ruby-node">&quot;operation: #{soapaction} #{qname} not supported&quot;</span>)
248:     <span class="ruby-keyword kw">else</span>
249:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;operation: #{qname} not supported&quot;</span>)
250:     <span class="ruby-keyword kw">end</span>
251:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006652">
                    
                    <a name="M006652"></a><b>marshal</b>(conn_data, env, default_encodingstyle = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006652_source')" id="l_M006652_source">show</a>
                        
                    </p>
                    <div id="M006652_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 295</span>
295:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">env</span>, <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-keyword kw">nil</span>)
296:     <span class="ruby-identifier">opt</span> = {}
297:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>] = <span class="ruby-keyword kw">nil</span>
298:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:default_encodingstyle</span>] = <span class="ruby-identifier">default_encodingstyle</span>
299:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:generate_explicit_type</span>] = <span class="ruby-ivar">@generate_explicit_type</span>
300:     <span class="ruby-identifier">response_string</span> = <span class="ruby-constant">Processor</span>.<span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">env</span>, <span class="ruby-identifier">opt</span>)
301:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">send_string</span> = <span class="ruby-identifier">response_string</span>
302:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ext</span> = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>]
303:       <span class="ruby-identifier">mimeize</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">ext</span>)
304:     <span class="ruby-keyword kw">end</span>
305:     <span class="ruby-identifier">conn_data</span>
306:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006655">
                    
                    <a name="M006655"></a><b>mimeize</b>(conn_data, ext)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006655_source')" id="l_M006655_source">show</a>
                        
                    </p>
                    <div id="M006655_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 308</span>
308:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mimeize</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">ext</span>)
309:     <span class="ruby-identifier">mime</span> = <span class="ruby-constant">MIMEMessage</span>.<span class="ruby-identifier">new</span>
310:     <span class="ruby-identifier">ext</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
311:       <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">add_attachment</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">data</span>)
312:     <span class="ruby-keyword kw">end</span>
313:     <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">add_part</span>(<span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">send_string</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\r\n&quot;</span>)
314:     <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">close</span>
315:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">send_string</span> = <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">content_str</span>
316:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">send_contenttype</span> = <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-value str">'content-type'</span>].<span class="ruby-identifier">str</span>
317:     <span class="ruby-identifier">conn_data</span>
318:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006649">
                    
                    <a name="M006649"></a><b>receive_headers</b>(headerhandler, headers)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006649_source')" id="l_M006649_source">show</a>
                        
                    </p>
                    <div id="M006649_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 266</span>
266:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">receive_headers</span>(<span class="ruby-identifier">headerhandler</span>, <span class="ruby-identifier">headers</span>)
267:     <span class="ruby-identifier">headerhandler</span>.<span class="ruby-identifier">on_inbound</span>(<span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">headers</span>
268:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M006650">
                    
                    <a name="M006650"></a><b>unmarshal</b>(conn_data)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006650_source')" id="l_M006650_source">show</a>
                        
                    </p>
                    <div id="M006650_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 270</span>
270:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unmarshal</span>(<span class="ruby-identifier">conn_data</span>)
271:     <span class="ruby-identifier">opt</span> = {}
272:     <span class="ruby-identifier">contenttype</span> = <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">receive_contenttype</span>
273:     <span class="ruby-keyword kw">if</span> <span class="ruby-node">/#{MIMEMessage::MultipartContentType}/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">contenttype</span>
274:       <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>] = {}
275:       <span class="ruby-identifier">mime</span> = <span class="ruby-constant">MIMEMessage</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-value str">&quot;Content-Type: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">contenttype</span>,
276:         <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">receive_string</span>)
277:       <span class="ruby-identifier">mime</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span>
278:   <span class="ruby-identifier">value</span> = <span class="ruby-constant">Attachment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">part</span>.<span class="ruby-identifier">content</span>)
279:   <span class="ruby-identifier">value</span>.<span class="ruby-identifier">contentid</span> = <span class="ruby-identifier">part</span>.<span class="ruby-identifier">contentid</span>
280:   <span class="ruby-identifier">obj</span> = <span class="ruby-constant">SOAPAttachment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">value</span>)
281:   <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>][<span class="ruby-identifier">value</span>.<span class="ruby-identifier">contentid</span>] = <span class="ruby-identifier">obj</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">contentid</span>
282:       <span class="ruby-keyword kw">end</span>
283:       <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:charset</span>] =
284:   <span class="ruby-constant">StreamHandler</span>.<span class="ruby-identifier">parse_media_type</span>(<span class="ruby-identifier">mime</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-value str">'content-type'</span>].<span class="ruby-identifier">str</span>)
285:       <span class="ruby-identifier">env</span> = <span class="ruby-constant">Processor</span>.<span class="ruby-identifier">unmarshal</span>(<span class="ruby-identifier">mime</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">content</span>, <span class="ruby-identifier">opt</span>)
286:     <span class="ruby-keyword kw">else</span>
287:       <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:charset</span>] = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">StreamHandler</span>.<span class="ruby-identifier">parse_media_type</span>(<span class="ruby-identifier">contenttype</span>)
288:       <span class="ruby-identifier">env</span> = <span class="ruby-constant">Processor</span>.<span class="ruby-identifier">unmarshal</span>(<span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">receive_string</span>, <span class="ruby-identifier">opt</span>)
289:     <span class="ruby-keyword kw">end</span>
290:     <span class="ruby-identifier">charset</span> = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:charset</span>]
291:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">send_contenttype</span> = <span class="ruby-node">&quot;text/xml; charset=\&quot;#{charset}\&quot;&quot;</span>
292:     <span class="ruby-identifier">env</span>
293:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M006609">
                    
                    <a name="M006609"></a><b>new</b>(actor)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M006609_source')" id="l_M006609_source">show</a>
                        
                    </p>
                    <div id="M006609_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/soap/rpc/router.rb, line 33</span>
33:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">actor</span>)
34:     <span class="ruby-ivar">@actor</span> = <span class="ruby-identifier">actor</span>
35:     <span class="ruby-ivar">@mapping_registry</span> = <span class="ruby-keyword kw">nil</span>
36:     <span class="ruby-ivar">@headerhandler</span> = <span class="ruby-constant">Header</span><span class="ruby-operator">::</span><span class="ruby-constant">HandlerSet</span>.<span class="ruby-identifier">new</span>
37:     <span class="ruby-ivar">@literal_mapping_registry</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">Mapping</span><span class="ruby-operator">::</span><span class="ruby-constant">WSDLLiteralRegistry</span>.<span class="ruby-identifier">new</span>
38:     <span class="ruby-ivar">@generate_explicit_type</span> = <span class="ruby-keyword kw">true</span>
39:     <span class="ruby-ivar">@external_ces</span> = <span class="ruby-keyword kw">nil</span>
40:     <span class="ruby-ivar">@operation_by_soapaction</span> = {}
41:     <span class="ruby-ivar">@operation_by_qname</span> = {}
42:     <span class="ruby-ivar">@headerhandlerfactory</span> = []
43:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    