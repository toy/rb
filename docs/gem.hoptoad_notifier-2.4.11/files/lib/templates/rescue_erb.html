<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>rescue.erb</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            rescue.erb
        </h1>
        <ul class="files">
            <li>lib/templates/rescue.erb</li>
            <li>Last modified: Sun Oct 02 00:59:10 +0200 2011</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
<script type=&#8220;text/javascript&#8220;> var Hoptoad = {
</p>
<pre>
  host    : &lt;%= host.to_json %&gt;,
  api_key : &lt;%= api_key.to_json %&gt;,
  notice  : &lt;%= notice.to_json %&gt;,
  message : 'This error exists in production!',

  initialize: function() {
    if (this.initialized) {
      return;
    } else {
      this.initialized = true;
    }

    var data = [];

    for (var key in this.notice) {
      data[data.length] = 'notice[' + key + ']=' + this.notice[key];
    }

    data[data.length] = 'notice[api_key]=' + this.api_key;
    data[data.length] = 'callback=Hoptoad.onSuccess';
    data[data.length] = '_=' + (new Date()).getTime();

    var head = document.getElementsByTagName('head')[0];
    var done = false;

    var
    script = document.createElement('script');
    script.src  = 'http://' + this.host + '/notices_api/v1/notices/exist?' +
                  data.join('&amp;');
    script.type = 'text/javascript';
    script.onload = script.onreadystatechange = function(){
      if (!done &amp;&amp; (!this.readyState ||
          this.readyState == 'loaded' || this.readyState == 'complete')) {

        done = true;

        // Handle memory leak in IE. (via jQuery)
        script.onload = script.onreadystatechange = null;
        head.removeChild(script);
      }
    };

    head.appendChild(script);
  },

  onSuccess: function(error) {
    var body    = document.getElementsByTagName('body')[0];
    var text    = document.createTextNode(this.message);
    var element = document.createElement('a');

    element.id   = 'hoptoad';
    element.href = 'http://' + error.subdomain + '.' + this.host +
                   '/projects/' + error.project_id + '/errors/' + error.id;
    element.appendChild(text);

    body.insertBefore(element, body.firstChild);

    var h1      = document.getElementsByTagName('h1')[0];
    var pre     = document.getElementsByTagName('pre')[0];
    var wrapper = document.createElement('div');

    wrapper.id = 'wrapper';
    wrapper.appendChild(h1);
    wrapper.appendChild(pre);

    body.insertBefore(wrapper, body.children[1]);
  }
</pre>
<p>
};
</p>
<p>
window.onload = function() {
</p>
<pre>
  Hoptoad.initialize.apply(Hoptoad);
</pre>
<p>
}; </script>
</p>
<p>
<style type=&#8220;text/css&#8220;> hoptoad {
</p>
<pre>
  background: #FFF url(http://hoptoadapp.com/images/fell-off-the-toad.gif) no-repeat top right;
  color: #F00;
  padding: 45px 101px 45px 12px;
  font-size: 14px;
  font-weight: bold;
  display: block;
  float: right;
</pre>
<p>
}
</p>
<p>
wrapper {
</p>
<pre>
  padding-right: 360px;
</pre>
<p>
} </style>
</p>

    </div>
    

    

    
    

    
    

    

    

    

    

    

    
</div>
    </div>
  </body>
</html>