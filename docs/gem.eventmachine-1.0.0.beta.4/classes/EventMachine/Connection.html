<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>EventMachine::Connection</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            EventMachine::Connection 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/em/connection_rb.html">lib/em/connection.rb</a></li>
            
            <li><a href="../../files/lib/em/pure_ruby_rb.html">lib/em/pure_ruby.rb</a></li>
            
            <li><a href="../../files/lib/jeventmachine_rb.html">lib/jeventmachine.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
@private
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000497">associate_callback_target</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000043">close_connection</a>,</li>
                
                <li><a href="#M000047">close_connection_after_writing</a>,</li>
                
                <li><a href="#M000064">comm_inactivity_timeout</a>,</li>
                
                <li><a href="#M000065">comm_inactivity_timeout=</a>,</li>
                
                <li><a href="#M000050">connection_completed</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000044">detach</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000049">error?</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000341">get_outbound_data_size</a>,</li>
                
                <li><a href="#M000055">get_peer_cert</a>,</li>
                
                <li><a href="#M000059">get_peername</a>,</li>
                
                <li><a href="#M000061">get_pid</a>,</li>
                
                <li><a href="#M000045">get_sock_opt</a>,</li>
                
                <li><a href="#M000060">get_sockname</a>,</li>
                
                <li><a href="#M000063">get_status</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000026">new</a>,</li>
                
                <li><a href="#M000025">new</a>,</li>
                
                <li><a href="#M000078">notify_readable=</a>,</li>
                
                <li><a href="#M000079">notify_readable?</a>,</li>
                
                <li><a href="#M000080">notify_writable=</a>,</li>
                
                <li><a href="#M000081">notify_writable?</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000082">pause</a>,</li>
                
                <li><a href="#M000084">paused?</a>,</li>
                
                <li><a href="#M000070">pending_connect_timeout</a>,</li>
                
                <li><a href="#M000073">pending_connect_timeout=</a>,</li>
                
                <li><a href="#M000030">post_init</a>,</li>
                
                <li><a href="#M000040">proxy_completed</a>,</li>
                
                <li><a href="#M000041">proxy_incoming_to</a>,</li>
                
                <li><a href="#M000039">proxy_target_unbound</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000035">receive_data</a>,</li>
                
                <li><a href="#M000075">reconnect</a>,</li>
                
                <li><a href="#M000083">resume</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000048">send_data</a>,</li>
                
                <li><a href="#M000057">send_datagram</a>,</li>
                
                <li><a href="#M000076">send_file_data</a>,</li>
                
                <li><a href="#M000069">set_comm_inactivity_timeout</a>,</li>
                
                <li><a href="#M000074">set_pending_connect_timeout</a>,</li>
                
                <li><a href="#M000046">set_sock_opt</a>,</li>
                
                <li><a href="#M000036">ssl_handshake_completed</a>,</li>
                
                <li><a href="#M000037">ssl_verify_peer</a>,</li>
                
                <li><a href="#M000051">start_tls</a>,</li>
                
                <li><a href="#M000042">stop_proxying</a>,</li>
                
                <li><a href="#M000077">stream_file_data</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M000038">unbind</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>signature</td>
            <td class='attr-desc'><p>
@private
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000025">
                    
                    <a name="M000025"></a><b>new</b>(sig, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Override .new so subclasses don&#8217;t have to call super and can ignore
connection-specific arguments
</p>
<p>
@private
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show</a>
                        
                    </p>
                    <div id="M000025_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/em/connection.rb, line 48</span>
48:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sig</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
49:       <span class="ruby-identifier">allocate</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword kw">do</span>
50:         <span class="ruby-comment cmt"># Store signature</span>
51:         <span class="ruby-ivar">@signature</span> = <span class="ruby-identifier">sig</span>
52:         <span class="ruby-comment cmt"># associate_callback_target sig</span>
53: 
54:         <span class="ruby-comment cmt"># Call a superclass's #initialize if it has one</span>
55:         <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
56: 
57:         <span class="ruby-comment cmt"># post initialize callback</span>
58:         <span class="ruby-identifier">post_init</span>
59: 
60:         <span class="ruby-keyword kw">self</span>
61:       <span class="ruby-keyword kw">end</span>
62:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000026">
                    
                    <a name="M000026"></a><b>new</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Stubbed initialize so legacy superclasses can safely call super
</p>
<p>
@private
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show</a>
                        
                    </p>
                    <div id="M000026_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/em/connection.rb, line 67</span>
67:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
68:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000497">
                    
                    <a name="M000497"></a><b>associate_callback_target</b>(sig)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000497_source')" id="l_M000497_source">show</a>
                        
                    </p>
                    <div id="M000497_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 274</span>
274:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">associate_callback_target</span> <span class="ruby-identifier">sig</span>
275:       <span class="ruby-comment cmt"># No-op for the time being</span>
276:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000043">
                    
                    <a name="M000043"></a><b>close_connection</b>(after_writing = false)
                    
                </div>
                
                <div class="description">
                  <p>
<a
href="Connection.html#M000043">EventMachine::Connection#close_connection</a>
is called only by user code, and never by the event loop. You may call this
method against a connection object in any callback handler, whether or not
the callback was made against the connection you want to close. <a
href="Connection.html#M000043">close_connection</a> <em>schedules</em> the
connection to be closed at the next available opportunity within the event
loop. You may not assume that the connection is closed when <a
href="Connection.html#M000043">close_connection</a> returns. In particular,
the framework will callback the unbind method for the particular connection
at a point shortly after you call close_connection. You may assume that the
unbind callback will take place sometime after your call to <a
href="Connection.html#M000043">close_connection</a> completes. In other
words, the unbind callback will not re-enter your code &#8220;inside&#8221;
of your call to close_connection. However, it&#8217;s not guaranteed that a
future version of <a href="../EventMachine.html">EventMachine</a> will not
change this behavior.
</p>
<p>
{<a href="Connection.html#M000043">close_connection</a>} will *silently
discard* any outbound data which you have sent to the connection using {<a
href="Connection.html#M000048">EventMachine::Connection#send_data</a>} but
which has not yet been sent across the network. If you want to avoid this
behavior, use {<a
href="Connection.html#M000047">EventMachine::Connection#close_connection_after_writing</a>}.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000043_source')" id="l_M000043_source">show</a>
                        
                    </p>
                    <div id="M000043_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 259</span>
259:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close_connection</span> <span class="ruby-identifier">after_writing</span> = <span class="ruby-keyword kw">false</span>
260:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">close_connection</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">after_writing</span>
261:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000047">
                    
                    <a name="M000047"></a><b>close_connection_after_writing</b>()
                    
                </div>
                
                <div class="description">
                  <p>
A variant of {<a href="Connection.html#M000043">close_connection</a>}. All
of the descriptive comments given for <a
href="Connection.html#M000043">close_connection</a> also apply to <a
href="Connection.html#M000047">close_connection_after_writing</a>, *with
one exception*: if the connection has outbound data sent using send_dat but
which has not yet been sent across the network, <a
href="Connection.html#M000047">close_connection_after_writing</a> will
schedule the connection to be closed <b>after</b> all of the outbound data
has been safely written to the remote peer.
</p>
<p>
Depending on the amount of outgoing data and the speed of the network,
considerable time may elapse between your call to <a
href="Connection.html#M000047">close_connection_after_writing</a> and the
actual closing of the socket (at which time the unbind callback will be
called by the event loop). During this time, you *may not* call <a
href="Connection.html#M000048">send_data</a> to transmit additional data
(that is, the connection is closed for further writes). In very rare cases,
you may experience a <a href="Connection.html#M000035">receive_data</a>
callback after your call to {<a
href="Connection.html#M000047">close_connection_after_writing</a>},
depending on whether incoming data was in the process of being received on
the connection at the moment when you called {<a
href="Connection.html#M000047">close_connection_after_writing</a>}. Your
protocol handler must be prepared to properly deal with such data (probably
by ignoring it).
</p>
<p>
@see <a href="Connection.html#M000043">close_connection</a> @see <a
href="Connection.html#M000048">send_data</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000047_source')" id="l_M000047_source">show</a>
                        
                    </p>
                    <div id="M000047_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 296</span>
296:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close_connection_after_writing</span>
297:       <span class="ruby-identifier">close_connection</span> <span class="ruby-keyword kw">true</span>
298:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000064">
                    
                    <a name="M000064"></a><b>comm_inactivity_timeout</b>()
                    
                </div>
                
                <div class="description">
                  <p>
<a href="Connection.html#M000064">comm_inactivity_timeout</a> returns the
current value (float in seconds) of the inactivity-timeout property of
network-connection and datagram-socket objects. A nonzero value indicates
that the connection or socket will automatically be closed if no read or
write activity takes place for at least that number of seconds. A zero
value (the default) specifies that no automatic timeout will take place.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000064_source')" id="l_M000064_source">show</a>
                        
                    </p>
                    <div id="M000064_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 578</span>
578:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">comm_inactivity_timeout</span>
579:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_comm_inactivity_timeout</span> <span class="ruby-ivar">@signature</span>
580:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000065">
                    
                    <a name="M000065"></a><b>comm_inactivity_timeout=</b>(value)
                    
                </div>
                
                <div class="description">
                  <p>
Allows you to set the inactivity-timeout property for a network connection
or datagram socket. Specify a non-negative float value in seconds. If the
value is greater than zero, the connection or socket will automatically be
closed if no read or write activity takes place for at least that number of
seconds. Specify a value of zero to indicate that no automatic timeout
should take place. Zero is the default value.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Connection.html#M000069">set_comm_inactivity_timeout</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000065_source')" id="l_M000065_source">show</a>
                        
                    </p>
                    <div id="M000065_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 588</span>
588:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">comm_inactivity_timeout=</span> <span class="ruby-identifier">value</span>
589:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_comm_inactivity_timeout</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_f</span>
590:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000050">
                    
                    <a name="M000050"></a><b>connection_completed</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Called by the event loop when a remote TCP connection attempt completes
successfully. You can expect to get this notification after calls to {<a
href="../EventMachine.html#M000511">EventMachine.connect</a>}. Remember
that <a href="../EventMachine.html">EventMachine</a> makes remote
connections asynchronously, just as with any other kind of network event.
This method is intended primarily to assist with network diagnostics. For
normal protocol handling, use <a
href="Connection.html#M000030">post_init</a> to perform initial work on a
new connection (such as sending initial set of data). {<a
href="Connection.html#M000030">Connection#post_init</a>} will always be
called. This method will only be called in case of a successful completion.
A connection attempt which fails will result a call to {<a
href="Connection.html#M000038">Connection#unbind</a>} after the failure.
</p>
<p>
@see <a href="Connection.html#M000030">Connection#post_init</a> @see <a
href="Connection.html#M000038">Connection#unbind</a> @see file:<a
href="../../files/docs/GettingStarted_md.html">docs/GettingStarted.md</a>
<a href="../EventMachine.html">EventMachine</a> tutorial
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000050_source')" id="l_M000050_source">show</a>
                        
                    </p>
                    <div id="M000050_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 356</span>
356:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connection_completed</span>
357:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000044">
                    
                    <a name="M000044"></a><b>detach</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Removes given connection from the event loop. The connection&#8217;s socket
remains open and its file descriptor number is returned.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000044_source')" id="l_M000044_source">show</a>
                        
                    </p>
                    <div id="M000044_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 265</span>
265:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">detach</span>
266:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">detach_fd</span> <span class="ruby-ivar">@signature</span>
267:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000049">
                    
                    <a name="M000049"></a><b>error?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if the connection is in an error state, false otherwise.
</p>
<p>
In general, you can detect the occurrence of communication errors or
unexpected disconnection by the remote peer by handing the {<a
href="Connection.html#M000038">unbind</a>} method. In some cases, however,
it&#8217;s useful to check the status of the connection using {<a
href="Connection.html#M000049">error?</a>} before attempting to send data.
This function is synchronous but it will return immediately without
blocking.
</p>
<p>
@return [Boolean] true if the connection is in an error state, false
otherwise
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000049_source')" id="l_M000049_source">show</a>
                        
                    </p>
                    <div id="M000049_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 333</span>
333:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error?</span>
334:       <span class="ruby-identifier">errno</span> = <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">report_connection_error_status</span>(<span class="ruby-ivar">@signature</span>)
335:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">errno</span>
336:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
337:         <span class="ruby-keyword kw">false</span>
338:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">-1</span>
339:         <span class="ruby-keyword kw">true</span>
340:       <span class="ruby-keyword kw">else</span>
341:         <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-constant">ERRNOS</span>[<span class="ruby-identifier">errno</span>]
342:       <span class="ruby-keyword kw">end</span>
343:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000341">
                    
                    <a name="M000341"></a><b>get_outbound_data_size</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@private
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000341_source')" id="l_M000341_source">show</a>
                        
                    </p>
                    <div id="M000341_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/pure_ruby.rb, line 234</span>
234:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_outbound_data_size</span>
235:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_outbound_data_size</span> <span class="ruby-ivar">@signature</span>
236:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000055">
                    
                    <a name="M000055"></a><b>get_peer_cert</b>()
                    
                </div>
                
                <div class="description">
                  <p>
If [TLS](<a
href="http://en.wikipedia.org/wiki/Transport_Layer_Security">en.wikipedia.org/wiki/Transport_Layer_Security</a>)
is active on the connection, returns the remote [X509 certificate](<a
href="http://en.wikipedia.org/wiki/X.509">en.wikipedia.org/wiki/X.509</a>)
as a string, in the popular [PEM format](<a
href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">en.wikipedia.org/wiki/Privacy_Enhanced_Mail</a>).
This can then be used for arbitrary validation of a peer&#8217;s
certificate in your code.
</p>
<p>
This should be called in/after the {<a
href="Connection.html#M000036">ssl_handshake_completed</a>} callback, which
indicates that SSL/TLS is active. Using this callback is important, because
the certificate may not be available until the time it is executed. Using
<a href="Connection.html#M000030">post_init</a> or <a
href="Connection.html#M000050">connection_completed</a> is not adequate,
because the SSL handshake may still be taking place.
</p>
<p>
This method will return `nil` if:
</p>
<ul>
<li><a href="../EventMachine.html">EventMachine</a> is not built with
[OpenSSL](<a href="http://www.openssl.org">www.openssl.org</a>) support

</li>
<li>[TLS](<a
href="http://en.wikipedia.org/wiki/Transport_Layer_Security">en.wikipedia.org/wiki/Transport_Layer_Security</a>)
is not active on the connection

</li>
<li>TLS handshake is not yet complete

</li>
<li>Remote peer for any other reason has not presented a certificate

</li>
</ul>
<p>
@example Getting peer TLS certificate information in <a
href="../EventMachine.html">EventMachine</a>
</p>
<pre>
 module Handler
   def post_init
     puts &quot;Starting TLS&quot;
     start_tls
   end

   def ssl_handshake_completed
     puts get_peer_cert
     close_connection
   end

   def unbind
     EventMachine::stop_event_loop
   end
 end

  EventMachine.run do
    EventMachine.connect &quot;mail.google.com&quot;, 443, Handler
 end

 # Will output:
 # -----BEGIN CERTIFICATE-----
 # MIIDIjCCAougAwIBAgIQbldpChBPqv+BdPg4iwgN8TANBgkqhkiG9w0BAQUFADBM
 # MQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkg
 # THRkLjEWMBQGA1UEAxMNVGhhd3RlIFNHQyBDQTAeFw0wODA1MDIxNjMyNTRaFw0w
 # OTA1MDIxNjMyNTRaMGkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlh
 # MRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRMwEQYDVQQKEwpHb29nbGUgSW5jMRgw
 # FgYDVQQDEw9tYWlsLmdvb2dsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJ
 # AoGBALlkxdh2QXegdElukCSOV2+8PKiONIS+8Tu9K7MQsYpqtLNC860zwOPQ2NLI
 # 3Zp4jwuXVTrtzGuiqf5Jioh35Ig3CqDXtLyZoypjZUQcq4mlLzHlhIQ4EhSjDmA7
 # Ffw9y3ckSOQgdBQWNLbquHh9AbEUjmhkrYxIqKXeCnRKhv6nAgMBAAGjgecwgeQw
 # KAYDVR0lBCEwHwYIKwYBBQUHAwEGCCsGAQUFBwMCBglghkgBhvhCBAEwNgYDVR0f
 # BC8wLTAroCmgJ4YlaHR0cDovL2NybC50aGF3dGUuY29tL1RoYXd0ZVNHQ0NBLmNy
 # bDByBggrBgEFBQcBAQRmMGQwIgYIKwYBBQUHMAGGFmh0dHA6Ly9vY3NwLnRoYXd0
 # ZS5jb20wPgYIKwYBBQUHMAKGMmh0dHA6Ly93d3cudGhhd3RlLmNvbS9yZXBvc2l0
 # b3J5L1RoYXd0ZV9TR0NfQ0EuY3J0MAwGA1UdEwEB/wQCMAAwDQYJKoZIhvcNAQEF
 # BQADgYEAsRwpLg1dgCR1gYDK185MFGukXMeQFUvhGqF8eT/CjpdvezyKVuz84gSu
 # 6ccMXgcPQZGQN/F4Xug+Q01eccJjRSVfdvR5qwpqCj+6BFl5oiKDBsveSkrmL5dz
 # s2bn7TdTSYKcLeBkjXxDLHGBqLJ6TNCJ3c4/cbbG5JhGvoema94=
 # -----END CERTIFICATE-----
</pre>
<p>
You can do whatever you want with the certificate String, such as load it
as a certificate object using the OpenSSL library, and check its fields.
</p>
<p>
@return [String] the remote [X509 certificate](<a
href="http://en.wikipedia.org/wiki/X.509">en.wikipedia.org/wiki/X.509</a>),
in the popular [PEM format](<a
href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">en.wikipedia.org/wiki/Privacy_Enhanced_Mail</a>),
</p>
<pre>
                 if TLS is active on the connection
</pre>
<p>
@see <a href="Connection.html#M000051">Connection#start_tls</a> @see <a
href="Connection.html#M000036">Connection#ssl_handshake_completed</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000055_source')" id="l_M000055_source">show</a>
                        
                    </p>
                    <div id="M000055_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 481</span>
481:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_peer_cert</span>
482:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_peer_cert</span> <span class="ruby-ivar">@signature</span>
483:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000059">
                    
                    <a name="M000059"></a><b>get_peername</b>()
                    
                </div>
                
                <div class="description">
                  <p>
This method is used with stream-connections to obtain the identity of the
remotely-connected peer. If a peername is available, this method returns a
sockaddr structure. The method returns nil if no peername is available. You
can use Socket.unpack_sockaddr_in and its variants to obtain the values
contained in the peername structure returned from <a
href="Connection.html#M000059">get_peername</a>.
</p>
<p>
@example How to get peer IP address and port with <a
href="../EventMachine.html">EventMachine</a>
</p>
<pre>
 require 'socket'

 module Handler
   def receive_data data
     port, ip = Socket.unpack_sockaddr_in(get_peername)
     puts &quot;got #{data.inspect} from #{ip}:#{port}&quot;
   end
 end
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000059_source')" id="l_M000059_source">show</a>
                        
                    </p>
                    <div id="M000059_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 532</span>
532:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_peername</span>
533:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_peername</span> <span class="ruby-ivar">@signature</span>
534:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000061">
                    
                    <a name="M000061"></a><b>get_pid</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the PID (kernel process identifier) of a subprocess associated with
this <a href="Connection.html">Connection</a> object. For use with {<a
href="../EventMachine.html#M000529">EventMachine.popen</a>} and similar
methods. Returns nil when there is no meaningful subprocess.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000061_source')" id="l_M000061_source">show</a>
                        
                    </p>
                    <div id="M000061_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 561</span>
561:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_pid</span>
562:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_subprocess_pid</span> <span class="ruby-ivar">@signature</span>
563:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000045">
                    
                    <a name="M000045"></a><b>get_sock_opt</b>(level, option)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000045_source')" id="l_M000045_source">show</a>
                        
                    </p>
                    <div id="M000045_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 269</span>
269:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_sock_opt</span> <span class="ruby-identifier">level</span>, <span class="ruby-identifier">option</span>
270:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_sock_opt</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">level</span>, <span class="ruby-identifier">option</span>
271:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000060">
                    
                    <a name="M000060"></a><b>get_sockname</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Used with stream-connections to obtain the identity of the local side of
the connection. If a local name is available, this method returns a
sockaddr structure. The method returns nil if no local name is available.
You can use {Socket.unpack_sockaddr_in} and its variants to obtain the
values contained in the local-name structure returned from this method.
</p>
<p>
@example
</p>
<pre>
 require 'socket'

 module Handler
   def receive_data data
     port, ip = Socket.unpack_sockaddr_in(get_sockname)
     puts &quot;got #{data.inspect}&quot;
   end
 end
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000060_source')" id="l_M000060_source">show</a>
                        
                    </p>
                    <div id="M000060_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 552</span>
552:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_sockname</span>
553:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_sockname</span> <span class="ruby-ivar">@signature</span>
554:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000063">
                    
                    <a name="M000063"></a><b>get_status</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns a subprocess exit status. Only useful for {<a
href="../EventMachine.html#M000529">EventMachine.popen</a>}. Call it in
your {<a href="Connection.html#M000038">unbind</a>} handler.
</p>
<p>
@return [Integer]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000063_source')" id="l_M000063_source">show</a>
                        
                    </p>
                    <div id="M000063_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 569</span>
569:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_status</span>
570:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_subprocess_status</span> <span class="ruby-ivar">@signature</span>
571:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000078">
                    
                    <a name="M000078"></a><b>notify_readable=</b>(mode)
                    
                </div>
                
                <div class="description">
                  <p>
Watches connection for readability. Only possible if the connection was
created using {<a
href="../EventMachine.html#M000514">EventMachine.attach</a>} and had
{EventMachine.notify_readable}/{EventMachine.notify_writable} defined on
the handler.
</p>
<p>
@see <a href="Connection.html#M000079">notify_readable?</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000078_source')" id="l_M000078_source">show</a>
                        
                    </p>
                    <div id="M000078_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 660</span>
660:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">notify_readable=</span> <span class="ruby-identifier">mode</span>
661:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_notify_readable</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">mode</span>
662:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000079">
                    
                    <a name="M000079"></a><b>notify_readable?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return [Boolean] true if the connection is being watched for readability.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000079_source')" id="l_M000079_source">show</a>
                        
                    </p>
                    <div id="M000079_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 665</span>
665:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">notify_readable?</span>
666:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">is_notify_readable</span> <span class="ruby-ivar">@signature</span>
667:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000080">
                    
                    <a name="M000080"></a><b>notify_writable=</b>(mode)
                    
                </div>
                
                <div class="description">
                  <p>
Watches connection for writeability. Only possible if the connection was
created using {<a
href="../EventMachine.html#M000514">EventMachine.attach</a>} and had
{EventMachine.notify_readable}/{EventMachine.notify_writable} defined on
the handler.
</p>
<p>
@see <a href="Connection.html#M000081">notify_writable?</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000080_source')" id="l_M000080_source">show</a>
                        
                    </p>
                    <div id="M000080_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 673</span>
673:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">notify_writable=</span> <span class="ruby-identifier">mode</span>
674:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_notify_writable</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">mode</span>
675:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000081">
                    
                    <a name="M000081"></a><b>notify_writable?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if the connection is being watched for writability.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000081_source')" id="l_M000081_source">show</a>
                        
                    </p>
                    <div id="M000081_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 678</span>
678:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">notify_writable?</span>
679:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">is_notify_writable</span> <span class="ruby-ivar">@signature</span>
680:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000082">
                    
                    <a name="M000082"></a><b>pause</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Pause a connection so that {<a
href="Connection.html#M000048">send_data</a>} and {<a
href="Connection.html#M000035">receive_data</a>} events are not fired until
{<a href="Connection.html#M000083">resume</a>} is called. @see <a
href="Connection.html#M000083">resume</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000082_source')" id="l_M000082_source">show</a>
                        
                    </p>
                    <div id="M000082_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 684</span>
684:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pause</span>
685:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">pause_connection</span> <span class="ruby-ivar">@signature</span>
686:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000084">
                    
                    <a name="M000084"></a><b>paused?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return [Boolean] true if the connect was paused using {<a
href="Connection.html#M000082">EventMachine::Connection#pause</a>}. @see <a
href="Connection.html#M000082">pause</a> @see <a
href="Connection.html#M000083">resume</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000084_source')" id="l_M000084_source">show</a>
                        
                    </p>
                    <div id="M000084_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 697</span>
697:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">paused?</span>
698:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">connection_paused?</span> <span class="ruby-ivar">@signature</span>
699:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000070">
                    
                    <a name="M000070"></a><b>pending_connect_timeout</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The duration after which a TCP connection in the connecting state will
fail. It is important to distinguish this value from {<a
href="Connection.html#M000064">EventMachine::Connection#comm_inactivity_timeout</a>},
which looks at how long since data was passed on an already established
connection. The value is a float in seconds.
</p>
<p>
@return [Float] The duration after which a TCP connection in the connecting
state will fail, in seconds.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000070_source')" id="l_M000070_source">show</a>
                        
                    </p>
                    <div id="M000070_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 599</span>
599:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pending_connect_timeout</span>
600:         <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_pending_connect_timeout</span> <span class="ruby-ivar">@signature</span>
601:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000073">
                    
                    <a name="M000073"></a><b>pending_connect_timeout=</b>(value)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the duration after which a TCP connection in a connecting state will
fail.
</p>
<p>
@param [Float, to_f] value <a href="Connection.html">Connection</a> timeout
in seconds
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Connection.html#M000074">set_pending_connect_timeout</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000073_source')" id="l_M000073_source">show</a>
                        
                    </p>
                    <div id="M000073_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 607</span>
607:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pending_connect_timeout=</span> <span class="ruby-identifier">value</span>
608:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_pending_connect_timeout</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_f</span>
609:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000030">
                    
                    <a name="M000030"></a><b>post_init</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Called by the event loop immediately after the network connection has been
established, and before resumption of the network loop. This method is
generally not called by user code, but is called automatically by the event
loop. The base-class implementation is a no-op. This is a very good place
to initialize instance variables that will be used throughout the lifetime
of the network connection.
</p>
<p>
@see <a href="Connection.html#M000050">connection_completed</a> @see <a
href="Connection.html#M000038">unbind</a> @see <a
href="Connection.html#M000048">send_data</a> @see <a
href="Connection.html#M000035">receive_data</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000030_source')" id="l_M000030_source">show</a>
                        
                    </p>
                    <div id="M000030_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/em/connection.rb, line 81</span>
81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post_init</span>
82:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000040">
                    
                    <a name="M000040"></a><b>proxy_completed</b>()
                    
                </div>
                
                <div class="description">
                  <p>
called when the reactor finished proxying all of the requested bytes.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000040_source')" id="l_M000040_source">show</a>
                        
                    </p>
                    <div id="M000040_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 224</span>
224:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy_completed</span>
225:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000041">
                    
                    <a name="M000041"></a><b>proxy_incoming_to</b>(conn,bufsize=0)
                    
                </div>
                
                <div class="description">
                  <p>
<a
href="Connection.html#M000041">EventMachine::Connection#proxy_incoming_to</a>
is called only by user code. It sets up a low-level proxy relay for all
data inbound for this connection, to the connection given as the argument.
This is essentially just a helper method for enable_proxy.
</p>
<p>
@see <a href="../EventMachine.html#M000535">EventMachine.enable_proxy</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000041_source')" id="l_M000041_source">show</a>
                        
                    </p>
                    <div id="M000041_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 232</span>
232:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy_incoming_to</span>(<span class="ruby-identifier">conn</span>,<span class="ruby-identifier">bufsize</span>=<span class="ruby-value">0</span>)
233:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">enable_proxy</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">conn</span>, <span class="ruby-identifier">bufsize</span>)
234:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000039">
                    
                    <a name="M000039"></a><b>proxy_target_unbound</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Called by the reactor after attempting to relay incoming data to a
descriptor (set as a proxy target descriptor with {<a
href="../EventMachine.html#M000535">EventMachine.enable_proxy</a>}) that
has already been closed.
</p>
<p>
@see <a href="../EventMachine.html#M000535">EventMachine.enable_proxy</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show</a>
                        
                    </p>
                    <div id="M000039_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 219</span>
219:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy_target_unbound</span>
220:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000035">
                    
                    <a name="M000035"></a><b>receive_data</b>(data)
                    
                </div>
                
                <div class="description">
                  <p>
Called by the event loop whenever data has been received by the network
connection. It is never called by user code. {<a
href="Connection.html#M000035">receive_data</a>} is called with a single
parameter, a String containing the network protocol data, which may of
course be binary. You will generally redefine this method to perform your
own processing of the incoming data.
</p>
<p>
Here&#8217;s a key point which is essential to understanding the
event-driven programming model: <em><a
href="../EventMachine.html">EventMachine</a> knows absolutely nothing about
the protocol which your code implements.</em> You must not make any
assumptions about the size of the incoming data packets, or about their
alignment on any particular intra-message or PDU boundaries (such as line
breaks). <a href="Connection.html#M000035">receive_data</a> can and will
send you arbitrary chunks of data, with the only guarantee being that the
data is presented to your code in the order it was collected from the
network. Don&#8217;t even assume that the chunks of data will correspond to
network packets, as <a href="../EventMachine.html">EventMachine</a> can and
will coalesce several incoming packets into one, to improve performance.
The implication for your code is that you generally will need to implement
some kind of a state machine in your redefined implementation of
receive_data. For a better understanding of this, read through the examples
of specific protocol handlers in <a
href="Protocols.html">EventMachine::Protocols</a>
</p>
<p>
The base-class implementation (which will be invoked only if you
didn&#8217;t override it in your protocol handler) simply prints incoming
data packet size to stdout.
</p>
<p>
@param [String] data Opaque incoming data. @note Depending on the protocol,
buffer sizes and OS networking stack configuration, incoming data may or
may not be &#8220;a complete message&#8221;.
</p>
<pre>
      It is up to this handler to detect content boundaries to determine whether all the content (for example, full HTTP request)
      has been received and can be processed.
</pre>
<p>
@see <a href="Connection.html#M000030">post_init</a> @see <a
href="Connection.html#M000050">connection_completed</a> @see <a
href="Connection.html#M000038">unbind</a> @see <a
href="Connection.html#M000048">send_data</a> @see file:<a
href="../../files/docs/GettingStarted_md.html">docs/GettingStarted.md</a>
<a href="../EventMachine.html">EventMachine</a> tutorial
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000035_source')" id="l_M000035_source">show</a>
                        
                    </p>
                    <div id="M000035_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 116</span>
116:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">receive_data</span> <span class="ruby-identifier">data</span>
117:       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;............&gt;&gt;&gt;#{data.length}&quot;</span>
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000075">
                    
                    <a name="M000075"></a><b>reconnect</b>(server, port)
                    
                </div>
                
                <div class="description">
                  <p>
Reconnect to a given host/port with the current instance
</p>
<p>
@param [String] server Hostname or IP address @param [Integer] port Port to
reconnect to
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000075_source')" id="l_M000075_source">show</a>
                        
                    </p>
                    <div id="M000075_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 616</span>
616:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reconnect</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
617:         <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">reconnect</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>, <span class="ruby-keyword kw">self</span>
618:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000083">
                    
                    <a name="M000083"></a><b>resume</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Resume a connection&#8217;s {<a
href="Connection.html#M000048">send_data</a>} and {<a
href="Connection.html#M000035">receive_data</a>} events. @see <a
href="Connection.html#M000082">pause</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000083_source')" id="l_M000083_source">show</a>
                        
                    </p>
                    <div id="M000083_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 690</span>
690:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resume</span>
691:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">resume_connection</span> <span class="ruby-ivar">@signature</span>
692:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000048">
                    
                    <a name="M000048"></a><b>send_data</b>(data)
                    
                </div>
                
                <div class="description">
                  <p>
Call this method to send data to the remote end of the network connection.
It takes a single String argument, which may contain binary data. Data is
buffered to be sent at the end of this event loop tick (cycle).
</p>
<p>
When used in a method that is event handler (for example, {<a
href="Connection.html#M000030">post_init</a>} or {<a
href="Connection.html#M000050">connection_completed</a>}, it will send data
to the other end of the connection that generated the event. You can also
call {<a href="Connection.html#M000048">send_data</a>} to write to other
connections. For more information see The Chat Server Example in the
{file:<a
href="../../files/docs/GettingStarted_md.html">docs/GettingStarted.md</a>
<a href="../EventMachine.html">EventMachine</a> tutorial}.
</p>
<p>
If you want to send some data and then immediately close the connection,
make sure to use {<a
href="Connection.html#M000047">close_connection_after_writing</a>} instead
of {<a href="Connection.html#M000043">close_connection</a>}.
</p>
<p>
@param [String] data Data to send asynchronously
</p>
<p>
@see file:<a
href="../../files/docs/GettingStarted_md.html">docs/GettingStarted.md</a>
<a href="../EventMachine.html">EventMachine</a> tutorial @see <a
href="Connection.html#M000035">Connection#receive_data</a> @see <a
href="Connection.html#M000030">Connection#post_init</a> @see <a
href="Connection.html#M000038">Connection#unbind</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000048_source')" id="l_M000048_source">show</a>
                        
                    </p>
                    <div id="M000048_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 318</span>
318:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_data</span> <span class="ruby-identifier">data</span>
319:       <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>
320:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:bytesize</span>)
321:       <span class="ruby-identifier">size</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">size</span>
322:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">send_data</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">size</span>
323:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000057">
                    
                    <a name="M000057"></a><b>send_datagram</b>(data, recipient_address, recipient_port)
                    
                </div>
                
                <div class="description">
                  <p>
Sends UDP messages.
</p>
<p>
This method may be called from any <a href="Connection.html">Connection</a>
object that refers to an open datagram socket (see <a
href="../EventMachine.html#M000518">EventMachine#open_datagram_socket</a>).
The method sends a UDP (datagram) packet containing the data you specify,
to a remote peer specified by the IP address and port that you give as
parameters to the method. Observe that you may send a zero-length packet
(empty string). However, you may not send an arbitrarily-large data packet
because your operating system will enforce a platform-specific limit on the
size of the outbound packet. (Your kernel will respond in a
platform-specific way if you send an overlarge packet: some will send a
truncated packet, some will complain, and some will silently drop your
request). On LANs, it&#8217;s usually OK to send datagrams up to about 4000
bytes in length, but to be really safe, send messages smaller than the
Ethernet-packet size (typically about 1400 bytes). Some very restrictive
WANs will either drop or truncate packets larger than about 500 bytes.
</p>
<p>
@param [String] data Data to send asynchronously @param [String]
recipient_address IP address of the recipient @param [String]
recipient_port Port of the recipient
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000057_source')" id="l_M000057_source">show</a>
                        
                    </p>
                    <div id="M000057_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 508</span>
508:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_datagram</span> <span class="ruby-identifier">data</span>, <span class="ruby-identifier">recipient_address</span>, <span class="ruby-identifier">recipient_port</span>
509:       <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>
510:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:bytesize</span>)
511:       <span class="ruby-identifier">size</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">size</span>
512:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">send_datagram</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">size</span>, <span class="ruby-identifier">recipient_address</span>, <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">recipient_port</span>)
513:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000076">
                    
                    <a name="M000076"></a><b>send_file_data</b>(filename)
                    
                </div>
                
                <div class="description">
                  <p>
Like {<a
href="Connection.html#M000048">EventMachine::Connection#send_data</a>},
this sends data to the remote end of the network connection. {<a
href="Connection.html#M000076">EventMachine::Connection#send_file_data</a>}
takes a filename as an argument, though, and sends the contents of the
file, in one chunk.
</p>
<p>
@param [String] filename Local path of the file to send
</p>
<p>
@see <a href="Connection.html#M000048">send_data</a> @author Kirk Haines
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000076_source')" id="l_M000076_source">show</a>
                        
                    </p>
                    <div id="M000076_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 630</span>
630:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_file_data</span> <span class="ruby-identifier">filename</span>
631:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">send_file_data</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">filename</span>
632:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000069">
                    
                    <a name="M000069"></a><b>set_comm_inactivity_timeout</b>(value)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Connection.html#M000065">comm_inactivity_timeout=</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000074">
                    
                    <a name="M000074"></a><b>set_pending_connect_timeout</b>(value)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Connection.html#M000073">pending_connect_timeout=</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M000046">
                    
                    <a name="M000046"></a><b>set_sock_opt</b>(level, optname, optval)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000046_source')" id="l_M000046_source">show</a>
                        
                    </p>
                    <div id="M000046_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 273</span>
273:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_sock_opt</span> <span class="ruby-identifier">level</span>, <span class="ruby-identifier">optname</span>, <span class="ruby-identifier">optval</span>
274:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_sock_opt</span> <span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">level</span>, <span class="ruby-identifier">optname</span>, <span class="ruby-identifier">optval</span>
275:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000036">
                    
                    <a name="M000036"></a><b>ssl_handshake_completed</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Called by <a href="../EventMachine.html">EventMachine</a> when the SSL/TLS
handshake has been completed, as a result of calling <a
href="Connection.html#M000051">start_tls</a> to initiate SSL/TLS on the
connection.
</p>
<p>
This callback exists because {<a
href="Connection.html#M000030">post_init</a>} and {<a
href="Connection.html#M000050">connection_completed</a>} are *<b>not</b>*
reliable for indicating when an SSL/TLS connection is ready to have its
certificate queried for.
</p>
<p>
@see <a href="Connection.html#M000055">get_peer_cert</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000036_source')" id="l_M000036_source">show</a>
                        
                    </p>
                    <div id="M000036_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 127</span>
127:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ssl_handshake_completed</span>
128:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000037">
                    
                    <a name="M000037"></a><b>ssl_verify_peer</b>(cert)
                    
                </div>
                
                <div class="description">
                  <p>
Called by <a href="../EventMachine.html">EventMachine</a> when :verify_peer
=> true has been passed to {<a
href="Connection.html#M000051">start_tls</a>}. It will be called with each
certificate in the certificate chain provided by the remote peer.
</p>
<p>
The cert will be passed as a String in PEM format, the same as in {<a
href="Connection.html#M000055">get_peer_cert</a>}. It is up to user defined
code to perform a check on the certificates. The return value from this
callback is used to accept or deny the peer. A return value that is not nil
or false triggers acceptance. If the peer is not accepted, the connection
will be subsequently closed.
</p>
<p>
@example This server always accepts all peers
</p>
<pre>
  module AcceptServer
    def post_init
      start_tls(:verify_peer =&gt; true)
    end

    def ssl_verify_peer(cert)
      true
    end

    def ssl_handshake_completed
      $server_handshake_completed = true
    end
  end
</pre>
<p>
@example This server never accepts any peers
</p>
<pre>
  module DenyServer
    def post_init
      start_tls(:verify_peer =&gt; true)
    end

    def ssl_verify_peer(cert)
      # Do not accept the peer. This should now cause the connection to shut down
      # without the SSL handshake being completed.
      false
    end

    def ssl_handshake_completed
      $server_handshake_completed = true
    end
  end
</pre>
<p>
@see <a href="Connection.html#M000051">start_tls</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show</a>
                        
                    </p>
                    <div id="M000037_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 174</span>
174:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ssl_verify_peer</span>(<span class="ruby-identifier">cert</span>)
175:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000051">
                    
                    <a name="M000051"></a><b>start_tls</b>(args={})
                    
                </div>
                
                <div class="description">
                  <p>
Call {<a href="Connection.html#M000051">start_tls</a>} at any point to
initiate TLS encryption on connected streams. The method is smart enough to
know whether it should perform a server-side or a client-side handshake. An
appropriate place to call {<a href="Connection.html#M000051">start_tls</a>}
is in your redefined {<a href="Connection.html#M000030">post_init</a>}
method, or in the {<a
href="Connection.html#M000050">connection_completed</a>} handler for an
outbound connection.
</p>
<p>
@option args [String] :cert_chain_file (nil) local path of a readable file
that contants a chain of X509 certificates in
</p>
<pre>
                                             the [PEM format](http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail),
                                             with the most-resolved certificate at the top of the file, successive intermediate
                                             certs in the middle, and the root (or CA) cert at the bottom.
</pre>
<p>
@option args [String] :private_key_file (nil) local path of a readable file
that must contain a private key in the [PEM format](<a
href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">en.wikipedia.org/wiki/Privacy_Enhanced_Mail</a>).
</p>
<p>
@option args [String] :verify_peer (false) indicates whether a server
should request a certificate from a peer, to be verified by user code.
</p>
<pre>
                                              If true, the {#ssl_verify_peer} callback on the {EventMachine::Connection} object is called with each certificate
                                              in the certificate chain provided by the peer. See documentation on {#ssl_verify_peer} for how to use this.
</pre>
<p>
@example Using TLS with <a href="../EventMachine.html">EventMachine</a>
</p>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module Handler
   def post_init
     start_tls(:private_key_file =&gt; '/tmp/server.key', :cert_chain_file =&gt; '/tmp/server.crt', :verify_peer =&gt; false)
   end
 end

  EventMachine.run do
   EventMachine.start_server(&quot;127.0.0.1&quot;, 9999, Handler)
 end
</pre>
<p>
@param [Hash] args
</p>
<p>
@todo support passing an encryption parameter, which can be string or Proc,
to get a passphrase for encrypted private keys. @todo support passing key
material via raw strings or Procs that return strings instead of just
filenames.
</p>
<p>
@see <a href="Connection.html#M000037">ssl_verify_peer</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000051_source')" id="l_M000051_source">show</a>
                        
                    </p>
                    <div id="M000051_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 400</span>
400:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">start_tls</span> <span class="ruby-identifier">args</span>={}
401:       <span class="ruby-identifier">priv_key</span>, <span class="ruby-identifier">cert_chain</span>, <span class="ruby-identifier">verify_peer</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-identifier">:private_key_file</span>, <span class="ruby-identifier">:cert_chain_file</span>, <span class="ruby-identifier">:verify_peer</span>)
402: 
403:       [<span class="ruby-identifier">priv_key</span>, <span class="ruby-identifier">cert_chain</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
404:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">empty?</span>
405:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">FileNotFoundException</span>,
406:         <span class="ruby-node">&quot;Could not find #{file} for start_tls&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-identifier">file</span>
407:       <span class="ruby-keyword kw">end</span>
408: 
409:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_tls_parms</span>(<span class="ruby-ivar">@signature</span>, <span class="ruby-identifier">priv_key</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">cert_chain</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">verify_peer</span>)
410:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">start_tls</span> <span class="ruby-ivar">@signature</span>
411:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000042">
                    
                    <a name="M000042"></a><b>stop_proxying</b>()
                    
                </div>
                
                <div class="description">
                  <p>
A helper method for {<a
href="../EventMachine.html#M000536">EventMachine.disable_proxy</a>}
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000042_source')" id="l_M000042_source">show</a>
                        
                    </p>
                    <div id="M000042_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 237</span>
237:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop_proxying</span>
238:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">disable_proxy</span>(<span class="ruby-keyword kw">self</span>)
239:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000077">
                    
                    <a name="M000077"></a><b>stream_file_data</b>(filename, args={})
                    
                </div>
                
                <div class="description">
                  <p>
Open a file on the filesystem and send it to the remote peer. This returns
an object of type {EventMachine::Deferrable}. The object&#8217;s callbacks
will be executed on the reactor main thread when the file has been
completely scheduled for transmission to the remote peer. Its errbacks will
be called in case of an error (such as file-not-found). This method employs
various strategies to achieve the fastest possible performance, balanced
against minimum consumption of memory.
</p>
<p>
Warning: this feature has an implicit dependency on an outboard extension,
evma_fastfilereader. You must install this extension in order to use {<a
href="Connection.html#M000077">stream_file_data</a>} with files larger than
a certain size (currently 8192 bytes).
</p>
<p>
@option args [Boolean] :http_chunks (false) If true, this method will
stream the file data in a format
</p>
<pre>
                                            compatible with the HTTP chunked-transfer encoding
</pre>
<p>
@param [String] filename Local path of the file to stream @param [Hash]
args Options
</p>
<p>
@return [EventMachine::Deferrable]
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000077_source')" id="l_M000077_source">show</a>
                        
                    </p>
                    <div id="M000077_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 652</span>
652:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stream_file_data</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">args</span>={}
653:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-constant">FileStreamer</span>.<span class="ruby-identifier">new</span>( <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">args</span> )
654:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000038">
                    
                    <a name="M000038"></a><b>unbind</b>()
                    
                </div>
                
                <div class="description">
                  <p>
called by the framework whenever a connection (either a server or client
connection) is closed. The close can occur because your code intentionally
closes it (using {<a href="Connection.html#M000043">close_connection</a>}
and {<a
href="Connection.html#M000047">close_connection_after_writing</a>}),
because the remote peer closed the connection, or because of a network
error. You may not assume that the network connection is still open and
able to send or receive data when the callback to unbind is made. This is
intended only to give you a chance to clean up associations your code may
have made to the connection object while it was open.
</p>
<p>
If you want to detect which peer has closed the connection, you can
override {<a href="Connection.html#M000043">close_connection</a>} in your
protocol handler and set an @ivar.
</p>
<p>
@example Overriding <a
href="Connection.html#M000043">Connection#close_connection</a> to
distinguish connections closed on our side
</p>
<pre>
  class MyProtocolHandler &lt; EventMachine::Connection

    # ...

    def close_connection(*args)
      @intentionally_closed_connection = true
      super(*args)
    end

    def unbind
      if @intentionally_closed_connection
        # ...
      end
    end

    # ...

  end
</pre>
<p>
@see <a href="Connection.html#M000030">post_init</a> @see <a
href="Connection.html#M000050">connection_completed</a> @see file:<a
href="../../files/docs/GettingStarted_md.html">docs/GettingStarted.md</a>
<a href="../EventMachine.html">EventMachine</a> tutorial
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000038_source')" id="l_M000038_source">show</a>
                        
                    </p>
                    <div id="M000038_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/em/connection.rb, line 212</span>
212:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unbind</span>
213:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    