<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::RDoc</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::RDoc 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rdoc/rdoc_rb.html">lib/rdoc/rdoc.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Encapsulate the production of rdoc documentation. Basically you can use
this as you would invoke rdoc from the command line:
</p>
<pre>
  rdoc = RDoc::RDoc.new
  rdoc.document(args)
</pre>
<p>
Where <tt>args</tt> is an array of strings, each corresponding to an
argument you&#8217;d give rdoc on the command line. See <tt>rdoc
&#8212;help<tt> for details.
</p>
<h1>Plugins</h1>
<p>
When you <tt>require 'rdoc/rdoc'</tt> <a href="RDoc.html">RDoc</a> looks
for &#8216;rdoc/discover&#8217; files in your installed gems. This can be
used to load alternate generators or add additional preprocessor
directives.
</p>
<p>
You will want to wrap your plugin loading in an <a
href="RDoc.html">RDoc</a> version check. Something like:
</p>
<pre>
  begin
    gem 'rdoc', '~&gt; 3'
    require 'path/to/my/awesome/rdoc/plugin'
  rescue Gem::LoadError
  end
</pre>
<p>
The most obvious plugin type is a new output generator. See <a
href="Generator.html">RDoc::Generator</a> for details.
</p>
<p>
You can also hook into <a href="Markup.html">RDoc::Markup</a> to add new
directives (:nodoc: is a directive). See RDoc::Markup::PreProcess::register
for details.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M004591">add_generator</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M004592">current</a>,</li>
                
                <li><a href="#M004593">current=</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M004612">document</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M004596">error</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M004597">gather_files</a>,</li>
                
                <li><a href="#M004615">generate</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M004598">handle_pipe</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M004599">install_siginfo_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M004606">list_files_in_directory</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M004595">new</a>,</li>
                
                <li><a href="#M004604">normalized_file_list</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M004602">output_flag_file</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M004603">parse_dot_doc_file</a>,</li>
                
                <li><a href="#M004607">parse_file</a>,</li>
                
                <li><a href="#M004609">parse_files</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M004616">remove_siginfo_handler</a>,</li>
                
                <li><a href="#M004611">remove_unparseable</a>,</li>
                
                <li><a href="#M004594">reset</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M004600">setup_output_dir</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M004601">update_output_dir</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">GENERATORS</td>
            <td>=</td>
            <td class="attr-value">{}</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
This is the list of supported output generators
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>exclude</td>
            <td class='attr-desc'><p>
<a href="../File.html">File</a> pattern to exclude
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>generator</td>
            <td class='attr-desc'><p>
<a href="Generator.html">Generator</a> instance used for creating output
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>last_modified</td>
            <td class='attr-desc'><p>
<a href="../Hash.html">Hash</a> of files and their last modified times.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>
<a href="RDoc.html">RDoc</a> options
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>stats</td>
            <td class='attr-desc'><p>
Accessor for statistics. Available after each call to <a
href="RDoc.html#M004609">parse_files</a>
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M004591">
                    
                    <a name="M004591"></a><b>add_generator</b>(klass)
                    
                </div>
                
                <div class="description">
                  <p>
Add <tt>klass</tt> that can generate output after parsing
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004591_source')" id="l_M004591_source">show</a>
                        
                    </p>
                    <div id="M004591_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 84</span>
84:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_generator</span>(<span class="ruby-identifier">klass</span>)
85:     <span class="ruby-identifier">name</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^RDoc::Generator::/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">downcase</span>
86:     <span class="ruby-constant">GENERATORS</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">klass</span>
87:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004592">
                    
                    <a name="M004592"></a><b>current</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Active <a href="RDoc.html">RDoc::RDoc</a> instance
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004592_source')" id="l_M004592_source">show</a>
                        
                    </p>
                    <div id="M004592_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current</span>
93:     <span class="ruby-ivar">@current</span>
94:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004593">
                    
                    <a name="M004593"></a><b>current=</b>(rdoc)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the active <a href="RDoc.html">RDoc::RDoc</a> instance
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004593_source')" id="l_M004593_source">show</a>
                        
                    </p>
                    <div id="M004593_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 99</span>
 99:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current=</span>(<span class="ruby-identifier">rdoc</span>)
100:     <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">rdoc</span>
101:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004595">
                    
                    <a name="M004595"></a><b>new</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Creates a new <a href="RDoc.html">RDoc::RDoc</a> instance. Call <a
href="RDoc.html#M004612">document</a> to parse files and generate
documentation.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004595_source')" id="l_M004595_source">show</a>
                        
                    </p>
                    <div id="M004595_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 115</span>
115:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>
116:     <span class="ruby-ivar">@current</span>       = <span class="ruby-keyword kw">nil</span>
117:     <span class="ruby-ivar">@exclude</span>       = <span class="ruby-keyword kw">nil</span>
118:     <span class="ruby-ivar">@generator</span>     = <span class="ruby-keyword kw">nil</span>
119:     <span class="ruby-ivar">@last_modified</span> = {}
120:     <span class="ruby-ivar">@old_siginfo</span>   = <span class="ruby-keyword kw">nil</span>
121:     <span class="ruby-ivar">@options</span>       = <span class="ruby-keyword kw">nil</span>
122:     <span class="ruby-ivar">@stats</span>         = <span class="ruby-keyword kw">nil</span>
123:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004594">
                    
                    <a name="M004594"></a><b>reset</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Resets all internal state
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004594_source')" id="l_M004594_source">show</a>
                        
                    </p>
                    <div id="M004594_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reset</span>
107:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">reset</span>
108:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">C</span>.<span class="ruby-identifier">reset</span>
109:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M004612">
                    
                    <a name="M004612"></a><b>document</b>(options)
                    
                </div>
                
                <div class="description">
                  <p>
Generates documentation or a coverage report depending upon the settings in
<tt>options</tt>.
</p>
<p>
<tt>options</tt> can be either an <a href="Options.html">RDoc::Options</a>
instance or an array of strings equivalent to the strings that would be
passed on the command line like <tt>%w[-q -o doc -t My\ Doc\ Title]</tt>.
<a href="RDoc.html#M004612">document</a> will automatically call <a
href="Options.html#M004509">RDoc::Options#finish</a> if an options instance
was given.
</p>
<p>
For a list of options, see either <a href="Options.html">RDoc::Options</a>
or <tt>rdoc --help</tt>.
</p>
<p>
By default, output will be stored in a directory called &#8220;doc&#8221;
below the current directory, so make sure you&#8217;re somewhere writable
before invoking.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004612_source')" id="l_M004612_source">show</a>
                        
                    </p>
                    <div id="M004612_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 412</span>
412:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">document</span> <span class="ruby-identifier">options</span>
413:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">reset</span>
414: 
415:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span> <span class="ruby-keyword kw">then</span>
416:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
417:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">finish</span>
418:     <span class="ruby-keyword kw">else</span>
419:       <span class="ruby-ivar">@options</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>.<span class="ruby-identifier">new</span>
420:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">options</span>
421:     <span class="ruby-keyword kw">end</span>
422: 
423:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">pipe</span> <span class="ruby-keyword kw">then</span>
424:       <span class="ruby-identifier">handle_pipe</span>
425:       <span class="ruby-identifier">exit</span>
426:     <span class="ruby-keyword kw">end</span>
427: 
428:     <span class="ruby-ivar">@exclude</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>
429: 
430:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">then</span>
431:       <span class="ruby-ivar">@last_modified</span> = <span class="ruby-identifier">setup_output_dir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_update</span>
432:     <span class="ruby-keyword kw">end</span>
433: 
434:     <span class="ruby-ivar">@start_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
435: 
436:     <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">parse_files</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">files</span>
437: 
438:     <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-value str">&quot;RDoc Documentation&quot;</span>
439: 
440:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">complete</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">visibility</span>
441: 
442:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">coverage_level</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>
443: 
444:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">then</span>
445:       <span class="ruby-identifier">puts</span>
446: 
447:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">report</span>
448:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">file_info</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">then</span>
449:       <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;\nNo newer files.&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
450:     <span class="ruby-keyword kw">else</span>
451:       <span class="ruby-identifier">gen_klass</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">generator</span>
452: 
453:       <span class="ruby-ivar">@generator</span> = <span class="ruby-identifier">gen_klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@options</span>
454: 
455:       <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
456:     <span class="ruby-keyword kw">end</span>
457: 
458:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@stats</span> <span class="ruby-keyword kw">and</span> (<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>) <span class="ruby-keyword kw">then</span>
459:       <span class="ruby-identifier">puts</span>
460:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">summary</span>
461:     <span class="ruby-keyword kw">end</span>
462: 
463:     <span class="ruby-identifier">exit</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">fully_documented?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>
464:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004596">
                    
                    <a name="M004596"></a><b>error</b>(msg)
                    
                </div>
                
                <div class="description">
                  <p>
Report an error message and exit
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004596_source')" id="l_M004596_source">show</a>
                        
                    </p>
                    <div id="M004596_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>(<span class="ruby-identifier">msg</span>)
129:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-identifier">msg</span>
130:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004597">
                    
                    <a name="M004597"></a><b>gather_files</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Gathers a set of parseable files from the files and directories listed in
<tt>files</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004597_source')" id="l_M004597_source">show</a>
                        
                    </p>
                    <div id="M004597_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 136</span>
136:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
137:     <span class="ruby-identifier">files</span> = [<span class="ruby-value str">&quot;.&quot;</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">empty?</span>
138: 
139:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-ivar">@exclude</span>
140: 
141:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">uniq</span>
142: 
143:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">file_list</span>
144:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004615">
                    
                    <a name="M004615"></a><b>generate</b>(file_info)
                    
                </div>
                
                <div class="description">
                  <p>
Generates documentation for <tt>file_info</tt> (from <a
href="RDoc.html#M004609">parse_files</a>) into the output dir using the
generator selected by the <a href="RDoc.html">RDoc</a> options
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004615_source')" id="l_M004615_source">show</a>
                        
                    </p>
                    <div id="M004615_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 471</span>
471:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
472:     <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span> <span class="ruby-keyword kw">do</span>
473:       <span class="ruby-keyword kw">begin</span>
474:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword kw">self</span>
475: 
476:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span> <span class="ruby-keyword kw">then</span>
477:           <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nGenerating #{@generator.class.name.sub(/^.*::/, '')} format into #{Dir.pwd}...&quot;</span>
478:         <span class="ruby-keyword kw">end</span>
479: 
480:         <span class="ruby-ivar">@generator</span>.<span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
481:         <span class="ruby-identifier">update_output_dir</span> <span class="ruby-value str">'.'</span>, <span class="ruby-ivar">@start_time</span>, <span class="ruby-ivar">@last_modified</span>
482:       <span class="ruby-keyword kw">ensure</span>
483:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword kw">nil</span>
484:       <span class="ruby-keyword kw">end</span>
485:     <span class="ruby-keyword kw">end</span>
486:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004598">
                    
                    <a name="M004598"></a><b>handle_pipe</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Turns <a href="RDoc.html">RDoc</a> from stdin into HTML
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004598_source')" id="l_M004598_source">show</a>
                        
                    </p>
                    <div id="M004598_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 149</span>
149:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_pipe</span>
150:     <span class="ruby-ivar">@html</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">ToHtml</span>.<span class="ruby-identifier">new</span>
151: 
152:     <span class="ruby-identifier">out</span> = <span class="ruby-ivar">@html</span>.<span class="ruby-identifier">convert</span> <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">read</span>
153: 
154:     <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">out</span>
155:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004599">
                    
                    <a name="M004599"></a><b>install_siginfo_handler</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Installs a siginfo handler that prints the current filename.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004599_source')" id="l_M004599_source">show</a>
                        
                    </p>
                    <div id="M004599_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 160</span>
160:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install_siginfo_handler</span>
161:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">'INFO'</span>
162: 
163:     <span class="ruby-ivar">@old_siginfo</span> = <span class="ruby-identifier">trap</span> <span class="ruby-value str">'INFO'</span> <span class="ruby-keyword kw">do</span>
164:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@current</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@current</span>
165:     <span class="ruby-keyword kw">end</span>
166:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004606">
                    
                    <a name="M004606"></a><b>list_files_in_directory</b>(dir)
                    
                </div>
                
                <div class="description">
                  <p>
Return a list of the files to be processed in a directory. We know that
this directory doesn&#8217;t have a .document file, so we&#8217;re looking
for real files. However we may well contain subdirectories which must be
tested for .document files.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004606_source')" id="l_M004606_source">show</a>
                        
                    </p>
                    <div id="M004606_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 308</span>
308:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_files_in_directory</span> <span class="ruby-identifier">dir</span>
309:     <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-value str">&quot;*&quot;</span>)
310: 
311:     <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>
312:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004604">
                    
                    <a name="M004604"></a><b>normalized_file_list</b>(relative_files, force_doc = false, exclude_pattern = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Given a list of files and directories, create a list of all the Ruby files
they contain.
</p>
<p>
If <tt>force_doc</tt> is true we always add the given files, if false, only
add files that we guarantee we can parse. It is true when looking at files
given on the command line, false when recursing through subdirectories.
</p>
<p>
The effect of this is that if you want a file with a non-standard extension
parsed, you must name it explicitly.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004604_source')" id="l_M004604_source">show</a>
                        
                    </p>
                    <div id="M004604_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 267</span>
267:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">relative_files</span>, <span class="ruby-identifier">force_doc</span> = <span class="ruby-keyword kw">false</span>,
268:                            <span class="ruby-identifier">exclude_pattern</span> = <span class="ruby-keyword kw">nil</span>)
269:     <span class="ruby-identifier">file_list</span> = []
270: 
271:     <span class="ruby-identifier">relative_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel_file_name</span><span class="ruby-operator">|</span>
272:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">rel_file_name</span>
273:       <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">next</span>
274: 
275:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">ftype</span>
276:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;file&quot;</span> <span class="ruby-keyword kw">then</span>
277:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">last_modified</span> = <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] <span class="ruby-keyword kw">and</span>
278:                 <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">last_modified</span>.<span class="ruby-identifier">to_i</span>
279: 
280:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">force_doc</span> <span class="ruby-keyword kw">or</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">can_parse</span>(<span class="ruby-identifier">rel_file_name</span>) <span class="ruby-keyword kw">then</span>
281:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rel_file_name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\.\//</span>, <span class="ruby-value str">''</span>)
282:           <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>
283:         <span class="ruby-keyword kw">end</span>
284:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;directory&quot;</span> <span class="ruby-keyword kw">then</span>
285:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;CVS&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.svn&quot;</span>
286: 
287:         <span class="ruby-identifier">dot_doc</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">rel_file_name</span>, <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">DOT_DOC_FILENAME</span>
288: 
289:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span> <span class="ruby-identifier">dot_doc</span> <span class="ruby-keyword kw">then</span>
290:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parse_dot_doc_file</span>(<span class="ruby-identifier">rel_file_name</span>, <span class="ruby-identifier">dot_doc</span>)
291:         <span class="ruby-keyword kw">else</span>
292:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">list_files_in_directory</span>(<span class="ruby-identifier">rel_file_name</span>)
293:         <span class="ruby-keyword kw">end</span>
294:       <span class="ruby-keyword kw">else</span>
295:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;I can't deal with a #{type} #{rel_file_name}&quot;</span>
296:       <span class="ruby-keyword kw">end</span>
297:     <span class="ruby-keyword kw">end</span>
298: 
299:     <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">flatten</span>
300:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004602">
                    
                    <a name="M004602"></a><b>output_flag_file</b>(op_dir)
                    
                </div>
                
                <div class="description">
                  <p>
Return the path name of the flag file in an output directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004602_source')" id="l_M004602_source">show</a>
                        
                    </p>
                    <div id="M004602_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 232</span>
232:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>)
233:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">op_dir</span>, <span class="ruby-value str">&quot;created.rid&quot;</span>
234:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004603">
                    
                    <a name="M004603"></a><b>parse_dot_doc_file</b>(in_dir, filename)
                    
                </div>
                
                <div class="description">
                  <p>
The .document file contains a list of file and directory name patterns,
representing candidates for documentation. It may also contain comments
(starting with &#8217;#&#8217;)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004603_source')" id="l_M004603_source">show</a>
                        
                    </p>
                    <div id="M004603_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 241</span>
241:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_dot_doc_file</span> <span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">filename</span>
242:     <span class="ruby-comment cmt"># read and strip comments</span>
243:     <span class="ruby-identifier">patterns</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/#.*/</span>, <span class="ruby-value str">''</span>)
244: 
245:     <span class="ruby-identifier">result</span> = []
246: 
247:     <span class="ruby-identifier">patterns</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">patt</span><span class="ruby-operator">|</span>
248:       <span class="ruby-identifier">candidates</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">patt</span>))
249:       <span class="ruby-identifier">result</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">candidates</span>)
250:     <span class="ruby-keyword kw">end</span>
251: 
252:     <span class="ruby-identifier">result</span>
253:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004607">
                    
                    <a name="M004607"></a><b>parse_file</b>(filename)
                    
                </div>
                
                <div class="description">
                  <p>
Parses <tt>filename</tt> and returns an <a
href="TopLevel.html">RDoc::TopLevel</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004607_source')" id="l_M004607_source">show</a>
                        
                    </p>
                    <div id="M004607_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 317</span>
317:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
318:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-keyword kw">then</span>
319:       <span class="ruby-identifier">encoding</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">encoding</span>
320:       <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">encode</span> <span class="ruby-identifier">encoding</span>
321:     <span class="ruby-keyword kw">end</span>
322: 
323:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">add_file</span> <span class="ruby-identifier">filename</span>
324: 
325:     <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">encoding</span>
326: 
327:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">content</span>
328: 
329:     <span class="ruby-identifier">top_level</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">filename</span>
330: 
331:     <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">for</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">content</span>, <span class="ruby-ivar">@options</span>, <span class="ruby-ivar">@stats</span>
332: 
333:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parser</span>
334: 
335:     <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">scan</span>
336: 
337:     <span class="ruby-comment cmt"># restart documentation for the classes &amp; modules found</span>
338:     <span class="ruby-identifier">top_level</span>.<span class="ruby-identifier">classes_or_modules</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cm</span><span class="ruby-operator">|</span>
339:       <span class="ruby-identifier">cm</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword kw">false</span>
340:     <span class="ruby-keyword kw">end</span>
341: 
342:     <span class="ruby-identifier">top_level</span>
343: 
344:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
345:     <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Before reporting this, could you check that the file you're documenting\nhas proper syntax:\n\n\#{Gem.ruby} -c \#{filename}\n\nRDoc is not a full Ruby parser and will fail when fed invalid ruby programs.\n\nThe internal error was:\n\n\\t(\#{e.class}) \#{e.message}\n\n&quot;</span>
346: 
347:     <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n\t&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG_RDOC</span>
348: 
349:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
350:     <span class="ruby-keyword kw">nil</span>
351:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004609">
                    
                    <a name="M004609"></a><b>parse_files</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Parse each file on the command line, recursively entering directories.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004609_source')" id="l_M004609_source">show</a>
                        
                    </p>
                    <div id="M004609_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 369</span>
369:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_files</span> <span class="ruby-identifier">files</span>
370:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
371:     <span class="ruby-ivar">@stats</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Stats</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">size</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">verbosity</span>
372: 
373:     <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">empty?</span>
374: 
375:     <span class="ruby-identifier">file_info</span> = []
376: 
377:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">begin_adding</span>
378: 
379:     <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
380:       <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">filename</span>
381:       <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
382:     <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">compact</span>
383: 
384:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">done_adding</span>
385: 
386:     <span class="ruby-identifier">file_info</span>
387:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004616">
                    
                    <a name="M004616"></a><b>remove_siginfo_handler</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Removes a siginfo handler and replaces the previous
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004616_source')" id="l_M004616_source">show</a>
                        
                    </p>
                    <div id="M004616_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 491</span>
491:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_siginfo_handler</span>
492:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">key?</span> <span class="ruby-value str">'INFO'</span>
493: 
494:     <span class="ruby-identifier">handler</span> = <span class="ruby-ivar">@old_siginfo</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'DEFAULT'</span>
495: 
496:     <span class="ruby-identifier">trap</span> <span class="ruby-value str">'INFO'</span>, <span class="ruby-identifier">handler</span>
497:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004611">
                    
                    <a name="M004611"></a><b>remove_unparseable</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Removes file extensions known to be unparseable from <tt>files</tt>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004611_source')" id="l_M004611_source">show</a>
                        
                    </p>
                    <div id="M004611_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 392</span>
392:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">files</span>
393:     <span class="ruby-identifier">files</span>.<span class="ruby-identifier">reject</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
394:       <span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.(?:class|eps|erb|scpt\.txt|ttf|yml)$/i</span>
395:     <span class="ruby-keyword kw">end</span>
396:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004600">
                    
                    <a name="M004600"></a><b>setup_output_dir</b>(dir, force)
                    
                </div>
                
                <div class="description">
                  <p>
Create an output dir if it doesn&#8217;t exist. If it does exist, but
doesn&#8217;t contain the flag file <tt>created.rid</tt> then we refuse to
use it, as we may clobber some manually generated documentation
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004600_source')" id="l_M004600_source">show</a>
                        
                    </p>
                    <div id="M004600_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 173</span>
173:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup_output_dir</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">force</span>)
174:     <span class="ruby-identifier">flag_file</span> = <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>
175: 
176:     <span class="ruby-identifier">last</span> = {}
177: 
178:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword kw">then</span>
179:       <span class="ruby-comment cmt"># do nothing</span>
180:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dir</span> <span class="ruby-keyword kw">then</span>
181:       <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;#{dir} exists and is not a directory&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">dir</span>
182: 
183:       <span class="ruby-keyword kw">begin</span>
184:         <span class="ruby-identifier">open</span> <span class="ruby-identifier">flag_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
185:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">force</span> <span class="ruby-keyword kw">then</span>
186:             <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">gets</span>
187: 
188:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
189:               <span class="ruby-identifier">file</span>, <span class="ruby-identifier">time</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span> <span class="ruby-value str">&quot;\t&quot;</span>, <span class="ruby-value">2</span>
190:               <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">time</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">next</span>
191:               <span class="ruby-identifier">last</span>[<span class="ruby-identifier">file</span>] = <span class="ruby-identifier">time</span>
192:             <span class="ruby-keyword kw">end</span>
193:           <span class="ruby-keyword kw">end</span>
194:         <span class="ruby-keyword kw">end</span>
195:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">TypeError</span>
196:         <span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;\nDirectory \#{dir} already exists, but it looks like it isn't an RDoc directory.\n\nBecause RDoc doesn't want to risk destroying any of your existing files,\nyou'll need to specify a different output directory name (using the --op &lt;dir&gt;\noption)\n\n&quot;</span>
197:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_output</span>
198:     <span class="ruby-keyword kw">else</span>
199:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span>
200:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">touch</span> <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>
201:     <span class="ruby-keyword kw">end</span>
202: 
203:     <span class="ruby-identifier">last</span>
204:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004601">
                    
                    <a name="M004601"></a><b>update_output_dir</b>(op_dir, time, last = {})
                    
                </div>
                
                <div class="description">
                  <p>
Update the flag file in an output directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004601_source')" id="l_M004601_source">show</a>
                        
                    </p>
                    <div id="M004601_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 218</span>
218:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_output_dir</span>(<span class="ruby-identifier">op_dir</span>, <span class="ruby-identifier">time</span>, <span class="ruby-identifier">last</span> = {})
219:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">update_output_dir</span>
220: 
221:     <span class="ruby-identifier">open</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>), <span class="ruby-value str">&quot;w&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
222:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">rfc2822</span>
223:       <span class="ruby-identifier">last</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
224:         <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{n}\t#{t.rfc2822}&quot;</span>
225:       <span class="ruby-keyword kw">end</span>
226:     <span class="ruby-keyword kw">end</span>
227:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    