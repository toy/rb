<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::Markup::PreProcess</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::Markup::PreProcess 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/rdoc/markup/pre_process_rb.html">lib/rdoc/markup/pre_process.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Handle common directives that can occur in a block of text:
</p>
<pre>
  \:include: filename
</pre>
<p>
Directives can be escaped by preceding them with a backslash.
</p>
<p>
<a href="../RDoc.html">RDoc</a> plugin authors can register additional
directives to be handled by using RDoc::Markup::PreProcess::register
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M004365">find_include_file</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M004357">handle</a>,</li>
                
                <li><a href="#M004358">handle_directive</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M004364">include_file</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M004356">new</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M004354">register</a>,</li>
                
                <li><a href="#M004355">registered</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M004356">
                    
                    <a name="M004356"></a><b>new</b>(input_file_name, include_path)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a new pre-processor for <tt>input_file_name</tt> that will look for
included files in <tt>include_path</tt>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004356_source')" id="l_M004356_source">show</a>
                        
                    </p>
                    <div id="M004356_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 40</span>
40:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">input_file_name</span>, <span class="ruby-identifier">include_path</span>)
41:     <span class="ruby-ivar">@input_file_name</span> = <span class="ruby-identifier">input_file_name</span>
42:     <span class="ruby-ivar">@include_path</span> = <span class="ruby-identifier">include_path</span>
43:     <span class="ruby-ivar">@options</span> = <span class="ruby-keyword kw">nil</span>
44:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004354">
                    
                    <a name="M004354"></a><b>register</b>(directive, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Registers <tt>directive</tt> as one handled by <a
href="../RDoc.html">RDoc</a>. If a block is given the directive will be
replaced by the result of the block, otherwise the directive will be
removed from the processed text.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004354_source')" id="l_M004354_source">show</a>
                        
                    </p>
                    <div id="M004354_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 25</span>
25:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">register</span> <span class="ruby-identifier">directive</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
26:     <span class="ruby-ivar">@registered</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">block</span>
27:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004355">
                    
                    <a name="M004355"></a><b>registered</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Registered directives
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004355_source')" id="l_M004355_source">show</a>
                        
                    </p>
                    <div id="M004355_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">registered</span>
33:     <span class="ruby-ivar">@registered</span>
34:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M004365">
                    
                    <a name="M004365"></a><b>find_include_file</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Look for the given file in the directory containing the current file, and
then in each of the directories specified in the RDOC_INCLUDE path
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004365_source')" id="l_M004365_source">show</a>
                        
                    </p>
                    <div id="M004365_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 216</span>
216:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_include_file</span>(<span class="ruby-identifier">name</span>)
217:     <span class="ruby-identifier">to_search</span> = [<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-ivar">@input_file_name</span>)].<span class="ruby-identifier">concat</span> <span class="ruby-ivar">@include_path</span>
218:     <span class="ruby-identifier">to_search</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
219:       <span class="ruby-identifier">full_name</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">name</span>)
220:       <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">full_name</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">next</span>
221:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">readable?</span>
222:     <span class="ruby-keyword kw">end</span>
223:     <span class="ruby-keyword kw">nil</span>
224:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004357">
                    
                    <a name="M004357"></a><b>handle</b>(text, code_object = nil, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Look for directives in a chunk of <tt>text</tt>.
</p>
<p>
<a href="../Options.html">Options</a> that we don&#8217;t handle are
yielded. If the block returns false the directive is restored to the text.
If the block returns nil or no block was given the directive is handled
according to the registered directives. If a <a
href="../../String.html">String</a> was returned the directive is replaced
with the string.
</p>
<p>
If no matching directive was registered the directive is restored to the
text.
</p>
<p>
If <tt>code_object</tt> is given and the param is set as metadata on the
<tt>code_object</tt>. See <a
href="../CodeObject.html#metadata">RDoc::CodeObject#metadata</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004357_source')" id="l_M004357_source">show</a>
                        
                    </p>
                    <div id="M004357_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
61:     <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">encoding</span> <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">end</span>
62:     <span class="ruby-comment cmt"># regexp helper (square brackets for optional)</span>
63:     <span class="ruby-comment cmt"># $1      $2  $3        $4      $5</span>
64:     <span class="ruby-comment cmt"># [prefix][\]:directive:[spaces][param]newline</span>
65:     <span class="ruby-identifier">text</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^([ \t]*(?:#|\/?\*)?[ \t]*)(\\?):(\w+):([ \t]*)(.+)?\n/</span>) <span class="ruby-keyword kw">do</span>
66:       <span class="ruby-comment cmt"># skip something like ':toto::'</span>
67:       <span class="ruby-keyword kw">next</span> <span class="ruby-identifier">$&amp;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$4</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">$5</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">$5</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">':'</span>
68: 
69:       <span class="ruby-comment cmt"># skip if escaped</span>
70:       <span class="ruby-keyword kw">next</span> <span class="ruby-value str">&quot;#$1:#$3:#$4#$5\n&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">empty?</span>
71: 
72:       <span class="ruby-identifier">handle_directive</span> <span class="ruby-identifier">$1</span>, <span class="ruby-identifier">$3</span>, <span class="ruby-identifier">$5</span>, <span class="ruby-identifier">code_object</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
73:     <span class="ruby-keyword kw">end</span>
74: 
75:     <span class="ruby-identifier">text</span>
76:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004358">
                    
                    <a name="M004358"></a><b>handle_directive</b>(prefix, directive, param, code_object = nil, encoding = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004358_source')" id="l_M004358_source">show</a>
                        
                    </p>
                    <div id="M004358_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 81</span>
 81:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_directive</span> <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword kw">nil</span>,
 82:                        <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword kw">nil</span>
 83:     <span class="ruby-identifier">blankline</span> = <span class="ruby-node">&quot;#{prefix.strip}\n&quot;</span>
 84:     <span class="ruby-identifier">directive</span> = <span class="ruby-identifier">directive</span>.<span class="ruby-identifier">downcase</span>
 85: 
 86:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">directive</span>
 87:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'arg'</span>, <span class="ruby-value str">'args'</span> <span class="ruby-keyword kw">then</span>
 88:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
 89: 
 90:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">param</span>
 91: 
 92:       <span class="ruby-identifier">blankline</span>
 93:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'category'</span> <span class="ruby-keyword kw">then</span>
 94:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Context</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span> <span class="ruby-keyword kw">then</span>
 95:         <span class="ruby-identifier">section</span> = <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">add_section</span> <span class="ruby-identifier">param</span>, <span class="ruby-value str">''</span>
 96:         <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">temporary_section</span> = <span class="ruby-identifier">section</span>
 97:       <span class="ruby-keyword kw">end</span>
 98: 
 99:       <span class="ruby-identifier">blankline</span> <span class="ruby-comment cmt"># ignore category if we're not on an RDoc::Context</span>
100:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'doc'</span> <span class="ruby-keyword kw">then</span>
101:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
102:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword kw">true</span>
103:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword kw">true</span>
104: 
105:       <span class="ruby-identifier">blankline</span>
106:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'enddoc'</span> <span class="ruby-keyword kw">then</span>
107:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
108:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword kw">true</span>
109: 
110:       <span class="ruby-identifier">blankline</span>
111:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'include'</span> <span class="ruby-keyword kw">then</span>
112:       <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">param</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">first</span>
113:       <span class="ruby-identifier">include_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">encoding</span>
114:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'main'</span> <span class="ruby-keyword kw">then</span>
115:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">main_page</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:main_page</span>
116: 
117:       <span class="ruby-identifier">blankline</span>
118:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'nodoc'</span> <span class="ruby-keyword kw">then</span>
119:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
120:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># notify nodoc</span>
121:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_children</span> = <span class="ruby-identifier">param</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/all/i</span>
122: 
123:       <span class="ruby-identifier">blankline</span>
124:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'notnew'</span>, <span class="ruby-value str">'not_new'</span>, <span class="ruby-value str">'not-new'</span> <span class="ruby-keyword kw">then</span>
125:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">AnyMethod</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span>
126: 
127:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">dont_rename_initialize</span> = <span class="ruby-keyword kw">true</span>
128: 
129:       <span class="ruby-identifier">blankline</span>
130:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'startdoc'</span> <span class="ruby-keyword kw">then</span>
131:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
132: 
133:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">start_doc</span>
134:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword kw">true</span>
135: 
136:       <span class="ruby-identifier">blankline</span>
137:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'stopdoc'</span> <span class="ruby-keyword kw">then</span>
138:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
139: 
140:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">stop_doc</span>
141: 
142:       <span class="ruby-identifier">blankline</span>
143:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'title'</span> <span class="ruby-keyword kw">then</span>
144:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:default_title=</span>
145: 
146:       <span class="ruby-identifier">blankline</span>
147:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'yield'</span>, <span class="ruby-value str">'yields'</span> <span class="ruby-keyword kw">then</span>
148:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">code_object</span>
149:       <span class="ruby-comment cmt"># remove parameter &amp;block</span>
150:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/,?\s*&amp;\w+/</span>, <span class="ruby-value str">''</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>
151: 
152:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">block_params</span> = <span class="ruby-identifier">param</span>
153: 
154:       <span class="ruby-identifier">blankline</span>
155:     <span class="ruby-keyword kw">else</span>
156:       <span class="ruby-identifier">result</span> = <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
157: 
158:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">result</span>
159:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
160:         <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">metadata</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">param</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">code_object</span>
161: 
162:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">directive</span> <span class="ruby-keyword kw">then</span>
163:           <span class="ruby-identifier">handler</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>[<span class="ruby-identifier">directive</span>]
164:           <span class="ruby-identifier">result</span> = <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">handler</span>
165:         <span class="ruby-keyword kw">else</span>
166:           <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
167:         <span class="ruby-keyword kw">end</span>
168:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">then</span>
169:         <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
170:       <span class="ruby-keyword kw">end</span>
171: 
172:       <span class="ruby-identifier">result</span>
173:     <span class="ruby-keyword kw">end</span>
174:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M004364">
                    
                    <a name="M004364"></a><b>include_file</b>(name, indent, encoding)
                    
                </div>
                
                <div class="description">
                  <p>
Handles the <tt>:include: <em>filename</em></tt> directive.
</p>
<p>
If the first line of the included file starts with &#8217;#&#8217;, and
contains an encoding information in the form &#8216;coding:&#8217; or
&#8216;coding=&#8217;, it is removed.
</p>
<p>
If all lines in the included file start with a &#8217;#&#8217;, this
leading &#8217;#&#8217; is removed before inclusion. The included content
is indented like the <tt>:include:</tt> directive.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M004364_source')" id="l_M004364_source">show</a>
                        
                    </p>
                    <div id="M004364_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/markup/pre_process.rb, line 191</span>
191:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_file</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">indent</span>, <span class="ruby-identifier">encoding</span>
192:     <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">find_include_file</span> <span class="ruby-identifier">name</span>
193: 
194:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword kw">then</span>
195:       <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Couldn't find file to include '#{name}' from #{@input_file_name}&quot;</span>
196:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">''</span>
197:     <span class="ruby-keyword kw">end</span>
198: 
199:     <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-keyword kw">true</span>
200: 
201:     <span class="ruby-comment cmt"># strip magic comment</span>
202:     <span class="ruby-identifier">content</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\A# .*coding[=:].*$/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">lstrip</span>
203: 
204:     <span class="ruby-comment cmt"># strip leading '#'s, but only if all lines start with them</span>
205:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">content</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^[^#]/</span> <span class="ruby-keyword kw">then</span>
206:       <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^/</span>, <span class="ruby-identifier">indent</span>)
207:     <span class="ruby-keyword kw">else</span>
208:       <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^#?/</span>, <span class="ruby-identifier">indent</span>)
209:     <span class="ruby-keyword kw">end</span>
210:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    