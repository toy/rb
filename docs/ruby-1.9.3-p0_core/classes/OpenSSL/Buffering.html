<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>OpenSSL::Buffering</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            OpenSSL::Buffering 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/ext/openssl/lib/openssl/buffering_rb.html">ext/openssl/lib/openssl/buffering.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
<a href="../OpenSSL.html">OpenSSL</a> <a href="../IO.html">IO</a> buffering
mix-in module.
</p>
<p>
This module allows an <a
href="SSL/SSLSocket.html">OpenSSL::SSL::SSLSocket</a> to behave like an <a
href="../IO.html">IO</a>.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M009292"><<</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M009298">close</a>,</li>
                
                <li><a href="#M009269">consume_rbuff</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M009288">do_write</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M009274">each</a>,</li>
                
                <li><a href="#M009281">each_byte</a>,</li>
                
                <li><a href="#M009275">each_line</a>,</li>
                
                <li><a href="#M009286">eof</a>,</li>
                
                <li><a href="#M009285">eof?</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M009268">fill_rbuff</a>,</li>
                
                <li><a href="#M009297">flush</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M009280">getc</a>,</li>
                
                <li><a href="#M009273">gets</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M009265">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M009294">print</a>,</li>
                
                <li><a href="#M009295">printf</a>,</li>
                
                <li><a href="#M009293">puts</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M009270">read</a>,</li>
                
                <li><a href="#M009272">read_nonblock</a>,</li>
                
                <li><a href="#M009283">readchar</a>,</li>
                
                <li><a href="#M009279">readline</a>,</li>
                
                <li><a href="#M009276">readlines</a>,</li>
                
                <li><a href="#M009271">readpartial</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M009284">ungetc</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M009289">write</a>,</li>
                
                <li><a href="#M009291">write_nonblock</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../JSON.html">JSON</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">BLOCK_SIZE</td>
            <td>=</td>
            <td class="attr-value">1024*16</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Default size to read from or write to the SSLSocket for buffer operations.
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>sync</td>
            <td class='attr-desc'><p>
The &#8220;sync mode&#8221; of the SSLSocket.
</p>
<p>
See <a href="../IO.html#M000673">IO#sync</a> for full details.
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M009265">
                    
                    <a name="M009265"></a><b>new</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009265_source')" id="l_M009265_source">show</a>
                        
                    </p>
                    <div id="M009265_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 37</span>
37:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
38:     <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">false</span>
39:     <span class="ruby-ivar">@rbuffer</span> = <span class="ruby-value str">&quot;&quot;</span>
40:     <span class="ruby-ivar">@sync</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">sync</span>
41:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M009292">
                    
                    <a name="M009292"></a><b>&lt;&lt;</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>s</tt> to the stream. <tt>s</tt> will be converted to a <a
href="../String.html">String</a> using <a
href="../String.html#M001388">String#to_s</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009292_source')" id="l_M009292_source">show</a>
                        
                    </p>
                    <div id="M009292_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 381</span>
381:   <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">s</span>)
382:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
383:     <span class="ruby-keyword kw">self</span>
384:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009298">
                    
                    <a name="M009298"></a><b>close</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Closes the SSLSocket and flushes any unwritten data.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009298_source')" id="l_M009298_source">show</a>
                        
                    </p>
                    <div id="M009298_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 444</span>
444:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
445:     <span class="ruby-identifier">flush</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
446:     <span class="ruby-identifier">sysclose</span>
447:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009274">
                    
                    <a name="M009274"></a><b>each</b>(eol=$/)
                    
                </div>
                
                <div class="description">
                  <p>
Executes the block for every line in the stream where lines are separated
by <tt>eol</tt>.
</p>
<p>
See also <a href="Buffering.html#M009273">gets</a>
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Buffering.html#M009275">each_line</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009274_source')" id="l_M009274_source">show</a>
                        
                    </p>
                    <div id="M009274_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 220</span>
220:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
221:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">line</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
222:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">line</span>
223:     <span class="ruby-keyword kw">end</span>
224:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009281">
                    
                    <a name="M009281"></a><b>each_byte</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Calls the given block once for each byte in the stream.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009281_source')" id="l_M009281_source">show</a>
                        
                    </p>
                    <div id="M009281_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 261</span>
261:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_byte</span> <span class="ruby-comment cmt"># :yields: byte</span>
262:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>
263:       <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">ord</span>)
264:     <span class="ruby-keyword kw">end</span>
265:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009275">
                    
                    <a name="M009275"></a><b>each_line</b>(eol=$/)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Buffering.html#M009274">each</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M009286">
                    
                    <a name="M009286"></a><b>eof</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Buffering.html#M009285">eof?</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M009285">
                    
                    <a name="M009285"></a><b>eof?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if the stream is at file which means there is no more data to
be read.
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Buffering.html#M009286">eof</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009285_source')" id="l_M009285_source">show</a>
                        
                    </p>
                    <div id="M009285_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 292</span>
292:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof?</span>
293:     <span class="ruby-identifier">fill_rbuff</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@eof</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
294:     <span class="ruby-ivar">@eof</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
295:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009297">
                    
                    <a name="M009297"></a><b>flush</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Flushes buffered data to the SSLSocket.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009297_source')" id="l_M009297_source">show</a>
                        
                    </p>
                    <div id="M009297_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 432</span>
432:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush</span>
433:     <span class="ruby-identifier">osync</span> = <span class="ruby-ivar">@sync</span>
434:     <span class="ruby-ivar">@sync</span> = <span class="ruby-keyword kw">true</span>
435:     <span class="ruby-identifier">do_write</span> <span class="ruby-value str">&quot;&quot;</span>
436:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
437:   <span class="ruby-keyword kw">ensure</span>
438:     <span class="ruby-ivar">@sync</span> = <span class="ruby-identifier">osync</span>
439:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009280">
                    
                    <a name="M009280"></a><b>getc</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Reads one character from the stream. Returns nil if called at end of file.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009280_source')" id="l_M009280_source">show</a>
                        
                    </p>
                    <div id="M009280_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 254</span>
254:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getc</span>
255:     <span class="ruby-identifier">read</span>(<span class="ruby-value">1</span>)
256:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009273">
                    
                    <a name="M009273"></a><b>gets</b>(eol=$/, limit=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Reads the next &#8220;line+ from the stream. Lines are separated by
<tt>eol</tt>. If <tt>limit</tt> is provided the result will not be longer
than the given number of bytes.
</p>
<p>
<tt>eol</tt> may be a <a href="../String.html">String</a> or <a
href="../Regexp.html">Regexp</a>.
</p>
<p>
Unlike <a href="../IO.html#M000683">IO#gets</a> the line read will not be
assigned to +$_+.
</p>
<p>
Unlike <a href="../IO.html#M000683">IO#gets</a> the separator must be
provided if a limit is provided.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009273_source')" id="l_M009273_source">show</a>
                        
                    </p>
                    <div id="M009273_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 196</span>
196:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>, <span class="ruby-identifier">limit</span>=<span class="ruby-keyword kw">nil</span>)
197:     <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">eol</span>)
198:     <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@eof</span>
199:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span>
200:       <span class="ruby-identifier">fill_rbuff</span>
201:       <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">eol</span>)
202:     <span class="ruby-keyword kw">end</span>
203:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eol</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)
204:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">$&amp;</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
205:     <span class="ruby-keyword kw">else</span>
206:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">eol</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
207:     <span class="ruby-keyword kw">end</span>
208:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">limit</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">limit</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
209:       <span class="ruby-identifier">size</span> = [<span class="ruby-identifier">size</span>, <span class="ruby-identifier">limit</span>].<span class="ruby-identifier">min</span>
210:     <span class="ruby-keyword kw">end</span>
211:     <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>)
212:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009294">
                    
                    <a name="M009294"></a><b>print</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>args</tt> to the stream.
</p>
<p>
See <a href="../IO.html#M000654">IO#print</a> for full details.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009294_source')" id="l_M009294_source">show</a>
                        
                    </p>
                    <div id="M009294_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 411</span>
411:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
412:     <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;&quot;</span>
413:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span> }
414:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
415:     <span class="ruby-keyword kw">nil</span>
416:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009295">
                    
                    <a name="M009295"></a><b>printf</b>(s, *args)
                    
                </div>
                
                <div class="description">
                  <p>
Formats and writes to the stream converting parameters under control of the
format string.
</p>
<p>
See Kernel#sprintf for format string details.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009295_source')" id="l_M009295_source">show</a>
                        
                    </p>
                    <div id="M009295_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 424</span>
424:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">printf</span>(<span class="ruby-identifier">s</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
425:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">args</span>)
426:     <span class="ruby-keyword kw">nil</span>
427:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009293">
                    
                    <a name="M009293"></a><b>puts</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>args</tt> to the stream along with a record separator.
</p>
<p>
See <a href="../IO.html#M000656">IO#puts</a> for full details.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009293_source')" id="l_M009293_source">show</a>
                        
                    </p>
                    <div id="M009293_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 391</span>
391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">puts</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
392:     <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;&quot;</span>
393:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
394:       <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
395:     <span class="ruby-keyword kw">end</span>
396:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
397:       <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>
398:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-regexp re">/\n\z/</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">s</span>
399:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
400:       <span class="ruby-keyword kw">end</span>
401:     }
402:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
403:     <span class="ruby-keyword kw">nil</span>
404:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009270">
                    
                    <a name="M009270"></a><b>read</b>(size=nil, buf=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Reads <tt>size</tt> bytes from the stream. If <tt>buf</tt> is provided it
must reference a string which will receive the data.
</p>
<p>
See <a href="../IO.html#M000643">IO#read</a> for full details.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009270_source')" id="l_M009270_source">show</a>
                        
                    </p>
                    <div id="M009270_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 83</span>
 83:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">size</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
 84:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
 85:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
 86:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
 87:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
 88:       <span class="ruby-keyword kw">else</span>
 89:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
 90:       <span class="ruby-keyword kw">end</span>
 91:     <span class="ruby-keyword kw">end</span>
 92:     <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@eof</span>
 93:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">size</span>
 94:       <span class="ruby-identifier">fill_rbuff</span>
 95:     <span class="ruby-keyword kw">end</span>
 96:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>) <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
 97:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
 98:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
 99:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
100:     <span class="ruby-keyword kw">end</span>
101:     (<span class="ruby-identifier">size</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ret</span>
102:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009272">
                    
                    <a name="M009272"></a><b>read_nonblock</b>(maxlen, buf=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Reads at most <tt>maxlen</tt> bytes in the non-blocking manner.
</p>
<p>
When no data can be read without blocking it raises <a
href="SSL/SSLError.html">OpenSSL::SSL::SSLError</a> extended by <a
href="../IO/WaitReadable.html">IO::WaitReadable</a> or <a
href="../IO/WaitWritable.html">IO::WaitWritable</a>.
</p>
<p>
<a href="../IO/WaitReadable.html">IO::WaitReadable</a> means <a
href="SSL.html">SSL</a> needs to read internally so <a
href="Buffering.html#M009272">read_nonblock</a> should be called again when
the underlying <a href="../IO.html">IO</a> is readable.
</p>
<p>
<a href="../IO/WaitWritable.html">IO::WaitWritable</a> means <a
href="SSL.html">SSL</a> needs to write internally so <a
href="Buffering.html#M009272">read_nonblock</a> should be called again
after the underlying <a href="../IO.html">IO</a> is writable.
</p>
<p>
<a href="Buffering.html#M009272">OpenSSL::Buffering#read_nonblock</a> needs
two rescue clause as follows:
</p>
<pre>
  # emulates blocking read (readpartial).
  begin
    result = ssl.read_nonblock(maxlen)
  rescue IO::WaitReadable
    IO.select([io])
    retry
  rescue IO::WaitWritable
    IO.select(nil, [io])
    retry
  end
</pre>
<p>
Note that one reason that <a
href="Buffering.html#M009272">read_nonblock</a> writes to the underlying <a
href="../IO.html">IO</a> is when the peer requests a new TLS/SSL handshake.
See openssl the FAQ for more details. <a
href="http://www.openssl.org/support/faq.html">www.openssl.org/support/faq.html</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009272_source')" id="l_M009272_source">show</a>
                        
                    </p>
                    <div id="M009272_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_nonblock</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
165:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">maxlen</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
166:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
167:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
168:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
169:       <span class="ruby-keyword kw">else</span>
170:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
171:       <span class="ruby-keyword kw">end</span>
172:     <span class="ruby-keyword kw">end</span>
173:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
174:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sysread_nonblock</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>)
175:     <span class="ruby-keyword kw">end</span>
176:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">maxlen</span>)
177:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
178:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
179:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
180:     <span class="ruby-keyword kw">end</span>
181:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>
182:     <span class="ruby-identifier">ret</span>
183:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009283">
                    
                    <a name="M009283"></a><b>readchar</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Reads a one-character string from the stream. Raises an <a
href="../EOFError.html">EOFError</a> at end of file.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009283_source')" id="l_M009283_source">show</a>
                        
                    </p>
                    <div id="M009283_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 271</span>
271:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readchar</span>
272:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
273:     <span class="ruby-identifier">getc</span>
274:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009279">
                    
                    <a name="M009279"></a><b>readline</b>(eol=$/)
                    
                </div>
                
                <div class="description">
                  <p>
Reads a line from the stream which is separated by <tt>eol</tt>.
</p>
<p>
Raises <a href="../EOFError.html">EOFError</a> if at end of file.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009279_source')" id="l_M009279_source">show</a>
                        
                    </p>
                    <div id="M009279_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 245</span>
245:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readline</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
246:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
247:     <span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
248:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009276">
                    
                    <a name="M009276"></a><b>readlines</b>(eol=$/)
                    
                </div>
                
                <div class="description">
                  <p>
Reads lines from the stream which are separated by <tt>eol</tt>.
</p>
<p>
See also <a href="Buffering.html#M009273">gets</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009276_source')" id="l_M009276_source">show</a>
                        
                    </p>
                    <div id="M009276_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 232</span>
232:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
233:     <span class="ruby-identifier">ary</span> = []
234:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">line</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
235:       <span class="ruby-identifier">ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
236:     <span class="ruby-keyword kw">end</span>
237:     <span class="ruby-identifier">ary</span>
238:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009271">
                    
                    <a name="M009271"></a><b>readpartial</b>(maxlen, buf=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Reads at most <tt>maxlen</tt> bytes from the stream. If <tt>buf</tt> is
provided it must reference a string which will receive the data.
</p>
<p>
See <a href="../IO.html#M000680">IO#readpartial</a> for full details.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009271_source')" id="l_M009271_source">show</a>
                        
                    </p>
                    <div id="M009271_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 110</span>
110:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readpartial</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
111:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">maxlen</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
112:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
113:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
114:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
115:       <span class="ruby-keyword kw">else</span>
116:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
117:       <span class="ruby-keyword kw">end</span>
118:     <span class="ruby-keyword kw">end</span>
119:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
120:       <span class="ruby-keyword kw">begin</span>
121:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sysread</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>)
122:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
123:         <span class="ruby-keyword kw">retry</span>
124:       <span class="ruby-keyword kw">end</span>
125:     <span class="ruby-keyword kw">end</span>
126:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">maxlen</span>)
127:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
128:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
129:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
130:     <span class="ruby-keyword kw">end</span>
131:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>
132:     <span class="ruby-identifier">ret</span>
133:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009284">
                    
                    <a name="M009284"></a><b>ungetc</b>(c)
                    
                </div>
                
                <div class="description">
                  <p>
Pushes character <tt>c</tt> back onto the stream such that a subsequent
buffered character read will return it.
</p>
<p>
Unlike <a href="../IO.html#M000685">IO#getc</a> multiple bytes may be
pushed back onto the stream.
</p>
<p>
Has no effect on unbuffered reads (such as sysread).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009284_source')" id="l_M009284_source">show</a>
                        
                    </p>
                    <div id="M009284_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 284</span>
284:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ungetc</span>(<span class="ruby-identifier">c</span>)
285:     <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>,<span class="ruby-value">0</span>] = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">chr</span>
286:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009289">
                    
                    <a name="M009289"></a><b>write</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>s</tt> to the stream. If the argument is not a string it will be
converted using <a href="../String.html#M001388">String#to_s</a>. Returns
the number of bytes written.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009289_source')" id="l_M009289_source">show</a>
                        
                    </p>
                    <div id="M009289_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 334</span>
334:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">s</span>)
335:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
336:     <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span>
337:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009291">
                    
                    <a name="M009291"></a><b>write_nonblock</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>str</tt> in the non-blocking manner.
</p>
<p>
If there is buffered data, it is flushed first. This may block.
</p>
<p>
<a href="Buffering.html#M009291">write_nonblock</a> returns number of bytes
written to the <a href="SSL.html">SSL</a> connection.
</p>
<p>
When no data can be written without blocking it raises <a
href="SSL/SSLError.html">OpenSSL::SSL::SSLError</a> extended by <a
href="../IO/WaitReadable.html">IO::WaitReadable</a> or <a
href="../IO/WaitWritable.html">IO::WaitWritable</a>.
</p>
<p>
<a href="../IO/WaitReadable.html">IO::WaitReadable</a> means <a
href="SSL.html">SSL</a> needs to read internally so <a
href="Buffering.html#M009291">write_nonblock</a> should be called again
after the underlying <a href="../IO.html">IO</a> is readable.
</p>
<p>
<a href="../IO/WaitWritable.html">IO::WaitWritable</a> means <a
href="SSL.html">SSL</a> needs to write internally so <a
href="Buffering.html#M009291">write_nonblock</a> should be called again
after underlying <a href="../IO.html">IO</a> is writable.
</p>
<p>
So <a href="Buffering.html#M009291">OpenSSL::Buffering#write_nonblock</a>
needs two rescue clause as follows.
</p>
<pre>
  # emulates blocking write.
  begin
    result = ssl.write_nonblock(str)
  rescue IO::WaitReadable
    IO.select([io])
    retry
  rescue IO::WaitWritable
    IO.select(nil, [io])
    retry
  end
</pre>
<p>
Note that one reason that <a
href="Buffering.html#M009291">write_nonblock</a> reads from the underlying
<a href="../IO.html">IO</a> is when the peer requests a new TLS/SSL
handshake. See the openssl FAQ for more details. <a
href="http://www.openssl.org/support/faq.html">www.openssl.org/support/faq.html</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009291_source')" id="l_M009291_source">show</a>
                        
                    </p>
                    <div id="M009291_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 372</span>
372:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_nonblock</span>(<span class="ruby-identifier">s</span>)
373:     <span class="ruby-identifier">flush</span>
374:     <span class="ruby-identifier">syswrite_nonblock</span>(<span class="ruby-identifier">s</span>)
375:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M009269">
                    
                    <a name="M009269"></a><b>consume_rbuff</b>(size=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Consumes <tt>size</tt> bytes from the buffer
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009269_source')" id="l_M009269_source">show</a>
                        
                    </p>
                    <div id="M009269_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>=<span class="ruby-keyword kw">nil</span>)
65:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
66:       <span class="ruby-keyword kw">nil</span>
67:     <span class="ruby-keyword kw">else</span>
68:       <span class="ruby-identifier">size</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">size</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">size</span>
69:       <span class="ruby-identifier">ret</span> = <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">size</span>]
70:       <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">size</span>] = <span class="ruby-value str">&quot;&quot;</span>
71:       <span class="ruby-identifier">ret</span>
72:     <span class="ruby-keyword kw">end</span>
73:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009288">
                    
                    <a name="M009288"></a><b>do_write</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <tt>s</tt> to the buffer. When the buffer is full or <a
href="Buffering.html#sync">sync</a> is true the buffer is flushed to the
underlying socket.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009288_source')" id="l_M009288_source">show</a>
                        
                    </p>
                    <div id="M009288_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 307</span>
307:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
308:     <span class="ruby-ivar">@wbuffer</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-ivar">@wbuffer</span>
309:     <span class="ruby-ivar">@wbuffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>
310:     <span class="ruby-ivar">@sync</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">false</span>
311:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sync</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">BLOCK_SIZE</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-identifier">$/</span>)
312:       <span class="ruby-identifier">remain</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$/</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">length</span>
313:       <span class="ruby-identifier">nwritten</span> = <span class="ruby-value">0</span>
314:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">remain</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
315:         <span class="ruby-identifier">str</span> = <span class="ruby-ivar">@wbuffer</span>[<span class="ruby-identifier">nwritten</span>,<span class="ruby-identifier">remain</span>]
316:         <span class="ruby-keyword kw">begin</span>
317:           <span class="ruby-identifier">nwrote</span> = <span class="ruby-identifier">syswrite</span>(<span class="ruby-identifier">str</span>)
318:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
319:           <span class="ruby-keyword kw">retry</span>
320:         <span class="ruby-keyword kw">end</span>
321:         <span class="ruby-identifier">remain</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">nwrote</span>
322:         <span class="ruby-identifier">nwritten</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">nwrote</span>
323:       <span class="ruby-keyword kw">end</span>
324:       <span class="ruby-ivar">@wbuffer</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">nwritten</span>] = <span class="ruby-value str">&quot;&quot;</span>
325:     <span class="ruby-keyword kw">end</span>
326:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M009268">
                    
                    <a name="M009268"></a><b>fill_rbuff</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Fills the buffer from the underlying SSLSocket
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009268_source')" id="l_M009268_source">show</a>
                        
                    </p>
                    <div id="M009268_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fill_rbuff</span>
52:     <span class="ruby-keyword kw">begin</span>
53:       <span class="ruby-ivar">@rbuffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">sysread</span>(<span class="ruby-constant">BLOCK_SIZE</span>)
54:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
55:       <span class="ruby-keyword kw">retry</span>
56:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">EOFError</span>
57:       <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">true</span>
58:     <span class="ruby-keyword kw">end</span>
59:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    