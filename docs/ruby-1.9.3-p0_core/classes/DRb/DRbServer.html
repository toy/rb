<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>DRb::DRbServer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            DRb::DRbServer 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/drb/invokemethod_rb.html">lib/drb/invokemethod.rb</a></li>
            
            <li><a href="../../files/lib/drb/drb_rb.html">lib/drb/drb.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
<a href="../Class.html">Class</a> representing a drb server instance.
</p>
<p>
A <a href="DRbServer.html">DRbServer</a> must be running in the local
process before any incoming dRuby calls can be accepted, or any local
objects can be passed as dRuby references to remote processes, even if
those local objects are never actually called remotely. You do not need to
start a <a href="DRbServer.html">DRbServer</a> in the local process if you
are only making outgoing dRuby calls passing marshalled parameters.
</p>
<p>
Unless multiple servers are being used, the local <a
href="DRbServer.html">DRbServer</a> is normally started by calling <a
href="../DRb.html#M002108">DRb.start_service</a>.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M002087">alive?</a>,</li>
                
                <li><a href="#M002096">any_to_s</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M002098">check_insecure_method</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M002075">default_acl</a>,</li>
                
                <li><a href="#M002073">default_argc_limit</a>,</li>
                
                <li><a href="#M002076">default_id_conv</a>,</li>
                
                <li><a href="#M002074">default_load_limit</a>,</li>
                
                <li><a href="#M002077">default_safe_level</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M002088">here?</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M002095">insecure_method?</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M002105">main_loop</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M002081">new</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M002094">run</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M002089">stop_service</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M002093">to_id</a>,</li>
                
                <li><a href="#M002092">to_obj</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M002086">verbose</a>,</li>
                
                <li><a href="#M002079">verbose</a>,</li>
                
                <li><a href="#M002085">verbose=</a>,</li>
                
                <li><a href="#M002078">verbose=</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="DRbServer/InvokeMethod18Mixin.html">DRb::DRbServer::InvokeMethod18Mixin</a></li>
        
        <li><span class="type">CLASS</span> <a href="DRbServer/InvokeMethod.html">DRb::DRbServer::InvokeMethod</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">INSECURE_METHOD</td>
            <td>=</td>
            <td class="attr-value">[       :__send__     ]</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
List of insecure methods.
</p>
<p>
These methods are not callable via dRuby.
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>uri</td>
            <td class='attr-desc'><p>
The <a href="../URI.html">URI</a> of this <a
href="DRbServer.html">DRbServer</a>.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>thread</td>
            <td class='attr-desc'><p>
The main thread of this <a href="DRbServer.html">DRbServer</a>.
</p>
<p>
This is the thread that listens for and accepts connections from clients,
not that handles each client&#8217;s request-response session.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>front</td>
            <td class='attr-desc'><p>
The front object of the <a href="DRbServer.html">DRbServer</a>.
</p>
<p>
This object receives remote method calls made on the server&#8217;s <a
href="../URI.html">URI</a> alone, with an object id.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>config</td>
            <td class='attr-desc'><p>
The configuration of this <a href="DRbServer.html">DRbServer</a>
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>safe_level</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M002075">
                    
                    <a name="M002075"></a><b>default_acl</b>(acl)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> the default value for the :acl option.
</p>
<p>
See new(). The initial default value is nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002075_source')" id="l_M002075_source">show</a>
                        
                    </p>
                    <div id="M002075_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1248</span>
1248:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_acl</span>(<span class="ruby-identifier">acl</span>)
1249:       <span class="ruby-ivar">@@acl</span> = <span class="ruby-identifier">acl</span>
1250:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002073">
                    
                    <a name="M002073"></a><b>default_argc_limit</b>(argc)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> the default value for the :argc_limit option.
</p>
<p>
See new(). The initial default value is 256.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002073_source')" id="l_M002073_source">show</a>
                        
                    </p>
                    <div id="M002073_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1234</span>
1234:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_argc_limit</span>(<span class="ruby-identifier">argc</span>)
1235:       <span class="ruby-ivar">@@argc_limit</span> = <span class="ruby-identifier">argc</span>
1236:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002076">
                    
                    <a name="M002076"></a><b>default_id_conv</b>(idconv)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> the default value for the :id_conv option.
</p>
<p>
See new(). The initial default value is a <a
href="DRbIdConv.html">DRbIdConv</a> instance.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002076_source')" id="l_M002076_source">show</a>
                        
                    </p>
                    <div id="M002076_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1255</span>
1255:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_id_conv</span>(<span class="ruby-identifier">idconv</span>)
1256:       <span class="ruby-ivar">@@idconv</span> = <span class="ruby-identifier">idconv</span>
1257:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002074">
                    
                    <a name="M002074"></a><b>default_load_limit</b>(sz)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> the default value for the :load_limit option.
</p>
<p>
See new(). The initial default value is 25 MB.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002074_source')" id="l_M002074_source">show</a>
                        
                    </p>
                    <div id="M002074_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1241</span>
1241:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_load_limit</span>(<span class="ruby-identifier">sz</span>)
1242:       <span class="ruby-ivar">@@load_limit</span> = <span class="ruby-identifier">sz</span>
1243:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002077">
                    
                    <a name="M002077"></a><b>default_safe_level</b>(level)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002077_source')" id="l_M002077_source">show</a>
                        
                    </p>
                    <div id="M002077_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1259</span>
1259:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_safe_level</span>(<span class="ruby-identifier">level</span>)
1260:       <span class="ruby-ivar">@@safe_level</span> = <span class="ruby-identifier">level</span>
1261:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002081">
                    
                    <a name="M002081"></a><b>new</b>(uri=nil, front=nil, config_or_acl=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Create a new <a href="DRbServer.html">DRbServer</a> instance.
</p>
<p>
<tt>uri</tt> is the <a href="../URI.html">URI</a> to bind to. This is
normally of the form &#8216;druby://<hostname>:<port>&#8217; where
<hostname> is a hostname of the local machine. If nil, then the
system&#8217;s default hostname will be bound to, on a port selected by the
system; these value can be retrieved from the <tt>uri</tt> attribute.
&#8216;druby:&#8217; specifies the default dRuby transport protocol:
another protocol, such as &#8216;drbunix:&#8217;, can be specified instead.
</p>
<p>
<tt>front</tt> is the front object for the server, that is, the object to
which remote method calls on the server will be passed. If nil, then the
server will not accept remote method calls.
</p>
<p>
If <tt>config_or_acl</tt> is a hash, it is the configuration to use for
this server. The following options are recognised:
</p>
<table>
<tr><td valign="top">:idconv :</td><td>an id-to-object conversion object. This defaults to an instance of the
class <a href="DRbIdConv.html">DRb::DRbIdConv</a>.

</td></tr>
<tr><td valign="top">:verbose :</td><td>if true, all unsuccessful remote calls on objects in the server will be
logged to $stdout. false by default.

</td></tr>
<tr><td valign="top">:tcp_acl :</td><td>the access control list for this server. See the <a
href="../ACL.html">ACL</a> class from the main dRuby distribution.

</td></tr>
<tr><td valign="top">:load_limit :</td><td>the maximum message size in bytes accepted by the server. Defaults to 25 MB
(26214400).

</td></tr>
<tr><td valign="top">:argc_limit :</td><td>the maximum number of arguments to a remote method accepted by the server.
Defaults to 256.

</td></tr>
</table>
<p>
The default values of these options can be modified on a class-wide basis
by the class methods <a
href="DRbServer.html#M002073">default_argc_limit</a>, <a
href="DRbServer.html#M002074">default_load_limit</a>, <a
href="DRbServer.html#M002075">default_acl</a>, <a
href="DRbServer.html#M002076">default_id_conv</a>, and <a
href="DRbServer.html#M002078">verbose=</a>
</p>
<p>
If <tt>config_or_acl</tt> is not a hash, but is not nil, it is assumed to
be the access control list for this server. See the :tcp_acl option for
more details.
</p>
<p>
If no other server is currently set as the primary server, this will become
the primary server.
</p>
<p>
The server will immediately start running in its own thread.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002081_source')" id="l_M002081_source">show</a>
                        
                    </p>
                    <div id="M002081_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1330</span>
1330:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">uri</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">front</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">config_or_acl</span>=<span class="ruby-keyword kw">nil</span>)
1331:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">config_or_acl</span>
1332:         <span class="ruby-identifier">config</span> = <span class="ruby-identifier">config_or_acl</span>.<span class="ruby-identifier">dup</span>
1333:       <span class="ruby-keyword kw">else</span>
1334:         <span class="ruby-identifier">acl</span> = <span class="ruby-identifier">config_or_acl</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@@acl</span>
1335:         <span class="ruby-identifier">config</span> = {
1336:           <span class="ruby-identifier">:tcp_acl</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">acl</span>
1337:         }
1338:       <span class="ruby-keyword kw">end</span>
1339: 
1340:       <span class="ruby-ivar">@config</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">make_config</span>(<span class="ruby-identifier">config</span>)
1341: 
1342:       <span class="ruby-ivar">@protocol</span> = <span class="ruby-constant">DRbProtocol</span>.<span class="ruby-identifier">open_server</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-ivar">@config</span>)
1343:       <span class="ruby-ivar">@uri</span> = <span class="ruby-ivar">@protocol</span>.<span class="ruby-identifier">uri</span>
1344:       <span class="ruby-ivar">@exported_uri</span> = [<span class="ruby-ivar">@uri</span>]
1345: 
1346:       <span class="ruby-ivar">@front</span> = <span class="ruby-identifier">front</span>
1347:       <span class="ruby-ivar">@idconv</span> = <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:idconv</span>]
1348:       <span class="ruby-ivar">@safe_level</span> = <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:safe_level</span>]
1349: 
1350:       <span class="ruby-ivar">@grp</span> = <span class="ruby-constant">ThreadGroup</span>.<span class="ruby-identifier">new</span>
1351:       <span class="ruby-ivar">@thread</span> = <span class="ruby-identifier">run</span>
1352: 
1353:       <span class="ruby-constant">DRb</span>.<span class="ruby-identifier">regist_server</span>(<span class="ruby-keyword kw">self</span>)
1354:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002079">
                    
                    <a name="M002079"></a><b>verbose</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Get the default value of the :verbose option.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002079_source')" id="l_M002079_source">show</a>
                        
                    </p>
                    <div id="M002079_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1271</span>
1271:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">verbose</span>
1272:       <span class="ruby-ivar">@@verbose</span>
1273:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002078">
                    
                    <a name="M002078"></a><b>verbose=</b>(on)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> the default value of the :verbose option.
</p>
<p>
See new(). The initial default value is false.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002078_source')" id="l_M002078_source">show</a>
                        
                    </p>
                    <div id="M002078_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1266</span>
1266:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">verbose=</span>(<span class="ruby-identifier">on</span>)
1267:       <span class="ruby-ivar">@@verbose</span> = <span class="ruby-identifier">on</span>
1268:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M002087">
                    
                    <a name="M002087"></a><b>alive?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Is this server alive?
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002087_source')" id="l_M002087_source">show</a>
                        
                    </p>
                    <div id="M002087_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1388</span>
1388:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">alive?</span>
1389:       <span class="ruby-ivar">@thread</span>.<span class="ruby-identifier">alive?</span>
1390:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002098">
                    
                    <a name="M002098"></a><b>check_insecure_method</b>(obj, msg_id)
                    
                </div>
                
                <div class="description">
                  <p>
Check that a method is callable via dRuby.
</p>
<p>
<tt>obj</tt> is the object we want to invoke the method on. <tt>msg_id</tt>
is the method name, as a <a href="../Symbol.html">Symbol</a>.
</p>
<p>
If the method is an insecure method (see <a
href="DRbServer.html#M002095">insecure_method?</a>) a <a
href="../SecurityError.html">SecurityError</a> is thrown. If the method is
private or undefined, a <a href="../NameError.html">NameError</a> is
thrown.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002098_source')" id="l_M002098_source">show</a>
                        
                    </p>
                    <div id="M002098_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1460</span>
1460:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_insecure_method</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">msg_id</span>)
1461:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Proc</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">obj</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">msg_id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:__drb_yield</span>
1462:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;#{any_to_s(msg_id)} is not a symbol&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Symbol</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">msg_id</span>.<span class="ruby-identifier">class</span>
1463:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">SecurityError</span>, <span class="ruby-node">&quot;insecure method `#{msg_id}'&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">insecure_method?</span>(<span class="ruby-identifier">msg_id</span>)
1464: 
1465:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">private_methods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">msg_id</span>)
1466:         <span class="ruby-identifier">desc</span> = <span class="ruby-identifier">any_to_s</span>(<span class="ruby-identifier">obj</span>)
1467:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-node">&quot;private method `#{msg_id}' called for #{desc}&quot;</span>
1468:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">protected_methods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">msg_id</span>)
1469:         <span class="ruby-identifier">desc</span> = <span class="ruby-identifier">any_to_s</span>(<span class="ruby-identifier">obj</span>)
1470:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-node">&quot;protected method `#{msg_id}' called for #{desc}&quot;</span>
1471:       <span class="ruby-keyword kw">else</span>
1472:         <span class="ruby-keyword kw">true</span>
1473:       <span class="ruby-keyword kw">end</span>
1474:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002088">
                    
                    <a name="M002088"></a><b>here?</b>(uri)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002088_source')" id="l_M002088_source">show</a>
                        
                    </p>
                    <div id="M002088_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1392</span>
1392:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">here?</span>(<span class="ruby-identifier">uri</span>)
1393:       <span class="ruby-ivar">@exported_uri</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">uri</span>)
1394:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002089">
                    
                    <a name="M002089"></a><b>stop_service</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Stop this server.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002089_source')" id="l_M002089_source">show</a>
                        
                    </p>
                    <div id="M002089_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1397</span>
1397:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop_service</span>
1398:       <span class="ruby-constant">DRb</span>.<span class="ruby-identifier">remove_server</span>(<span class="ruby-keyword kw">self</span>)
1399:       <span class="ruby-keyword kw">if</span>  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value str">'DRb'</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value str">'DRb'</span>][<span class="ruby-value str">'server'</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>
1400:         <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value str">'DRb'</span>][<span class="ruby-value str">'stop_service'</span>] = <span class="ruby-keyword kw">true</span>
1401:       <span class="ruby-keyword kw">else</span>
1402:         <span class="ruby-ivar">@thread</span>.<span class="ruby-identifier">kill</span>.<span class="ruby-identifier">join</span>
1403:       <span class="ruby-keyword kw">end</span>
1404:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002093">
                    
                    <a name="M002093"></a><b>to_id</b>(obj)
                    
                </div>
                
                <div class="description">
                  <p>
Convert a local object to a dRuby reference.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002093_source')" id="l_M002093_source">show</a>
                        
                    </p>
                    <div id="M002093_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1414</span>
1414:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_id</span>(<span class="ruby-identifier">obj</span>)
1415:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">__id__</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">front</span>.<span class="ruby-identifier">__id__</span>
1416:       <span class="ruby-ivar">@idconv</span>.<span class="ruby-identifier">to_id</span>(<span class="ruby-identifier">obj</span>)
1417:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002092">
                    
                    <a name="M002092"></a><b>to_obj</b>(ref)
                    
                </div>
                
                <div class="description">
                  <p>
Convert a dRuby reference to the local object it refers to.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002092_source')" id="l_M002092_source">show</a>
                        
                    </p>
                    <div id="M002092_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1407</span>
1407:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_obj</span>(<span class="ruby-identifier">ref</span>)
1408:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">front</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ref</span>.<span class="ruby-identifier">nil?</span>
1409:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">front</span>[<span class="ruby-identifier">ref</span>.<span class="ruby-identifier">to_s</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-constant">DRbURIOption</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">ref</span>
1410:       <span class="ruby-ivar">@idconv</span>.<span class="ruby-identifier">to_obj</span>(<span class="ruby-identifier">ref</span>)
1411:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002086">
                    
                    <a name="M002086"></a><b>verbose</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Get whether the server is in verbose mode.
</p>
<p>
In verbose mode, failed calls are logged to stdout.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002086_source')" id="l_M002086_source">show</a>
                        
                    </p>
                    <div id="M002086_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1385</span>
1385:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">verbose</span>; <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:verbose</span>]; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002085">
                    
                    <a name="M002085"></a><b>verbose=</b>(v)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Set.html">Set</a> whether to operate in verbose mode.
</p>
<p>
In verbose mode, failed calls are logged to stdout.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002085_source')" id="l_M002085_source">show</a>
                        
                    </p>
                    <div id="M002085_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1380</span>
1380:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">verbose=</span>(<span class="ruby-identifier">v</span>); <span class="ruby-ivar">@config</span>[<span class="ruby-identifier">:verbose</span>]=<span class="ruby-identifier">v</span>; <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M002096">
                    
                    <a name="M002096"></a><b>any_to_s</b>(obj)
                    
                </div>
                
                <div class="description">
                  <p>
Coerce an object to a string, providing our own representation if to_s is
not defined for the object.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002096_source')" id="l_M002096_source">show</a>
                        
                    </p>
                    <div id="M002096_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1446</span>
1446:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">any_to_s</span>(<span class="ruby-identifier">obj</span>)
1447:       <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;:#{obj.class}&quot;</span>
1448:     <span class="ruby-keyword kw">rescue</span>
1449:       <span class="ruby-identifier">sprintf</span>(<span class="ruby-value str">&quot;#&lt;%s:0x%lx&gt;&quot;</span>, <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span>, <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">__id__</span>)
1450:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002095">
                    
                    <a name="M002095"></a><b>insecure_method?</b>(msg_id)
                    
                </div>
                
                <div class="description">
                  <p>
Has a method been included in the list of insecure methods?
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002095_source')" id="l_M002095_source">show</a>
                        
                    </p>
                    <div id="M002095_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1440</span>
1440:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insecure_method?</span>(<span class="ruby-identifier">msg_id</span>)
1441:       <span class="ruby-constant">INSECURE_METHOD</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">msg_id</span>)
1442:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002105">
                    
                    <a name="M002105"></a><b>main_loop</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The main loop performed by a DRbServer&#8217;s internal thread.
</p>
<p>
Accepts a connection from a client, and starts up its own thread to handle
it. This thread loops, receiving requests from the client, invoking them on
a local object, and returning responses, until the client closes the
connection or a local method call fails.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002105_source')" id="l_M002105_source">show</a>
                        
                    </p>
                    <div id="M002105_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1573</span>
1573:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">main_loop</span>
1574:       <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">start</span>(<span class="ruby-ivar">@protocol</span>.<span class="ruby-identifier">accept</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span><span class="ruby-operator">|</span>
1575:         <span class="ruby-ivar">@grp</span>.<span class="ruby-identifier">add</span> <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>
1576:         <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value str">'DRb'</span>] = { <span class="ruby-value str">'client'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">client</span> ,
1577:                                   <span class="ruby-value str">'server'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span> }
1578:         <span class="ruby-constant">DRb</span>.<span class="ruby-identifier">mutex</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword kw">do</span>
1579:           <span class="ruby-identifier">client_uri</span> = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">uri</span>
1580:           <span class="ruby-ivar">@exported_uri</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">client_uri</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@exported_uri</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client_uri</span>)
1581:         <span class="ruby-keyword kw">end</span>
1582:         <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
1583:           <span class="ruby-keyword kw">begin</span>
1584:             <span class="ruby-identifier">succ</span> = <span class="ruby-keyword kw">false</span>
1585:             <span class="ruby-identifier">invoke_method</span> = <span class="ruby-constant">InvokeMethod</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">client</span>)
1586:             <span class="ruby-identifier">succ</span>, <span class="ruby-identifier">result</span> = <span class="ruby-identifier">invoke_method</span>.<span class="ruby-identifier">perform</span>
1587:             <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">succ</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">verbose</span>
1588:               <span class="ruby-identifier">p</span> <span class="ruby-identifier">result</span>
1589:               <span class="ruby-identifier">result</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
1590:                 <span class="ruby-identifier">puts</span> <span class="ruby-identifier">x</span>
1591:               <span class="ruby-keyword kw">end</span>
1592:             <span class="ruby-keyword kw">end</span>
1593:             <span class="ruby-identifier">client</span>.<span class="ruby-identifier">send_reply</span>(<span class="ruby-identifier">succ</span>, <span class="ruby-identifier">result</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
1594:           <span class="ruby-keyword kw">ensure</span>
1595:             <span class="ruby-identifier">client</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">succ</span>
1596:             <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value str">'DRb'</span>][<span class="ruby-value str">'stop_service'</span>]
1597:               <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">stop_service</span> }
1598:             <span class="ruby-keyword kw">end</span>
1599:             <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">succ</span>
1600:           <span class="ruby-keyword kw">end</span>
1601:         <span class="ruby-keyword kw">end</span>
1602:       <span class="ruby-keyword kw">end</span>
1603:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002094">
                    
                    <a name="M002094"></a><b>run</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002094_source')" id="l_M002094_source">show</a>
                        
                    </p>
                    <div id="M002094_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/drb/drb.rb, line 1420</span>
1420:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>
1421:       <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">start</span> <span class="ruby-keyword kw">do</span>
1422:         <span class="ruby-keyword kw">begin</span>
1423:           <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
1424:             <span class="ruby-identifier">main_loop</span>
1425:           <span class="ruby-keyword kw">end</span>
1426:         <span class="ruby-keyword kw">ensure</span>
1427:           <span class="ruby-ivar">@protocol</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@protocol</span>
1428:         <span class="ruby-keyword kw">end</span>
1429:       <span class="ruby-keyword kw">end</span>
1430:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    