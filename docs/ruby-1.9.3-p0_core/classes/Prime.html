<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Prime</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Prime 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/lib/prime_rb.html">lib/prime.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
The set of all prime numbers.
</p>
<h2>Example</h2>
<pre>
  Prime.each(100) do |prime|
    p prime  #=&gt; 2, 3, 5, 7, 11, ...., 97
  end
</pre>
<p>
<a href="Prime.html">Prime</a> is Enumerable:
</p>
<pre>
  Prime.first 5 # =&gt; [2, 3, 5, 7, 11]
</pre>
<h2>Retrieving the instance</h2>
<p>
<tt>Prime</tt>.new is obsolete. Now <tt>Prime</tt> has the default instance
and you can access it as <tt>Prime</tt>.instance.
</p>
<p>
For convenience, each instance method of <tt>Prime</tt>.instance can be
accessed as a class method of <tt>Prime</tt>.
</p>
<p>
e.g.
</p>
<pre>
  Prime.instance.prime?(2)  #=&gt; true
  Prime.prime?(2)           #=&gt; true
</pre>
<h2>Generators</h2>
<p>
A &#8220;generator&#8221; provides an implementation of enumerating
pseudo-prime numbers and it remembers the position of enumeration and upper
bound. Futhermore, it is a external iterator of prime enumeration which is
compatible to an <a href="Enumerator.html">Enumerator</a>.
</p>
<p>
<tt>Prime</tt>::<tt>PseudoPrimeGenerator</tt> is the base class for
generators. There are few implementations of generator.
</p>
<dl>
<dt><tt>Prime</tt>::<tt>EratosthenesGenerator</tt></dt><dd>Uses eratosthenes&#8217;s sieve.

</dd>
<dt><tt>Prime</tt>::<tt>TrialDivisionGenerator</tt></dt><dd>Uses the trial division method.

</dd>
<dt><tt>Prime</tt>::<tt>Generator23</tt></dt><dd>Generates all positive integers which is not divided by 2 nor 3. This
sequence is very bad as a pseudo-prime sequence. But this is faster and
uses much less memory than other generators. So, it is suitable for
factorizing an integer which is not large but has many prime factors. e.g.
for <a href="Prime.html#M003652">Prime#prime?</a> .

</dd>
</dl>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M003651">each</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M003647">instance</a>,</li>
                
                <li><a href="#M003653">int_from_prime_division</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M003646">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M003652">prime?</a>,</li>
                
                <li><a href="#M003654">prime_division</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="JSON.html">JSON</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="JSON.html">JSON</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="Prime/OldCompatibility.html">Prime::OldCompatibility</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/EratosthenesGenerator.html">Prime::EratosthenesGenerator</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/EratosthenesSieve.html">Prime::EratosthenesSieve</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/Generator23.html">Prime::Generator23</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/PseudoPrimeGenerator.html">Prime::PseudoPrimeGenerator</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/TrialDivision.html">Prime::TrialDivision</a></li>
        
        <li><span class="type">CLASS</span> <a href="Prime/TrialDivisionGenerator.html">Prime::TrialDivisionGenerator</a></li>
        
    </ul>
    

    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M003647">
                    
                    <a name="M003647"></a><b>instance</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the default instance of <a href="Prime.html">Prime</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003647_source')" id="l_M003647_source">show</a>
                        
                    </p>
                    <div id="M003647_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 106</span>
106:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instance</span>; <span class="ruby-ivar">@the_instance</span> <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003646">
                    
                    <a name="M003646"></a><b>new</b>()
                    
                </div>
                
                <div class="description">
                  <p>
obsolete. Use <tt>Prime</tt>::<tt>instance</tt> or class methods of
<tt>Prime</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003646_source')" id="l_M003646_source">show</a>
                        
                    </p>
                    <div id="M003646_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 96</span>
 96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>
 97:     <span class="ruby-ivar">@generator</span> = <span class="ruby-constant">EratosthenesGenerator</span>.<span class="ruby-identifier">new</span>
 98:     <span class="ruby-identifier">extend</span> <span class="ruby-constant">OldCompatibility</span>
 99:     <span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;Prime::new is obsolete. use Prime::instance or class methods of Prime.&quot;</span>
100:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M003651">
                    
                    <a name="M003651"></a><b>each</b>(ubound = nil, generator = EratosthenesGenerator.new, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
Iterates the given block over all prime numbers.
</p>
<h2>Parameters</h2>
<table>
<tr><td valign="top"><tt>ubound</tt>:</td><td>Optional. An arbitrary positive number. The upper bound of enumeration. The
method enumerates prime numbers infinitely if <tt>ubound</tt> is nil.

</td></tr>
<tr><td valign="top"><tt>generator</tt>:</td><td>Optional. An implementation of pseudo-prime generator.

</td></tr>
</table>
<h2>Return value</h2>
<p>
An evaluated value of the given block at the last time. Or an enumerator
which is compatible to an <tt>Enumerator</tt> if no block given.
</p>
<h2>Description</h2>
<p>
Calls <tt>block</tt> once for each prime number, passing the prime as a
parameter.
</p>
<table>
<tr><td valign="top"><tt>ubound</tt>:</td><td>Upper bound of prime numbers. The iterator stops after yields all prime
numbers p <= <tt>ubound</tt>.

</td></tr>
</table>
<h2>Note</h2>
<p>
<tt>Prime</tt>.<tt>new</tt> returns a object extended by
<tt>Prime</tt>::<tt>OldCompatibility</tt> in order to compatibility to Ruby
1.8, and <tt>Prime</tt><a href="Prime.html#M003651">each</a> is overwritten
by <tt>Prime</tt>::<tt>OldCompatibility</tt>#<tt>each</tt>.
</p>
<p>
<tt>Prime</tt>.<tt>new</tt> is now obsolete. Use
<tt>Prime</tt>.<tt>instance</tt>.<tt>each</tt> or simply
<tt>Prime</tt>.<tt>each</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003651_source')" id="l_M003651_source">show</a>
                        
                    </p>
                    <div id="M003651_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-identifier">ubound</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">generator</span> = <span class="ruby-constant">EratosthenesGenerator</span>.<span class="ruby-identifier">new</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
148:     <span class="ruby-identifier">generator</span>.<span class="ruby-identifier">upper_bound</span> = <span class="ruby-identifier">ubound</span>
149:     <span class="ruby-identifier">generator</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
150:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003653">
                    
                    <a name="M003653"></a><b>int_from_prime_division</b>(pd)
                    
                </div>
                
                <div class="description">
                  <p>
Re-composes a prime factorization and returns the product.
</p>
<h2>Parameters</h2>
<table>
<tr><td valign="top"><tt>pd</tt>:</td><td><a href="Array.html">Array</a> of pairs of integers. The each internal pair
consists of a prime number &#8212; a prime factor &#8212; and a natural
number &#8212; an exponent.

</td></tr>
</table>
<h2>Example</h2>
<p>
For <tt>[[p_1, e_1], [p_2, e_2], ...., [p_n, e_n]]</tt>, it returns:
</p>
<pre>
  p_1**e_1 * p_2**e_2 * .... * p_n**e_n.

  Prime.int_from_prime_division([[2,2], [3,1]])  #=&gt; 12
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003653_source')" id="l_M003653_source">show</a>
                        
                    </p>
                    <div id="M003653_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 182</span>
182:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">int_from_prime_division</span>(<span class="ruby-identifier">pd</span>)
183:     <span class="ruby-identifier">pd</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">1</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">value</span>, (<span class="ruby-identifier">prime</span>, <span class="ruby-identifier">index</span>)<span class="ruby-operator">|</span>
184:       <span class="ruby-identifier">value</span> <span class="ruby-operator">*=</span> <span class="ruby-identifier">prime</span><span class="ruby-operator">**</span><span class="ruby-identifier">index</span>
185:     }
186:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003652">
                    
                    <a name="M003652"></a><b>prime?</b>(value, generator = Prime::Generator23.new)
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if <tt>value</tt> is prime, false for a composite.
</p>
<h2>Parameters</h2>
<table>
<tr><td valign="top"><tt>value</tt>:</td><td>an arbitrary integer to be checked.

</td></tr>
<tr><td valign="top"><tt>generator</tt>:</td><td>optional. A pseudo-prime generator.

</td></tr>
</table>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003652_source')" id="l_M003652_source">show</a>
                        
                    </p>
                    <div id="M003652_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prime?</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">generator</span> = <span class="ruby-constant">Prime</span><span class="ruby-operator">::</span><span class="ruby-constant">Generator23</span>.<span class="ruby-identifier">new</span>)
160:     <span class="ruby-identifier">value</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">value</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
161:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
162:     <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">num</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">generator</span>
163:       <span class="ruby-identifier">q</span>,<span class="ruby-identifier">r</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">divmod</span> <span class="ruby-identifier">num</span>
164:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">q</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">num</span>
165:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
166:     <span class="ruby-keyword kw">end</span>
167:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M003654">
                    
                    <a name="M003654"></a><b>prime_division</b>(value, generator= Prime::Generator23.new)
                    
                </div>
                
                <div class="description">
                  <p>
Returns the factorization of <tt>value</tt>.
</p>
<h2>Parameters</h2>
<table>
<tr><td valign="top"><tt>value</tt>:</td><td>An arbitrary integer.

</td></tr>
<tr><td valign="top"><tt>generator</tt>:</td><td>Optional. A pseudo-prime generator. <tt>generator</tt>.succ must return the
next pseudo-prime number in the ascendent order. It must generate all prime
numbers, but may generate non prime numbers.

</td></tr>
</table>
<h3>Exceptions</h3>
<table>
<tr><td valign="top"><tt>ZeroDivisionError</tt>:</td><td>when <tt>value</tt> is zero.

</td></tr>
</table>
<h2>Example</h2>
<p>
For an arbitrary integer:
</p>
<pre>
  n = p_1**e_1 * p_2**e_2 * .... * p_n**e_n,
</pre>
<p>
<a href="Prime.html#M003654">prime_division</a>(n) returns:
</p>
<pre>
  [[p_1, e_1], [p_2, e_2], ...., [p_n, e_n]].

  Prime.prime_division(12) #=&gt; [[2,2], [3,1]]
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M003654_source')" id="l_M003654_source">show</a>
                        
                    </p>
                    <div id="M003654_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/prime.rb, line 212</span>
212:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prime_division</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">generator</span>= <span class="ruby-constant">Prime</span><span class="ruby-operator">::</span><span class="ruby-constant">Generator23</span>.<span class="ruby-identifier">new</span>)
213:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">ZeroDivisionError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
214:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
215:       <span class="ruby-identifier">value</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">value</span>
216:       <span class="ruby-identifier">pv</span> = [[<span class="ruby-value">-1</span>, <span class="ruby-value">1</span>]]
217:     <span class="ruby-keyword kw">else</span>
218:       <span class="ruby-identifier">pv</span> = []
219:     <span class="ruby-keyword kw">end</span>
220:     <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">prime</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">generator</span>
221:       <span class="ruby-identifier">count</span> = <span class="ruby-value">0</span>
222:       <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">value1</span>, <span class="ruby-identifier">mod</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">divmod</span>(<span class="ruby-identifier">prime</span>)
223:              <span class="ruby-identifier">mod</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
224:         <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value1</span>
225:         <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
226:       <span class="ruby-keyword kw">end</span>
227:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
228:         <span class="ruby-identifier">pv</span>.<span class="ruby-identifier">push</span> [<span class="ruby-identifier">prime</span>, <span class="ruby-identifier">count</span>]
229:       <span class="ruby-keyword kw">end</span>
230:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value1</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">prime</span>
231:     <span class="ruby-keyword kw">end</span>
232:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
233:       <span class="ruby-identifier">pv</span>.<span class="ruby-identifier">push</span> [<span class="ruby-identifier">value</span>, <span class="ruby-value">1</span>]
234:     <span class="ruby-keyword kw">end</span>
235:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pv</span>
236:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    