<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RubyLex</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RubyLex 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/lib/irb/ruby-lex_rb.html">lib/irb/ruby-lex.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M002539">buf_input</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M002526">debug?</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M002543">each_top_level_statement</a>,</li>
                
                <li><a href="#M002533">eof?</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M002530">get_readed</a>,</li>
                
                <li><a href="#M002531">getc</a>,</li>
                
                <li><a href="#M002534">getc_of_rests</a>,</li>
                
                <li><a href="#M002532">gets</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M002574">identify_comment</a>,</li>
                
                <li><a href="#M002563">identify_gvar</a>,</li>
                
                <li><a href="#M002566">identify_here_document</a>,</li>
                
                <li><a href="#M002564">identify_identifier</a>,</li>
                
                <li><a href="#M002568">identify_number</a>,</li>
                
                <li><a href="#M002567">identify_quotation</a>,</li>
                
                <li><a href="#M002570">identify_string</a>,</li>
                
                <li><a href="#M002573">identify_string_dvar</a>,</li>
                
                <li><a href="#M002542">initialize_input</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M002544">lex</a>,</li>
                
                <li><a href="#M002547">lex_init</a>,</li>
                
                <li><a href="#M002559">lex_int2</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M002527">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M002538">peek</a>,</li>
                
                <li><a href="#M002536">peek_equal?</a>,</li>
                
                <li><a href="#M002537">peek_match?</a>,</li>
                
                <li><a href="#M002541">prompt</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M002576">read_escape</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M002529">set_input</a>,</li>
                
                <li><a href="#M002540">set_prompt</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M002546">token</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M002535">ungetc</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="JSON.html">JSON</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">ENINDENT_CLAUSE</td>
            <td>=</td>
            <td class="attr-value">[     &quot;case&quot;, &quot;class&quot;, &quot;def&quot;, &quot;do&quot;, &quot;for&quot;, &quot;if&quot;,     &quot;module&quot;, &quot;unless&quot;, &quot;until&quot;, &quot;while&quot;, &quot;begin&quot; #, &quot;when&quot;   ]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DEINDENT_CLAUSE</td>
            <td>=</td>
            <td class="attr-value">[&quot;end&quot; #, &quot;when&quot;   ]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">PERCENT_LTYPE</td>
            <td>=</td>
            <td class="attr-value">{     &quot;q&quot; =&gt; &quot;\'&quot;,     &quot;Q&quot; =&gt; &quot;\&quot;&quot;,     &quot;x&quot; =&gt; &quot;\`&quot;,     &quot;r&quot; =&gt; &quot;/&quot;,     &quot;w&quot; =&gt; &quot;]&quot;,     &quot;W&quot; =&gt; &quot;]&quot;,     &quot;s&quot; =&gt; &quot;:&quot;   }</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">PERCENT_PAREN</td>
            <td>=</td>
            <td class="attr-value">{     &quot;{&quot; =&gt; &quot;}&quot;,     &quot;[&quot; =&gt; &quot;]&quot;,     &quot;&lt;&quot; =&gt; &quot;&gt;&quot;,     &quot;(&quot; =&gt; &quot;)&quot;   }</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">Ltype2Token</td>
            <td>=</td>
            <td class="attr-value">{     &quot;\'&quot; =&gt; TkSTRING,     &quot;\&quot;&quot; =&gt; TkSTRING,     &quot;\`&quot; =&gt; TkXSTRING,     &quot;/&quot; =&gt; TkREGEXP,     &quot;]&quot; =&gt; TkDSTRING,     &quot;:&quot; =&gt; TkSYMBOL   }</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DLtype2Token</td>
            <td>=</td>
            <td class="attr-value">{     &quot;\&quot;&quot; =&gt; TkDSTRING,     &quot;\`&quot; =&gt; TkDXSTRING,     &quot;/&quot; =&gt; TkDREGEXP,   }</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>debug_level</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>skip_space</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>readed_auto_clean_up</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>exception_on_syntax_error</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>seek</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>char_no</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>line_no</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>indent</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M002526">
                    
                    <a name="M002526"></a><b>debug?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002526_source')" id="l_M002526_source">show</a>
                        
                    </p>
                    <div id="M002526_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 33</span>
33:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug?</span>
34:       <span class="ruby-ivar">@debug_level</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
35:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002527">
                    
                    <a name="M002527"></a><b>new</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002527_source')" id="l_M002527_source">show</a>
                        
                    </p>
                    <div id="M002527_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 39</span>
39:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>
40:     <span class="ruby-identifier">lex_init</span>
41:     <span class="ruby-identifier">set_input</span>(<span class="ruby-constant">STDIN</span>)
42: 
43:     <span class="ruby-ivar">@seek</span> = <span class="ruby-value">0</span>
44:     <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span> = <span class="ruby-value">1</span>
45:     <span class="ruby-ivar">@base_char_no</span> = <span class="ruby-value">0</span>
46:     <span class="ruby-ivar">@char_no</span> = <span class="ruby-value">0</span>
47:     <span class="ruby-ivar">@rests</span> = []
48:     <span class="ruby-ivar">@readed</span> = []
49:     <span class="ruby-ivar">@here_readed</span> = []
50: 
51:     <span class="ruby-ivar">@indent</span> = <span class="ruby-value">0</span>
52:     <span class="ruby-ivar">@indent_stack</span> = []
53:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
54:     <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword kw">false</span>
55:     <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword kw">false</span>
56: 
57:     <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">false</span>
58:     <span class="ruby-ivar">@line</span> = <span class="ruby-value str">&quot;&quot;</span>
59: 
60:     <span class="ruby-ivar">@skip_space</span> = <span class="ruby-keyword kw">false</span>
61:     <span class="ruby-ivar">@readed_auto_clean_up</span> = <span class="ruby-keyword kw">false</span>
62:     <span class="ruby-ivar">@exception_on_syntax_error</span> = <span class="ruby-keyword kw">true</span>
63: 
64:     <span class="ruby-ivar">@prompt</span> = <span class="ruby-keyword kw">nil</span>
65:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M002543">
                    
                    <a name="M002543"></a><b>each_top_level_statement</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002543_source')" id="l_M002543_source">show</a>
                        
                    </p>
                    <div id="M002543_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 226</span>
226:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_top_level_statement</span>
227:     <span class="ruby-identifier">initialize_input</span>
228:     <span class="ruby-identifier">catch</span>(<span class="ruby-identifier">:TERM_INPUT</span>) <span class="ruby-keyword kw">do</span>
229:       <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
230:   <span class="ruby-keyword kw">begin</span>
231:     <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">false</span>
232:     <span class="ruby-identifier">prompt</span>
233:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">lex</span>
234:       <span class="ruby-identifier">throw</span> <span class="ruby-identifier">:TERM_INPUT</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@line</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span>
235:     <span class="ruby-keyword kw">else</span>
236:       <span class="ruby-ivar">@line</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">l</span>
237:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@continue</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
238:         <span class="ruby-keyword kw">next</span>
239:       <span class="ruby-keyword kw">end</span>
240:     <span class="ruby-keyword kw">end</span>
241:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@line</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;\n&quot;</span>
242:             <span class="ruby-ivar">@line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">encoding</span>)
243:       <span class="ruby-keyword kw">yield</span> <span class="ruby-ivar">@line</span>, <span class="ruby-ivar">@exp_line_no</span>
244:     <span class="ruby-keyword kw">end</span>
245:     <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">l</span>
246:     <span class="ruby-ivar">@line</span> = <span class="ruby-value str">''</span>
247:     <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span>
248: 
249:     <span class="ruby-ivar">@indent</span> = <span class="ruby-value">0</span>
250:     <span class="ruby-ivar">@indent_stack</span> = []
251:     <span class="ruby-identifier">prompt</span>
252:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">TerminateLineInput</span>
253:     <span class="ruby-identifier">initialize_input</span>
254:     <span class="ruby-identifier">prompt</span>
255:     <span class="ruby-identifier">get_readed</span>
256:   <span class="ruby-keyword kw">end</span>
257:       <span class="ruby-keyword kw">end</span>
258:     <span class="ruby-keyword kw">end</span>
259:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002533">
                    
                    <a name="M002533"></a><b>eof?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002533_source')" id="l_M002533_source">show</a>
                        
                    </p>
                    <div id="M002533_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 131</span>
131:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof?</span>
132:     <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
133:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002530">
                    
                    <a name="M002530"></a><b>get_readed</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002530_source')" id="l_M002530_source">show</a>
                        
                    </p>
                    <div id="M002530_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_readed</span>
89:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
90:       <span class="ruby-ivar">@base_char_no</span> = <span class="ruby-identifier">idx</span>
91:     <span class="ruby-keyword kw">else</span>
92:       <span class="ruby-ivar">@base_char_no</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span>
93:     <span class="ruby-keyword kw">end</span>
94: 
95:     <span class="ruby-identifier">readed</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&quot;</span>)
96:     <span class="ruby-ivar">@readed</span> = []
97:     <span class="ruby-identifier">readed</span>
98:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002531">
                    
                    <a name="M002531"></a><b>getc</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002531_source')" id="l_M002531_source">show</a>
                        
                    </p>
                    <div id="M002531_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 100</span>
100:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getc</span>
101:     <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
102: <span class="ruby-comment cmt">#      return nil unless buf_input</span>
103:       <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">push</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">buf_input</span>
104:     <span class="ruby-keyword kw">end</span>
105:     <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">shift</span>
106:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@here_header</span>
107:       <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">c</span>
108:     <span class="ruby-keyword kw">else</span>
109:       <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">c</span>
110:     <span class="ruby-keyword kw">end</span>
111:     <span class="ruby-ivar">@seek</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
112:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
113:       <span class="ruby-ivar">@line_no</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
114:       <span class="ruby-ivar">@char_no</span> = <span class="ruby-value">0</span>
115:     <span class="ruby-keyword kw">else</span>
116:       <span class="ruby-ivar">@char_no</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
117:     <span class="ruby-keyword kw">end</span>
118:     <span class="ruby-identifier">c</span>
119:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002534">
                    
                    <a name="M002534"></a><b>getc_of_rests</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002534_source')" id="l_M002534_source">show</a>
                        
                    </p>
                    <div id="M002534_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getc_of_rests</span>
136:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
137:       <span class="ruby-keyword kw">nil</span>
138:     <span class="ruby-keyword kw">else</span>
139:       <span class="ruby-identifier">getc</span>
140:     <span class="ruby-keyword kw">end</span>
141:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002532">
                    
                    <a name="M002532"></a><b>gets</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002532_source')" id="l_M002532_source">show</a>
                        
                    </p>
                    <div id="M002532_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gets</span>
122:     <span class="ruby-identifier">l</span> = <span class="ruby-value str">&quot;&quot;</span>
123:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>
124:       <span class="ruby-identifier">l</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">c</span>)
125:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
126:     <span class="ruby-keyword kw">end</span>
127:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
128:     <span class="ruby-identifier">l</span>
129:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002574">
                    
                    <a name="M002574"></a><b>identify_comment</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002574_source')" id="l_M002574_source">show</a>
                        
                    </p>
                    <div id="M002574_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 1123</span>
1123:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_comment</span>
1124:     <span class="ruby-ivar">@ltype</span> = <span class="ruby-value str">&quot;#&quot;</span>
1125: 
1126:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1127: <span class="ruby-comment cmt">#      if ch == &quot;\\&quot; #&quot;</span>
1128: <span class="ruby-comment cmt"># read_escape</span>
1129: <span class="ruby-comment cmt">#      end</span>
1130:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
1131:   <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword kw">nil</span>
1132:   <span class="ruby-identifier">ungetc</span>
1133:   <span class="ruby-keyword kw">break</span>
1134:       <span class="ruby-keyword kw">end</span>
1135:     <span class="ruby-keyword kw">end</span>
1136:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOMMENT</span>)
1137:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002563">
                    
                    <a name="M002563"></a><b>identify_gvar</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002563_source')" id="l_M002563_source">show</a>
                        
                    </p>
                    <div id="M002563_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 740</span>
740:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_gvar</span>
741:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
742: 
743:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
744:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[~_*$?!@\/\\;,=:&lt;&gt;&quot;.]/</span>   <span class="ruby-comment cmt">#&quot;</span>
745:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-value str">&quot;$&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ch</span>)
746:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;-&quot;</span>
747:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-value str">&quot;$-&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">getc</span>)
748:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;&amp;&quot;</span>, <span class="ruby-value str">&quot;`&quot;</span>, <span class="ruby-value str">&quot;'&quot;</span>, <span class="ruby-value str">&quot;+&quot;</span>
749:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkBACK_REF</span>, <span class="ruby-value str">&quot;$&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">ch</span>)
750:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[1-9]/</span>
751:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>; <span class="ruby-keyword kw">end</span>
752:       <span class="ruby-identifier">ungetc</span>
753:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkNTH_REF</span>)
754:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/\w/</span>
755:       <span class="ruby-identifier">ungetc</span>
756:       <span class="ruby-identifier">ungetc</span>
757:       <span class="ruby-identifier">identify_identifier</span>
758:     <span class="ruby-keyword kw">else</span>
759:       <span class="ruby-identifier">ungetc</span>
760:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;$&quot;</span>)
761:     <span class="ruby-keyword kw">end</span>
762:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002566">
                    
                    <a name="M002566"></a><b>identify_here_document</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002566_source')" id="l_M002566_source">show</a>
                        
                    </p>
                    <div id="M002566_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 873</span>
873:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_here_document</span>
874:     <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
875: <span class="ruby-comment cmt">#    if lt = PERCENT_LTYPE[ch]</span>
876:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;-&quot;</span>
877:       <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
878:       <span class="ruby-identifier">indent</span> = <span class="ruby-keyword kw">true</span>
879:     <span class="ruby-keyword kw">end</span>
880:     <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/['&quot;`]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">ch</span>
881:       <span class="ruby-identifier">lt</span> = <span class="ruby-identifier">ch</span>
882:       <span class="ruby-identifier">quoted</span> = <span class="ruby-value str">&quot;&quot;</span>
883:       <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">lt</span>
884:   <span class="ruby-identifier">quoted</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">c</span>
885:       <span class="ruby-keyword kw">end</span>
886:     <span class="ruby-keyword kw">else</span>
887:       <span class="ruby-identifier">lt</span> = <span class="ruby-value str">'&quot;'</span>
888:       <span class="ruby-identifier">quoted</span> = <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">dup</span>
889:       <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\w/</span>
890:   <span class="ruby-identifier">quoted</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">c</span>
891:       <span class="ruby-keyword kw">end</span>
892:       <span class="ruby-identifier">ungetc</span>
893:     <span class="ruby-keyword kw">end</span>
894: 
895:     <span class="ruby-identifier">ltback</span>, <span class="ruby-ivar">@ltype</span> = <span class="ruby-ivar">@ltype</span>, <span class="ruby-identifier">lt</span>
896:     <span class="ruby-identifier">reserve</span> = []
897:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
898:       <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">ch</span>
899:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\\&quot;</span>
900:   <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
901:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
902:   <span class="ruby-keyword kw">break</span>
903:       <span class="ruby-keyword kw">end</span>
904:     <span class="ruby-keyword kw">end</span>
905: 
906:     <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword kw">false</span>
907:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">gets</span>
908:       <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/(:?\r)?\n\z/</span>, <span class="ruby-value str">''</span>)
909:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">indent</span> <span class="ruby-value">? </span><span class="ruby-identifier">l</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">l</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">quoted</span>
910:   <span class="ruby-keyword kw">break</span>
911:       <span class="ruby-keyword kw">end</span>
912:     <span class="ruby-keyword kw">end</span>
913: 
914:     <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword kw">true</span>
915:     <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">reserve</span>
916:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">pop</span>
917:       <span class="ruby-identifier">ungetc</span> <span class="ruby-identifier">ch</span>
918:     <span class="ruby-keyword kw">end</span>
919: 
920:     <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">ltback</span>
921:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
922:     <span class="ruby-constant">Token</span>(<span class="ruby-constant">Ltype2Token</span>[<span class="ruby-identifier">lt</span>])
923:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002564">
                    
                    <a name="M002564"></a><b>identify_identifier</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002564_source')" id="l_M002564_source">show</a>
                        
                    </p>
                    <div id="M002564_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 764</span>
764:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_identifier</span>
765:     <span class="ruby-identifier">token</span> = <span class="ruby-value str">&quot;&quot;</span>
766:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[$@]/</span>
767:       <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>)
768:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;@&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;@&quot;</span>
769:   <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
770:       <span class="ruby-keyword kw">end</span>
771:     <span class="ruby-keyword kw">end</span>
772: 
773:     <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[^\x00-\/:-@\[-^`{-\x7F]/</span>
774:       <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;:&quot;</span>, <span class="ruby-identifier">ch</span>, <span class="ruby-value str">&quot;:&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
775:       <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">ch</span>
776:     <span class="ruby-keyword kw">end</span>
777:     <span class="ruby-identifier">ungetc</span>
778: 
779:     <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;!&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;?&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">token</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\w/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;=&quot;</span>
780:       <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
781:     <span class="ruby-keyword kw">end</span>
782: 
783:     <span class="ruby-comment cmt"># almost fix token</span>
784: 
785:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">token</span>
786:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^\$/</span>
787:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-identifier">token</span>)
788:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^\@\@/</span>
789:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
790:       <span class="ruby-comment cmt"># p Token(TkCVAR, token)</span>
791:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCVAR</span>, <span class="ruby-identifier">token</span>)
792:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^\@/</span>
793:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
794:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkIVAR</span>, <span class="ruby-identifier">token</span>)
795:     <span class="ruby-keyword kw">end</span>
796: 
797:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_DOT</span>
798:       <span class="ruby-identifier">print</span> <span class="ruby-identifier">token</span>, <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
799: 
800:       <span class="ruby-identifier">token_c</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">trans</span> = <span class="ruby-constant">TkReading2Token</span>[<span class="ruby-identifier">token</span>]
801:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">token_c</span>
802:   <span class="ruby-comment cmt"># reserved word?</span>
803: 
804:   <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">&amp;&amp;</span>
805:       <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_FNAME</span> <span class="ruby-operator">&amp;&amp;</span>
806:       <span class="ruby-identifier">trans</span>[<span class="ruby-value">1</span>])
807:     <span class="ruby-comment cmt"># modifiers</span>
808:     <span class="ruby-identifier">token_c</span> = <span class="ruby-constant">TkSymbol2Token</span>[<span class="ruby-identifier">trans</span>[<span class="ruby-value">1</span>]]
809:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">trans</span>[<span class="ruby-value">0</span>]
810:   <span class="ruby-keyword kw">else</span>
811:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_FNAME</span>
812:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ENINDENT_CLAUSE</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">token</span>)
813:         <span class="ruby-comment cmt"># check for ``class = val'' etc.</span>
814:         <span class="ruby-identifier">valid</span> = <span class="ruby-keyword kw">true</span>
815:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">token</span>
816:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;class&quot;</span>
817:     <span class="ruby-identifier">valid</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp re">/^\s*(&lt;&lt;|\w|::)/</span>)
818:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;def&quot;</span>
819:     <span class="ruby-identifier">valid</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp re">/^\s*(([+\-\/*&amp;\|^]|&lt;&lt;|&gt;&gt;|\|\||\&amp;\&amp;)=|\&amp;\&amp;|\|\|)/</span>)
820:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;do&quot;</span>
821:     <span class="ruby-identifier">valid</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp re">/^\s*([+\-\/*]?=|\*|&lt;|&gt;|\&amp;)/</span>)
822:         <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">ENINDENT_CLAUSE</span>
823:     <span class="ruby-identifier">valid</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp re">/^\s*([+\-\/*]?=|\*|&lt;|&gt;|\&amp;|\|)/</span>)
824:         <span class="ruby-keyword kw">else</span>
825:     <span class="ruby-comment cmt"># no nothing</span>
826:         <span class="ruby-keyword kw">end</span>
827:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">valid</span>
828:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">token</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;do&quot;</span>
829:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">TkFOR</span>, <span class="ruby-constant">TkWHILE</span>, <span class="ruby-constant">TkUNTIL</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>)
830:         <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
831:         <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">token_c</span>
832:       <span class="ruby-keyword kw">end</span>
833:     <span class="ruby-keyword kw">else</span>
834:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
835:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">token_c</span>
836:     <span class="ruby-keyword kw">end</span>
837: <span class="ruby-comment cmt">#   p @indent_stack</span>
838:         <span class="ruby-keyword kw">end</span>
839: 
840:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">DEINDENT_CLAUSE</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">token</span>)
841:         <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
842:         <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
843:       <span class="ruby-keyword kw">end</span>
844:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">trans</span>[<span class="ruby-value">0</span>]
845:     <span class="ruby-keyword kw">else</span>
846:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
847:     <span class="ruby-keyword kw">end</span>
848:   <span class="ruby-keyword kw">end</span>
849:   <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-identifier">token_c</span>, <span class="ruby-identifier">token</span>)
850:       <span class="ruby-keyword kw">end</span>
851:     <span class="ruby-keyword kw">end</span>
852: 
853:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
854:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
855:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
856:   <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
857:       <span class="ruby-keyword kw">end</span>
858:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_DOT</span>
859:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
860:     <span class="ruby-keyword kw">else</span>
861:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
862:     <span class="ruby-keyword kw">end</span>
863: 
864:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">token</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[A-Z]/</span>
865:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCONSTANT</span>, <span class="ruby-identifier">token</span>)
866:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">token</span>[<span class="ruby-identifier">token</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[!?]/</span>
867:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkFID</span>, <span class="ruby-identifier">token</span>)
868:     <span class="ruby-keyword kw">else</span>
869:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkIDENTIFIER</span>, <span class="ruby-identifier">token</span>)
870:     <span class="ruby-keyword kw">end</span>
871:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002568">
                    
                    <a name="M002568"></a><b>identify_number</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002568_source')" id="l_M002568_source">show</a>
                        
                    </p>
                    <div id="M002568_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 943</span>
 943:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_number</span>
 944:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
 945: 
 946:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;0&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">1</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/[.eE]/</span>
 947:       <span class="ruby-identifier">getc</span>
 948:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>)
 949:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[xX]/</span>
 950:   <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
 951:   <span class="ruby-identifier">match</span> = <span class="ruby-regexp re">/[0-9a-fA-F_]/</span>
 952:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[bB]/</span>
 953:   <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
 954:   <span class="ruby-identifier">match</span> = <span class="ruby-regexp re">/[01_]/</span>
 955:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[oO]/</span>
 956:   <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
 957:   <span class="ruby-identifier">match</span> = <span class="ruby-regexp re">/[0-7_]/</span>
 958:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[dD]/</span>
 959:   <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
 960:   <span class="ruby-identifier">match</span> = <span class="ruby-regexp re">/[0-9_]/</span>
 961:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[0-7]/</span>
 962:   <span class="ruby-identifier">match</span> = <span class="ruby-regexp re">/[0-7_]/</span>
 963:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[89]/</span>
 964:   <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-value str">&quot;Invalid octal digit&quot;</span>
 965:       <span class="ruby-keyword kw">else</span>
 966:   <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
 967:       <span class="ruby-keyword kw">end</span>
 968: 
 969:       <span class="ruby-identifier">len0</span> = <span class="ruby-keyword kw">true</span>
 970:       <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword kw">false</span>
 971:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
 972:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">match</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">ch</span>
 973:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;_&quot;</span>
 974:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">non_digit</span>
 975:         <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{ch}' in number&quot;</span>
 976:       <span class="ruby-keyword kw">else</span>
 977:         <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
 978:       <span class="ruby-keyword kw">end</span>
 979:     <span class="ruby-keyword kw">else</span>
 980:       <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword kw">false</span>
 981:       <span class="ruby-identifier">len0</span> = <span class="ruby-keyword kw">false</span>
 982:     <span class="ruby-keyword kw">end</span>
 983:   <span class="ruby-keyword kw">else</span>
 984:     <span class="ruby-identifier">ungetc</span>
 985:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">len0</span>
 986:       <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-value str">&quot;numeric literal without digits&quot;</span>
 987:     <span class="ruby-keyword kw">end</span>
 988:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">non_digit</span>
 989:       <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
 990:     <span class="ruby-keyword kw">end</span>
 991:     <span class="ruby-keyword kw">break</span>
 992:   <span class="ruby-keyword kw">end</span>
 993:       <span class="ruby-keyword kw">end</span>
 994:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
 995:     <span class="ruby-keyword kw">end</span>
 996: 
 997:     <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkINTEGER</span>
 998:     <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword kw">true</span>
 999:     <span class="ruby-identifier">allow_e</span> = <span class="ruby-keyword kw">true</span>
1000:     <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword kw">false</span>
1001:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1002:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span>
1003:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[0-9]/</span>
1004:   <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword kw">false</span>
1005:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;_&quot;</span>
1006:   <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
1007:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">allow_point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-value str">&quot;.&quot;</span>
1008:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">non_digit</span>
1009:     <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
1010:   <span class="ruby-keyword kw">end</span>
1011:   <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkFLOAT</span>
1012:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/[0-9]/</span>
1013:     <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkINTEGER</span>
1014:     <span class="ruby-identifier">ungetc</span>
1015:     <span class="ruby-keyword kw">break</span>
1016:   <span class="ruby-keyword kw">end</span>
1017:   <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword kw">false</span>
1018:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">allow_e</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-value str">&quot;e&quot;</span>, <span class="ruby-identifier">allow_e</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-value str">&quot;E&quot;</span>
1019:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">non_digit</span>
1020:     <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
1021:   <span class="ruby-keyword kw">end</span>
1022:   <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkFLOAT</span>
1023:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[+-]/</span>
1024:     <span class="ruby-identifier">getc</span>
1025:   <span class="ruby-keyword kw">end</span>
1026:   <span class="ruby-identifier">allow_e</span> = <span class="ruby-keyword kw">false</span>
1027:   <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword kw">false</span>
1028:   <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
1029:       <span class="ruby-keyword kw">else</span>
1030:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">non_digit</span>
1031:     <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
1032:   <span class="ruby-keyword kw">end</span>
1033:   <span class="ruby-identifier">ungetc</span>
1034:   <span class="ruby-keyword kw">break</span>
1035:       <span class="ruby-keyword kw">end</span>
1036:     <span class="ruby-keyword kw">end</span>
1037:     <span class="ruby-constant">Token</span>(<span class="ruby-identifier">type</span>)
1038:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002567">
                    
                    <a name="M002567"></a><b>identify_quotation</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002567_source')" id="l_M002567_source">show</a>
                        
                    </p>
                    <div id="M002567_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 925</span>
925:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_quotation</span>
926:     <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
927:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lt</span> = <span class="ruby-constant">PERCENT_LTYPE</span>[<span class="ruby-identifier">ch</span>]
928:       <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
929:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\W/</span>
930:       <span class="ruby-identifier">lt</span> = <span class="ruby-value str">&quot;\&quot;&quot;</span>
931:     <span class="ruby-keyword kw">else</span>
932:       <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-value str">&quot;unknown type of %string&quot;</span>
933:     <span class="ruby-keyword kw">end</span>
934: <span class="ruby-comment cmt">#     if ch !~ /\W/</span>
935: <span class="ruby-comment cmt">#       ungetc</span>
936: <span class="ruby-comment cmt">#       next</span>
937: <span class="ruby-comment cmt">#     end</span>
938:     <span class="ruby-comment cmt">#@ltype = lt</span>
939:     <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">ch</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@quoted</span> = <span class="ruby-constant">PERCENT_PAREN</span>[<span class="ruby-identifier">ch</span>]
940:     <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">lt</span>, <span class="ruby-ivar">@quoted</span>)
941:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002570">
                    
                    <a name="M002570"></a><b>identify_string</b>(ltype, quoted = ltype)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002570_source')" id="l_M002570_source">show</a>
                        
                    </p>
                    <div id="M002570_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 1040</span>
1040:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">ltype</span>, <span class="ruby-identifier">quoted</span> = <span class="ruby-identifier">ltype</span>)
1041:     <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">ltype</span>
1042:     <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">quoted</span>
1043:     <span class="ruby-identifier">subtype</span> = <span class="ruby-keyword kw">nil</span>
1044:     <span class="ruby-keyword kw">begin</span>
1045:       <span class="ruby-identifier">nest</span> = <span class="ruby-value">0</span>
1046:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1047:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@quoted</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">ch</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">nest</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
1048:     <span class="ruby-keyword kw">break</span>
1049:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;'&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;#&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;{&quot;</span>
1050:     <span class="ruby-identifier">identify_string_dvar</span>
1051:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;'&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;]&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;:&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;#&quot;</span>
1052:     <span class="ruby-identifier">subtype</span> = <span class="ruby-keyword kw">true</span>
1053:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'\\'</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;'&quot;</span> <span class="ruby-comment cmt">#'</span>
1054:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1055:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\\&quot;</span>, <span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;'&quot;</span>
1056:     <span class="ruby-keyword kw">else</span>
1057:       <span class="ruby-identifier">ungetc</span>
1058:     <span class="ruby-keyword kw">end</span>
1059:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'\\'</span> <span class="ruby-comment cmt">#'</span>
1060:     <span class="ruby-identifier">read_escape</span>
1061:   <span class="ruby-keyword kw">end</span>
1062:   <span class="ruby-keyword kw">if</span> <span class="ruby-constant">PERCENT_PAREN</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@quoted</span>)
1063:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">PERCENT_PAREN</span>[<span class="ruby-identifier">ch</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@quoted</span>
1064:       <span class="ruby-identifier">nest</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1065:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@quoted</span>
1066:       <span class="ruby-identifier">nest</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
1067:     <span class="ruby-keyword kw">end</span>
1068:   <span class="ruby-keyword kw">end</span>
1069:       <span class="ruby-keyword kw">end</span>
1070:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;/&quot;</span>
1071:         <span class="ruby-keyword kw">while</span> <span class="ruby-regexp re">/[imxoesun]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>)
1072:     <span class="ruby-identifier">getc</span>
1073:   <span class="ruby-keyword kw">end</span>
1074:       <span class="ruby-keyword kw">end</span>
1075:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">subtype</span>
1076:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">DLtype2Token</span>[<span class="ruby-identifier">ltype</span>])
1077:       <span class="ruby-keyword kw">else</span>
1078:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">Ltype2Token</span>[<span class="ruby-identifier">ltype</span>])
1079:       <span class="ruby-keyword kw">end</span>
1080:     <span class="ruby-keyword kw">ensure</span>
1081:       <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword kw">nil</span>
1082:       <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword kw">nil</span>
1083:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
1084:     <span class="ruby-keyword kw">end</span>
1085:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002573">
                    
                    <a name="M002573"></a><b>identify_string_dvar</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002573_source')" id="l_M002573_source">show</a>
                        
                    </p>
                    <div id="M002573_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 1087</span>
1087:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identify_string_dvar</span>
1088:     <span class="ruby-keyword kw">begin</span>
1089:       <span class="ruby-identifier">getc</span>
1090: 
1091:       <span class="ruby-identifier">reserve_continue</span> = <span class="ruby-ivar">@continue</span>
1092:       <span class="ruby-identifier">reserve_ltype</span> = <span class="ruby-ivar">@ltype</span>
1093:       <span class="ruby-identifier">reserve_indent</span> = <span class="ruby-ivar">@indent</span>
1094:       <span class="ruby-identifier">reserve_indent_stack</span> = <span class="ruby-ivar">@indent_stack</span>
1095:       <span class="ruby-identifier">reserve_state</span> = <span class="ruby-ivar">@lex_state</span>
1096:       <span class="ruby-identifier">reserve_quoted</span> = <span class="ruby-ivar">@quoted</span>
1097: 
1098:       <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword kw">nil</span>
1099:       <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword kw">nil</span>
1100:       <span class="ruby-ivar">@indent</span> = <span class="ruby-value">0</span>
1101:       <span class="ruby-ivar">@indent_stack</span> = []
1102:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
1103: 
1104:       <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
1105:   <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">false</span>
1106:   <span class="ruby-identifier">prompt</span>
1107:   <span class="ruby-identifier">tk</span> = <span class="ruby-identifier">token</span>
1108:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@continue</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
1109:     <span class="ruby-keyword kw">next</span>
1110:   <span class="ruby-keyword kw">end</span>
1111:   <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkRBRACE</span>)
1112:       <span class="ruby-keyword kw">end</span>
1113:     <span class="ruby-keyword kw">ensure</span>
1114:       <span class="ruby-ivar">@continue</span> = <span class="ruby-identifier">reserve_continue</span>
1115:       <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">reserve_ltype</span>
1116:       <span class="ruby-ivar">@indent</span> = <span class="ruby-identifier">reserve_indent</span>
1117:       <span class="ruby-ivar">@indent_stack</span> = <span class="ruby-identifier">reserve_indent_stack</span>
1118:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">reserve_state</span>
1119:       <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">reserve_quoted</span>
1120:     <span class="ruby-keyword kw">end</span>
1121:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002542">
                    
                    <a name="M002542"></a><b>initialize_input</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002542_source')" id="l_M002542_source">show</a>
                        
                    </p>
                    <div id="M002542_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 210</span>
210:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_input</span>
211:     <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword kw">nil</span>
212:     <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword kw">nil</span>
213:     <span class="ruby-ivar">@indent</span> = <span class="ruby-value">0</span>
214:     <span class="ruby-ivar">@indent_stack</span> = []
215:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
216:     <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword kw">false</span>
217:     <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword kw">false</span>
218: 
219:     <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">false</span>
220:     <span class="ruby-identifier">prompt</span>
221: 
222:     <span class="ruby-ivar">@line</span> = <span class="ruby-value str">&quot;&quot;</span>
223:     <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span>
224:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002544">
                    
                    <a name="M002544"></a><b>lex</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002544_source')" id="l_M002544_source">show</a>
                        
                    </p>
                    <div id="M002544_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 261</span>
261:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lex</span>
262:     <span class="ruby-keyword kw">until</span> (((<span class="ruby-identifier">tk</span> = <span class="ruby-identifier">token</span>).<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkNL</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>)) <span class="ruby-operator">&amp;&amp;</span>
263:        <span class="ruby-operator">!</span><span class="ruby-ivar">@continue</span> <span class="ruby-keyword kw">or</span>
264:        <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">nil?</span>)
265:       <span class="ruby-comment cmt">#p tk</span>
266:       <span class="ruby-comment cmt">#p @lex_state</span>
267:       <span class="ruby-comment cmt">#p self</span>
268:     <span class="ruby-keyword kw">end</span>
269:     <span class="ruby-identifier">line</span> = <span class="ruby-identifier">get_readed</span>
270:     <span class="ruby-comment cmt">#      print self.inspect</span>
271:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">nil?</span>
272:       <span class="ruby-keyword kw">nil</span>
273:     <span class="ruby-keyword kw">else</span>
274:       <span class="ruby-identifier">line</span>
275:     <span class="ruby-keyword kw">end</span>
276:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002547">
                    
                    <a name="M002547"></a><b>lex_init</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002547_source')" id="l_M002547_source">show</a>
                        
                    </p>
                    <div id="M002547_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 338</span>
338:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lex_init</span>()
339:     <span class="ruby-ivar">@OP</span> = <span class="ruby-constant">IRB</span><span class="ruby-operator">::</span><span class="ruby-constant">SLex</span>.<span class="ruby-identifier">new</span>
340:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;\0&quot;</span>, <span class="ruby-value str">&quot;\004&quot;</span>, <span class="ruby-value str">&quot;\032&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
341:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>)
342:     <span class="ruby-keyword kw">end</span>
343: 
344:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot; &quot;</span>, <span class="ruby-value str">&quot;\t&quot;</span>, <span class="ruby-value str">&quot;\f&quot;</span>, <span class="ruby-value str">&quot;\r&quot;</span>, <span class="ruby-value str">&quot;\13&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
345:       <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword kw">true</span>
346:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[ \t\f\r\13]/</span>; <span class="ruby-keyword kw">end</span>
347:       <span class="ruby-identifier">ungetc</span>
348:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSPACE</span>)
349:     <span class="ruby-keyword kw">end</span>
350: 
351:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;#&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
352:       <span class="ruby-identifier">identify_comment</span>
353:     <span class="ruby-keyword kw">end</span>
354: 
355:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;=begin&quot;</span>,
356:      <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@prev_char_no</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>}) <span class="ruby-keyword kw">do</span>
357:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
358:       <span class="ruby-ivar">@ltype</span> = <span class="ruby-value str">&quot;=&quot;</span>
359:       <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>; <span class="ruby-keyword kw">end</span>
360:       <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">peek_equal?</span>(<span class="ruby-value str">&quot;=end&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">4</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>
361:   <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>; <span class="ruby-keyword kw">end</span>
362:       <span class="ruby-keyword kw">end</span>
363:       <span class="ruby-identifier">gets</span>
364:       <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword kw">nil</span>
365:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkRD_COMMENT</span>)
366:     <span class="ruby-keyword kw">end</span>
367: 
368:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
369:       <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
370:       <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@lex_state</span>
371:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">EXPR_BEG</span>, <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
372:   <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">true</span>
373:       <span class="ruby-keyword kw">else</span>
374:   <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">false</span>
375:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
376:   <span class="ruby-keyword kw">until</span> (<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span>
377:          [<span class="ruby-constant">TkLPAREN</span>, <span class="ruby-constant">TkLBRACK</span>, <span class="ruby-constant">TkLBRACE</span>,
378:      <span class="ruby-constant">TkfLPAREN</span>, <span class="ruby-constant">TkfLBRACK</span>, <span class="ruby-constant">TkfLBRACE</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>))
379:     <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
380:   <span class="ruby-keyword kw">end</span>
381:       <span class="ruby-keyword kw">end</span>
382:       <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword kw">false</span>
383:       <span class="ruby-ivar">@here_readed</span> = []
384:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkNL</span>)
385:     <span class="ruby-keyword kw">end</span>
386: 
387:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;*&quot;</span>, <span class="ruby-value str">&quot;**&quot;</span>,
388:       <span class="ruby-value str">&quot;=&quot;</span>, <span class="ruby-value str">&quot;==&quot;</span>, <span class="ruby-value str">&quot;===&quot;</span>,
389:       <span class="ruby-value str">&quot;=~&quot;</span>, <span class="ruby-value str">&quot;&lt;=&gt;&quot;</span>,
390:       <span class="ruby-value str">&quot;&lt;&quot;</span>, <span class="ruby-value str">&quot;&lt;=&quot;</span>,
391:       <span class="ruby-value str">&quot;&gt;&quot;</span>, <span class="ruby-value str">&quot;&gt;=&quot;</span>, <span class="ruby-value str">&quot;&gt;&gt;&quot;</span>,
392:       <span class="ruby-value str">&quot;!&quot;</span>, <span class="ruby-value str">&quot;!=&quot;</span>, <span class="ruby-value str">&quot;!~&quot;</span>) <span class="ruby-keyword kw">do</span>
393:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
394:       <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@lex_state</span>
395:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
396:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
397:       <span class="ruby-keyword kw">else</span>
398:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
399:       <span class="ruby-keyword kw">end</span>
400:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
401:     <span class="ruby-keyword kw">end</span>
402: 
403:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;&lt;&lt;&quot;</span>) <span class="ruby-keyword kw">do</span>
404:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
405:       <span class="ruby-identifier">tk</span> = <span class="ruby-keyword kw">nil</span>
406:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_CLASS</span> <span class="ruby-operator">&amp;&amp;</span>
407:     (<span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@space_seen</span>)
408:   <span class="ruby-identifier">c</span> = <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>)
409:   <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\S/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-regexp re">/[&quot;'`]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">||</span> <span class="ruby-regexp re">/\w/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;-&quot;</span>)
410:     <span class="ruby-identifier">tk</span> = <span class="ruby-identifier">identify_here_document</span>
411:   <span class="ruby-keyword kw">end</span>
412:       <span class="ruby-keyword kw">end</span>
413:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">tk</span>
414:   <span class="ruby-identifier">tk</span> = <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
415:   <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@lex_state</span>
416:   <span class="ruby-keyword kw">when</span> <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
417:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
418:   <span class="ruby-keyword kw">else</span>
419:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
420:   <span class="ruby-keyword kw">end</span>
421:       <span class="ruby-keyword kw">end</span>
422:       <span class="ruby-identifier">tk</span>
423:     <span class="ruby-keyword kw">end</span>
424: 
425:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;'&quot;</span>, <span class="ruby-value str">'&quot;'</span>) <span class="ruby-keyword kw">do</span>
426:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
427:       <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
428:     <span class="ruby-keyword kw">end</span>
429: 
430:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;`&quot;</span>) <span class="ruby-keyword kw">do</span>
431:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
432:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
433:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
434:   <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
435:       <span class="ruby-keyword kw">else</span>
436:   <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
437:       <span class="ruby-keyword kw">end</span>
438:     <span class="ruby-keyword kw">end</span>
439: 
440:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">'?'</span>) <span class="ruby-keyword kw">do</span>
441:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
442:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_END</span>
443:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
444:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkQUESTION</span>)
445:       <span class="ruby-keyword kw">else</span>
446:   <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
447:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>
448:     <span class="ruby-identifier">ungetc</span>
449:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>;
450:     <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkQUESTION</span>)
451:   <span class="ruby-keyword kw">else</span>
452:     <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'\\'</span>)
453:       <span class="ruby-identifier">read_escape</span>
454:     <span class="ruby-keyword kw">end</span>
455:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
456:     <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
457:   <span class="ruby-keyword kw">end</span>
458:       <span class="ruby-keyword kw">end</span>
459:     <span class="ruby-keyword kw">end</span>
460: 
461:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>, <span class="ruby-value str">&quot;&amp;&amp;&quot;</span>, <span class="ruby-value str">&quot;|&quot;</span>, <span class="ruby-value str">&quot;||&quot;</span>) <span class="ruby-keyword kw">do</span>
462:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
463:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
464:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
465:     <span class="ruby-keyword kw">end</span>
466: 
467:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;+=&quot;</span>, <span class="ruby-value str">&quot;-=&quot;</span>, <span class="ruby-value str">&quot;*=&quot;</span>, <span class="ruby-value str">&quot;**=&quot;</span>,
468:       <span class="ruby-value str">&quot;&amp;=&quot;</span>, <span class="ruby-value str">&quot;|=&quot;</span>, <span class="ruby-value str">&quot;^=&quot;</span>, <span class="ruby-value str">&quot;&lt;&lt;=&quot;</span>, <span class="ruby-value str">&quot;&gt;&gt;=&quot;</span>, <span class="ruby-value str">&quot;||=&quot;</span>, <span class="ruby-value str">&quot;&amp;&amp;=&quot;</span>) <span class="ruby-keyword kw">do</span>
469:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
470:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
471:       <span class="ruby-identifier">op</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^(.*)=$/</span>
472:       <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-identifier">$1</span>)
473:     <span class="ruby-keyword kw">end</span>
474: 
475:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;+@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
476:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
477:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
478:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
479:     <span class="ruby-keyword kw">end</span>
480: 
481:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;-@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
482:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
483:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
484:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
485:     <span class="ruby-keyword kw">end</span>
486: 
487:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;+&quot;</span>, <span class="ruby-value str">&quot;-&quot;</span>) <span class="ruby-keyword kw">do</span>
488:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
489:       <span class="ruby-identifier">catch</span>(<span class="ruby-identifier">:RET</span>) <span class="ruby-keyword kw">do</span>
490:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span>
491:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>
492:       <span class="ruby-identifier">throw</span> <span class="ruby-identifier">:RET</span>, <span class="ruby-identifier">identify_number</span>
493:     <span class="ruby-keyword kw">else</span>
494:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
495:     <span class="ruby-keyword kw">end</span>
496:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>
497:     <span class="ruby-identifier">throw</span> <span class="ruby-identifier">:RET</span>, <span class="ruby-identifier">identify_number</span>
498:   <span class="ruby-keyword kw">else</span>
499:     <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
500:   <span class="ruby-keyword kw">end</span>
501:   <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
502:       <span class="ruby-keyword kw">end</span>
503:     <span class="ruby-keyword kw">end</span>
504: 
505:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;.&quot;</span>) <span class="ruby-keyword kw">do</span>
506:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
507:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
508:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>
509:   <span class="ruby-identifier">ungetc</span>
510:   <span class="ruby-identifier">identify_number</span>
511:       <span class="ruby-keyword kw">else</span>
512:   <span class="ruby-comment cmt"># for &quot;obj.if&quot; etc.</span>
513:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_DOT</span>
514:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkDOT</span>)
515:       <span class="ruby-keyword kw">end</span>
516:     <span class="ruby-keyword kw">end</span>
517: 
518:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;..&quot;</span>, <span class="ruby-value str">&quot;...&quot;</span>) <span class="ruby-keyword kw">do</span>
519:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
520:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
521:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
522:     <span class="ruby-keyword kw">end</span>
523: 
524:     <span class="ruby-identifier">lex_int2</span>
525:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002559">
                    
                    <a name="M002559"></a><b>lex_int2</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002559_source')" id="l_M002559_source">show</a>
                        
                    </p>
                    <div id="M002559_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 527</span>
527:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lex_int2</span>
528:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;]&quot;</span>, <span class="ruby-value str">&quot;}&quot;</span>, <span class="ruby-value str">&quot;)&quot;</span>) <span class="ruby-keyword kw">do</span>
529:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
530:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
531:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
532:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
533:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
534:     <span class="ruby-keyword kw">end</span>
535: 
536:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;:&quot;</span>) <span class="ruby-keyword kw">do</span>
537:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
538:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>
539:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
540:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON</span>)
541:       <span class="ruby-keyword kw">else</span>
542:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_FNAME</span>;
543:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSYMBEG</span>)
544:       <span class="ruby-keyword kw">end</span>
545:     <span class="ruby-keyword kw">end</span>
546: 
547:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;::&quot;</span>) <span class="ruby-keyword kw">do</span>
548:        <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
549: <span class="ruby-comment cmt">#      p @lex_state.id2name, @space_seen</span>
550:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
551:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
552:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON3</span>)
553:       <span class="ruby-keyword kw">else</span>
554:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_DOT</span>
555:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON2</span>)
556:       <span class="ruby-keyword kw">end</span>
557:     <span class="ruby-keyword kw">end</span>
558: 
559:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-keyword kw">do</span>
560:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
561:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
562:   <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
563:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
564:   <span class="ruby-identifier">getc</span>
565:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
566:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-comment cmt">#/)</span>
567:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\s/</span>
568:   <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
569:       <span class="ruby-keyword kw">else</span>
570:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
571:   <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-comment cmt">#/)</span>
572:       <span class="ruby-keyword kw">end</span>
573:     <span class="ruby-keyword kw">end</span>
574: 
575:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;^&quot;</span>) <span class="ruby-keyword kw">do</span>
576:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
577:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
578:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;^&quot;</span>)
579:     <span class="ruby-keyword kw">end</span>
580: 
581:     <span class="ruby-comment cmt">#       @OP.def_rules(&quot;^=&quot;) do</span>
582:     <span class="ruby-comment cmt">#   @lex_state = EXPR_BEG</span>
583:     <span class="ruby-comment cmt">#   Token(OP_ASGN, :^)</span>
584:     <span class="ruby-comment cmt">#       end</span>
585: 
586:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;,&quot;</span>) <span class="ruby-keyword kw">do</span>
587:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
588:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
589:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
590:     <span class="ruby-keyword kw">end</span>
591: 
592:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;;&quot;</span>) <span class="ruby-keyword kw">do</span>
593:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
594:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
595:       <span class="ruby-keyword kw">until</span> (<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span>
596:        [<span class="ruby-constant">TkLPAREN</span>, <span class="ruby-constant">TkLBRACK</span>, <span class="ruby-constant">TkLBRACE</span>,
597:          <span class="ruby-constant">TkfLPAREN</span>, <span class="ruby-constant">TkfLBRACK</span>, <span class="ruby-constant">TkfLBRACE</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>))
598:   <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
599:       <span class="ruby-keyword kw">end</span>
600:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
601:     <span class="ruby-keyword kw">end</span>
602: 
603:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;~&quot;</span>) <span class="ruby-keyword kw">do</span>
604:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
605:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
606:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;~&quot;</span>)
607:     <span class="ruby-keyword kw">end</span>
608: 
609:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;~@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
610:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
611:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
612:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;~&quot;</span>)
613:     <span class="ruby-keyword kw">end</span>
614: 
615:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;(&quot;</span>) <span class="ruby-keyword kw">do</span>
616:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
617:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
618:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
619:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
620:   <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLPAREN</span>
621:       <span class="ruby-keyword kw">else</span>
622:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
623:   <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLPAREN</span>
624:       <span class="ruby-keyword kw">end</span>
625:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
626:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
627:     <span class="ruby-keyword kw">end</span>
628: 
629:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[]&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
630:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
631:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
632:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;[]&quot;</span>)
633:     <span class="ruby-keyword kw">end</span>
634: 
635:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[]=&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
636:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
637:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
638:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;[]=&quot;</span>)
639:     <span class="ruby-keyword kw">end</span>
640: 
641:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[&quot;</span>) <span class="ruby-keyword kw">do</span>
642:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
643:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
644:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
645:   <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
646:       <span class="ruby-keyword kw">else</span>
647:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
648:     <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
649:   <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
650:     <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
651:   <span class="ruby-keyword kw">else</span>
652:     <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
653:   <span class="ruby-keyword kw">end</span>
654:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
655:       <span class="ruby-keyword kw">end</span>
656:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
657:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
658:     <span class="ruby-keyword kw">end</span>
659: 
660:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;{&quot;</span>) <span class="ruby-keyword kw">do</span>
661:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
662:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
663:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_ARG</span>
664:   <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACE</span>
665:       <span class="ruby-keyword kw">else</span>
666:   <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACE</span>
667:       <span class="ruby-keyword kw">end</span>
668:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
669:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
670:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
671:     <span class="ruby-keyword kw">end</span>
672: 
673:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'\\'</span>) <span class="ruby-keyword kw">do</span>
674:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
675:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
676:   <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword kw">true</span>
677:   <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">true</span>
678:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSPACE</span>)
679:       <span class="ruby-keyword kw">else</span>
680:   <span class="ruby-identifier">read_escape</span>
681:   <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;\\&quot;</span>)
682:       <span class="ruby-keyword kw">end</span>
683:     <span class="ruby-keyword kw">end</span>
684: 
685:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'%'</span>) <span class="ruby-keyword kw">do</span>
686:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
687:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
688:   <span class="ruby-identifier">identify_quotation</span>
689:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
690:   <span class="ruby-identifier">getc</span>
691:   <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-identifier">:%</span>)
692:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\s/</span>
693:   <span class="ruby-identifier">identify_quotation</span>
694:       <span class="ruby-keyword kw">else</span>
695:   <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
696:   <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;%&quot;</span>) <span class="ruby-comment cmt">#))</span>
697:       <span class="ruby-keyword kw">end</span>
698:     <span class="ruby-keyword kw">end</span>
699: 
700:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'$'</span>) <span class="ruby-keyword kw">do</span>
701:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
702:       <span class="ruby-identifier">identify_gvar</span>
703:     <span class="ruby-keyword kw">end</span>
704: 
705:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'@'</span>) <span class="ruby-keyword kw">do</span>
706:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
707:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[\w@]/</span>
708:   <span class="ruby-identifier">ungetc</span>
709:   <span class="ruby-identifier">identify_identifier</span>
710:       <span class="ruby-keyword kw">else</span>
711:   <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;@&quot;</span>)
712:       <span class="ruby-keyword kw">end</span>
713:     <span class="ruby-keyword kw">end</span>
714: 
715:     <span class="ruby-comment cmt">#       @OP.def_rule(&quot;def&quot;, proc{|op, io| /\s/ =~ io.peek(0)}) do</span>
716:     <span class="ruby-comment cmt">#   |op, io|</span>
717:     <span class="ruby-comment cmt">#   @indent += 1</span>
718:     <span class="ruby-comment cmt">#   @lex_state = EXPR_FNAME</span>
719:     <span class="ruby-comment cmt"># # @lex_state = EXPR_END</span>
720:     <span class="ruby-comment cmt"># # until @rests[0] == &quot;\n&quot; or @rests[0] == &quot;;&quot;</span>
721:     <span class="ruby-comment cmt"># #   rests.shift</span>
722:     <span class="ruby-comment cmt"># # end</span>
723:     <span class="ruby-comment cmt">#       end</span>
724: 
725:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-keyword kw">do</span>
726:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
727:       <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;MATCH: start %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
728:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>
729:   <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_number</span>
730:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[^\x00-\/:-@\[-^`{-\x7F]/</span>
731:   <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_identifier</span>
732:       <span class="ruby-keyword kw">end</span>
733:       <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;MATCH: end %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
734:       <span class="ruby-identifier">t</span>
735:     <span class="ruby-keyword kw">end</span>
736: 
737:     <span class="ruby-identifier">p</span> <span class="ruby-ivar">@OP</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
738:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002538">
                    
                    <a name="M002538"></a><b>peek</b>(i = 0)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002538_source')" id="l_M002538_source">show</a>
                        
                    </p>
                    <div id="M002538_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">peek</span>(<span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>)
180:     <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">i</span>
181:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">buf_input</span>
182:     <span class="ruby-keyword kw">end</span>
183:     <span class="ruby-ivar">@rests</span>[<span class="ruby-identifier">i</span>]
184:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002536">
                    
                    <a name="M002536"></a><b>peek_equal?</b>(str)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002536_source')" id="l_M002536_source">show</a>
                        
                    </p>
                    <div id="M002536_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">peek_equal?</span>(<span class="ruby-identifier">str</span>)
165:     <span class="ruby-identifier">chrs</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">//</span>)
166:     <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">chrs</span>.<span class="ruby-identifier">size</span>
167:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">buf_input</span>
168:     <span class="ruby-keyword kw">end</span>
169:     <span class="ruby-ivar">@rests</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">chrs</span>.<span class="ruby-identifier">size</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">chrs</span>
170:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002537">
                    
                    <a name="M002537"></a><b>peek_match?</b>(regexp)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002537_source')" id="l_M002537_source">show</a>
                        
                    </p>
                    <div id="M002537_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-identifier">regexp</span>)
173:     <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
174:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">buf_input</span>
175:     <span class="ruby-keyword kw">end</span>
176:     <span class="ruby-identifier">regexp</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&quot;</span>)
177:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002541">
                    
                    <a name="M002541"></a><b>prompt</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002541_source')" id="l_M002541_source">show</a>
                        
                    </p>
                    <div id="M002541_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 204</span>
204:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prompt</span>
205:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@prompt</span>
206:       <span class="ruby-ivar">@prompt</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@ltype</span>, <span class="ruby-ivar">@indent</span>, <span class="ruby-ivar">@continue</span>, <span class="ruby-ivar">@line_no</span>)
207:     <span class="ruby-keyword kw">end</span>
208:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002576">
                    
                    <a name="M002576"></a><b>read_escape</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002576_source')" id="l_M002576_source">show</a>
                        
                    </p>
                    <div id="M002576_source" class="dyn-source">
                        <pre>      <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 1139</span>
1139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_escape</span>
1140:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1141:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;\r&quot;</span>, <span class="ruby-value str">&quot;\f&quot;</span>
1142:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;\\&quot;</span>, <span class="ruby-value str">&quot;n&quot;</span>, <span class="ruby-value str">&quot;t&quot;</span>, <span class="ruby-value str">&quot;r&quot;</span>, <span class="ruby-value str">&quot;f&quot;</span>, <span class="ruby-value str">&quot;v&quot;</span>, <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;e&quot;</span>, <span class="ruby-value str">&quot;b&quot;</span>, <span class="ruby-value str">&quot;s&quot;</span> <span class="ruby-comment cmt">#&quot;</span>
1143:     <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[0-7]/</span>
1144:       <span class="ruby-identifier">ungetc</span> <span class="ruby-identifier">ch</span>
1145:       <span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword kw">do</span>
1146:   <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1147:   <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[0-7]/</span>
1148:   <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>
1149:     <span class="ruby-keyword kw">break</span>
1150:   <span class="ruby-keyword kw">else</span>
1151:     <span class="ruby-identifier">ungetc</span>
1152:     <span class="ruby-keyword kw">break</span>
1153:   <span class="ruby-keyword kw">end</span>
1154:       <span class="ruby-keyword kw">end</span>
1155: 
1156:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;x&quot;</span>
1157:       <span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword kw">do</span>
1158:   <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
1159:   <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/[0-9a-fA-F]/</span>
1160:   <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>
1161:     <span class="ruby-keyword kw">break</span>
1162:   <span class="ruby-keyword kw">else</span>
1163:     <span class="ruby-identifier">ungetc</span>
1164:     <span class="ruby-keyword kw">break</span>
1165:   <span class="ruby-keyword kw">end</span>
1166:       <span class="ruby-keyword kw">end</span>
1167: 
1168:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;M&quot;</span>
1169:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">!=</span> <span class="ruby-value str">'-'</span>
1170:   <span class="ruby-identifier">ungetc</span>
1171:       <span class="ruby-keyword kw">else</span>
1172:   <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\\&quot;</span> <span class="ruby-comment cmt">#&quot;</span>
1173:     <span class="ruby-identifier">read_escape</span>
1174:   <span class="ruby-keyword kw">end</span>
1175:       <span class="ruby-keyword kw">end</span>
1176: 
1177:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;C&quot;</span>, <span class="ruby-value str">&quot;c&quot;</span> <span class="ruby-comment cmt">#, &quot;^&quot;</span>
1178:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;C&quot;</span> <span class="ruby-keyword kw">and</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;-&quot;</span>
1179:   <span class="ruby-identifier">ungetc</span>
1180:       <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\\&quot;</span> <span class="ruby-comment cmt">#&quot;</span>
1181:   <span class="ruby-identifier">read_escape</span>
1182:       <span class="ruby-keyword kw">end</span>
1183:     <span class="ruby-keyword kw">else</span>
1184:       <span class="ruby-comment cmt"># other characters</span>
1185:     <span class="ruby-keyword kw">end</span>
1186:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002529">
                    
                    <a name="M002529"></a><b>set_input</b>(io, p = nil, &amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
io functions
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002529_source')" id="l_M002529_source">show</a>
                        
                    </p>
                    <div id="M002529_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 77</span>
77:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_input</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">p</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
78:     <span class="ruby-ivar">@io</span> = <span class="ruby-identifier">io</span>
79:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:call</span>)
80:       <span class="ruby-ivar">@input</span> = <span class="ruby-identifier">p</span>
81:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_given?</span>
82:       <span class="ruby-ivar">@input</span> = <span class="ruby-identifier">block</span>
83:     <span class="ruby-keyword kw">else</span>
84:       <span class="ruby-ivar">@input</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">gets</span>}
85:     <span class="ruby-keyword kw">end</span>
86:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002540">
                    
                    <a name="M002540"></a><b>set_prompt</b>(p = nil, &amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002540_source')" id="l_M002540_source">show</a>
                        
                    </p>
                    <div id="M002540_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 195</span>
195:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_prompt</span>(<span class="ruby-identifier">p</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
196:     <span class="ruby-identifier">p</span> = <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
197:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:call</span>)
198:       <span class="ruby-ivar">@prompt</span> = <span class="ruby-identifier">p</span>
199:     <span class="ruby-keyword kw">else</span>
200:       <span class="ruby-ivar">@prompt</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-identifier">print</span> <span class="ruby-identifier">p</span>}
201:     <span class="ruby-keyword kw">end</span>
202:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002546">
                    
                    <a name="M002546"></a><b>token</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002546_source')" id="l_M002546_source">show</a>
                        
                    </p>
                    <div id="M002546_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 278</span>
278:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">token</span>
279:     <span class="ruby-comment cmt">#      require &quot;tracer&quot;</span>
280:     <span class="ruby-comment cmt">#      Tracer.on</span>
281:     <span class="ruby-ivar">@prev_seek</span> = <span class="ruby-ivar">@seek</span>
282:     <span class="ruby-ivar">@prev_line_no</span> = <span class="ruby-ivar">@line_no</span>
283:     <span class="ruby-ivar">@prev_char_no</span> = <span class="ruby-ivar">@char_no</span>
284:     <span class="ruby-keyword kw">begin</span>
285:       <span class="ruby-keyword kw">begin</span>
286:   <span class="ruby-identifier">tk</span> = <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">match</span>(<span class="ruby-keyword kw">self</span>)
287:   <span class="ruby-ivar">@space_seen</span> = <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkSPACE</span>)
288:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SyntaxError</span>
289:   <span class="ruby-identifier">raise</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@exception_on_syntax_error</span>
290:   <span class="ruby-identifier">tk</span> = <span class="ruby-constant">TkError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@seek</span>, <span class="ruby-ivar">@line_no</span>, <span class="ruby-ivar">@char_no</span>)
291:       <span class="ruby-keyword kw">end</span>
292:     <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@skip_space</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkSPACE</span>)
293:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@readed_auto_clean_up</span>
294:       <span class="ruby-identifier">get_readed</span>
295:     <span class="ruby-keyword kw">end</span>
296:     <span class="ruby-comment cmt">#      Tracer.off</span>
297:     <span class="ruby-identifier">tk</span>
298:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002535">
                    
                    <a name="M002535"></a><b>ungetc</b>(c = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002535_source')" id="l_M002535_source">show</a>
                        
                    </p>
                    <div id="M002535_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ungetc</span>(<span class="ruby-identifier">c</span> = <span class="ruby-keyword kw">nil</span>)
144:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">empty?</span>
145:       <span class="ruby-identifier">c2</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">pop</span>
146:     <span class="ruby-keyword kw">else</span>
147:       <span class="ruby-identifier">c2</span> = <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">pop</span>
148:     <span class="ruby-keyword kw">end</span>
149:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">c2</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">c</span>
150:     <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">c</span> <span class="ruby-comment cmt">#c =</span>
151:     <span class="ruby-ivar">@seek</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
152:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
153:       <span class="ruby-ivar">@line_no</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
154:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
155:   <span class="ruby-ivar">@char_no</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">idx</span>
156:       <span class="ruby-keyword kw">else</span>
157:   <span class="ruby-ivar">@char_no</span> = <span class="ruby-ivar">@base_char_no</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span>
158:       <span class="ruby-keyword kw">end</span>
159:     <span class="ruby-keyword kw">else</span>
160:       <span class="ruby-ivar">@char_no</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
161:     <span class="ruby-keyword kw">end</span>
162:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M002539">
                    
                    <a name="M002539"></a><b>buf_input</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002539_source')" id="l_M002539_source">show</a>
                        
                    </p>
                    <div id="M002539_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 186</span>
186:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">buf_input</span>
187:     <span class="ruby-identifier">prompt</span>
188:     <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@input</span>.<span class="ruby-identifier">call</span>
189:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">line</span>
190:     <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">chars</span>.<span class="ruby-identifier">to_a</span>
191:     <span class="ruby-keyword kw">true</span>
192:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    