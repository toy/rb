<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>DL</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            DL 
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/ext/dl/dl_c.html">ext/dl/dl.c</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/callback_rb.html">ext/dl/lib/dl/callback.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/cparser_rb.html">ext/dl/lib/dl/cparser.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/func_rb.html">ext/dl/lib/dl/func.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/import_rb.html">ext/dl/lib/dl/import.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/pack_rb.html">ext/dl/lib/dl/pack.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/stack_rb.html">ext/dl/lib/dl/stack.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/struct_rb.html">ext/dl/lib/dl/struct.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/types_rb.html">ext/dl/lib/dl/types.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl/value_rb.html">ext/dl/lib/dl/value.rb</a></li>
            
            <li><a href="../files/ext/dl/lib/dl_rb.html">ext/dl/lib/dl.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
A bridge to the dlopen() or dynamic library linker function.
</p>
<h2>Example</h2>
<pre>
  bash $&gt; cat &gt; sum.c &lt;&lt;EOF
  double sum(double *arry, int len)
  {
          double ret = 0;
          int i;
          for(i = 0; i &lt; len; i++){
                  ret = ret + arry[i];
          }
          return ret;
  }

  double split(double num)
  {
          double ret = 0;
          ret = num / 2;
          return ret;
  }
  EOF
  bash $&gt; gcc -o libsum.so -shared sum.c
  bash $&gt; cat &gt; sum.rb &lt;&lt;EOF
  require 'dl'
  require 'dl/import'

  module LibSum
          extend DL::Importer
          dlload './libsum.so'
          extern 'double sum(double*, int)'
          extern 'double split(double)'
  end

  a = [2.0, 3.0, 4.0]

  sum = LibSum.sum(a.pack(&quot;d*&quot;), a.count)
  p LibSum.split(sum)
  EOF
  bash $&gt; ruby sum.rb
  4.5
</pre>
<p>
WIN! :-)
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M009000">fiddle?</a>,</li>
                
                <li><a href="#M008913">free</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M008911">malloc</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M008912">realloc</a>,</li>
                
                <li><a href="#M008924">remove_callback</a>,</li>
                
                <li><a href="#M008919">remove_callback_internal</a>,</li>
                
                <li><a href="#M008921">remove_cdecl_callback</a>,</li>
                
                <li><a href="#M008922">remove_stdcall_callback</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M008923">set_callback</a>,</li>
                
                <li><a href="#M008915">set_callback_internal</a>,</li>
                
                <li><a href="#M008916">set_cdecl_callback</a>,</li>
                
                <li><a href="#M008918">set_stdcall_callback</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="DL/BasicTypes.html">DL::BasicTypes</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/CParser.html">DL::CParser</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/CStructBuilder.html">DL::CStructBuilder</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/Importer.html">DL::Importer</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/PackInfo.html">DL::PackInfo</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/ValueUtil.html">DL::ValueUtil</a></li>
        
        <li><span class="type">MODULE</span> <a href="DL/Win32Types.html">DL::Win32Types</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CStruct.html">DL::CStruct</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CStructEntity.html">DL::CStructEntity</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CUnion.html">DL::CUnion</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CUnionEntity.html">DL::CUnionEntity</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CarriedFunction.html">DL::CarriedFunction</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/CompositeHandler.html">DL::CompositeHandler</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/DLError.html">DL::DLError</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/DLTypeError.html">DL::DLTypeError</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/Function.html">DL::Function</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/Handle.html">DL::Handle</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/Packer.html">DL::Packer</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/Stack.html">DL::Stack</a></li>
        
        <li><span class="type">CLASS</span> <a href="DL/TempFunction.html">DL::TempFunction</a></li>
        
    </ul>
    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">MAX_CALLBACK</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#MAX_CALLBACK">MAX_CALLBACK</a>
</p>
<p>
Maximum number of callbacks
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DLSTACK_SIZE</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#DLSTACK_SIZE">DLSTACK_SIZE</a>
</p>
<p>
Dynamic linker stack size
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RTLD_GLOBAL</td>
            <td>=</td>
            <td class="attr-value">Document-const: RTLD_GLOBAL
      
       rtld DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL/Handle.html">Handle</a> flag.
</p>
<p>
The symbols defined by this library will be made available for symbol
resolution of subsequently loaded libraries.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RTLD_LAZY</td>
            <td>=</td>
            <td class="attr-value">Document-const: RTLD_LAZY
      
       rtld DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL/Handle.html">Handle</a> flag.
</p>
<p>
Perform lazy binding. Only resolve symbols as the code that references them
is executed. If the symbol is never referenced, then it is never resolved.
(Lazy binding is only performed for function references; references to
variables are always immediately bound when the library is loaded.)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RTLD_NOW</td>
            <td>=</td>
            <td class="attr-value">Document-const: RTLD_NOW
      
       rtld DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL/Handle.html">Handle</a> flag.
</p>
<p>
If this value is specified or the environment variable LD_BIND_NOW is set
to a nonempty string, all undefined symbols in the library are resolved
before dlopen() returns. If this cannot be done an error is returned.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_VOID</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_VOID
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - void
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_VOIDP</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_VOIDP
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - void*
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_CHAR</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_CHAR
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - char
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_SHORT</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_SHORT
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - short
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_INT</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_INT
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - int
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_LONG
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - long
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_LONG_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_LONG_LONG
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - long long
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_FLOAT</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_FLOAT
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - float
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">TYPE_DOUBLE</td>
            <td>=</td>
            <td class="attr-value">Document-const: TYPE_DOUBLE
      
       DL:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
CFunc type - double
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_VOIDP</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_VOIDP">ALIGN_VOIDP</a>
</p>
<p>
The Offset of a struct void* and a void*
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_CHAR</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_CHAR">ALIGN_CHAR</a>
</p>
<p>
The Offset of a struct char and a char
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_SHORT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_SHORT">ALIGN_SHORT</a>
</p>
<p>
The Offset of a struct short and a short
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_INT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_INT">ALIGN_INT</a>
</p>
<p>
The Offset of a struct int and a int
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_LONG">ALIGN_LONG</a>
</p>
<p>
The Offset of a struct long and a long
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_LONG_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_LONG_LONG">ALIGN_LONG_LONG</a>
</p>
<p>
The Offset of a struct long long and a long long
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_FLOAT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_FLOAT">ALIGN_FLOAT</a>
</p>
<p>
The Offset of a struct float and a float
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">ALIGN_DOUBLE</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#ALIGN_DOUBLE">ALIGN_DOUBLE</a>
</p>
<p>
The Offset of a struct double and a double
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_VOIDP</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_VOIDP">SIZEOF_VOIDP</a>
</p>
<p>
OS Dependent - sizeof(void*)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_CHAR</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_CHAR">SIZEOF_CHAR</a>
</p>
<p>
OS Dependent - sizeof(char)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_SHORT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_SHORT">SIZEOF_SHORT</a>
</p>
<p>
OS Dependent - sizeof(short)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_INT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_INT">SIZEOF_INT</a>
</p>
<p>
OS Dependent - sizeof(int)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_LONG">SIZEOF_LONG</a>
</p>
<p>
OS Dependent - sizeof(long)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_LONG_LONG</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_LONG_LONG">SIZEOF_LONG_LONG</a>
</p>
<p>
OS Dependent - sizeof(long long)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_FLOAT</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_FLOAT">SIZEOF_FLOAT</a>
</p>
<p>
OS Dependent - sizeof(float)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SIZEOF_DOUBLE</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#SIZEOF_DOUBLE">SIZEOF_DOUBLE</a>
</p>
<p>
OS Dependent - sizeof(double)
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">RUBY_FREE</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#RUBY_FREE">RUBY_FREE</a>
</p>
<p>
Address of the ruby_xfree() function
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">BUILD_RUBY_PLATFORM</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#BUILD_RUBY_PLATFORM">BUILD_RUBY_PLATFORM</a>
</p>
<p>
Platform built against (i.e. &#8220;x86_64-linux&#8221;, etc.)
</p>
<p>
See also RUBY_PLATFORM
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">BUILD_RUBY_VERSION</td>
            <td>=</td>
            <td class="attr-value">Document-const</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
<a href="DL.html#BUILD_RUBY_VERSION">BUILD_RUBY_VERSION</a>
</p>
<p>
Ruby Version built. (i.e. &#8220;1.9.3&#8220;)
</p>
<p>
See also RUBY_VERSION
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SEM</td>
            <td>=</td>
            <td class="attr-value">Mutex.new # :nodoc:</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
The mutual exclusion (<a href="Mutex.html">Mutex</a>) semaphore for the <a
href="DL.html">DL</a> module
</p>
</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M009000">
                    
                    <a name="M009000"></a><b>fiddle?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M009000_source')" id="l_M009000_source">show</a>
                        
                    </p>
                    <div id="M009000_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/dl/lib/dl.rb, line 9</span>
 9:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fiddle?</span>
10:     <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-identifier">:Fiddle</span>)
11:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008913">
                    
                    <a name="M008913"></a><b> DL.free(addr)
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Free the memory at address <tt>addr</tt>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008913_source')" id="l_M008913_source">show</a>
                        
                    </p>
                    <div id="M008913_source" class="dyn-source">
                        <pre>VALUE
rb_dl_free(VALUE self, VALUE addr)
{
    void *ptr = NUM2PTR(addr);

    rb_secure(4);
    ruby_xfree(ptr);
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008911">
                    
                    <a name="M008911"></a><b> DL.malloc
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Allocate <tt>size</tt> bytes of memory and return the integer memory
address for the allocated memory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008911_source')" id="l_M008911_source">show</a>
                        
                    </p>
                    <div id="M008911_source" class="dyn-source">
                        <pre>VALUE
rb_dl_malloc(VALUE self, VALUE size)
{
    void *ptr;

    rb_secure(4);
    ptr = (void*)ruby_xmalloc(NUM2INT(size));
    return PTR2NUM(ptr);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008912">
                    
                    <a name="M008912"></a><b> DL.realloc(addr, size)
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Change the size of the memory allocated at the memory location
<tt>addr</tt> to <tt>size</tt> bytes. Returns the memory address of the
reallocated memory, which may be different than the address passed in.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008912_source')" id="l_M008912_source">show</a>
                        
                    </p>
                    <div id="M008912_source" class="dyn-source">
                        <pre>VALUE
rb_dl_realloc(VALUE self, VALUE addr, VALUE size)
{
    void *ptr = NUM2PTR(addr);

    rb_secure(4);
    ptr = (void*)ruby_xrealloc(ptr, NUM2INT(size));
    return PTR2NUM(ptr);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M008924">
                    
                    <a name="M008924"></a><b>remove_callback</b>(addr, ctype = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="DL.html#M008921">remove_cdecl_callback</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M008919">
                    
                    <a name="M008919"></a><b>remove_callback_internal</b>(proc_entry, addr_entry, addr, ctype = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008919_source')" id="l_M008919_source">show</a>
                        
                    </p>
                    <div id="M008919_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 70</span>
 70:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_callback_internal</span>(<span class="ruby-identifier">proc_entry</span>, <span class="ruby-identifier">addr_entry</span>, <span class="ruby-identifier">addr</span>, <span class="ruby-identifier">ctype</span> = <span class="ruby-keyword kw">nil</span>)
 71:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">DL</span>.<span class="ruby-identifier">fiddle?</span>
 72:       <span class="ruby-identifier">addr</span> = <span class="ruby-identifier">addr</span>.<span class="ruby-identifier">to_i</span>
 73:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">proc_entry</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">addr</span>)
 74:       <span class="ruby-identifier">proc_entry</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">addr</span>)
 75:       <span class="ruby-keyword kw">true</span>
 76:     <span class="ruby-keyword kw">else</span>
 77:       <span class="ruby-identifier">index</span> = <span class="ruby-keyword kw">nil</span>
 78:       <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">ctype</span> )
 79:         <span class="ruby-identifier">addr_entry</span>[<span class="ruby-identifier">ctype</span>].<span class="ruby-identifier">each_with_index</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">xaddr</span>, <span class="ruby-identifier">idx</span><span class="ruby-operator">|</span>
 80:           <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">xaddr</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">addr</span> )
 81:             <span class="ruby-identifier">index</span> = <span class="ruby-identifier">idx</span>
 82:           <span class="ruby-keyword kw">end</span>
 83:         }
 84:       <span class="ruby-keyword kw">else</span>
 85:         <span class="ruby-identifier">addr_entry</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">ty</span>,<span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
 86:           <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">each_with_index</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">xaddr</span>, <span class="ruby-identifier">idx</span><span class="ruby-operator">|</span>
 87:             <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">xaddr</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">addr</span> )
 88:               <span class="ruby-identifier">index</span> = <span class="ruby-identifier">idx</span>
 89:             <span class="ruby-keyword kw">end</span>
 90:           }
 91:         }
 92:       <span class="ruby-keyword kw">end</span>
 93:       <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">index</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">proc_entry</span>[<span class="ruby-identifier">ctype</span>][<span class="ruby-identifier">index</span>] )
 94:         <span class="ruby-identifier">proc_entry</span>[<span class="ruby-identifier">ctype</span>][<span class="ruby-identifier">index</span>] = <span class="ruby-keyword kw">nil</span>
 95:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
 96:       <span class="ruby-keyword kw">else</span>
 97:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
 98:       <span class="ruby-keyword kw">end</span>
 99:     <span class="ruby-keyword kw">end</span>
100:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008921">
                    
                    <a name="M008921"></a><b>remove_cdecl_callback</b>(addr, ctype = nil)
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="DL.html#M008924">remove_callback</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008921_source')" id="l_M008921_source">show</a>
                        
                    </p>
                    <div id="M008921_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 102</span>
102:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_cdecl_callback</span>(<span class="ruby-identifier">addr</span>, <span class="ruby-identifier">ctype</span> = <span class="ruby-keyword kw">nil</span>)
103:     <span class="ruby-identifier">remove_callback_internal</span>(<span class="ruby-constant">CdeclCallbackProcs</span>, <span class="ruby-constant">CdeclCallbackAddrs</span>, <span class="ruby-identifier">addr</span>, <span class="ruby-identifier">ctype</span>)
104:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008922">
                    
                    <a name="M008922"></a><b>remove_stdcall_callback</b>(addr, ctype = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008922_source')" id="l_M008922_source">show</a>
                        
                    </p>
                    <div id="M008922_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_stdcall_callback</span>(<span class="ruby-identifier">addr</span>, <span class="ruby-identifier">ctype</span> = <span class="ruby-keyword kw">nil</span>)
107:     <span class="ruby-identifier">remove_callback_internal</span>(<span class="ruby-constant">StdcallCallbackProcs</span>, <span class="ruby-constant">StdcallCallbackAddrs</span>, <span class="ruby-identifier">addr</span>, <span class="ruby-identifier">ctype</span>)
108:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008923">
                    
                    <a name="M008923"></a><b>set_callback</b>(ty, argc, &amp;cbp)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="DL.html#M008916">set_cdecl_callback</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M008915">
                    
                    <a name="M008915"></a><b>set_callback_internal</b>(proc_entry, addr_entry, argc, ty, abi = nil, &amp;cbp)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008915_source')" id="l_M008915_source">show</a>
                        
                    </p>
                    <div id="M008915_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_callback_internal</span>(<span class="ruby-identifier">proc_entry</span>, <span class="ruby-identifier">addr_entry</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">ty</span>, <span class="ruby-identifier">abi</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
31:     <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">argc</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> )
32:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;arity should not be less than 0.&quot;</span>)
33:     <span class="ruby-keyword kw">end</span>
34:     <span class="ruby-identifier">addr</span> = <span class="ruby-keyword kw">nil</span>
35: 
36:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">DL</span>.<span class="ruby-identifier">fiddle?</span>
37:       <span class="ruby-identifier">abi</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Fiddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Function</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT</span>
38:       <span class="ruby-identifier">closure</span> = <span class="ruby-constant">Fiddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Closure</span><span class="ruby-operator">::</span><span class="ruby-constant">BlockCaller</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ty</span>, [<span class="ruby-constant">TYPE_VOIDP</span>] <span class="ruby-operator">*</span> <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">abi</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
39:       <span class="ruby-identifier">proc_entry</span>[<span class="ruby-identifier">closure</span>.<span class="ruby-identifier">to_i</span>] = <span class="ruby-identifier">closure</span>
40:       <span class="ruby-identifier">addr</span> = <span class="ruby-identifier">closure</span>.<span class="ruby-identifier">to_i</span>
41:     <span class="ruby-keyword kw">else</span>
42:       <span class="ruby-constant">SEM</span>.<span class="ruby-identifier">synchronize</span>{
43:         <span class="ruby-identifier">ary</span> = <span class="ruby-identifier">proc_entry</span>[<span class="ruby-identifier">ty</span>]
44:         (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-constant">MAX_CALLBACK</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
45:           <span class="ruby-identifier">idx</span> = (<span class="ruby-identifier">n</span> <span class="ruby-operator">*</span> <span class="ruby-constant">DLSTACK_SIZE</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">argc</span>
46:           <span class="ruby-keyword kw">if</span>( <span class="ruby-identifier">ary</span>[<span class="ruby-identifier">idx</span>].<span class="ruby-identifier">nil?</span> )
47:             <span class="ruby-identifier">ary</span>[<span class="ruby-identifier">idx</span>] = <span class="ruby-identifier">cbp</span>
48:             <span class="ruby-identifier">addr</span> = <span class="ruby-identifier">addr_entry</span>[<span class="ruby-identifier">ty</span>][<span class="ruby-identifier">idx</span>]
49:             <span class="ruby-keyword kw">break</span>
50:           <span class="ruby-keyword kw">end</span>
51:         }
52:       }
53:     <span class="ruby-keyword kw">end</span>
54: 
55:     <span class="ruby-identifier">addr</span>
56:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008916">
                    
                    <a name="M008916"></a><b>set_cdecl_callback</b>(ty, argc, &amp;cbp)
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="DL.html#M008923">set_callback</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008916_source')" id="l_M008916_source">show</a>
                        
                    </p>
                    <div id="M008916_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 58</span>
58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_cdecl_callback</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
59:     <span class="ruby-identifier">set_callback_internal</span>(<span class="ruby-constant">CdeclCallbackProcs</span>, <span class="ruby-constant">CdeclCallbackAddrs</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">ty</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
60:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M008918">
                    
                    <a name="M008918"></a><b>set_stdcall_callback</b>(ty, argc, &amp;cbp)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M008918_source')" id="l_M008918_source">show</a>
                        
                    </p>
                    <div id="M008918_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/dl/lib/dl/callback.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_stdcall_callback</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
63:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">DL</span>.<span class="ruby-identifier">fiddle?</span>
64:       <span class="ruby-identifier">set_callback_internal</span>(<span class="ruby-constant">StdcallCallbackProcs</span>, <span class="ruby-constant">StdcallCallbackAddrs</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">ty</span>, <span class="ruby-constant">Fiddle</span><span class="ruby-operator">::</span><span class="ruby-constant">Function</span><span class="ruby-operator">::</span><span class="ruby-constant">STDCALL</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
65:     <span class="ruby-keyword kw">else</span>
66:       <span class="ruby-identifier">set_callback_internal</span>(<span class="ruby-constant">StdcallCallbackProcs</span>, <span class="ruby-constant">StdcallCallbackAddrs</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">ty</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">cbp</span>)
67:     <span class="ruby-keyword kw">end</span>
68:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    