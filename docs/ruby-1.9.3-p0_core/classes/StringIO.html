<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>StringIO</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            StringIO 
            
                <span class="parent">&lt; 
                    
                    <a href="Data.html">Data</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/ext/stringio/stringio_c.html">ext/stringio/stringio.c</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Pseudo I/O on <a href="String.html">String</a> object.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M010320"><<</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M010277">binmode</a>,</li>
                
                <li><a href="#M010301">bytes</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M010303">chars</a>,</li>
                
                <li><a href="#M010278">close</a>,</li>
                
                <li><a href="#M010279">close_read</a>,</li>
                
                <li><a href="#M010280">close_write</a>,</li>
                
                <li><a href="#M010281">closed?</a>,</li>
                
                <li><a href="#M010282">closed_read?</a>,</li>
                
                <li><a href="#M010283">closed_write?</a>,</li>
                
                <li><a href="#M010305">codepoints</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M010297">each</a>,</li>
                
                <li><a href="#M010300">each_byte</a>,</li>
                
                <li><a href="#M010302">each_char</a>,</li>
                
                <li><a href="#M010304">each_codepoint</a>,</li>
                
                <li><a href="#M010298">each_line</a>,</li>
                
                <li><a href="#M010284">eof</a>,</li>
                
                <li><a href="#M010285">eof?</a>,</li>
                
                <li><a href="#M010336">external_encoding</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M010286">fcntl</a>,</li>
                
                <li><a href="#M010332">fileno</a>,</li>
                
                <li><a href="#M010287">flush</a>,</li>
                
                <li><a href="#M010288">fsync</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M010310">getbyte</a>,</li>
                
                <li><a href="#M010306">getc</a>,</li>
                
                <li><a href="#M010312">gets</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M010337">internal_encoding</a>,</li>
                
                <li><a href="#M010329">isatty</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M010334">length</a>,</li>
                
                <li><a href="#M010275">lineno</a>,</li>
                
                <li><a href="#M010276">lineno=</a>,</li>
                
                <li><a href="#M010299">lines</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M010270">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M010269">open</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M010331">pid</a>,</li>
                
                <li><a href="#M010289">pos</a>,</li>
                
                <li><a href="#M010290">pos=</a>,</li>
                
                <li><a href="#M010322">print</a>,</li>
                
                <li><a href="#M010324">printf</a>,</li>
                
                <li><a href="#M010325">putc</a>,</li>
                
                <li><a href="#M010326">puts</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M010315">read</a>,</li>
                
                <li><a href="#M010318">read_nonblock</a>,</li>
                
                <li><a href="#M010311">readbyte</a>,</li>
                
                <li><a href="#M010309">readchar</a>,</li>
                
                <li><a href="#M010313">readline</a>,</li>
                
                <li><a href="#M010314">readlines</a>,</li>
                
                <li><a href="#M010317">readpartial</a>,</li>
                
                <li><a href="#M010272">reopen</a>,</li>
                
                <li><a href="#M010291">rewind</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M010293">seek</a>,</li>
                
                <li><a href="#M010338">set_encoding</a>,</li>
                
                <li><a href="#M010333">size</a>,</li>
                
                <li><a href="#M010273">string</a>,</li>
                
                <li><a href="#M010274">string=</a>,</li>
                
                <li><a href="#M010294">sync</a>,</li>
                
                <li><a href="#M010295">sync=</a>,</li>
                
                <li><a href="#M010316">sysread</a>,</li>
                
                <li><a href="#M010327">syswrite</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M010296">tell</a>,</li>
                
                <li><a href="#M010335">truncate</a>,</li>
                
                <li><a href="#M010330">tty?</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M010308">ungetbyte</a>,</li>
                
                <li><a href="#M010307">ungetc</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M010319">write</a>,</li>
                
                <li><a href="#M010328">write_nonblock</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="JSON.html">JSON</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M010270">
                    
                    <a name="M010270"></a><b> StringIO.new(string=""[, mode])
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Creates new <a href="StringIO.html">StringIO</a> instance from with
<em>string</em> and <em>mode</em>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010270_source')" id="l_M010270_source">show</a>
                        
                    </p>
                    <div id="M010270_source" class="dyn-source">
                        <pre>static VALUE
strio_initialize(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = check_strio(self);

    if (!ptr) {
  DATA_PTR(self) = ptr = strio_alloc();
    }
    rb_call_super(0, 0);
    strio_init(argc, argv, ptr);
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010269">
                    
                    <a name="M010269"></a><b> StringIO.open(string=""[, mode]) {|strio| ...}
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Equivalent to <a href="StringIO.html#M010270">StringIO.new</a> except that
when it is called with a block, it yields with the new instance and closes
it, and returns the result which returned from the block.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010269_source')" id="l_M010269_source">show</a>
                        
                    </p>
                    <div id="M010269_source" class="dyn-source">
                        <pre>static VALUE
strio_s_open(int argc, VALUE *argv, VALUE klass)
{
    VALUE obj = rb_class_new_instance(argc, argv, klass);
    if (!rb_block_given_p()) return obj;
    return rb_ensure(rb_yield, obj, strio_finalize, obj);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M010320">
                    
                    <a name="M010320"></a><b>strio << obj     &rarr; strio
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See IO#<<.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010320_source')" id="l_M010320_source">show</a>
                        
                    </p>
                    <div id="M010320_source" class="dyn-source">
                        <pre>#define strio_addstr rb_io_addstr</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010277">
                    
                    <a name="M010277"></a><b> strio.binmode &rarr; true </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <b>strio</b> itself. Just for compatibility to <a
href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010277_source')" id="l_M010277_source">show</a>
                        
                    </p>
                    <div id="M010277_source" class="dyn-source">
                        <pre>#define strio_binmode strio_self</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010301">
                    
                    <a name="M010301"></a><b>strio.bytes {|byte| block }      &rarr; strio
strio.bytes                      &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_byte {|byte| block }  -&gt; strio
  strio.each_byte                  -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000660">IO#each_byte</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010301_source')" id="l_M010301_source">show</a>
                        
                    </p>
                    <div id="M010301_source" class="dyn-source">
                        <pre>static VALUE
strio_each_byte(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));

    RETURN_ENUMERATOR(self, 0, 0);

    while (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) {
  char c = RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++];
  rb_yield(CHR2FIX(c));
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010303">
                    
                    <a name="M010303"></a><b>strio.chars {|char| block }      &rarr; strio
strio.chars                      &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_char {|char| block }  -&gt; strio
  strio.each_char                  -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000661">IO#each_char</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010303_source')" id="l_M010303_source">show</a>
                        
                    </p>
                    <div id="M010303_source" class="dyn-source">
                        <pre>static VALUE
strio_each_char(VALUE self)
{
    VALUE c;

    RETURN_ENUMERATOR(self, 0, 0);

    while (!NIL_P(c = strio_getc(self))) {
  rb_yield(c);
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010278">
                    
                    <a name="M010278"></a><b>strio.close  &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Closes strio. The <b>strio</b> is unavailable for any further data
operations; an <tt>IOError</tt> is raised if such an attempt is made.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010278_source')" id="l_M010278_source">show</a>
                        
                    </p>
                    <div id="M010278_source" class="dyn-source">
                        <pre>static VALUE
strio_close(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (CLOSED(ptr)) {
  rb_raise(rb_eIOError, &quot;closed stream&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_READWRITE;
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010279">
                    
                    <a name="M010279"></a><b>strio.close_read    &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Closes the read end of a <a href="StringIO.html">StringIO</a>. Will raise
an <tt>IOError</tt> if the <b>strio</b> is not readable.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010279_source')" id="l_M010279_source">show</a>
                        
                    </p>
                    <div id="M010279_source" class="dyn-source">
                        <pre>static VALUE
strio_close_read(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (!READABLE(ptr)) {
  rb_raise(rb_eIOError, &quot;closing non-duplex IO for reading&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_READABLE;
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010280">
                    
                    <a name="M010280"></a><b>strio.close_write    &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Closes the write end of a <a href="StringIO.html">StringIO</a>. Will raise
an <tt>IOError</tt> if the <b>strio</b> is not writeable.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010280_source')" id="l_M010280_source">show</a>
                        
                    </p>
                    <div id="M010280_source" class="dyn-source">
                        <pre>static VALUE
strio_close_write(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (!WRITABLE(ptr)) {
  rb_raise(rb_eIOError, &quot;closing non-duplex IO for writing&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_WRITABLE;
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010281">
                    
                    <a name="M010281"></a><b>strio.closed?    &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if <b>strio</b> is completely closed, <tt>false</tt>
otherwise.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010281_source')" id="l_M010281_source">show</a>
                        
                    </p>
                    <div id="M010281_source" class="dyn-source">
                        <pre>static VALUE
strio_closed(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (!CLOSED(ptr)) return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010282">
                    
                    <a name="M010282"></a><b>strio.closed_read?    &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if <b>strio</b> is not readable, <tt>false</tt>
otherwise.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010282_source')" id="l_M010282_source">show</a>
                        
                    </p>
                    <div id="M010282_source" class="dyn-source">
                        <pre>static VALUE
strio_closed_read(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (READABLE(ptr)) return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010283">
                    
                    <a name="M010283"></a><b>strio.closed_write?    &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if <b>strio</b> is not writable, <tt>false</tt>
otherwise.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010283_source')" id="l_M010283_source">show</a>
                        
                    </p>
                    <div id="M010283_source" class="dyn-source">
                        <pre>static VALUE
strio_closed_write(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    if (WRITABLE(ptr)) return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010305">
                    
                    <a name="M010305"></a><b>strio.codepoints {|c| block }      &rarr; strio
strio.codepoints                   &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_codepoint {|c| block }  -&gt; strio
  strio.each_codepoint               -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000662">IO#each_codepoint</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010305_source')" id="l_M010305_source">show</a>
                        
                    </p>
                    <div id="M010305_source" class="dyn-source">
                        <pre>static VALUE
strio_each_codepoint(VALUE self)
{
    struct StringIO *ptr;
    rb_encoding *enc;
    unsigned int c;
    int n;

    RETURN_ENUMERATOR(self, 0, 0);

    ptr = readable(StringIO(self));
    enc = rb_enc_get(ptr-&gt;string);
    for (;;) {
  if (ptr-&gt;pos &gt;= RSTRING_LEN(ptr-&gt;string)) {
      return self;
  }

  c = rb_enc_codepoint_len(RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos,
         RSTRING_END(ptr-&gt;string), &amp;n, enc);
  rb_yield(UINT2NUM(c));
  ptr-&gt;pos += n;
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010297">
                    
                    <a name="M010297"></a><b>strio.each(sep=$/) {|line| block }         &rarr; strio
strio.each(limit) {|line| block }          &rarr; strio
strio.each(sep, limit) {|line| block }     &rarr; strio
strio.each(...)                            &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_line(sep=$/) {|line| block }    -&gt; strio
  strio.each_line(limit) {|line| block }     -&gt; strio
  strio.each_line(sep,limit) {|line| block } -&gt; strio
  strio.each_line(...)                       -&gt; anEnumerator

  strio.lines(sep=$/) {|line| block }        -&gt; strio
  strio.lines(limit) {|line| block }         -&gt; strio
  strio.lines(sep,limit) {|line| block }     -&gt; strio
  strio.lines(...)                           -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000658">IO#each</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010297_source')" id="l_M010297_source">show</a>
                        
                    </p>
                    <div id="M010297_source" class="dyn-source">
                        <pre>static VALUE
strio_each(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    if (argc &gt; 0 &amp;&amp; !NIL_P(argv[argc-1]) &amp;&amp; NIL_P(rb_check_string_type(argv[argc-1])) &amp;&amp;
  NUM2LONG(argv[argc-1]) == 0) {
  rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    }

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
  rb_yield(line);
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010300">
                    
                    <a name="M010300"></a><b>strio.bytes {|byte| block }      &rarr; strio
strio.bytes                      &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_byte {|byte| block }  -&gt; strio
  strio.each_byte                  -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000660">IO#each_byte</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010300_source')" id="l_M010300_source">show</a>
                        
                    </p>
                    <div id="M010300_source" class="dyn-source">
                        <pre>static VALUE
strio_each_byte(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));

    RETURN_ENUMERATOR(self, 0, 0);

    while (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) {
  char c = RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++];
  rb_yield(CHR2FIX(c));
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010302">
                    
                    <a name="M010302"></a><b>strio.chars {|char| block }      &rarr; strio
strio.chars                      &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_char {|char| block }  -&gt; strio
  strio.each_char                  -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000661">IO#each_char</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010302_source')" id="l_M010302_source">show</a>
                        
                    </p>
                    <div id="M010302_source" class="dyn-source">
                        <pre>static VALUE
strio_each_char(VALUE self)
{
    VALUE c;

    RETURN_ENUMERATOR(self, 0, 0);

    while (!NIL_P(c = strio_getc(self))) {
  rb_yield(c);
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010304">
                    
                    <a name="M010304"></a><b>strio.codepoints {|c| block }      &rarr; strio
strio.codepoints                   &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_codepoint {|c| block }  -&gt; strio
  strio.each_codepoint               -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000662">IO#each_codepoint</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010304_source')" id="l_M010304_source">show</a>
                        
                    </p>
                    <div id="M010304_source" class="dyn-source">
                        <pre>static VALUE
strio_each_codepoint(VALUE self)
{
    struct StringIO *ptr;
    rb_encoding *enc;
    unsigned int c;
    int n;

    RETURN_ENUMERATOR(self, 0, 0);

    ptr = readable(StringIO(self));
    enc = rb_enc_get(ptr-&gt;string);
    for (;;) {
  if (ptr-&gt;pos &gt;= RSTRING_LEN(ptr-&gt;string)) {
      return self;
  }

  c = rb_enc_codepoint_len(RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos,
         RSTRING_END(ptr-&gt;string), &amp;n, enc);
  rb_yield(UINT2NUM(c));
  ptr-&gt;pos += n;
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010298">
                    
                    <a name="M010298"></a><b>strio.each(sep=$/) {|line| block }         &rarr; strio
strio.each(limit) {|line| block }          &rarr; strio
strio.each(sep, limit) {|line| block }     &rarr; strio
strio.each(...)                            &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_line(sep=$/) {|line| block }    -&gt; strio
  strio.each_line(limit) {|line| block }     -&gt; strio
  strio.each_line(sep,limit) {|line| block } -&gt; strio
  strio.each_line(...)                       -&gt; anEnumerator

  strio.lines(sep=$/) {|line| block }        -&gt; strio
  strio.lines(limit) {|line| block }         -&gt; strio
  strio.lines(sep,limit) {|line| block }     -&gt; strio
  strio.lines(...)                           -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000658">IO#each</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010298_source')" id="l_M010298_source">show</a>
                        
                    </p>
                    <div id="M010298_source" class="dyn-source">
                        <pre>static VALUE
strio_each(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    if (argc &gt; 0 &amp;&amp; !NIL_P(argv[argc-1]) &amp;&amp; NIL_P(rb_check_string_type(argv[argc-1])) &amp;&amp;
  NUM2LONG(argv[argc-1]) == 0) {
  rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    }

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
  rb_yield(line);
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010284">
                    
                    <a name="M010284"></a><b>strio.eof     &rarr; true or false
strio.eof?    &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if <b>strio</b> is at end of file. The stringio must be opened
for reading or an <tt>IOError</tt> will be raised.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010284_source')" id="l_M010284_source">show</a>
                        
                    </p>
                    <div id="M010284_source" class="dyn-source">
                        <pre>static VALUE
strio_eof(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));
    if (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010285">
                    
                    <a name="M010285"></a><b>strio.eof     &rarr; true or false
strio.eof?    &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns true if <b>strio</b> is at end of file. The stringio must be opened
for reading or an <tt>IOError</tt> will be raised.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010285_source')" id="l_M010285_source">show</a>
                        
                    </p>
                    <div id="M010285_source" class="dyn-source">
                        <pre>static VALUE
strio_eof(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));
    if (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010336">
                    
                    <a name="M010336"></a><b>strio.external_encoding   => encoding
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the <a href="Encoding.html">Encoding</a> object that represents the
encoding of the file. If strio is write mode and no encoding is specified,
returns <tt>nil</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010336_source')" id="l_M010336_source">show</a>
                        
                    </p>
                    <div id="M010336_source" class="dyn-source">
                        <pre>static VALUE
strio_external_encoding(VALUE self)
{
    return rb_enc_from_encoding(rb_enc_get(StringIO(self)-&gt;string));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010286">
                    
                    <a name="M010286"></a><b> strio.fcntl </b>
                    
                </div>
                
                <div class="description">
                  <p>
Raises <a href="NotImplementedError.html">NotImplementedError</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010286_source')" id="l_M010286_source">show</a>
                        
                    </p>
                    <div id="M010286_source" class="dyn-source">
                        <pre>#define strio_fcntl strio_unimpl</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010332">
                    
                    <a name="M010332"></a><b> strio.fileno &rarr; nil </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>nil</tt>. Just for compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010332_source')" id="l_M010332_source">show</a>
                        
                    </p>
                    <div id="M010332_source" class="dyn-source">
                        <pre>#define strio_fileno strio_nil</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010287">
                    
                    <a name="M010287"></a><b> strio.flush &rarr; strio </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <b>strio</b> itself. Just for compatibility to <a
href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010287_source')" id="l_M010287_source">show</a>
                        
                    </p>
                    <div id="M010287_source" class="dyn-source">
                        <pre>#define strio_flush strio_self</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010288">
                    
                    <a name="M010288"></a><b> strio.fsync &rarr; 0 </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns 0. Just for compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010288_source')" id="l_M010288_source">show</a>
                        
                    </p>
                    <div id="M010288_source" class="dyn-source">
                        <pre>#define strio_fsync strio_0</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010310">
                    
                    <a name="M010310"></a><b>strio.getbyte   &rarr; fixnum or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000686">IO#getbyte</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010310_source')" id="l_M010310_source">show</a>
                        
                    </p>
                    <div id="M010310_source" class="dyn-source">
                        <pre>static VALUE
strio_getbyte(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));
    int c;
    if (ptr-&gt;pos &gt;= RSTRING_LEN(ptr-&gt;string)) {
  return Qnil;
    }
    c = RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++];
    return CHR2FIX(c);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010306">
                    
                    <a name="M010306"></a><b>strio.getc   &rarr; string or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000685">IO#getc</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010306_source')" id="l_M010306_source">show</a>
                        
                    </p>
                    <div id="M010306_source" class="dyn-source">
                        <pre>static VALUE
strio_getc(VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));
    rb_encoding *enc = rb_enc_get(ptr-&gt;string);
    int len;
    char *p;

    if (ptr-&gt;pos &gt;= RSTRING_LEN(ptr-&gt;string)) {
  return Qnil;
    }
    p = RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos;
    len = rb_enc_mbclen(p, RSTRING_END(ptr-&gt;string), enc);
    ptr-&gt;pos += len;
    return rb_enc_str_new(p, len, rb_enc_get(ptr-&gt;string));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010312">
                    
                    <a name="M010312"></a><b>strio.gets(sep=$/)     &rarr; string or nil
strio.gets(limit)      &rarr; string or nil
strio.gets(sep, limit) &rarr; string or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000683">IO#gets</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010312_source')" id="l_M010312_source">show</a>
                        
                    </p>
                    <div id="M010312_source" class="dyn-source">
                        <pre>static VALUE
strio_gets(int argc, VALUE *argv, VALUE self)
{
    VALUE str = strio_getline(argc, argv, readable(StringIO(self)));

    rb_lastline_set(str);
    return str;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010337">
                    
                    <a name="M010337"></a><b>strio.internal_encoding   => encoding
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the <a href="Encoding.html">Encoding</a> of the internal string if
conversion is specified. Otherwise returns nil.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010337_source')" id="l_M010337_source">show</a>
                        
                    </p>
                    <div id="M010337_source" class="dyn-source">
                        <pre>static VALUE
strio_internal_encoding(VALUE self)
{
     return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010329">
                    
                    <a name="M010329"></a><b>strio.isatty &rarr; nil
strio.tty? &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>false</tt>. Just for compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010329_source')" id="l_M010329_source">show</a>
                        
                    </p>
                    <div id="M010329_source" class="dyn-source">
                        <pre>#define strio_isatty strio_false</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010334">
                    
                    <a name="M010334"></a><b>strio.size   &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the size of the buffer string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010334_source')" id="l_M010334_source">show</a>
                        
                    </p>
                    <div id="M010334_source" class="dyn-source">
                        <pre>static VALUE
strio_size(VALUE self)
{
    VALUE string = StringIO(self)-&gt;string;
    if (NIL_P(string)) {
  rb_raise(rb_eIOError, &quot;not opened&quot;);
    }
    return ULONG2NUM(RSTRING_LEN(string));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010275">
                    
                    <a name="M010275"></a><b>strio.lineno    &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the current line number in <b>strio</b>. The stringio must be
opened for reading. <tt>lineno</tt> counts the number of times
<tt>gets</tt> is called, rather than the number of newlines encountered.
The two values will differ if <tt>gets</tt> is called with a separator
other than newline. See also the <tt>$.</tt> variable.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010275_source')" id="l_M010275_source">show</a>
                        
                    </p>
                    <div id="M010275_source" class="dyn-source">
                        <pre>static VALUE
strio_get_lineno(VALUE self)
{
    return LONG2NUM(StringIO(self)-&gt;lineno);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010276">
                    
                    <a name="M010276"></a><b>strio.lineno = integer    &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Manually sets the current line number to the given value. <tt>$.</tt> is
updated only on the next read.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010276_source')" id="l_M010276_source">show</a>
                        
                    </p>
                    <div id="M010276_source" class="dyn-source">
                        <pre>static VALUE
strio_set_lineno(VALUE self, VALUE lineno)
{
    StringIO(self)-&gt;lineno = NUM2LONG(lineno);
    return lineno;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010299">
                    
                    <a name="M010299"></a><b>strio.each(sep=$/) {|line| block }         &rarr; strio
strio.each(limit) {|line| block }          &rarr; strio
strio.each(sep, limit) {|line| block }     &rarr; strio
strio.each(...)                            &rarr; anEnumerator
</b>
                    
                </div>
                
                <div class="description">
                  <pre>
  strio.each_line(sep=$/) {|line| block }    -&gt; strio
  strio.each_line(limit) {|line| block }     -&gt; strio
  strio.each_line(sep,limit) {|line| block } -&gt; strio
  strio.each_line(...)                       -&gt; anEnumerator

  strio.lines(sep=$/) {|line| block }        -&gt; strio
  strio.lines(limit) {|line| block }         -&gt; strio
  strio.lines(sep,limit) {|line| block }     -&gt; strio
  strio.lines(...)                           -&gt; anEnumerator
</pre>
<p>
See <a href="IO.html#M000658">IO#each</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010299_source')" id="l_M010299_source">show</a>
                        
                    </p>
                    <div id="M010299_source" class="dyn-source">
                        <pre>static VALUE
strio_each(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    if (argc &gt; 0 &amp;&amp; !NIL_P(argv[argc-1]) &amp;&amp; NIL_P(rb_check_string_type(argv[argc-1])) &amp;&amp;
  NUM2LONG(argv[argc-1]) == 0) {
  rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    }

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
  rb_yield(line);
    }
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010331">
                    
                    <a name="M010331"></a><b> strio.pid &rarr; nil </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>nil</tt>. Just for compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010331_source')" id="l_M010331_source">show</a>
                        
                    </p>
                    <div id="M010331_source" class="dyn-source">
                        <pre>#define strio_pid strio_nil</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010289">
                    
                    <a name="M010289"></a><b>strio.pos     &rarr; integer
strio.tell    &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the current offset (in bytes) of <b>strio</b>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010289_source')" id="l_M010289_source">show</a>
                        
                    </p>
                    <div id="M010289_source" class="dyn-source">
                        <pre>static VALUE
strio_get_pos(VALUE self)
{
    return LONG2NUM(StringIO(self)-&gt;pos);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010290">
                    
                    <a name="M010290"></a><b>strio.pos = integer    &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Seeks to the given position (in bytes) in <b>strio</b>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010290_source')" id="l_M010290_source">show</a>
                        
                    </p>
                    <div id="M010290_source" class="dyn-source">
                        <pre>static VALUE
strio_set_pos(VALUE self, VALUE pos)
{
    struct StringIO *ptr = StringIO(self);
    long p = NUM2LONG(pos);
    if (p &lt; 0) {
  error_inval(0);
    }
    ptr-&gt;pos = p;
    return pos;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010322">
                    
                    <a name="M010322"></a><b>strio.print()             &rarr; nil
strio.print(obj, ...)     &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000654">IO#print</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010322_source')" id="l_M010322_source">show</a>
                        
                    </p>
                    <div id="M010322_source" class="dyn-source">
                        <pre>#define strio_print rb_io_print</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010324">
                    
                    <a name="M010324"></a><b>strio.printf(format_string [, obj, ...] )   &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000657">IO#printf</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010324_source')" id="l_M010324_source">show</a>
                        
                    </p>
                    <div id="M010324_source" class="dyn-source">
                        <pre>#define strio_printf rb_io_printf</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010325">
                    
                    <a name="M010325"></a><b>strio.putc(obj)    &rarr; obj
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000655">IO#putc</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010325_source')" id="l_M010325_source">show</a>
                        
                    </p>
                    <div id="M010325_source" class="dyn-source">
                        <pre>static VALUE
strio_putc(VALUE self, VALUE ch)
{
    struct StringIO *ptr = writable(StringIO(self));
    int c = NUM2CHR(ch);
    long olen;

    check_modifiable(ptr);
    olen = RSTRING_LEN(ptr-&gt;string);
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
  ptr-&gt;pos = olen;
    }
    strio_extend(ptr, ptr-&gt;pos, 1);
    RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++] = c;
    OBJ_INFECT(ptr-&gt;string, self);
    return ch;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010326">
                    
                    <a name="M010326"></a><b>strio.puts(obj, ...)    &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000656">IO#puts</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010326_source')" id="l_M010326_source">show</a>
                        
                    </p>
                    <div id="M010326_source" class="dyn-source">
                        <pre>#define strio_puts rb_io_puts</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010315">
                    
                    <a name="M010315"></a><b>strio.read([length [, buffer]])    &rarr; string, buffer, or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000643">IO#read</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010315_source')" id="l_M010315_source">show</a>
                        
                    </p>
                    <div id="M010315_source" class="dyn-source">
                        <pre>static VALUE
strio_read(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = readable(StringIO(self));
    VALUE str = Qnil;
    long len;
    int binary = 0;

    switch (argc) {
      case 2:
  str = argv[1];
  if (!NIL_P(str)) {
      StringValue(str);
      rb_str_modify(str);
  }
      case 1:
  if (!NIL_P(argv[0])) {
      len = NUM2LONG(argv[0]);
      if (len &lt; 0) {
    rb_raise(rb_eArgError, &quot;negative length %ld given&quot;, len);
      }
      if (len &gt; 0 &amp;&amp; ptr-&gt;pos &gt;= RSTRING_LEN(ptr-&gt;string)) {
    if (!NIL_P(str)) rb_str_resize(str, 0);
    return Qnil;
      }
      binary = 1;
      break;
  }
  /* fall through */
      case 0:
  len = RSTRING_LEN(ptr-&gt;string);
  if (len &lt;= ptr-&gt;pos) {
      if (NIL_P(str)) {
    str = rb_str_new(0, 0);
      }
      else {
    rb_str_resize(str, 0);
      }
      return str;
  }
  else {
      len -= ptr-&gt;pos;
  }
  break;
      default:
  rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for 0)&quot;, argc);
    }
    if (NIL_P(str)) {
  str = strio_substr(ptr, ptr-&gt;pos, len);
  if (binary) rb_enc_associate(str, rb_ascii8bit_encoding());
    }
    else {
  long rest = RSTRING_LEN(ptr-&gt;string) - ptr-&gt;pos;
  if (len &gt; rest) len = rest;
  rb_str_resize(str, len);
  MEMCPY(RSTRING_PTR(str), RSTRING_PTR(ptr-&gt;string) + ptr-&gt;pos, char, len);
  if (binary)
      rb_enc_associate(str, rb_ascii8bit_encoding());
  else
      rb_enc_copy(str, ptr-&gt;string);
    }
    ptr-&gt;pos += RSTRING_LEN(str);
    return str;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010318">
                    
                    <a name="M010318"></a><b>strio.sysread(integer[, outbuf])    &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Similar to <a href="StringIO.html#M010315">read</a>, but raises
<tt>EOFError</tt> at end of string instead of returning <tt>nil</tt>, as
well as <a href="IO.html#M000668">IO#sysread</a> does.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010318_source')" id="l_M010318_source">show</a>
                        
                    </p>
                    <div id="M010318_source" class="dyn-source">
                        <pre>static VALUE
strio_sysread(int argc, VALUE *argv, VALUE self)
{
    VALUE val = strio_read(argc, argv, self);
    if (NIL_P(val)) {
  rb_eof_error();
    }
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010311">
                    
                    <a name="M010311"></a><b>strio.readbyte   &rarr; fixnum
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000688">IO#readbyte</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010311_source')" id="l_M010311_source">show</a>
                        
                    </p>
                    <div id="M010311_source" class="dyn-source">
                        <pre>static VALUE
strio_readbyte(VALUE self)
{
    VALUE c = strio_getbyte(self);
    if (NIL_P(c)) rb_eof_error();
    return c;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010309">
                    
                    <a name="M010309"></a><b>strio.readchar   &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000687">IO#readchar</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010309_source')" id="l_M010309_source">show</a>
                        
                    </p>
                    <div id="M010309_source" class="dyn-source">
                        <pre>static VALUE
strio_readchar(VALUE self)
{
    VALUE c = strio_getc(self);
    if (NIL_P(c)) rb_eof_error();
    return c;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010313">
                    
                    <a name="M010313"></a><b>strio.readline(sep=$/)     &rarr; string
strio.readline(limit)      &rarr; string or nil
strio.readline(sep, limit) &rarr; string or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000684">IO#readline</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010313_source')" id="l_M010313_source">show</a>
                        
                    </p>
                    <div id="M010313_source" class="dyn-source">
                        <pre>static VALUE
strio_readline(int argc, VALUE *argv, VALUE self)
{
    VALUE line = strio_gets(argc, argv, self);
    if (NIL_P(line)) rb_eof_error();
    return line;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010314">
                    
                    <a name="M010314"></a><b>strio.readlines(sep=$/)    &rarr;   array
strio.readlines(limit)     &rarr;   array
strio.readlines(sep,limit) &rarr;   array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000642">IO#readlines</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010314_source')" id="l_M010314_source">show</a>
                        
                    </p>
                    <div id="M010314_source" class="dyn-source">
                        <pre>static VALUE
strio_readlines(int argc, VALUE *argv, VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    VALUE ary = rb_ary_new(), line;

    if (argc &gt; 0 &amp;&amp; !NIL_P(argv[argc-1]) &amp;&amp; NIL_P(rb_check_string_type(argv[argc-1])) &amp;&amp;
  NUM2LONG(argv[argc-1]) == 0) {
  rb_raise(rb_eArgError, &quot;invalid limit: 0 for readlines&quot;);
    }

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
  rb_ary_push(ary, line);
    }
    return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010317">
                    
                    <a name="M010317"></a><b>strio.sysread(integer[, outbuf])    &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Similar to <a href="StringIO.html#M010315">read</a>, but raises
<tt>EOFError</tt> at end of string instead of returning <tt>nil</tt>, as
well as <a href="IO.html#M000668">IO#sysread</a> does.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010317_source')" id="l_M010317_source">show</a>
                        
                    </p>
                    <div id="M010317_source" class="dyn-source">
                        <pre>static VALUE
strio_sysread(int argc, VALUE *argv, VALUE self)
{
    VALUE val = strio_read(argc, argv, self);
    if (NIL_P(val)) {
  rb_eof_error();
    }
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010272">
                    
                    <a name="M010272"></a><b>strio.reopen(other_StrIO)     &rarr; strio
strio.reopen(string, mode)    &rarr; strio
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Reinitializes <b>strio</b> with the given <em>other_StrIO</em> or
<em>string</em> and <em>mode</em> (see <a
href="StringIO.html#M010270">StringIO#new</a>).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010272_source')" id="l_M010272_source">show</a>
                        
                    </p>
                    <div id="M010272_source" class="dyn-source">
                        <pre>static VALUE
strio_reopen(int argc, VALUE *argv, VALUE self)
{
    rb_io_taint_check(self);
    if (argc == 1 &amp;&amp; TYPE(*argv) != T_STRING) {
  return strio_copy(self, *argv);
    }
    strio_init(argc, argv, StringIO(self));
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010291">
                    
                    <a name="M010291"></a><b>strio.rewind    &rarr; 0
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Positions <b>strio</b> to the beginning of input, resetting <tt>lineno</tt>
to zero.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010291_source')" id="l_M010291_source">show</a>
                        
                    </p>
                    <div id="M010291_source" class="dyn-source">
                        <pre>static VALUE
strio_rewind(VALUE self)
{
    struct StringIO *ptr = StringIO(self);
    ptr-&gt;pos = 0;
    ptr-&gt;lineno = 0;
    return INT2FIX(0);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010293">
                    
                    <a name="M010293"></a><b>strio.seek(amount, whence=SEEK_SET) &rarr; 0
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Seeks to a given offset <em>amount</em> in the stream according to the
value of <em>whence</em> (see <a href="IO.html#M000694">IO#seek</a>).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010293_source')" id="l_M010293_source">show</a>
                        
                    </p>
                    <div id="M010293_source" class="dyn-source">
                        <pre>static VALUE
strio_seek(int argc, VALUE *argv, VALUE self)
{
    VALUE whence;
    struct StringIO *ptr = StringIO(self);
    long offset;

    rb_scan_args(argc, argv, &quot;11&quot;, NULL, &amp;whence);
    offset = NUM2LONG(argv[0]);
    if (CLOSED(ptr)) {
  rb_raise(rb_eIOError, &quot;closed stream&quot;);
    }
    switch (NIL_P(whence) ? 0 : NUM2LONG(whence)) {
      case 0:
  break;
      case 1:
  offset += ptr-&gt;pos;
  break;
      case 2:
  offset += RSTRING_LEN(ptr-&gt;string);
  break;
      default:
  error_inval(&quot;invalid whence&quot;);
    }
    if (offset &lt; 0) {
  error_inval(0);
    }
    ptr-&gt;pos = offset;
    return INT2FIX(0);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010338">
                    
                    <a name="M010338"></a><b>strio.set_encoding(ext_enc, [int_enc[, opt]])  => strio
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Specify the encoding of the <a href="StringIO.html">StringIO</a> as
<em>ext_enc</em>. Use the default external encoding if <em>ext_enc</em> is
nil. 2nd argument <em>int_enc</em> and optional hash <em>opt</em> argument
are ignored; they are for API compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010338_source')" id="l_M010338_source">show</a>
                        
                    </p>
                    <div id="M010338_source" class="dyn-source">
                        <pre>static VALUE
strio_set_encoding(int argc, VALUE *argv, VALUE self)
{
    rb_encoding* enc;
    VALUE str = StringIO(self)-&gt;string;
    VALUE ext_enc, int_enc, opt;

    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;ext_enc, &amp;int_enc, &amp;opt);

    if (NIL_P(ext_enc)) {
  enc = rb_default_external_encoding();
    }
    else {
  enc = rb_to_encoding(ext_enc);
    }
    rb_enc_associate(str, enc);
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010333">
                    
                    <a name="M010333"></a><b>strio.size   &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the size of the buffer string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010333_source')" id="l_M010333_source">show</a>
                        
                    </p>
                    <div id="M010333_source" class="dyn-source">
                        <pre>static VALUE
strio_size(VALUE self)
{
    VALUE string = StringIO(self)-&gt;string;
    if (NIL_P(string)) {
  rb_raise(rb_eIOError, &quot;not opened&quot;);
    }
    return ULONG2NUM(RSTRING_LEN(string));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010273">
                    
                    <a name="M010273"></a><b> strio.string     &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns underlying <a href="String.html">String</a> object, the subject of
<a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010273_source')" id="l_M010273_source">show</a>
                        
                    </p>
                    <div id="M010273_source" class="dyn-source">
                        <pre>static VALUE
strio_get_string(VALUE self)
{
    return StringIO(self)-&gt;string;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010274">
                    
                    <a name="M010274"></a><b>strio.string = string  &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Changes underlying <a href="String.html">String</a> object, the subject of
<a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010274_source')" id="l_M010274_source">show</a>
                        
                    </p>
                    <div id="M010274_source" class="dyn-source">
                        <pre>static VALUE
strio_set_string(VALUE self, VALUE string)
{
    struct StringIO *ptr = StringIO(self);

    rb_io_taint_check(self);
    ptr-&gt;flags &amp;= ~FMODE_READWRITE;
    StringValue(string);
    ptr-&gt;flags = OBJ_FROZEN(string) ? FMODE_READABLE : FMODE_READWRITE;
    ptr-&gt;pos = 0;
    ptr-&gt;lineno = 0;
    return ptr-&gt;string = string;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010294">
                    
                    <a name="M010294"></a><b>strio.sync    &rarr; true
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> always.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010294_source')" id="l_M010294_source">show</a>
                        
                    </p>
                    <div id="M010294_source" class="dyn-source">
                        <pre>static VALUE
strio_get_sync(VALUE self)
{
    StringIO(self);
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010295">
                    
                    <a name="M010295"></a><b> strio.sync = boolean &rarr; boolean </b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the argument unchanged. Just for compatibility to <a
href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010295_source')" id="l_M010295_source">show</a>
                        
                    </p>
                    <div id="M010295_source" class="dyn-source">
                        <pre>#define strio_set_sync strio_first</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010316">
                    
                    <a name="M010316"></a><b>strio.sysread(integer[, outbuf])    &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Similar to <a href="StringIO.html#M010315">read</a>, but raises
<tt>EOFError</tt> at end of string instead of returning <tt>nil</tt>, as
well as <a href="IO.html#M000668">IO#sysread</a> does.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010316_source')" id="l_M010316_source">show</a>
                        
                    </p>
                    <div id="M010316_source" class="dyn-source">
                        <pre>static VALUE
strio_sysread(int argc, VALUE *argv, VALUE self)
{
    VALUE val = strio_read(argc, argv, self);
    if (NIL_P(val)) {
  rb_eof_error();
    }
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010327">
                    
                    <a name="M010327"></a><b>strio.write(string)    &rarr; integer
strio.syswrite(string) &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Appends the given string to the underlying buffer string of <b>strio</b>.
The stream must be opened for writing. If the argument is not a string, it
will be converted to a string using <tt>to_s</tt>. Returns the number of
bytes written. See <a href="IO.html#M000645">IO#write</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010327_source')" id="l_M010327_source">show</a>
                        
                    </p>
                    <div id="M010327_source" class="dyn-source">
                        <pre>static VALUE
strio_write(VALUE self, VALUE str)
{
    struct StringIO *ptr = writable(StringIO(self));
    long len, olen;
    rb_encoding *enc, *enc2;

    RB_GC_GUARD(str);
    if (TYPE(str) != T_STRING)
  str = rb_obj_as_string(str);
    enc = rb_enc_get(ptr-&gt;string);
    enc2 = rb_enc_get(str);
    if (enc != enc2 &amp;&amp; enc != rb_ascii8bit_encoding()) {
  str = rb_str_conv_enc(str, enc2, enc);
    }
    len = RSTRING_LEN(str);
    if (len == 0) return INT2FIX(0);
    check_modifiable(ptr);
    olen = RSTRING_LEN(ptr-&gt;string);
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
  ptr-&gt;pos = olen;
    }
    if (ptr-&gt;pos == olen) {
  rb_str_cat(ptr-&gt;string, RSTRING_PTR(str), len);
    }
    else {
  strio_extend(ptr, ptr-&gt;pos, len);
  memmove(RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos, RSTRING_PTR(str), len);
  OBJ_INFECT(ptr-&gt;string, str);
    }
    OBJ_INFECT(ptr-&gt;string, self);
    ptr-&gt;pos += len;
    return LONG2NUM(len);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010296">
                    
                    <a name="M010296"></a><b>strio.pos     &rarr; integer
strio.tell    &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the current offset (in bytes) of <b>strio</b>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010296_source')" id="l_M010296_source">show</a>
                        
                    </p>
                    <div id="M010296_source" class="dyn-source">
                        <pre>static VALUE
strio_get_pos(VALUE self)
{
    return LONG2NUM(StringIO(self)-&gt;pos);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010335">
                    
                    <a name="M010335"></a><b>strio.truncate(integer)    &rarr; 0
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Truncates the buffer string to at most <em>integer</em> bytes. The
<b>strio</b> must be opened for writing.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010335_source')" id="l_M010335_source">show</a>
                        
                    </p>
                    <div id="M010335_source" class="dyn-source">
                        <pre>static VALUE
strio_truncate(VALUE self, VALUE len)
{
    VALUE string = writable(StringIO(self))-&gt;string;
    long l = NUM2LONG(len);
    long plen = RSTRING_LEN(string);
    if (l &lt; 0) {
  error_inval(&quot;negative legnth&quot;);
    }
    rb_str_resize(string, l);
    if (plen &lt; l) {
  MEMZERO(RSTRING_PTR(string) + plen, char, l - plen);
    }
    return len;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010330">
                    
                    <a name="M010330"></a><b>strio.isatty &rarr; nil
strio.tty? &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>false</tt>. Just for compatibility to <a href="IO.html">IO</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010330_source')" id="l_M010330_source">show</a>
                        
                    </p>
                    <div id="M010330_source" class="dyn-source">
                        <pre>#define strio_isatty strio_false</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010308">
                    
                    <a name="M010308"></a><b>strio.ungetbyte(fixnum)   &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
See <a href="IO.html#M000689">IO#ungetbyte</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010308_source')" id="l_M010308_source">show</a>
                        
                    </p>
                    <div id="M010308_source" class="dyn-source">
                        <pre>static VALUE
strio_ungetbyte(VALUE self, VALUE c)
{
    struct StringIO *ptr = readable(StringIO(self));
    char buf[1], *cp = buf;
    long pos = ptr-&gt;pos, cl = 1;
    VALUE str = ptr-&gt;string;

    if (NIL_P(c)) return Qnil;
    if (FIXNUM_P(c)) {
  buf[0] = (char)FIX2INT(c);
    }
    else {
  SafeStringValue(c);
  cp = RSTRING_PTR(c);
  cl = RSTRING_LEN(c);
  if (cl == 0) return Qnil;
    }
    rb_str_modify(str);
    if (cl &gt; pos) {
  char *s;
  long rest = RSTRING_LEN(str) - pos;
  rb_str_resize(str, rest + cl);
  s = RSTRING_PTR(str);
  memmove(s + cl, s + pos, rest);
  pos = 0;
    }
    else {
  pos -= cl;
    }
    memcpy(RSTRING_PTR(str) + pos, cp, cl);
    ptr-&gt;pos = pos;
    RB_GC_GUARD(c);
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010307">
                    
                    <a name="M010307"></a><b>strio.ungetc(string)   &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Pushes back one character (passed as a parameter) onto <b>strio</b> such
that a subsequent buffered read will return it. There is no limitation for
multiple pushbacks including pushing back behind the beginning of the
buffer string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010307_source')" id="l_M010307_source">show</a>
                        
                    </p>
                    <div id="M010307_source" class="dyn-source">
                        <pre>static VALUE
strio_ungetc(VALUE self, VALUE c)
{
    struct StringIO *ptr = readable(StringIO(self));
    long lpos, clen;
    char *p, *pend;
    rb_encoding *enc, *enc2;

    if (NIL_P(c)) return Qnil;
    if (FIXNUM_P(c)) {
  int cc = FIX2INT(c);
  char buf[16];

  enc = rb_enc_get(ptr-&gt;string);
  rb_enc_mbcput(cc, buf, enc);
  c = rb_enc_str_new(buf, rb_enc_codelen(cc, enc), enc);
    }
    else {
  SafeStringValue(c);
  enc = rb_enc_get(ptr-&gt;string);
  enc2 = rb_enc_get(c);
  if (enc != enc2 &amp;&amp; enc != rb_ascii8bit_encoding()) {
      c = rb_str_conv_enc(c, enc2, enc);
  }
    }
    if (RSTRING_LEN(ptr-&gt;string) &lt; ptr-&gt;pos) {
  long len = RSTRING_LEN(ptr-&gt;string);
  rb_str_resize(ptr-&gt;string, ptr-&gt;pos - 1);
  memset(RSTRING_PTR(ptr-&gt;string) + len, 0, ptr-&gt;pos - len - 1);
  rb_str_concat(ptr-&gt;string, c);
  ptr-&gt;pos--;
    }
    else {
  /* get logical position */
  lpos = 0; p = RSTRING_PTR(ptr-&gt;string); pend = p + ptr-&gt;pos;
  for (;;) {
      clen = rb_enc_mbclen(p, pend, enc);
      if (p+clen &gt;= pend) break;
      p += clen;
      lpos++;
  }
  clen = p - RSTRING_PTR(ptr-&gt;string);
  rb_str_update(ptr-&gt;string, lpos, ptr-&gt;pos ? 1 : 0, c);
  ptr-&gt;pos = clen;
    }

    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010319">
                    
                    <a name="M010319"></a><b>strio.write(string)    &rarr; integer
strio.syswrite(string) &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Appends the given string to the underlying buffer string of <b>strio</b>.
The stream must be opened for writing. If the argument is not a string, it
will be converted to a string using <tt>to_s</tt>. Returns the number of
bytes written. See <a href="IO.html#M000645">IO#write</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010319_source')" id="l_M010319_source">show</a>
                        
                    </p>
                    <div id="M010319_source" class="dyn-source">
                        <pre>static VALUE
strio_write(VALUE self, VALUE str)
{
    struct StringIO *ptr = writable(StringIO(self));
    long len, olen;
    rb_encoding *enc, *enc2;

    RB_GC_GUARD(str);
    if (TYPE(str) != T_STRING)
  str = rb_obj_as_string(str);
    enc = rb_enc_get(ptr-&gt;string);
    enc2 = rb_enc_get(str);
    if (enc != enc2 &amp;&amp; enc != rb_ascii8bit_encoding()) {
  str = rb_str_conv_enc(str, enc2, enc);
    }
    len = RSTRING_LEN(str);
    if (len == 0) return INT2FIX(0);
    check_modifiable(ptr);
    olen = RSTRING_LEN(ptr-&gt;string);
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
  ptr-&gt;pos = olen;
    }
    if (ptr-&gt;pos == olen) {
  rb_str_cat(ptr-&gt;string, RSTRING_PTR(str), len);
    }
    else {
  strio_extend(ptr, ptr-&gt;pos, len);
  memmove(RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos, RSTRING_PTR(str), len);
  OBJ_INFECT(ptr-&gt;string, str);
    }
    OBJ_INFECT(ptr-&gt;string, self);
    ptr-&gt;pos += len;
    return LONG2NUM(len);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M010328">
                    
                    <a name="M010328"></a><b>strio.write(string)    &rarr; integer
strio.syswrite(string) &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Appends the given string to the underlying buffer string of <b>strio</b>.
The stream must be opened for writing. If the argument is not a string, it
will be converted to a string using <tt>to_s</tt>. Returns the number of
bytes written. See <a href="IO.html#M000645">IO#write</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M010328_source')" id="l_M010328_source">show</a>
                        
                    </p>
                    <div id="M010328_source" class="dyn-source">
                        <pre>static VALUE
strio_write(VALUE self, VALUE str)
{
    struct StringIO *ptr = writable(StringIO(self));
    long len, olen;
    rb_encoding *enc, *enc2;

    RB_GC_GUARD(str);
    if (TYPE(str) != T_STRING)
  str = rb_obj_as_string(str);
    enc = rb_enc_get(ptr-&gt;string);
    enc2 = rb_enc_get(str);
    if (enc != enc2 &amp;&amp; enc != rb_ascii8bit_encoding()) {
  str = rb_str_conv_enc(str, enc2, enc);
    }
    len = RSTRING_LEN(str);
    if (len == 0) return INT2FIX(0);
    check_modifiable(ptr);
    olen = RSTRING_LEN(ptr-&gt;string);
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
  ptr-&gt;pos = olen;
    }
    if (ptr-&gt;pos == olen) {
  rb_str_cat(ptr-&gt;string, RSTRING_PTR(str), len);
    }
    else {
  strio_extend(ptr, ptr-&gt;pos, len);
  memmove(RSTRING_PTR(ptr-&gt;string)+ptr-&gt;pos, RSTRING_PTR(str), len);
  OBJ_INFECT(ptr-&gt;string, str);
    }
    OBJ_INFECT(ptr-&gt;string, self);
    ptr-&gt;pos += len;
    return LONG2NUM(len);
}</pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    