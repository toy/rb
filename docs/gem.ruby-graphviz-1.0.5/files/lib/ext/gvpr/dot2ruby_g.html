<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>dot2ruby.g</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            dot2ruby.g
        </h1>
        <ul class="files">
            <li>lib/ext/gvpr/dot2ruby.g</li>
            <li>Last modified: Mon Feb 13 07:34:55 +0100 2012</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
// Copyright &#169; 2010 Gregoire Lejeune <gregoire.lejeune@free.fr> // //
This program is free software; you can redistribute it and/or modify // it
under the terms of the GNU General Public License as published by // the
Free Software Foundation; either version 2 of the License, or // (at your
option) any later version. // // This program is distributed in the hope
that it will be useful, // but WITHOUT ANY WARRANTY; without even the
implied warranty of // MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the // GNU General Public License for more details. // // You should
have received a copy of the GNU General Public License // along with this
program; if not, write to the Free Software // Foundation, Inc., 59 Temple
Place, Suite 330, Boston, MA 02111-1307 USA // // Usage : // gvpr -f
dot2ruby.g [-a <output type>] <dot script>
</p>
<p>
BEGIN {
</p>
<pre>
  int g_strict; int g_direct;
  graph_t cluster;
  node_t cnode;
  edge_t cedge;
  string attr; string attrv;
  graph_t subgraph; graph_t pgraph;
  graph_t ofgraph;

        string xOut;
        if( ARGC == 0 ) {
                xOut = &quot;_&quot;;
        } else {
                xOut = tolower(ARGV[0]);
        }

  printf( &quot;# This code was generated by dot2ruby.g\n\n&quot; );

  string rubyfy( string s ) {
    string out;
    out = tolower( s );
    out = gsub( out, &quot; &quot;, &quot;__&quot; );
    out = gsub( out, &quot;'&quot;, &quot;&quot; );
    out = gsub( out, &quot;-&quot;, &quot;_&quot; );
    out = gsub( out, &quot;.&quot;, &quot;&quot; );
                out = gsub( out, &quot;%&quot;, &quot;u&quot; );
                out = gsub( out, &quot;+&quot;, &quot;&quot; );
                out = gsub( out, &quot;/&quot;, &quot;_&quot; );
    return( out );
  }
</pre>
<p>
}
</p>
<p>
BEG_G {
</p>
<pre>
  printf( &quot;require 'rubygems'\nrequire 'graphviz'\n&quot;);
  // Directed
  g_direct = isDirect($);
  if( g_direct == 0 ) {
    printf( &quot;graph_%s = GraphViz.graph( \&quot;%s\&quot;&quot;, rubyfy($.name), rubyfy($.name) );
  } else {
    printf( &quot;graph_%s = GraphViz.digraph( \&quot;%s\&quot;&quot;, rubyfy($.name), rubyfy($.name) );
  }
  // Strict
  g_strict = isStrict($);
  if( g_strict != 0 ) {
    printf( &quot;, :strict =&gt; true&quot; );
  }
  printf( &quot; ) { |graph_%s|\n&quot;, rubyfy($.name) );

  // Attributs of G
  attr = fstAttr($, &quot;G&quot;);
  while( attr != &quot;&quot; ) {
    attrv = aget( $, attr );
    if( attrv != &quot;&quot; ) {
      printf( &quot;  graph_%s[:%s] = '%s'\n&quot;, rubyfy($.name), attr, attrv );
    }
    attr = nxtAttr( $, &quot;G&quot;, attr );
  }

  // Subgraph
  subgraph = fstsubg( $ );
  while( subgraph != NULL ) {
    pgraph = subgraph.parent;
    printf ( &quot;  graph_%s = graph_%s.add_graph( \&quot;%s\&quot; )\n&quot;, rubyfy(subgraph.name), rubyfy(pgraph.name), rubyfy(subgraph.name) );

    // ATTRS
    attr = fstAttr(subgraph, &quot;G&quot;);
    while( attr != &quot;&quot; ) {
      attrv = aget( subgraph, attr );
      if( attrv != &quot;&quot; ) {
        printf( &quot;  graph_%s[:%s] = '%s'\n&quot;, rubyfy(subgraph.name), attr, attrv );
      }
      attr = nxtAttr( subgraph, &quot;G&quot;, attr );
    }

    subgraph = nxtsubg( subgraph );
  }
</pre>
<p>
}
</p>
<p>
N {
</p>
<pre>
  pgraph = $.root;
  ofgraph = pgraph;

  subgraph = fstsubg( pgraph );
  while( subgraph != NULL ) {
    if( isSubnode( subgraph, $ ) != 0 ) {
      ofgraph = subgraph;
    }
    subgraph = nxtsubg( subgraph );
  }

  printf( &quot;  node_%s = graph_%s.add_nodes( \&quot;%s\&quot;&quot;, rubyfy($.name), rubyfy(ofgraph.name), $.name );

  // Attributs of N
  attr = fstAttr($G, &quot;N&quot;);
  while( attr != &quot;&quot; ) {
    attrv = aget( $, attr );
    if( attrv != &quot;&quot; ) {
      printf( &quot;, :%s =&gt; '%s'&quot;, attr, gsub( attrv, &quot;'&quot;, &quot;\\'&quot; ) );
    } else {
      printf( &quot;, :%s =&gt; ''&quot;, attr );
    }
    attr = nxtAttr( $G, &quot;N&quot;, attr );
  }

  printf( &quot; )\n&quot;);
</pre>
<p>
}
</p>
<p>
E {
</p>
<pre>
  pgraph = $.root;
  ofgraph = pgraph;

  subgraph = fstsubg( pgraph );
  while( subgraph != NULL ) {
    if( isSubedge( subgraph, $ ) != 0 ) {
      ofgraph = subgraph;
    }
    subgraph = nxtsubg( subgraph );
  }

  printf( &quot;  graph_%s.add_edges( \&quot;%s\&quot;, \&quot;%s\&quot;&quot;, rubyfy(ofgraph.name), $.tail.name, $.head.name );

  // Attributs of E
  attr = fstAttr($G, &quot;E&quot;);
  while( attr != &quot;&quot; ) {
    attrv = aget( $, attr );
    if( attrv != &quot;&quot; ) {
      printf( &quot;, :%s =&gt; '%s'&quot;, attr, gsub( attrv, &quot;'&quot;, &quot;\\'&quot; ) );
    } else {
      printf( &quot;, :%s =&gt; ''&quot;, attr );
    }
    attr = nxtAttr( $G, &quot;E&quot;, attr );
  }

  printf( &quot; )\n&quot; );
</pre>
<p>
}
</p>
<p>
END_G {
</p>
<pre>
  printf( &quot;}\n&quot; );
        if( xOut != &quot;_&quot; ) {
                if( xOut == &quot;-&quot; ) {
                        printf( &quot;@_graph_eval = graph_%s\n&quot;, rubyfy($.name) );
                } else {
                printf( &quot;graph_%s.output( :%s =&gt; \&quot;%s.%s\&quot; )\n&quot;, rubyfy($.name), xOut, gsub($F, &quot;.*/&quot;, &quot;&quot;), xOut );
                }
        }
</pre>
<p>
}
</p>

    </div>
    

    

    
    

    
    

    

    

    

    

    

    
</div>
    </div>
  </body>
</html>