<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>NewRelic::TransactionSample::Segment</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            NewRelic::TransactionSample::Segment 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/new_relic/transaction_sample/segment_rb.html">lib/new_relic/transaction_sample/segment.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M000917">[]</a>,</li>
                
                <li><a href="#M000916">[]=</a></li>
                
            </ul>
        </dd>
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000902">add_called_segment</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000910">called_segments</a>,</li>
                
                <li><a href="#M000925">called_segments=</a>,</li>
                
                <li><a href="#M000913">count_segments</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000911">duration</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000919">each_segment</a>,</li>
                
                <li><a href="#M000920">each_segment_with_nest_tracking</a>,</li>
                
                <li><a href="#M000901">end_trace</a>,</li>
                
                <li><a href="#M000912">exclusive_duration</a>,</li>
                
                <li><a href="#M000922">explain_sql</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000921">find_segment</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000900">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000923">obfuscated_sql</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000918">params</a>,</li>
                
                <li><a href="#M000924">params=</a>,</li>
                
                <li><a href="#M000926">parent_segment=</a>,</li>
                
                <li><a href="#M000905">path_string</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000909">to_debug_str</a>,</li>
                
                <li><a href="#M000904">to_json</a>,</li>
                
                <li><a href="#M000903">to_s</a>,</li>
                
                <li><a href="#M000906">to_s_compact</a>,</li>
                
                <li><a href="#M000914">truncate</a>,</li>
                
                <li><a href="#M000915">truncate_each_child</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>entry_timestamp</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>exit_timestamp</td>
            <td class='attr-desc'><p>
The exit timestamp will be relative except for the outermost sample which
will have a timestamp.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>parent_segment</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>metric_name</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>segment_id</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000900">
                    
                    <a name="M000900"></a><b>new</b>(timestamp, metric_name, segment_id)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000900_source')" id="l_M000900_source">show</a>
                        
                    </p>
                    <div id="M000900_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 13</span>
13:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">timestamp</span>, <span class="ruby-identifier">metric_name</span>, <span class="ruby-identifier">segment_id</span>)
14:         <span class="ruby-ivar">@entry_timestamp</span> = <span class="ruby-identifier">timestamp</span>
15:         <span class="ruby-ivar">@metric_name</span> = <span class="ruby-identifier">metric_name</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'&lt;unknown&gt;'</span>
16:         <span class="ruby-ivar">@segment_id</span> = <span class="ruby-identifier">segment_id</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">object_id</span>
17:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000917">
                    
                    <a name="M000917"></a><b>[]</b>(key)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000917_source')" id="l_M000917_source">show</a>
                        
                    </p>
                    <div id="M000917_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 134</span>
134:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">key</span>)
135:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>]
136:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000916">
                    
                    <a name="M000916"></a><b>[]=</b>(key, value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000916_source')" id="l_M000916_source">show</a>
                        
                    </p>
                    <div id="M000916_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 128</span>
128:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
129:         <span class="ruby-comment cmt"># only create a parameters field if a parameter is set; this will save</span>
130:         <span class="ruby-comment cmt"># bandwidth etc as most segments have no parameters</span>
131:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
132:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000902">
                    
                    <a name="M000902"></a><b>add_called_segment</b>(s)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000902_source')" id="l_M000902_source">show</a>
                        
                    </p>
                    <div id="M000902_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 25</span>
25:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_called_segment</span>(<span class="ruby-identifier">s</span>)
26:         <span class="ruby-ivar">@called_segments</span> <span class="ruby-operator">||=</span> []
27:         <span class="ruby-ivar">@called_segments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>
28:         <span class="ruby-identifier">s</span>.<span class="ruby-identifier">parent_segment</span> = <span class="ruby-keyword kw">self</span>
29:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000910">
                    
                    <a name="M000910"></a><b>called_segments</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000910_source')" id="l_M000910_source">show</a>
                        
                    </p>
                    <div id="M000910_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 81</span>
81:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">called_segments</span>
82:         <span class="ruby-ivar">@called_segments</span> <span class="ruby-operator">||</span> []
83:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000925">
                    
                    <a name="M000925"></a><b>called_segments=</b>(segments)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000925_source')" id="l_M000925_source">show</a>
                        
                    </p>
                    <div id="M000925_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 191</span>
191:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">called_segments=</span>(<span class="ruby-identifier">segments</span>)
192:         <span class="ruby-ivar">@called_segments</span> = <span class="ruby-identifier">segments</span>
193:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000913">
                    
                    <a name="M000913"></a><b>count_segments</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000913_source')" id="l_M000913_source">show</a>
                        
                    </p>
                    <div id="M000913_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 100</span>
100:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">count_segments</span>
101:         <span class="ruby-identifier">count</span> = <span class="ruby-value">1</span>
102:         <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">seg</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">count</span>  <span class="ruby-operator">+=</span> <span class="ruby-identifier">seg</span>.<span class="ruby-identifier">count_segments</span> }
103:         <span class="ruby-identifier">count</span>
104:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000911">
                    
                    <a name="M000911"></a><b>duration</b>()
                    
                </div>
                
                <div class="description">
                  <p>
return the total duration of this segment
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000911_source')" id="l_M000911_source">show</a>
                        
                    </p>
                    <div id="M000911_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 86</span>
86:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">duration</span>
87:         (<span class="ruby-ivar">@exit_timestamp</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@entry_timestamp</span>).<span class="ruby-identifier">to_f</span>
88:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000919">
                    
                    <a name="M000919"></a><b>each_segment</b>(&amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
call the provided block for this segment and each of the called segments
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000919_source')" id="l_M000919_source">show</a>
                        
                    </p>
                    <div id="M000919_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 144</span>
144:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_segment</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
145:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">self</span>
146: 
147:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@called_segments</span>
148:           <span class="ruby-ivar">@called_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
149:             <span class="ruby-identifier">segment</span>.<span class="ruby-identifier">each_segment</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
150:           <span class="ruby-keyword kw">end</span>
151:         <span class="ruby-keyword kw">end</span>
152:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000920">
                    
                    <a name="M000920"></a><b>each_segment_with_nest_tracking</b>(&amp;block)
                    
                </div>
                
                <div class="description">
                  <p>
call the provided block for this segment and each of the called segments
while keeping track of nested segments
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000920_source')" id="l_M000920_source">show</a>
                        
                    </p>
                    <div id="M000920_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 156</span>
156:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_segment_with_nest_tracking</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
157:         <span class="ruby-identifier">summary</span> = <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">self</span>
158:         <span class="ruby-identifier">summary</span>.<span class="ruby-identifier">current_nest_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">summary</span>
159: 
160:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@called_segments</span>
161:           <span class="ruby-ivar">@called_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
162:             <span class="ruby-identifier">segment</span>.<span class="ruby-identifier">each_segment_with_nest_tracking</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
163:           <span class="ruby-keyword kw">end</span>
164:         <span class="ruby-keyword kw">end</span>
165: 
166:         <span class="ruby-identifier">summary</span>.<span class="ruby-identifier">current_nest_count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">summary</span>
167:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000901">
                    
                    <a name="M000901"></a><b>end_trace</b>(timestamp)
                    
                </div>
                
                <div class="description">
                  <p>
sets the final timestamp on a segment to indicate the exit point of the
segment
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000901_source')" id="l_M000901_source">show</a>
                        
                    </p>
                    <div id="M000901_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 21</span>
21:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">end_trace</span>(<span class="ruby-identifier">timestamp</span>)
22:         <span class="ruby-ivar">@exit_timestamp</span> = <span class="ruby-identifier">timestamp</span>
23:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000912">
                    
                    <a name="M000912"></a><b>exclusive_duration</b>()
                    
                </div>
                
                <div class="description">
                  <p>
return the duration of this segment without including the time in the
called segments
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000912_source')" id="l_M000912_source">show</a>
                        
                    </p>
                    <div id="M000912_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 92</span>
92:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exclusive_duration</span>
93:         <span class="ruby-identifier">d</span> = <span class="ruby-identifier">duration</span>
94: 
95:         <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
96:           <span class="ruby-identifier">d</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">segment</span>.<span class="ruby-identifier">duration</span>
97:         <span class="ruby-keyword kw">end</span>
98:         <span class="ruby-identifier">d</span>
99:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000922">
                    
                    <a name="M000922"></a><b>explain_sql</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000922_source')" id="l_M000922_source">show</a>
                        
                    </p>
                    <div id="M000922_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 178</span>
178:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">explain_sql</span>
179:         <span class="ruby-constant">NewRelic</span><span class="ruby-operator">::</span><span class="ruby-constant">Agent</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">explain_sql</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sql</span>],
180:                                               <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:connection_config</span>])
181:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000921">
                    
                    <a name="M000921"></a><b>find_segment</b>(id)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000921_source')" id="l_M000921_source">show</a>
                        
                    </p>
                    <div id="M000921_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 169</span>
169:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_segment</span>(<span class="ruby-identifier">id</span>)
170:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@segment_id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">id</span>
171:         <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
172:           <span class="ruby-identifier">found</span> = <span class="ruby-identifier">segment</span>.<span class="ruby-identifier">find_segment</span>(<span class="ruby-identifier">id</span>)
173:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">found</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found</span>
174:         <span class="ruby-keyword kw">end</span>
175:         <span class="ruby-keyword kw">nil</span>
176:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000923">
                    
                    <a name="M000923"></a><b>obfuscated_sql</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000923_source')" id="l_M000923_source">show</a>
                        
                    </p>
                    <div id="M000923_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 183</span>
183:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">obfuscated_sql</span>
184:         <span class="ruby-constant">NewRelic</span><span class="ruby-operator">::</span><span class="ruby-constant">Agent</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">obfuscate_sql</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sql</span>])
185:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000918">
                    
                    <a name="M000918"></a><b>params</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000918_source')" id="l_M000918_source">show</a>
                        
                    </p>
                    <div id="M000918_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 138</span>
138:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">params</span>
139:         <span class="ruby-ivar">@params</span> <span class="ruby-operator">||=</span> {}
140:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000924">
                    
                    <a name="M000924"></a><b>params=</b>(p)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000924_source')" id="l_M000924_source">show</a>
                        
                    </p>
                    <div id="M000924_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 187</span>
187:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">params=</span>(<span class="ruby-identifier">p</span>)
188:         <span class="ruby-ivar">@params</span> = <span class="ruby-identifier">p</span>
189:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000905">
                    
                    <a name="M000905"></a><b>path_string</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000905_source')" id="l_M000905_source">show</a>
                        
                    </p>
                    <div id="M000905_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 49</span>
49:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">path_string</span>
50:         <span class="ruby-node">&quot;#{metric_name}[#{called_segments.collect {|segment| segment.path_string }.join('')}]&quot;</span>
51:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000909">
                    
                    <a name="M000909"></a><b>to_debug_str</b>(depth)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000909_source')" id="l_M000909_source">show</a>
                        
                    </p>
                    <div id="M000909_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 60</span>
60:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_debug_str</span>(<span class="ruby-identifier">depth</span>)
61:         <span class="ruby-identifier">tab</span> = <span class="ruby-value str">&quot;  &quot;</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">depth</span>
62:         <span class="ruby-identifier">s</span> = <span class="ruby-identifier">tab</span>.<span class="ruby-identifier">clone</span>
63:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&gt;&gt; #{'%3i ms' % (@entry_timestamp*1000)} [#{self.class.name.split(&quot;::&quot;).last}] #{metric_name} \n&quot;</span>
64:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">empty?</span>
65:           <span class="ruby-identifier">params</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
66:             <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{tab}    -#{'%-16s' % k}: #{v.to_s[0..80]}\n&quot;</span>
67:           <span class="ruby-keyword kw">end</span>
68:         <span class="ruby-keyword kw">end</span>
69:         <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cs</span><span class="ruby-operator">|</span>
70:           <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">cs</span>.<span class="ruby-identifier">to_debug_str</span>(<span class="ruby-identifier">depth</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
71:         <span class="ruby-keyword kw">end</span>
72:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tab</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;&lt;&lt; &quot;</span>
73:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@exit_timestamp</span>
74:              <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span> <span class="ruby-value str">' n/a'</span>
75:              <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Numeric</span> <span class="ruby-keyword kw">then</span> <span class="ruby-value str">'%3i ms'</span> <span class="ruby-operator">%</span> (<span class="ruby-ivar">@exit_timestamp</span><span class="ruby-operator">*</span><span class="ruby-value">1000</span>)
76:              <span class="ruby-keyword kw">else</span> <span class="ruby-ivar">@exit_timestamp</span>.<span class="ruby-identifier">to_s</span>
77:              <span class="ruby-keyword kw">end</span>
78:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; #{metric_name}\n&quot;</span>
79:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000904">
                    
                    <a name="M000904"></a><b>to_json</b>(options={})
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000904_source')" id="l_M000904_source">show</a>
                        
                    </p>
                    <div id="M000904_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 35</span>
35:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_json</span>(<span class="ruby-identifier">options</span>={})
36:         <span class="ruby-identifier">hash</span> = {
37:           <span class="ruby-identifier">:entry_timestamp</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@entry_timestamp</span>,
38:           <span class="ruby-identifier">:exit_timestamp</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@exit_timestamp</span>,
39:           <span class="ruby-identifier">:metric_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@metric_name</span>,
40:           <span class="ruby-identifier">:segment_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@segment_id</span>,
41:         }
42: 
43:         <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">:called_segments</span>] = <span class="ruby-identifier">called_segments</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">empty?</span>
44:         <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">:params</span>] = <span class="ruby-ivar">@params</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@params</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@params</span>.<span class="ruby-identifier">empty?</span>
45: 
46:         <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">to_json</span>
47:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000903">
                    
                    <a name="M000903"></a><b>to_s</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000903_source')" id="l_M000903_source">show</a>
                        
                    </p>
                    <div id="M000903_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 31</span>
31:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
32:         <span class="ruby-identifier">to_debug_str</span>(<span class="ruby-value">0</span>)
33:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000906">
                    
                    <a name="M000906"></a><b>to_s_compact</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000906_source')" id="l_M000906_source">show</a>
                        
                    </p>
                    <div id="M000906_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 52</span>
52:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s_compact</span>
53:         <span class="ruby-identifier">str</span> = <span class="ruby-value str">&quot;&quot;</span>
54:         <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">metric_name</span>
55:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">any?</span>
56:           <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;{#{called_segments.map { | cs | cs.to_s_compact }.join(&quot;,&quot;)}}&quot;</span>
57:         <span class="ruby-keyword kw">end</span>
58:         <span class="ruby-identifier">str</span>
59:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000914">
                    
                    <a name="M000914"></a><b>truncate</b>(max)
                    
                </div>
                
                <div class="description">
                  <p>
Walk through the tree and truncate the segments in a depth-first manner
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000914_source')" id="l_M000914_source">show</a>
                        
                    </p>
                    <div id="M000914_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 107</span>
107:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">truncate</span>(<span class="ruby-identifier">max</span>)
108:         <span class="ruby-keyword kw">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@called_segments</span>
109:         <span class="ruby-identifier">total</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">called_segments</span> = <span class="ruby-identifier">truncate_each_child</span>(<span class="ruby-identifier">max</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
110:         <span class="ruby-identifier">total</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
111:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000915">
                    
                    <a name="M000915"></a><b>truncate_each_child</b>(max)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000915_source')" id="l_M000915_source">show</a>
                        
                    </p>
                    <div id="M000915_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 113</span>
113:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">truncate_each_child</span>(<span class="ruby-identifier">max</span>)
114:         <span class="ruby-identifier">total</span> = <span class="ruby-value">0</span>
115:         <span class="ruby-identifier">accumulator</span> = []
116:         <span class="ruby-identifier">called_segments</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">|</span>
117:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">total</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">max</span>
118:             <span class="ruby-keyword kw">true</span>
119:           <span class="ruby-keyword kw">else</span>
120:             <span class="ruby-identifier">total</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-identifier">max</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">total</span>)
121:             <span class="ruby-identifier">accumulator</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>
122:           <span class="ruby-keyword kw">end</span>
123:         }
124:         <span class="ruby-identifier">total</span>
125:         [<span class="ruby-identifier">total</span>, <span class="ruby-identifier">accumulator</span>]
126:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000926">
                    
                    <a name="M000926"></a><b>parent_segment=</b>(s)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000926_source')" id="l_M000926_source">show</a>
                        
                    </p>
                    <div id="M000926_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/new_relic/transaction_sample/segment.rb, line 196</span>
196:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parent_segment=</span>(<span class="ruby-identifier">s</span>)
197:         <span class="ruby-ivar">@parent_segment</span> = <span class="ruby-identifier">s</span>
198:       <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    