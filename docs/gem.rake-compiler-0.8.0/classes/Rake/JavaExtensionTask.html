<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Rake::JavaExtensionTask</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Rake::JavaExtensionTask 
            
                <span class="parent">&lt; 
                    
                    BaseExtensionTask
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rake/javaextensiontask_rb.html">lib/rake/javaextensiontask.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000017">define</a>,</li>
                
                <li><a href="#M000018">define_compile_tasks</a>,</li>
                
                <li><a href="#M000022">define_java_platform_tasks</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000016">init</a></li>
                
            </ul>
        </dd>
    
        <dt>J</dt>
        <dd>
            <ul>
                
                <li><a href="#M000025">java_classpath_arg</a>,</li>
                
                <li><a href="#M000015">java_compiling</a>,</li>
                
                <li><a href="#M000023">java_extdirs_arg</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000011">platform</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>classpath</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>debug</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>source_version</td>
            <td class='attr-desc'><p>
Provide source compatibility with specified release
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>target_version</td>
            <td class='attr-desc'><p>
Generate class files for specific VM version
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000017">
                    
                    <a name="M000017"></a><b>define</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000017_source')" id="l_M000017_source">show</a>
                        
                    </p>
                    <div id="M000017_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 38</span>
38:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">define</span>
39:       <span class="ruby-keyword kw">super</span>
40: 
41:       <span class="ruby-identifier">define_java_platform_tasks</span>
42:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000016">
                    
                    <a name="M000016"></a><b>init</b>(name = nil, gem_spec = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000016_source')" id="l_M000016_source">show</a>
                        
                    </p>
                    <div id="M000016_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 28</span>
28:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">gem_spec</span> = <span class="ruby-keyword kw">nil</span>)
29:       <span class="ruby-keyword kw">super</span>
30:       <span class="ruby-ivar">@source_pattern</span> = <span class="ruby-value str">'**/*.java'</span>
31:       <span class="ruby-ivar">@classpath</span>      = <span class="ruby-keyword kw">nil</span>
32:       <span class="ruby-ivar">@java_compiling</span> = <span class="ruby-keyword kw">nil</span>
33:       <span class="ruby-ivar">@debug</span>          = <span class="ruby-keyword kw">false</span>
34:       <span class="ruby-ivar">@source_version</span> = <span class="ruby-value str">'1.5'</span>
35:       <span class="ruby-ivar">@target_version</span> = <span class="ruby-value str">'1.5'</span>
36:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000015">
                    
                    <a name="M000015"></a><b>java_compiling</b>(&amp;block)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 24</span>
24:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">java_compiling</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
25:       <span class="ruby-ivar">@java_compiling</span> = <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
26:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000011">
                    
                    <a name="M000011"></a><b>platform</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 20</span>
20:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">platform</span>
21:       <span class="ruby-ivar">@platform</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'java'</span>
22:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M000018">
                    
                    <a name="M000018"></a><b>define_compile_tasks</b>(for_platform = nil, ruby_ver = RUBY_VERSION)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000018_source')" id="l_M000018_source">show</a>
                        
                    </p>
                    <div id="M000018_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 45</span>
 45:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">define_compile_tasks</span>(<span class="ruby-identifier">for_platform</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">ruby_ver</span> = <span class="ruby-constant">RUBY_VERSION</span>)
 46:       <span class="ruby-comment cmt"># platform usage</span>
 47:       <span class="ruby-identifier">platf</span> = <span class="ruby-identifier">for_platform</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">platform</span>
 48: 
 49:       <span class="ruby-comment cmt"># lib_path</span>
 50:       <span class="ruby-identifier">lib_path</span> = <span class="ruby-identifier">lib_dir</span>
 51: 
 52:       <span class="ruby-comment cmt"># tmp_path</span>
 53:       <span class="ruby-identifier">tmp_path</span> = <span class="ruby-node">&quot;#{@tmp_dir}/#{platf}/#{@name}&quot;</span>
 54: 
 55:       <span class="ruby-comment cmt"># cleanup and clobbering</span>
 56:       <span class="ruby-constant">CLEAN</span>.<span class="ruby-identifier">include</span>(<span class="ruby-identifier">tmp_path</span>)
 57:       <span class="ruby-constant">CLOBBER</span>.<span class="ruby-identifier">include</span>(<span class="ruby-node">&quot;#{lib_path}/#{binary(platf)}&quot;</span>)
 58:       <span class="ruby-constant">CLOBBER</span>.<span class="ruby-identifier">include</span>(<span class="ruby-node">&quot;#{@tmp_dir}&quot;</span>)
 59: 
 60:       <span class="ruby-comment cmt"># directories we need</span>
 61:       <span class="ruby-identifier">directory</span> <span class="ruby-identifier">tmp_path</span>
 62:       <span class="ruby-identifier">directory</span> <span class="ruby-identifier">lib_dir</span>
 63: 
 64:       <span class="ruby-comment cmt"># copy binary from temporary location to final lib</span>
 65:       <span class="ruby-comment cmt"># tmp/extension_name/extension_name.{so,bundle} =&gt; lib/</span>
 66:       <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;copy:#{@name}:#{platf}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">lib_path</span>, <span class="ruby-node">&quot;#{tmp_path}/#{binary(platf)}&quot;</span>] <span class="ruby-keyword kw">do</span>
 67:         <span class="ruby-identifier">install</span> <span class="ruby-node">&quot;#{tmp_path}/#{binary(platf)}&quot;</span>, <span class="ruby-node">&quot;#{lib_path}/#{binary(platf)}&quot;</span>
 68:       <span class="ruby-keyword kw">end</span>
 69: 
 70:       <span class="ruby-identifier">file</span> <span class="ruby-node">&quot;#{tmp_path}/#{binary(platf)}&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{tmp_path}/.build&quot;</span> <span class="ruby-keyword kw">do</span>
 71: 
 72:         <span class="ruby-identifier">class_files</span> = <span class="ruby-constant">FileList</span>[<span class="ruby-node">&quot;#{tmp_path}/**/*.class&quot;</span>].
 73:           <span class="ruby-identifier">gsub</span>(<span class="ruby-node">&quot;#{tmp_path}/&quot;</span>, <span class="ruby-value str">''</span>)
 74: 
 75:         <span class="ruby-comment cmt"># avoid environment variable expansion using backslash</span>
 76:         <span class="ruby-identifier">class_files</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-value str">'$'</span>, <span class="ruby-value str">'\$'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">windows?</span>
 77: 
 78:         <span class="ruby-identifier">args</span> = <span class="ruby-identifier">class_files</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
 79:           [<span class="ruby-node">&quot;-C #{tmp_path}&quot;</span>, <span class="ruby-identifier">path</span>]
 80:         }.<span class="ruby-identifier">flatten</span>
 81: 
 82:         <span class="ruby-identifier">sh</span> <span class="ruby-node">&quot;jar cf #{tmp_path}/#{binary(platf)} #{args.join(' ')}&quot;</span>
 83:       <span class="ruby-keyword kw">end</span>
 84: 
 85:       <span class="ruby-identifier">file</span> <span class="ruby-node">&quot;#{tmp_path}/.build&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">tmp_path</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">source_files</span> <span class="ruby-keyword kw">do</span>
 86:         <span class="ruby-identifier">not_jruby_compile_msg</span> = <span class="ruby-value str">&quot;WARNING: You're cross-compiling a binary extension for JRuby, but are using\nanother interpreter. If your Java classpath or extension dir settings are not\ncorrectly detected, then either check the appropriate environment variables or\nexecute the Rake compilation task using the JRuby interpreter.\n(e.g. `jruby -S rake compile:java`)\n&quot;</span>
 87:         <span class="ruby-identifier">warn_once</span>(<span class="ruby-identifier">not_jruby_compile_msg</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">JRUBY_VERSION</span>)
 88: 
 89:         <span class="ruby-identifier">classpath_arg</span> = <span class="ruby-identifier">java_classpath_arg</span>(<span class="ruby-ivar">@classpath</span>)
 90:         <span class="ruby-identifier">debug_arg</span>     = <span class="ruby-ivar">@debug</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'-g'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>
 91: 
 92:         <span class="ruby-identifier">sh</span> <span class="ruby-node">&quot;javac #{java_extdirs_arg} -target #{@target_version} -source #{@source_version} -Xlint:unchecked #{debug_arg} #{classpath_arg} -d #{tmp_path} #{source_files.join(' ')}&quot;</span>
 93: 
 94:         <span class="ruby-comment cmt"># Checkpoint file</span>
 95:         <span class="ruby-identifier">touch</span> <span class="ruby-node">&quot;#{tmp_path}/.build&quot;</span>
 96:       <span class="ruby-keyword kw">end</span>
 97: 
 98:       <span class="ruby-comment cmt"># compile tasks</span>
 99:       <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">Task</span>.<span class="ruby-identifier">task_defined?</span>(<span class="ruby-value str">'compile'</span>) <span class="ruby-keyword kw">then</span>
100:         <span class="ruby-identifier">desc</span> <span class="ruby-value str">&quot;Compile all the extensions&quot;</span>
101:         <span class="ruby-identifier">task</span> <span class="ruby-value str">&quot;compile&quot;</span>
102:       <span class="ruby-keyword kw">end</span>
103: 
104:       <span class="ruby-comment cmt"># compile:name</span>
105:       <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">Task</span>.<span class="ruby-identifier">task_defined?</span>(<span class="ruby-node">&quot;compile:#{@name}&quot;</span>) <span class="ruby-keyword kw">then</span>
106:         <span class="ruby-identifier">desc</span> <span class="ruby-node">&quot;Compile #{@name}&quot;</span>
107:         <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;compile:#{@name}&quot;</span>
108:       <span class="ruby-keyword kw">end</span>
109: 
110:       <span class="ruby-comment cmt"># Allow segmented compilation by platform (open door for 'cross compile')</span>
111:       <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;compile:#{@name}:#{platf}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;copy:#{@name}:#{platf}&quot;</span>]
112:       <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;compile:#{platf}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;compile:#{@name}:#{platf}&quot;</span>]
113: 
114:       <span class="ruby-comment cmt"># Only add this extension to the compile chain if current</span>
115:       <span class="ruby-comment cmt"># platform matches the indicated one.</span>
116:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">platf</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-keyword kw">then</span>
117:         <span class="ruby-comment cmt"># ensure file is always copied</span>
118:         <span class="ruby-identifier">file</span> <span class="ruby-node">&quot;#{lib_path}/#{binary(platf)}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;copy:#{name}:#{platf}&quot;</span>]
119: 
120:         <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;compile:#{@name}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;compile:#{@name}:#{platf}&quot;</span>]
121:         <span class="ruby-identifier">task</span> <span class="ruby-value str">&quot;compile&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;compile:#{platf}&quot;</span>]
122:       <span class="ruby-keyword kw">end</span>
123:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000022">
                    
                    <a name="M000022"></a><b>define_java_platform_tasks</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000022_source')" id="l_M000022_source">show</a>
                        
                    </p>
                    <div id="M000022_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 132</span>
132:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">define_java_platform_tasks</span>
133:       <span class="ruby-comment cmt"># lib_path</span>
134:       <span class="ruby-identifier">lib_path</span> = <span class="ruby-identifier">lib_dir</span>
135: 
136:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@gem_spec</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">Task</span>.<span class="ruby-identifier">task_defined?</span>(<span class="ruby-node">&quot;java:#{@gem_spec.name}&quot;</span>)
137:         <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;java:#{@gem_spec.name}&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
138:           <span class="ruby-comment cmt"># FIXME: workaround Gem::Specification limitation around cache_file:</span>
139:           <span class="ruby-comment cmt"># http://github.com/rubygems/rubygems/issues/78</span>
140:           <span class="ruby-identifier">spec</span> = <span class="ruby-identifier">gem_spec</span>.<span class="ruby-identifier">dup</span>
141:           <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">:&quot;@cache_file&quot;</span>, <span class="ruby-keyword kw">nil</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:cache_file</span>)
142: 
143:           <span class="ruby-comment cmt"># adjust to specified platform</span>
144:           <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">platform</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'java'</span>)
145: 
146:           <span class="ruby-comment cmt"># clear the extensions defined in the specs</span>
147:           <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">clear</span>
148: 
149:           <span class="ruby-comment cmt"># add the binaries that this task depends on</span>
150:           <span class="ruby-identifier">ext_files</span> = []
151: 
152:           <span class="ruby-comment cmt"># go through native prerequisites and grab the real extension files from there</span>
153:           <span class="ruby-identifier">t</span>.<span class="ruby-identifier">prerequisites</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span>
154:             <span class="ruby-identifier">ext_files</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ext</span>
155:           <span class="ruby-keyword kw">end</span>
156: 
157:           <span class="ruby-comment cmt"># include the files in the gem specification</span>
158:           <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">files</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">ext_files</span>
159: 
160:           <span class="ruby-comment cmt"># expose gem specification for customization</span>
161:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@java_compiling</span>
162:             <span class="ruby-ivar">@java_compiling</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">spec</span>)
163:           <span class="ruby-keyword kw">end</span>
164: 
165:           <span class="ruby-comment cmt"># Generate a package for this gem</span>
166:           <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">PackageTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">spec</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pkg</span><span class="ruby-operator">|</span>
167:             <span class="ruby-identifier">pkg</span>.<span class="ruby-identifier">need_zip</span> = <span class="ruby-keyword kw">false</span>
168:             <span class="ruby-identifier">pkg</span>.<span class="ruby-identifier">need_tar</span> = <span class="ruby-keyword kw">false</span>
169:           <span class="ruby-keyword kw">end</span>
170:         <span class="ruby-keyword kw">end</span>
171: 
172:         <span class="ruby-comment cmt"># add binaries to the dependency chain</span>
173:         <span class="ruby-identifier">task</span> <span class="ruby-node">&quot;java:#{@gem_spec.name}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;#{lib_path}/#{binary(platform)}&quot;</span>]
174: 
175:         <span class="ruby-comment cmt"># ensure the extension get copied</span>
176:         <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">Task</span>.<span class="ruby-identifier">task_defined?</span>(<span class="ruby-node">&quot;#{lib_path}/#{binary(platform)}&quot;</span>) <span class="ruby-keyword kw">then</span>
177:           <span class="ruby-identifier">file</span> <span class="ruby-node">&quot;#{lib_path}/#{binary(platform)}&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;copy:#{name}:#{platform}&quot;</span>]
178:         <span class="ruby-keyword kw">end</span>
179: 
180:         <span class="ruby-identifier">task</span> <span class="ruby-value str">'java'</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;java:#{@gem_spec.name}&quot;</span>]
181:       <span class="ruby-keyword kw">end</span>
182: 
183:       <span class="ruby-identifier">task</span> <span class="ruby-value str">'java'</span> <span class="ruby-keyword kw">do</span>
184:         <span class="ruby-identifier">task</span> <span class="ruby-value str">'compile'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'compile:java'</span>
185:       <span class="ruby-keyword kw">end</span>
186:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000025">
                    
                    <a name="M000025"></a><b>java_classpath_arg</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Discover the Java/JRuby classpath and build a classpath argument
</p>
<p>
@params
</p>
<pre>
  *args:: Additional classpath arguments to append
</pre>
<p>
Copied verbatim from the ActiveRecord-JDBC project. There are a small
myriad of ways to discover the Java classpath correctly.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show</a>
                        
                    </p>
                    <div id="M000025_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 206</span>
206:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">java_classpath_arg</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
207:       <span class="ruby-identifier">jruby_cpath</span> = <span class="ruby-keyword kw">nil</span>
208:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/java/</span>
209:         <span class="ruby-keyword kw">begin</span>
210:           <span class="ruby-identifier">cpath</span>  = <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-identifier">java</span>.<span class="ruby-identifier">lang</span>.<span class="ruby-constant">System</span>.<span class="ruby-identifier">getProperty</span>(<span class="ruby-value str">'java.class.path'</span>).<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
211:           <span class="ruby-identifier">cpath</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-identifier">java</span>.<span class="ruby-identifier">lang</span>.<span class="ruby-constant">System</span>.<span class="ruby-identifier">getProperty</span>(<span class="ruby-value str">'sun.boot.class.path'</span>).<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
212:           <span class="ruby-identifier">jruby_cpath</span> = <span class="ruby-identifier">cpath</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
213:         <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
214:         <span class="ruby-keyword kw">end</span>
215:       <span class="ruby-keyword kw">end</span>
216:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">jruby_cpath</span>
217:         <span class="ruby-identifier">jruby_cpath</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'JRUBY_PARENT_CLASSPATH'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'JRUBY_HOME'</span>] <span class="ruby-operator">&amp;&amp;</span>
218:           <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-node">&quot;#{File.expand_path(ENV['JRUBY_HOME'])}/lib/*.jar&quot;</span>).
219:             <span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
220:       <span class="ruby-keyword kw">end</span>
221:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;JRUBY_HOME or JRUBY_PARENT_CLASSPATH are not set&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">jruby_cpath</span>
222:       <span class="ruby-identifier">jruby_cpath</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
223:       <span class="ruby-identifier">jruby_cpath</span> <span class="ruby-value">? </span><span class="ruby-node">&quot;-cp \&quot;#{jruby_cpath}\&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;&quot;</span>
224:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000023">
                    
                    <a name="M000023"></a><b>java_extdirs_arg</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Discover Java Extension Directories and build an extdirs argument
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show</a>
                        
                    </p>
                    <div id="M000023_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rake/javaextensiontask.rb, line 191</span>
191:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">java_extdirs_arg</span>
192:       <span class="ruby-identifier">extdirs</span> = <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-identifier">java</span>.<span class="ruby-identifier">lang</span>.<span class="ruby-constant">System</span>.<span class="ruby-identifier">getProperty</span>(<span class="ruby-value str">'java.ext.dirs'</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
193:       <span class="ruby-identifier">extdirs</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'JAVA_EXT_DIR'</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">extdirs</span>
194:       <span class="ruby-identifier">java_extdir</span> = <span class="ruby-identifier">extdirs</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;-extdirs \&quot;#{extdirs}\&quot;&quot;</span>
195:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    