<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::Parser</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::Parser 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rdoc/parser_rb.html">lib/rdoc/parser.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
A parser is simple a class that subclasses <a
href="Parser.html">RDoc::Parser</a> and implements scan to fill in an <a
href="TopLevel.html">RDoc::TopLevel</a> with parsed data.
</p>
<p>
The initialize method takes an <a href="TopLevel.html">RDoc::TopLevel</a>
to fill with parsed content, the name of the file to be parsed, the content
of the file, an <a href="Options.html">RDoc::Options</a> object and an <a
href="Stats.html">RDoc::Stats</a> object to inform the user of parsed
items. The scan method is then called to parse the file and must return the
<a href="TopLevel.html">RDoc::TopLevel</a> object. By calling super these
items will be set for you.
</p>
<p>
In order to be used by <a href="RDoc.html">RDoc</a> the parser needs to
register the file extensions it can parse. Use ::<a
href="Parser.html#M000648">parse_files_matching</a> to register extensions.
</p>
<pre>
  require 'rdoc'

  class RDoc::Parser::Xyz &lt; RDoc::Parser
    parse_files_matching /\.xyz$/

    def initialize top_level, file_name, content, options, stats
      super

      # extra initialization if needed
    end

    def scan
      # parse file and fill in @top_level
    end
  end
</pre>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000641">alias_extension</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M000642">binary?</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000646">can_parse</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000647">for</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000650">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000648">parse_files_matching</a>,</li>
                
                <li><a href="#M000643">process_directive</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M000649">use_markup</a></li>
                
            </ul>
        </dd>
    
        <dt>Z</dt>
        <dd>
            <ul>
                
                <li><a href="#M000645">zip?</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="Parser/RubyTools.html">RDoc::Parser::RubyTools</a></li>
        
        <li><span class="type">MODULE</span> <a href="Parser/Text.html">RDoc::Parser::Text</a></li>
        
        <li><span class="type">CLASS</span> <a href="Parser/C.html">RDoc::Parser::C</a></li>
        
        <li><span class="type">CLASS</span> <a href="Parser/RD.html">RDoc::Parser::RD</a></li>
        
        <li><span class="type">CLASS</span> <a href="Parser/Ruby.html">RDoc::Parser::Ruby</a></li>
        
        <li><span class="type">CLASS</span> <a href="Parser/Simple.html">RDoc::Parser::Simple</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>parsers</td>
            <td class='attr-desc'><p>
An Array of arrays that maps file extension (or name) regular expressions
to parser classes that will parse matching filenames.
</p>
<p>
Use <a href="Parser.html#M000648">parse_files_matching</a> to register a
parser&#8217;s file extensions.
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000641">
                    
                    <a name="M000641"></a><b>alias_extension</b>(old_ext, new_ext)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="Alias.html">Alias</a> an extension to another extension. After
this call, files ending &#8220;new_ext&#8220; will be parsed using the same
parser as &#8220;old_ext&#8220;
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000641_source')" id="l_M000641_source">show</a>
                        
                    </p>
                    <div id="M000641_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">alias_extension</span>(<span class="ruby-identifier">old_ext</span>, <span class="ruby-identifier">new_ext</span>)
51:     <span class="ruby-identifier">old_ext</span> = <span class="ruby-identifier">old_ext</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\.(.*)/</span>, <span class="ruby-value str">'\1'</span>)
52:     <span class="ruby-identifier">new_ext</span> = <span class="ruby-identifier">new_ext</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\.(.*)/</span>, <span class="ruby-value str">'\1'</span>)
53: 
54:     <span class="ruby-identifier">parser</span> = <span class="ruby-identifier">can_parse</span> <span class="ruby-node">&quot;xxx.#{old_ext}&quot;</span>
55:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parser</span>
56: 
57:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parsers</span>.<span class="ruby-identifier">unshift</span> [<span class="ruby-node">/\.#{new_ext}$/</span>, <span class="ruby-identifier">parser</span>]
58: 
59:     <span class="ruby-keyword kw">true</span>
60:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000642">
                    
                    <a name="M000642"></a><b>binary?</b>(file)
                    
                </div>
                
                <div class="description">
                  <p>
Determines if the file is a &#8220;binary&#8221; file which basically means
it has content that an <a href="RDoc.html">RDoc</a> parser shouldn&#8217;t
try to consume.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000642_source')" id="l_M000642_source">show</a>
                        
                    </p>
                    <div id="M000642_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 66</span>
66:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">binary?</span>(<span class="ruby-identifier">file</span>)
67:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.(rdoc|txt)$/</span>
68: 
69:     <span class="ruby-identifier">s</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value">1024</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
70: 
71:     <span class="ruby-identifier">have_encoding</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:encoding</span>
72: 
73:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">have_encoding</span> <span class="ruby-keyword kw">then</span>
74:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">encoding</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">valid_encoding?</span>
75:     <span class="ruby-keyword kw">end</span>
76: 
77:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s</span>[<span class="ruby-value">0</span>, <span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-value str">''</span>)[<span class="ruby-value">0</span>, <span class="ruby-value">2</span>] <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">&quot;\x00&quot;</span>)
78: 
79:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">have_encoding</span> <span class="ruby-keyword kw">then</span>
80:       <span class="ruby-identifier">s</span>.<span class="ruby-identifier">force_encoding</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">default_external</span>
81: 
82:       <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">valid_encoding?</span>
83:     <span class="ruby-keyword kw">else</span>
84:       <span class="ruby-keyword kw">if</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:fdiv</span> <span class="ruby-keyword kw">then</span>
85:         <span class="ruby-identifier">s</span>.<span class="ruby-identifier">count</span>(<span class="ruby-value str">&quot;\x00-\x7F&quot;</span>, <span class="ruby-value str">&quot;^ -~\t\r\n&quot;</span>).<span class="ruby-identifier">fdiv</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">size</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span><span class="ruby-value">.3</span>
86:       <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># HACK 1.8.6</span>
87:         (<span class="ruby-identifier">s</span>.<span class="ruby-identifier">count</span>(<span class="ruby-value str">&quot;\x00-\x7F&quot;</span>, <span class="ruby-value str">&quot;^ -~\t\r\n&quot;</span>).<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">size</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span><span class="ruby-value">.3</span>
88:       <span class="ruby-keyword kw">end</span>
89:     <span class="ruby-keyword kw">end</span>
90:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000646">
                    
                    <a name="M000646"></a><b>can_parse</b>(file_name)
                    
                </div>
                
                <div class="description">
                  <p>
Return a parser that can handle a particular extension
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000646_source')" id="l_M000646_source">show</a>
                        
                    </p>
                    <div id="M000646_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">can_parse</span>(<span class="ruby-identifier">file_name</span>)
133:     <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parsers</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">regexp</span>,<span class="ruby-operator">|</span> <span class="ruby-identifier">regexp</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">file_name</span> }.<span class="ruby-identifier">last</span>
134: 
135:     <span class="ruby-comment cmt"># HACK Selenium hides a jar file using a .txt extension</span>
136:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parser</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">Simple</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">zip?</span> <span class="ruby-identifier">file_name</span>
137: 
138:     <span class="ruby-comment cmt"># The default parser must not parse binary files</span>
139:     <span class="ruby-identifier">ext_name</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span> <span class="ruby-identifier">file_name</span>
140:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">parser</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ext_name</span>.<span class="ruby-identifier">empty?</span>
141:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parser</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">Simple</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">ext_name</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/txt|rdoc/</span>
142: 
143:     <span class="ruby-identifier">parser</span>
144:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000647">
                    
                    <a name="M000647"></a><b>for</b>(top_level, file_name, content, options, stats)
                    
                </div>
                
                <div class="description">
                  <p>
Finds and instantiates the correct parser for the given <tt>file_name</tt>
and <tt>content</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000647_source')" id="l_M000647_source">show</a>
                        
                    </p>
                    <div id="M000647_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-keyword kw">for</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">content</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">stats</span>
151:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">binary?</span> <span class="ruby-identifier">file_name</span>
152: 
153:     <span class="ruby-identifier">parser</span> = <span class="ruby-identifier">use_markup</span> <span class="ruby-identifier">content</span>
154: 
155:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parser</span> <span class="ruby-keyword kw">then</span>
156:       <span class="ruby-comment cmt"># If no extension, look for shebang</span>
157:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_name</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\.\w+$/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">content</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">%r{\A#!(.+)}</span> <span class="ruby-keyword kw">then</span>
158:         <span class="ruby-identifier">shebang</span> = <span class="ruby-identifier">$1</span>
159:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">shebang</span>
160:         <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">%r{env\s+ruby}</span>, <span class="ruby-regexp re">%r{/ruby}</span>
161:           <span class="ruby-identifier">file_name</span> = <span class="ruby-value str">&quot;dummy.rb&quot;</span>
162:         <span class="ruby-keyword kw">end</span>
163:       <span class="ruby-keyword kw">end</span>
164: 
165:       <span class="ruby-identifier">parser</span> = <span class="ruby-identifier">can_parse</span> <span class="ruby-identifier">file_name</span>
166:     <span class="ruby-keyword kw">end</span>
167: 
168:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parser</span>
169: 
170:     <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">content</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">stats</span>
171:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000650">
                    
                    <a name="M000650"></a><b>new</b>(top_level, file_name, content, options, stats)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a new <a href="Parser.html">Parser</a> storing <tt>top_level</tt>,
<tt>file_name</tt>, <tt>content</tt>, <tt>options</tt> and <tt>stats</tt>
in instance variables. In +@preprocess+ an <a
href="Markup/PreProcess.html">RDoc::Markup::PreProcess</a> object is
created which allows processing of directives.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000650_source')" id="l_M000650_source">show</a>
                        
                    </p>
                    <div id="M000650_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 219</span>
219:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">content</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">stats</span>
220:     <span class="ruby-ivar">@top_level</span> = <span class="ruby-identifier">top_level</span>
221:     <span class="ruby-ivar">@top_level</span>.<span class="ruby-identifier">parser</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>
222: 
223:     <span class="ruby-ivar">@file_name</span> = <span class="ruby-identifier">file_name</span>
224:     <span class="ruby-ivar">@content</span> = <span class="ruby-identifier">content</span>
225:     <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
226:     <span class="ruby-ivar">@stats</span> = <span class="ruby-identifier">stats</span>
227: 
228:     <span class="ruby-ivar">@preprocess</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@file_name</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">rdoc_include</span>
229:     <span class="ruby-ivar">@preprocess</span>.<span class="ruby-identifier">options</span> = <span class="ruby-ivar">@options</span>
230:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000648">
                    
                    <a name="M000648"></a><b>parse_files_matching</b>(regexp)
                    
                </div>
                
                <div class="description">
                  <p>
Record which file types this parser can understand.
</p>
<p>
It is ok to call this multiple times.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000648_source')" id="l_M000648_source">show</a>
                        
                    </p>
                    <div id="M000648_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse_files_matching</span>(<span class="ruby-identifier">regexp</span>)
179:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parsers</span>.<span class="ruby-identifier">unshift</span> [<span class="ruby-identifier">regexp</span>, <span class="ruby-keyword kw">self</span>]
180:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000643">
                    
                    <a name="M000643"></a><b>process_directive</b>(code_object, directive, value)
                    
                </div>
                
                <div class="description">
                  <p>
Processes common directives for CodeObjects for the <a
href="Parser/C.html">C</a> and <a href="Parser/Ruby.html">Ruby</a> parsers.
</p>
<p>
Applies <tt>directive</tt>&#8217;s <tt>value</tt> to <tt>code_object</tt>,
if appropriate
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000643_source')" id="l_M000643_source">show</a>
                        
                    </p>
                    <div id="M000643_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 97</span>
 97:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">process_directive</span> <span class="ruby-identifier">code_object</span>, <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">value</span>
 98:     <span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;RDoc::Parser::process_directive is deprecated and wil be removed in RDoc 4.  Use RDoc::Markup::PreProcess#handle_directive instead&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$-w</span>
 99: 
100:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">directive</span>
101:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'nodoc'</span> <span class="ruby-keyword kw">then</span>
102:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># notify nodoc</span>
103:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_children</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">'all'</span>
104:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'doc'</span> <span class="ruby-keyword kw">then</span>
105:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword kw">true</span>
106:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword kw">true</span>
107:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'yield'</span>, <span class="ruby-value str">'yields'</span> <span class="ruby-keyword kw">then</span>
108:       <span class="ruby-comment cmt"># remove parameter &amp;block</span>
109:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/,?\s*&amp;\w+/</span>, <span class="ruby-value str">''</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>
110: 
111:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">block_params</span> = <span class="ruby-identifier">value</span>
112:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'arg'</span>, <span class="ruby-value str">'args'</span> <span class="ruby-keyword kw">then</span>
113:       <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">value</span>
114:     <span class="ruby-keyword kw">end</span>
115:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000649">
                    
                    <a name="M000649"></a><b>use_markup</b>(content)
                    
                </div>
                
                <div class="description">
                  <p>
If there is a <tt>markup: parser_name</tt> comment at the front of the
file, use it to determine the parser. For example:
</p>
<pre>
  # markup: rdoc
  # Class comment can go here

  class C
  end
</pre>
<p>
The comment should appear as the first line of the <tt>content</tt>.
</p>
<p>
If the content contains a shebang or editor modeline the comment may appear
on the second or third line.
</p>
<p>
Any comment style may be used to hide the markup comment.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000649_source')" id="l_M000649_source">show</a>
                        
                    </p>
                    <div id="M000649_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 199</span>
199:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">use_markup</span> <span class="ruby-identifier">content</span>
200:     <span class="ruby-identifier">markup</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">lines</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">grep</span>(<span class="ruby-regexp re">/markup:\s+(\w+)/</span>) { <span class="ruby-identifier">$1</span> }.<span class="ruby-identifier">first</span>
201: 
202:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">markup</span>
203: 
204:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">Ruby</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">markup</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'tomdoc'</span>
205: 
206:     <span class="ruby-identifier">markup</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span> <span class="ruby-identifier">markup</span>
207: 
208:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parsers</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">parser</span><span class="ruby-operator">|</span>
209:       <span class="ruby-node">/^#{markup}$/i</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/.*:/</span>, <span class="ruby-value str">''</span>)
210:     <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">last</span>
211:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000645">
                    
                    <a name="M000645"></a><b>zip?</b>(file)
                    
                </div>
                
                <div class="description">
                  <p>
Checks if <tt>file</tt> is a zip file in disguise. Signatures from <a
href="http://www.garykessler.net/library/file_sigs.html">www.garykessler.net/library/file_sigs.html</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000645_source')" id="l_M000645_source">show</a>
                        
                    </p>
                    <div id="M000645_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/parser.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">zip?</span> <span class="ruby-identifier">file</span>
122:     <span class="ruby-identifier">zip_signature</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">file</span>, <span class="ruby-value">4</span>
123: 
124:     <span class="ruby-identifier">zip_signature</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PK\x03\x04&quot;</span> <span class="ruby-keyword kw">or</span>
125:       <span class="ruby-identifier">zip_signature</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PK\x05\x06&quot;</span> <span class="ruby-keyword kw">or</span>
126:       <span class="ruby-identifier">zip_signature</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PK\x07\x08&quot;</span>
127:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    