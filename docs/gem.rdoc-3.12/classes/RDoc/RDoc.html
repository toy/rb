<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::RDoc</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::RDoc 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rdoc/rdoc_rb.html">lib/rdoc/rdoc.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
This is the driver for generating <a href="RDoc.html">RDoc</a> output. It
file parsing and generation of output.
</p>
<p>
To use this class to generate <a href="RDoc.html">RDoc</a> output via the
API, the recommended way is:
</p>
<pre>
  rdoc = RDoc::RDoc.new
  options = rdoc.load_options # returns an RDoc::Options instance
  # set extra options
  rdoc.document options
</pre>
<p>
You can also generate output like the <tt>rdoc</tt> executable:
</p>
<pre>
  rdoc = RDoc::RDoc.new
  rdoc.document argv
</pre>
<p>
Where <tt>argv</tt> is an array of strings, each corresponding to an
argument you&#8217;d give rdoc on the command line. See <tt>rdoc
&#8212;help<tt> for details.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000672">add_generator</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000673">current</a>,</li>
                
                <li><a href="#M000675">current=</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000705">document</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M000678">error</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000681">gather_files</a>,</li>
                
                <li><a href="#M000706">generate</a></li>
                
            </ul>
        </dd>
    
        <dt>H</dt>
        <dd>
            <ul>
                
                <li><a href="#M000682">handle_pipe</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000685">install_siginfo_handler</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M000697">list_files_in_directory</a>,</li>
                
                <li><a href="#M000686">load_options</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000677">new</a>,</li>
                
                <li><a href="#M000696">normalized_file_list</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M000692">output_flag_file</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M000693">parse_dot_doc_file</a>,</li>
                
                <li><a href="#M000698">parse_file</a>,</li>
                
                <li><a href="#M000701">parse_files</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000707">remove_siginfo_handler</a>,</li>
                
                <li><a href="#M000704">remove_unparseable</a>,</li>
                
                <li><a href="#M000676">reset</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M000687">setup_output_dir</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M000689">update_output_dir</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">GENERATORS</td>
            <td>=</td>
            <td class="attr-value">{}</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
This is the list of supported output generators
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>exclude</td>
            <td class='attr-desc'><p>
File pattern to exclude
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>generator</td>
            <td class='attr-desc'><p>
<a href="Generator.html">Generator</a> instance used for creating output
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>last_modified</td>
            <td class='attr-desc'><p>
Hash of files and their last modified times.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>
<a href="RDoc.html">RDoc</a> options
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>stats</td>
            <td class='attr-desc'><p>
Accessor for statistics. Available after each call to <a
href="RDoc.html#M000701">parse_files</a>
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000672">
                    
                    <a name="M000672"></a><b>add_generator</b>(klass)
                    
                </div>
                
                <div class="description">
                  <p>
Add <tt>klass</tt> that can generate output after parsing
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000672_source')" id="l_M000672_source">show</a>
                        
                    </p>
                    <div id="M000672_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_generator</span>(<span class="ruby-identifier">klass</span>)
65:     <span class="ruby-identifier">name</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^RDoc::Generator::/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">downcase</span>
66:     <span class="ruby-constant">GENERATORS</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">klass</span>
67:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000673">
                    
                    <a name="M000673"></a><b>current</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Active <a href="RDoc.html">RDoc::RDoc</a> instance
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000673_source')" id="l_M000673_source">show</a>
                        
                    </p>
                    <div id="M000673_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 72</span>
72:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current</span>
73:     <span class="ruby-ivar">@current</span>
74:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000675">
                    
                    <a name="M000675"></a><b>current=</b>(rdoc)
                    
                </div>
                
                <div class="description">
                  <p>
Sets the active <a href="RDoc.html">RDoc::RDoc</a> instance
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000675_source')" id="l_M000675_source">show</a>
                        
                    </p>
                    <div id="M000675_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current=</span> <span class="ruby-identifier">rdoc</span>
80:     <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">rdoc</span>
81:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000677">
                    
                    <a name="M000677"></a><b>new</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Creates a new <a href="RDoc.html">RDoc::RDoc</a> instance. Call <a
href="RDoc.html#M000705">document</a> to parse files and generate
documentation.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000677_source')" id="l_M000677_source">show</a>
                        
                    </p>
                    <div id="M000677_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 96</span>
 96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>
 97:     <span class="ruby-ivar">@current</span>       = <span class="ruby-keyword kw">nil</span>
 98:     <span class="ruby-ivar">@exclude</span>       = <span class="ruby-keyword kw">nil</span>
 99:     <span class="ruby-ivar">@generator</span>     = <span class="ruby-keyword kw">nil</span>
100:     <span class="ruby-ivar">@last_modified</span> = {}
101:     <span class="ruby-ivar">@old_siginfo</span>   = <span class="ruby-keyword kw">nil</span>
102:     <span class="ruby-ivar">@options</span>       = <span class="ruby-keyword kw">nil</span>
103:     <span class="ruby-ivar">@stats</span>         = <span class="ruby-keyword kw">nil</span>
104:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000676">
                    
                    <a name="M000676"></a><b>reset</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Resets all internal state
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000676_source')" id="l_M000676_source">show</a>
                        
                    </p>
                    <div id="M000676_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 86</span>
86:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reset</span>
87:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">reset</span>
88:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">C</span>.<span class="ruby-identifier">reset</span>
89:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword kw">nil</span>
90:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000705">
                    
                    <a name="M000705"></a><b>document</b>(options)
                    
                </div>
                
                <div class="description">
                  <p>
Generates documentation or a coverage report depending upon the settings in
<tt>options</tt>.
</p>
<p>
<tt>options</tt> can be either an <a href="Options.html">RDoc::Options</a>
instance or an array of strings equivalent to the strings that would be
passed on the command line like <tt>%w[-q -o doc -t My\ Doc\ Title]</tt>.
<a href="RDoc.html#M000705">document</a> will automatically call <a
href="Options.html#M000580">RDoc::Options#finish</a> if an options instance
was given.
</p>
<p>
For a list of options, see either <a href="Options.html">RDoc::Options</a>
or <tt>rdoc --help</tt>.
</p>
<p>
By default, output will be stored in a directory called &#8220;doc&#8221;
below the current directory, so make sure you&#8217;re somewhere writable
before invoking.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000705_source')" id="l_M000705_source">show</a>
                        
                    </p>
                    <div id="M000705_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 429</span>
429:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">document</span> <span class="ruby-identifier">options</span>
430:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">reset</span>
431:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword kw">self</span>
432: 
433:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span> <span class="ruby-keyword kw">then</span>
434:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
435:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">finish</span>
436:     <span class="ruby-keyword kw">else</span>
437:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">load_options</span>
438:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">options</span>
439:     <span class="ruby-keyword kw">end</span>
440: 
441:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">pipe</span> <span class="ruby-keyword kw">then</span>
442:       <span class="ruby-identifier">handle_pipe</span>
443:       <span class="ruby-identifier">exit</span>
444:     <span class="ruby-keyword kw">end</span>
445: 
446:     <span class="ruby-ivar">@exclude</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>
447: 
448:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">then</span>
449:       <span class="ruby-ivar">@last_modified</span> = <span class="ruby-identifier">setup_output_dir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_update</span>
450:     <span class="ruby-keyword kw">end</span>
451: 
452:     <span class="ruby-ivar">@start_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
453: 
454:     <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">parse_files</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">files</span>
455: 
456:     <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-value str">&quot;RDoc Documentation&quot;</span>
457: 
458:     <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">complete</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">visibility</span>
459: 
460:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">coverage_level</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>
461: 
462:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">then</span>
463:       <span class="ruby-identifier">puts</span>
464: 
465:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">report</span>
466:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">file_info</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">then</span>
467:       <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;\nNo newer files.&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
468:     <span class="ruby-keyword kw">else</span>
469:       <span class="ruby-identifier">gen_klass</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">generator</span>
470: 
471:       <span class="ruby-ivar">@generator</span> = <span class="ruby-identifier">gen_klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@options</span>
472: 
473:       <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
474:     <span class="ruby-keyword kw">end</span>
475: 
476:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@stats</span> <span class="ruby-keyword kw">and</span> (<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>) <span class="ruby-keyword kw">then</span>
477:       <span class="ruby-identifier">puts</span>
478:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">summary</span>
479:     <span class="ruby-keyword kw">end</span>
480: 
481:     <span class="ruby-identifier">exit</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">fully_documented?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>
482:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000678">
                    
                    <a name="M000678"></a><b>error</b>(msg)
                    
                </div>
                
                <div class="description">
                  <p>
Report an error message and exit
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000678_source')" id="l_M000678_source">show</a>
                        
                    </p>
                    <div id="M000678_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>(<span class="ruby-identifier">msg</span>)
110:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-identifier">msg</span>
111:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000681">
                    
                    <a name="M000681"></a><b>gather_files</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Gathers a set of parseable files from the files and directories listed in
<tt>files</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000681_source')" id="l_M000681_source">show</a>
                        
                    </p>
                    <div id="M000681_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 117</span>
117:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
118:     <span class="ruby-identifier">files</span> = [<span class="ruby-value str">&quot;.&quot;</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">empty?</span>
119: 
120:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-ivar">@exclude</span>
121: 
122:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">uniq</span>
123: 
124:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">file_list</span>
125:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000706">
                    
                    <a name="M000706"></a><b>generate</b>(file_info)
                    
                </div>
                
                <div class="description">
                  <p>
Generates documentation for <tt>file_info</tt> (from <a
href="RDoc.html#M000701">parse_files</a>) into the output dir using the
generator selected by the <a href="RDoc.html">RDoc</a> options
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000706_source')" id="l_M000706_source">show</a>
                        
                    </p>
                    <div id="M000706_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 489</span>
489:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
490:     <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span> <span class="ruby-keyword kw">do</span>
491:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span> <span class="ruby-keyword kw">then</span>
492:         <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nGenerating #{@generator.class.name.sub(/^.*::/, '')} format into #{Dir.pwd}...&quot;</span>
493:       <span class="ruby-keyword kw">end</span>
494: 
495:       <span class="ruby-ivar">@generator</span>.<span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
496:       <span class="ruby-identifier">update_output_dir</span> <span class="ruby-value str">'.'</span>, <span class="ruby-ivar">@start_time</span>, <span class="ruby-ivar">@last_modified</span>
497:     <span class="ruby-keyword kw">end</span>
498:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000682">
                    
                    <a name="M000682"></a><b>handle_pipe</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Turns <a href="RDoc.html">RDoc</a> from stdin into HTML
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000682_source')" id="l_M000682_source">show</a>
                        
                    </p>
                    <div id="M000682_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 130</span>
130:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_pipe</span>
131:     <span class="ruby-ivar">@html</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">ToHtml</span>.<span class="ruby-identifier">new</span>
132: 
133:     <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-constant">MARKUP_FORMAT</span>[<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">markup</span>]
134: 
135:     <span class="ruby-identifier">document</span> = <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">read</span>
136: 
137:     <span class="ruby-identifier">out</span> = <span class="ruby-ivar">@html</span>.<span class="ruby-identifier">convert</span> <span class="ruby-identifier">document</span>
138: 
139:     <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">out</span>
140:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000685">
                    
                    <a name="M000685"></a><b>install_siginfo_handler</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Installs a siginfo handler that prints the current filename.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000685_source')" id="l_M000685_source">show</a>
                        
                    </p>
                    <div id="M000685_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 145</span>
145:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install_siginfo_handler</span>
146:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">'INFO'</span>
147: 
148:     <span class="ruby-ivar">@old_siginfo</span> = <span class="ruby-identifier">trap</span> <span class="ruby-value str">'INFO'</span> <span class="ruby-keyword kw">do</span>
149:       <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@current</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@current</span>
150:     <span class="ruby-keyword kw">end</span>
151:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000697">
                    
                    <a name="M000697"></a><b>list_files_in_directory</b>(dir)
                    
                </div>
                
                <div class="description">
                  <p>
Return a list of the files to be processed in a directory. We know that
this directory doesn&#8217;t have a .document file, so we&#8217;re looking
for real files. However we may well contain subdirectories which must be
tested for .document files.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000697_source')" id="l_M000697_source">show</a>
                        
                    </p>
                    <div id="M000697_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 320</span>
320:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_files_in_directory</span> <span class="ruby-identifier">dir</span>
321:     <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-value str">&quot;*&quot;</span>)
322: 
323:     <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>
324:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000686">
                    
                    <a name="M000686"></a><b>load_options</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Loads options from .rdoc_options if the file exists, otherwise creates a
new <a href="Options.html">RDoc::Options</a> instance.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000686_source')" id="l_M000686_source">show</a>
                        
                    </p>
                    <div id="M000686_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 157</span>
157:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_options</span>
158:     <span class="ruby-identifier">options_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-value str">'.rdoc_options'</span>
159:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">options_file</span>
160: 
161:     <span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">load_yaml</span>
162: 
163:     <span class="ruby-identifier">parse_error</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_defined?</span> <span class="ruby-identifier">:Psych</span> <span class="ruby-keyword kw">then</span>
164:                     <span class="ruby-constant">Psych</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span>
165:                   <span class="ruby-keyword kw">else</span>
166:                     <span class="ruby-constant">ArgumentError</span>
167:                   <span class="ruby-keyword kw">end</span>
168: 
169:     <span class="ruby-keyword kw">begin</span>
170:       <span class="ruby-identifier">options</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load_file</span> <span class="ruby-value str">'.rdoc_options'</span>
171:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-operator">*</span><span class="ruby-identifier">parse_error</span>
172:     <span class="ruby-keyword kw">end</span>
173: 
174:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;#{options_file} is not a valid rdoc options file&quot;</span> <span class="ruby-keyword kw">unless</span>
175:       <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span>
176: 
177:     <span class="ruby-identifier">options</span>
178:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000696">
                    
                    <a name="M000696"></a><b>normalized_file_list</b>(relative_files, force_doc = false, exclude_pattern = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Given a list of files and directories, create a list of all the Ruby files
they contain.
</p>
<p>
If <tt>force_doc</tt> is true we always add the given files, if false, only
add files that we guarantee we can parse. It is true when looking at files
given on the command line, false when recursing through subdirectories.
</p>
<p>
The effect of this is that if you want a file with a non-standard extension
parsed, you must name it explicitly.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000696_source')" id="l_M000696_source">show</a>
                        
                    </p>
                    <div id="M000696_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 279</span>
279:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">relative_files</span>, <span class="ruby-identifier">force_doc</span> = <span class="ruby-keyword kw">false</span>,
280:                            <span class="ruby-identifier">exclude_pattern</span> = <span class="ruby-keyword kw">nil</span>)
281:     <span class="ruby-identifier">file_list</span> = []
282: 
283:     <span class="ruby-identifier">relative_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel_file_name</span><span class="ruby-operator">|</span>
284:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">rel_file_name</span>
285:       <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">next</span>
286: 
287:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">ftype</span>
288:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;file&quot;</span> <span class="ruby-keyword kw">then</span>
289:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">last_modified</span> = <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] <span class="ruby-keyword kw">and</span>
290:                 <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">last_modified</span>.<span class="ruby-identifier">to_i</span>
291: 
292:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">force_doc</span> <span class="ruby-keyword kw">or</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">can_parse</span>(<span class="ruby-identifier">rel_file_name</span>) <span class="ruby-keyword kw">then</span>
293:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rel_file_name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^\.\//</span>, <span class="ruby-value str">''</span>)
294:           <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>
295:         <span class="ruby-keyword kw">end</span>
296:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;directory&quot;</span> <span class="ruby-keyword kw">then</span>
297:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;CVS&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.svn&quot;</span>
298: 
299:         <span class="ruby-identifier">dot_doc</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">rel_file_name</span>, <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">DOT_DOC_FILENAME</span>
300: 
301:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span> <span class="ruby-identifier">dot_doc</span> <span class="ruby-keyword kw">then</span>
302:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parse_dot_doc_file</span>(<span class="ruby-identifier">rel_file_name</span>, <span class="ruby-identifier">dot_doc</span>)
303:         <span class="ruby-keyword kw">else</span>
304:           <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">list_files_in_directory</span>(<span class="ruby-identifier">rel_file_name</span>)
305:         <span class="ruby-keyword kw">end</span>
306:       <span class="ruby-keyword kw">else</span>
307:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;I can't deal with a #{type} #{rel_file_name}&quot;</span>
308:       <span class="ruby-keyword kw">end</span>
309:     <span class="ruby-keyword kw">end</span>
310: 
311:     <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">flatten</span>
312:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000692">
                    
                    <a name="M000692"></a><b>output_flag_file</b>(op_dir)
                    
                </div>
                
                <div class="description">
                  <p>
Return the path name of the flag file in an output directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000692_source')" id="l_M000692_source">show</a>
                        
                    </p>
                    <div id="M000692_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 244</span>
244:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>)
245:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">op_dir</span>, <span class="ruby-value str">&quot;created.rid&quot;</span>
246:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000693">
                    
                    <a name="M000693"></a><b>parse_dot_doc_file</b>(in_dir, filename)
                    
                </div>
                
                <div class="description">
                  <p>
The .document file contains a list of file and directory name patterns,
representing candidates for documentation. It may also contain comments
(starting with &#8217;#&#8217;)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000693_source')" id="l_M000693_source">show</a>
                        
                    </p>
                    <div id="M000693_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 253</span>
253:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_dot_doc_file</span> <span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">filename</span>
254:     <span class="ruby-comment cmt"># read and strip comments</span>
255:     <span class="ruby-identifier">patterns</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/#.*/</span>, <span class="ruby-value str">''</span>)
256: 
257:     <span class="ruby-identifier">result</span> = []
258: 
259:     <span class="ruby-identifier">patterns</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">patt</span><span class="ruby-operator">|</span>
260:       <span class="ruby-identifier">candidates</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">patt</span>))
261:       <span class="ruby-identifier">result</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">candidates</span>)
262:     <span class="ruby-keyword kw">end</span>
263: 
264:     <span class="ruby-identifier">result</span>
265:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000698">
                    
                    <a name="M000698"></a><b>parse_file</b>(filename)
                    
                </div>
                
                <div class="description">
                  <p>
Parses <tt>filename</tt> and returns an <a
href="TopLevel.html">RDoc::TopLevel</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000698_source')" id="l_M000698_source">show</a>
                        
                    </p>
                    <div id="M000698_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 329</span>
329:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
330:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-keyword kw">then</span>
331:       <span class="ruby-identifier">encoding</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">encoding</span>
332:       <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">encode</span> <span class="ruby-identifier">encoding</span>
333:     <span class="ruby-keyword kw">end</span>
334: 
335:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">add_file</span> <span class="ruby-identifier">filename</span>
336: 
337:     <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">encoding</span>
338: 
339:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">content</span>
340: 
341:     <span class="ruby-identifier">top_level</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">filename</span>
342: 
343:     <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">for</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">content</span>, <span class="ruby-ivar">@options</span>, <span class="ruby-ivar">@stats</span>
344: 
345:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parser</span>
346: 
347:     <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">scan</span>
348: 
349:     <span class="ruby-comment cmt"># restart documentation for the classes &amp; modules found</span>
350:     <span class="ruby-identifier">top_level</span>.<span class="ruby-identifier">classes_or_modules</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cm</span><span class="ruby-operator">|</span>
351:       <span class="ruby-identifier">cm</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword kw">false</span>
352:     <span class="ruby-keyword kw">end</span>
353: 
354:     <span class="ruby-identifier">top_level</span>
355: 
356:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
357:     <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Before reporting this, could you check that the file you're documenting\nhas proper syntax:\n\n\#{Gem.ruby} -c \#{filename}\n\nRDoc is not a full Ruby parser and will fail when fed invalid ruby programs.\n\nThe internal error was:\n\n\\t(\#{e.class}) \#{e.message}\n\n&quot;</span>
358: 
359:     <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n\t&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG_RDOC</span>
360: 
361:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
362:     <span class="ruby-keyword kw">nil</span>
363:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000701">
                    
                    <a name="M000701"></a><b>parse_files</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Parse each file on the command line, recursively entering directories.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000701_source')" id="l_M000701_source">show</a>
                        
                    </p>
                    <div id="M000701_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 381</span>
381:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_files</span> <span class="ruby-identifier">files</span>
382:     <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
383:     <span class="ruby-ivar">@stats</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Stats</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">size</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">verbosity</span>
384: 
385:     <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">empty?</span>
386: 
387:     <span class="ruby-identifier">file_info</span> = []
388: 
389:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">begin_adding</span>
390: 
391:     <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
392:       <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">filename</span>
393:       <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
394:     <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">compact</span>
395: 
396:     <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">done_adding</span>
397: 
398:     <span class="ruby-identifier">file_info</span>
399:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000707">
                    
                    <a name="M000707"></a><b>remove_siginfo_handler</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Removes a siginfo handler and replaces the previous
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000707_source')" id="l_M000707_source">show</a>
                        
                    </p>
                    <div id="M000707_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 503</span>
503:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_siginfo_handler</span>
504:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">key?</span> <span class="ruby-value str">'INFO'</span>
505: 
506:     <span class="ruby-identifier">handler</span> = <span class="ruby-ivar">@old_siginfo</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'DEFAULT'</span>
507: 
508:     <span class="ruby-identifier">trap</span> <span class="ruby-value str">'INFO'</span>, <span class="ruby-identifier">handler</span>
509:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000704">
                    
                    <a name="M000704"></a><b>remove_unparseable</b>(files)
                    
                </div>
                
                <div class="description">
                  <p>
Removes file extensions known to be unparseable from <tt>files</tt> and
TAGS files for emacs and vim.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000704_source')" id="l_M000704_source">show</a>
                        
                    </p>
                    <div id="M000704_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 405</span>
405:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">files</span>
406:     <span class="ruby-identifier">files</span>.<span class="ruby-identifier">reject</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
407:       <span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.(?:class|eps|erb|scpt\.txt|ttf|yml)$/i</span> <span class="ruby-keyword kw">or</span>
408:         (<span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/tags$/i</span> <span class="ruby-keyword kw">and</span>
409:          <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value str">'rb'</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
410:            <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">100</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\A(\f\n[^,]+,\d+$|!_TAG_)/</span>
411:          })
412:     <span class="ruby-keyword kw">end</span>
413:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000687">
                    
                    <a name="M000687"></a><b>setup_output_dir</b>(dir, force)
                    
                </div>
                
                <div class="description">
                  <p>
Create an output dir if it doesn&#8217;t exist. If it does exist, but
doesn&#8217;t contain the flag file <tt>created.rid</tt> then we refuse to
use it, as we may clobber some manually generated documentation
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000687_source')" id="l_M000687_source">show</a>
                        
                    </p>
                    <div id="M000687_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 185</span>
185:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup_output_dir</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">force</span>)
186:     <span class="ruby-identifier">flag_file</span> = <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>
187: 
188:     <span class="ruby-identifier">last</span> = {}
189: 
190:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword kw">then</span>
191:       <span class="ruby-comment cmt"># do nothing</span>
192:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dir</span> <span class="ruby-keyword kw">then</span>
193:       <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;#{dir} exists and is not a directory&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">dir</span>
194: 
195:       <span class="ruby-keyword kw">begin</span>
196:         <span class="ruby-identifier">open</span> <span class="ruby-identifier">flag_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
197:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">force</span> <span class="ruby-keyword kw">then</span>
198:             <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">gets</span>
199: 
200:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
201:               <span class="ruby-identifier">file</span>, <span class="ruby-identifier">time</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span> <span class="ruby-value str">&quot;\t&quot;</span>, <span class="ruby-value">2</span>
202:               <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">time</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">next</span>
203:               <span class="ruby-identifier">last</span>[<span class="ruby-identifier">file</span>] = <span class="ruby-identifier">time</span>
204:             <span class="ruby-keyword kw">end</span>
205:           <span class="ruby-keyword kw">end</span>
206:         <span class="ruby-keyword kw">end</span>
207:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">TypeError</span>
208:         <span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;\nDirectory \#{dir} already exists, but it looks like it isn't an RDoc directory.\n\nBecause RDoc doesn't want to risk destroying any of your existing files,\nyou'll need to specify a different output directory name (using the --op &lt;dir&gt;\noption)\n\n&quot;</span>
209:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_output</span>
210:     <span class="ruby-keyword kw">else</span>
211:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span>
212:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">touch</span> <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>
213:     <span class="ruby-keyword kw">end</span>
214: 
215:     <span class="ruby-identifier">last</span>
216:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000689">
                    
                    <a name="M000689"></a><b>update_output_dir</b>(op_dir, time, last = {})
                    
                </div>
                
                <div class="description">
                  <p>
Update the flag file in an output directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000689_source')" id="l_M000689_source">show</a>
                        
                    </p>
                    <div id="M000689_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/rdoc.rb, line 230</span>
230:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_output_dir</span>(<span class="ruby-identifier">op_dir</span>, <span class="ruby-identifier">time</span>, <span class="ruby-identifier">last</span> = {})
231:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">update_output_dir</span>
232: 
233:     <span class="ruby-identifier">open</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>), <span class="ruby-value str">&quot;w&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
234:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">rfc2822</span>
235:       <span class="ruby-identifier">last</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
236:         <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{n}\t#{t.rfc2822}&quot;</span>
237:       <span class="ruby-keyword kw">end</span>
238:     <span class="ruby-keyword kw">end</span>
239:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    