<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::Generator::Darkfish</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            RDoc::Generator::Darkfish 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/rdoc/generator/darkfish_rb.html">lib/rdoc/generator/darkfish.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
<a href="Darkfish.html">Darkfish</a> <a href="../RDoc.html">RDoc</a> HTML
<a href="../Generator.html">Generator</a>
</p>
<p>
$Id: darkfish.rb 52 2009-01-07 02:08:11Z deveiant $
</p>
<h2>Author/s</h2>
<ul>
<li>Michael Granger (ged@FaerieMUD.org)

</li>
</ul>
<h2>Contributors</h2>
<ul>
<li>Mahlon E. Smith (mahlon@martini.nu)

</li>
<li>Eric Hodel (drbrain@segment7.net)

</li>
</ul>
<h2>License</h2>
<p>
Copyright &#169; 2007, 2008, Michael Granger. All rights reserved.
</p>
<p>
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

</li>
<li>Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

</li>
<li>Neither the name of the author/s, nor the names of the project&#8217;s
contributors may be used to endorse or promote products derived from this
software without specific prior written permission.

</li>
</ul>
<p>
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&#8220;AS IS&#8221; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</p>
<h2>Attributions</h2>
<p>
<a href="Darkfish.html">Darkfish</a> uses the <a
href="http://www.famfamfam.com/lab/icons/silk/">Silk Icons</a> set by Mark
James.
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000182">assemble_template</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M000133">class_dir</a>,</li>
                
                <li><a href="#M000150">copy_static</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000130">debug_msg</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000134">file_dir</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000135">gen_sub_directories</a>,</li>
                
                <li><a href="#M000139">generate</a>,</li>
                
                <li><a href="#M000160">generate_class_files</a>,</li>
                
                <li><a href="#M000164">generate_file_files</a>,</li>
                
                <li><a href="#M000157">generate_index</a>,</li>
                
                <li><a href="#M000172">generate_table_of_contents</a>,</li>
                
                <li><a href="#M000155">get_sorted_module_list</a>,</li>
                
                <li><a href="#M000179">get_svninfo</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000129">new</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M000185">render</a>,</li>
                
                <li><a href="#M000186">render_template</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000189">template_for</a>,</li>
                
                <li><a href="#M000187">template_result</a>,</li>
                
                <li><a href="#M000176">time_delta_string</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M000136">write_style_sheet</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <span>ERB::Util</span>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">GENERATOR_DIR</td>
            <td>=</td>
            <td class="attr-value">File.join 'rdoc', 'generator'</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Path to this file&#8217;s parent directory. Used to find templates and
other resources.
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">VERSION</td>
            <td>=</td>
            <td class="attr-value">'3'</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Release Version
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">DESCRIPTION</td>
            <td>=</td>
            <td class="attr-value">'HTML generator, written by Michael Granger'</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Description of this generator
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SVNID_PATTERN</td>
            <td>=</td>
            <td class="attr-value">/     \$Id:\s     (\S+)\s                # filename     (\d+)\s                # rev     (\d{4}-\d{2}-\d{2})\s  # Date (YYYY-MM-DD)     (\d{2}:\d{2}:\d{2}Z)\s # Time (HH:MM:SSZ)     (\w+)\s                # committer     \$$   /x</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
%q$Id: darkfish.rb 52 2009-01-07 02:08:11Z deveiant $&#8220;
</p>
</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>base_dir</td>
            <td class='attr-desc'><p>
The path to generate files into, combined with <tt>--op</tt> from the
options for a full path.
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>outputdir</td>
            <td class='attr-desc'><p>
The output directory
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000129">
                    
                    <a name="M000129"></a><b>new</b>(options)
                    
                </div>
                
                <div class="description">
                  <p>
Initialize a few instance variables before we start
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000129_source')" id="l_M000129_source">show</a>
                        
                    </p>
                    <div id="M000129_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 85</span>
85:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">options</span>
86:     <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
87: 
88:     <span class="ruby-ivar">@template_dir</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">template_dir</span>
89:     <span class="ruby-ivar">@template_cache</span> = {}
90: 
91:     <span class="ruby-ivar">@files</span>      = <span class="ruby-keyword kw">nil</span>
92:     <span class="ruby-ivar">@classes</span>    = <span class="ruby-keyword kw">nil</span>
93: 
94:     <span class="ruby-ivar">@base_dir</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">pwd</span>.<span class="ruby-identifier">expand_path</span>
95: 
96:     <span class="ruby-ivar">@json_index</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Generator</span><span class="ruby-operator">::</span><span class="ruby-constant">JsonIndex</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">options</span>
97:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000133">
                    
                    <a name="M000133"></a><b>class_dir</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Directory where generated class HTML files live relative to the output dir.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000133_source')" id="l_M000133_source">show</a>
                        
                    </p>
                    <div id="M000133_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">class_dir</span>
117:     <span class="ruby-keyword kw">nil</span>
118:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000130">
                    
                    <a name="M000130"></a><b>debug_msg</b>(*msg)
                    
                </div>
                
                <div class="description">
                  <p>
Output progress information if debugging is enabled
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000130_source')" id="l_M000130_source">show</a>
                        
                    </p>
                    <div id="M000130_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug_msg</span> <span class="ruby-operator">*</span><span class="ruby-identifier">msg</span>
108:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$DEBUG_RDOC</span>
109:     <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">msg</span>)
110:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000134">
                    
                    <a name="M000134"></a><b>file_dir</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Directory where generated class HTML files live relative to the output dir.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000134_source')" id="l_M000134_source">show</a>
                        
                    </p>
                    <div id="M000134_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">file_dir</span>
125:     <span class="ruby-keyword kw">nil</span>
126:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000135">
                    
                    <a name="M000135"></a><b>gen_sub_directories</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Create the directories the generated docs will live in if they don&#8217;t
already exist.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000135_source')" id="l_M000135_source">show</a>
                        
                    </p>
                    <div id="M000135_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gen_sub_directories</span>
133:     <span class="ruby-ivar">@outputdir</span>.<span class="ruby-identifier">mkpath</span>
134:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000139">
                    
                    <a name="M000139"></a><b>generate</b>(top_levels)
                    
                </div>
                
                <div class="description">
                  <p>
Build the initial indices and output objects based on an array of <a
href="../TopLevel.html">TopLevel</a> objects containing the extracted
information.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000139_source')" id="l_M000139_source">show</a>
                        
                    </p>
                    <div id="M000139_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate</span> <span class="ruby-identifier">top_levels</span>
165:     <span class="ruby-ivar">@outputdir</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span>).<span class="ruby-identifier">expand_path</span>(<span class="ruby-ivar">@base_dir</span>)
166: 
167:     <span class="ruby-ivar">@files</span> = <span class="ruby-identifier">top_levels</span>.<span class="ruby-identifier">sort</span>
168:     <span class="ruby-ivar">@classes</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">all_classes_and_modules</span>.<span class="ruby-identifier">sort</span>
169:     <span class="ruby-ivar">@methods</span> = <span class="ruby-ivar">@classes</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">method_list</span> }.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">sort</span>
170:     <span class="ruby-ivar">@modsort</span> = <span class="ruby-identifier">get_sorted_module_list</span>(<span class="ruby-ivar">@classes</span>)
171: 
172:     <span class="ruby-comment cmt"># Now actually write the output</span>
173:     <span class="ruby-identifier">write_style_sheet</span>
174:     <span class="ruby-identifier">generate_index</span>
175:     <span class="ruby-identifier">generate_class_files</span>
176:     <span class="ruby-identifier">generate_file_files</span>
177:     <span class="ruby-identifier">generate_table_of_contents</span>
178:     <span class="ruby-ivar">@json_index</span>.<span class="ruby-identifier">generate</span> <span class="ruby-identifier">top_levels</span>
179: 
180:     <span class="ruby-identifier">copy_static</span>
181: 
182:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
183:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;%s: %s\n  %s&quot;</span> <span class="ruby-operator">%</span> [
184:       <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n  &quot;</span>)
185:     ]
186: 
187:     <span class="ruby-identifier">raise</span>
188:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000136">
                    
                    <a name="M000136"></a><b>write_style_sheet</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Copy over the stylesheet into the appropriate place in the output
directory.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000136_source')" id="l_M000136_source">show</a>
                        
                    </p>
                    <div id="M000136_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 140</span>
140:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_style_sheet</span>
141:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;Copying static files&quot;</span>
142:     <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$DEBUG_RDOC</span>, <span class="ruby-identifier">:noop</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> }
143: 
144:     <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'rdoc.css'</span>, <span class="ruby-value str">'.'</span>, <span class="ruby-identifier">options</span>
145: 
146:     <span class="ruby-constant">Dir</span>[(<span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;{js,images}/**/*&quot;</span>).<span class="ruby-identifier">to_s</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
147:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">path</span>
148:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">path</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\./</span>
149: 
150:         <span class="ruby-identifier">dst</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">relative_path_from</span> <span class="ruby-ivar">@template_dir</span>
151: 
152:       <span class="ruby-comment cmt"># I suck at glob</span>
153:       <span class="ruby-identifier">dst_dir</span> = <span class="ruby-identifier">dst</span>.<span class="ruby-identifier">dirname</span>
154:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dst_dir</span>, <span class="ruby-identifier">options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dst_dir</span>
155: 
156:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">path</span>, <span class="ruby-identifier">dst</span>, <span class="ruby-identifier">options</span>
157:     <span class="ruby-keyword kw">end</span>
158:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Protected methods</div>
            
            <div class="method">
                <div class="title" id="M000182">
                    
                    <a name="M000182"></a><b>assemble_template</b>(body_file)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a template from its components and the <tt>body_file</tt>.
</p>
<p>
For backwards compatibility, if <tt>body_file</tt> contains
&#8220;<html&#8221; the body is used directly.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000182_source')" id="l_M000182_source">show</a>
                        
                    </p>
                    <div id="M000182_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 429</span>
429:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assemble_template</span> <span class="ruby-identifier">body_file</span>
430:     <span class="ruby-identifier">body</span> = <span class="ruby-identifier">body_file</span>.<span class="ruby-identifier">read</span>
431:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">body</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">body</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/&lt;html/</span>
432: 
433:     <span class="ruby-identifier">head_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'_head.rhtml'</span>
434:     <span class="ruby-identifier">footer_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'_footer.rhtml'</span>
435: 
436:     <span class="ruby-value str">&quot;&lt;!DOCTYPE html&gt;\n\n&lt;html&gt;\n&lt;head&gt;\n\#{head_file.read}\n\n\#{body}\n\n\#{footer_file.read}\n&quot;</span>
437:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000150">
                    
                    <a name="M000150"></a><b>copy_static</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Copies static files from the static_path into the output directory
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000150_source')" id="l_M000150_source">show</a>
                        
                    </p>
                    <div id="M000150_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 195</span>
195:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">copy_static</span>
196:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">static_path</span>.<span class="ruby-identifier">empty?</span>
197: 
198:     <span class="ruby-identifier">fu_options</span> = { <span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$DEBUG_RDOC</span>, <span class="ruby-identifier">:noop</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> }
199: 
200:     <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">static_path</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
201:       <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">then</span>
202:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">install</span> <span class="ruby-identifier">path</span>, <span class="ruby-ivar">@outputdir</span>, <span class="ruby-identifier">fu_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:mode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0644</span>)
203:         <span class="ruby-keyword kw">next</span>
204:       <span class="ruby-keyword kw">end</span>
205: 
206:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">do</span>
207:         <span class="ruby-constant">Dir</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'**'</span>, <span class="ruby-value str">'*'</span>)].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
208:           <span class="ruby-identifier">dest_file</span> = <span class="ruby-ivar">@outputdir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">entry</span>
209: 
210:           <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">entry</span> <span class="ruby-keyword kw">then</span>
211:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">fu_options</span>
212:           <span class="ruby-keyword kw">else</span>
213:             <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">install</span> <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">dest_file</span>, <span class="ruby-identifier">fu_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:mode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0644</span>)
214:           <span class="ruby-keyword kw">end</span>
215:         <span class="ruby-keyword kw">end</span>
216:       <span class="ruby-keyword kw">end</span>
217:     <span class="ruby-keyword kw">end</span>
218:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000160">
                    
                    <a name="M000160"></a><b>generate_class_files</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Generate a documentation file for each class and module
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000160_source')" id="l_M000160_source">show</a>
                        
                    </p>
                    <div id="M000160_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 270</span>
270:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_class_files</span>
271:     <span class="ruby-identifier">template_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'class.rhtml'</span>
272:     <span class="ruby-identifier">template_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'classpage.rhtml'</span> <span class="ruby-keyword kw">unless</span>
273:       <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">exist?</span>
274:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">exist?</span>
275:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-node">&quot;Generating class documentation in #{@outputdir}&quot;</span>
276: 
277:     <span class="ruby-identifier">current</span> = <span class="ruby-keyword kw">nil</span>
278: 
279:     <span class="ruby-ivar">@classes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
280:       <span class="ruby-identifier">current</span> = <span class="ruby-identifier">klass</span>
281:       <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;  working on %s (%s)&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">path</span>]
282:       <span class="ruby-identifier">out_file</span>   = <span class="ruby-ivar">@outputdir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">path</span>
283:       <span class="ruby-comment cmt"># suppress 1.9.3 warning</span>
284:       <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-ivar">@outputdir</span>.<span class="ruby-identifier">relative_path_from</span>(<span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">dirname</span>)
285:       <span class="ruby-identifier">svninfo</span>    = <span class="ruby-identifier">svninfo</span>    = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_svninfo</span>(<span class="ruby-identifier">klass</span>)
286:       <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;#{klass.type} #{klass.full_name} - #{@options.title}&quot;</span>
287: 
288:       <span class="ruby-identifier">debug_msg</span> <span class="ruby-node">&quot;  rendering #{out_file}&quot;</span>
289:       <span class="ruby-identifier">render_template</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-identifier">out_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-identifier">binding</span> <span class="ruby-keyword kw">end</span>
290:     <span class="ruby-keyword kw">end</span>
291:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
292:     <span class="ruby-identifier">error</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> \
293:       <span class="ruby-node">&quot;error generating #{current.path}: #{e.message} (#{e.class})&quot;</span>
294:     <span class="ruby-identifier">error</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
295: 
296:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">error</span>
297:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000164">
                    
                    <a name="M000164"></a><b>generate_file_files</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Generate a documentation file for each file
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000164_source')" id="l_M000164_source">show</a>
                        
                    </p>
                    <div id="M000164_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 302</span>
302:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_file_files</span>
303:     <span class="ruby-identifier">page_file</span>     = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'page.rhtml'</span>
304:     <span class="ruby-identifier">fileinfo_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'fileinfo.rhtml'</span>
305: 
306:     <span class="ruby-comment cmt"># for legacy templates</span>
307:     <span class="ruby-identifier">filepage_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'filepage.rhtml'</span> <span class="ruby-keyword kw">unless</span>
308:       <span class="ruby-identifier">page_file</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">fileinfo_file</span>.<span class="ruby-identifier">exist?</span>
309: 
310:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span>
311:       <span class="ruby-identifier">page_file</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">fileinfo_file</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">exist?</span>
312:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-node">&quot;Generating file documentation in #{@outputdir}&quot;</span>
313: 
314:     <span class="ruby-identifier">out_file</span> = <span class="ruby-keyword kw">nil</span>
315: 
316:     <span class="ruby-ivar">@files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
317:       <span class="ruby-identifier">template_file</span> = <span class="ruby-keyword kw">nil</span>
318:       <span class="ruby-identifier">out_file</span> = <span class="ruby-ivar">@outputdir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">path</span>
319:       <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;  working on %s (%s)&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">file</span>.<span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">out_file</span>]
320:       <span class="ruby-comment cmt"># suppress 1.9.3 warning</span>
321:       <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-ivar">@outputdir</span>.<span class="ruby-identifier">relative_path_from</span>(<span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">dirname</span>)
322: 
323:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">filepage_file</span> <span class="ruby-keyword kw">then</span>
324:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">text?</span> <span class="ruby-keyword kw">then</span>
325:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">page_file</span>.<span class="ruby-identifier">exist?</span>
326:           <span class="ruby-identifier">template_file</span> = <span class="ruby-identifier">page_file</span>
327:           <span class="ruby-ivar">@title</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">page_name</span>
328:         <span class="ruby-keyword kw">else</span>
329:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">fileinfo_file</span>.<span class="ruby-identifier">exist?</span>
330:           <span class="ruby-identifier">template_file</span> = <span class="ruby-identifier">fileinfo_file</span>
331:           <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;File: #{file.base_name}&quot;</span>
332:         <span class="ruby-keyword kw">end</span>
333:       <span class="ruby-keyword kw">end</span>
334: 
335:       <span class="ruby-ivar">@title</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot; - #{@options.title}&quot;</span>
336:       <span class="ruby-identifier">template_file</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">filepage_file</span>
337: 
338:       <span class="ruby-identifier">render_template</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-identifier">out_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-identifier">binding</span> <span class="ruby-keyword kw">end</span>
339:     <span class="ruby-keyword kw">end</span>
340:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
341:     <span class="ruby-identifier">error</span> =
342:       <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> <span class="ruby-node">&quot;error generating #{out_file}: #{e.message} (#{e.class})&quot;</span>
343:     <span class="ruby-identifier">error</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
344: 
345:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">error</span>
346:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000157">
                    
                    <a name="M000157"></a><b>generate_index</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Generate an index page which lists all the classes which are documented.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000157_source')" id="l_M000157_source">show</a>
                        
                    </p>
                    <div id="M000157_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_index</span>
248:     <span class="ruby-identifier">template_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'index.rhtml'</span>
249:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">exist?</span>
250: 
251:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;Rendering the index page...&quot;</span>
252: 
253:     <span class="ruby-identifier">out_file</span> = <span class="ruby-ivar">@base_dir</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'index.html'</span>
254:     <span class="ruby-comment cmt"># suppress 1.9.3 warning</span>
255:     <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-ivar">@outputdir</span>.<span class="ruby-identifier">relative_path_from</span>(<span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">dirname</span>)
256:     <span class="ruby-ivar">@title</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">title</span>
257: 
258:     <span class="ruby-identifier">render_template</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-identifier">out_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-identifier">binding</span> <span class="ruby-keyword kw">end</span>
259:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
260:     <span class="ruby-identifier">error</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> \
261:       <span class="ruby-node">&quot;error generating index.html: #{e.message} (#{e.class})&quot;</span>
262:     <span class="ruby-identifier">error</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
263: 
264:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">error</span>
265:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000172">
                    
                    <a name="M000172"></a><b>generate_table_of_contents</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Generate an index page which lists all the classes which are documented.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000172_source')" id="l_M000172_source">show</a>
                        
                    </p>
                    <div id="M000172_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 351</span>
351:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_table_of_contents</span>
352:     <span class="ruby-identifier">template_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'table_of_contents.rhtml'</span>
353:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">exist?</span>
354: 
355:     <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;Rendering the Table of Contents...&quot;</span>
356: 
357:     <span class="ruby-identifier">out_file</span> = <span class="ruby-ivar">@outputdir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'table_of_contents.html'</span>
358:     <span class="ruby-comment cmt"># suppress 1.9.3 warning</span>
359:     <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-identifier">rel_prefix</span> = <span class="ruby-ivar">@outputdir</span>.<span class="ruby-identifier">relative_path_from</span>(<span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">dirname</span>)
360:     <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;Table of Contents - #{@options.title}&quot;</span>
361: 
362:     <span class="ruby-identifier">render_template</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-identifier">out_file</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-identifier">binding</span> <span class="ruby-keyword kw">end</span>
363:   <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
364:     <span class="ruby-identifier">error</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> \
365:       <span class="ruby-node">&quot;error generating table_of_contents.html: #{e.message} (#{e.class})&quot;</span>
366:     <span class="ruby-identifier">error</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
367: 
368:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">error</span>
369:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000155">
                    
                    <a name="M000155"></a><b>get_sorted_module_list</b>(classes)
                    
                </div>
                
                <div class="description">
                  <p>
Return a list of the documented modules sorted by salience first, then by
name.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000155_source')" id="l_M000155_source">show</a>
                        
                    </p>
                    <div id="M000155_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 224</span>
224:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_sorted_module_list</span>(<span class="ruby-identifier">classes</span>)
225:     <span class="ruby-identifier">nscounts</span> = <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">counthash</span>, <span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
226:       <span class="ruby-identifier">top_level</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">full_name</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/::.*/</span>, <span class="ruby-value str">''</span>)
227:       <span class="ruby-identifier">counthash</span>[<span class="ruby-identifier">top_level</span>] <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>
228:       <span class="ruby-identifier">counthash</span>[<span class="ruby-identifier">top_level</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
229: 
230:       <span class="ruby-identifier">counthash</span>
231:     <span class="ruby-keyword kw">end</span>
232: 
233:     <span class="ruby-comment cmt"># Sort based on how often the top level namespace occurs, and then on the</span>
234:     <span class="ruby-comment cmt"># name of the module -- this works for projects that put their stuff into</span>
235:     <span class="ruby-comment cmt"># a namespace, of course, but doesn't hurt if they don't.</span>
236:     <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">sort_by</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
237:       <span class="ruby-identifier">top_level</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">full_name</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/::.*/</span>, <span class="ruby-value str">''</span> )
238:       [<span class="ruby-identifier">nscounts</span>[<span class="ruby-identifier">top_level</span>] <span class="ruby-operator">*</span> <span class="ruby-value">-1</span>, <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">full_name</span>]
239:     <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
240:       <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">display?</span>
241:     <span class="ruby-keyword kw">end</span>
242:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000179">
                    
                    <a name="M000179"></a><b>get_svninfo</b>(klass)
                    
                </div>
                
                <div class="description">
                  <p>
Try to extract Subversion information out of the first constant whose value
looks like a subversion Id tag. If no matching constant is found, and empty
hash is returned.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000179_source')" id="l_M000179_source">show</a>
                        
                    </p>
                    <div id="M000179_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 406</span>
406:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_svninfo</span> <span class="ruby-identifier">klass</span>
407:     <span class="ruby-identifier">constants</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">constants</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">return</span> {}
408: 
409:     <span class="ruby-identifier">constants</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">value</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">SVNID_PATTERN</span> } <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">return</span> {}
410: 
411:     <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">rev</span>, <span class="ruby-identifier">date</span>, <span class="ruby-identifier">time</span>, <span class="ruby-identifier">committer</span> = <span class="ruby-identifier">$~</span>.<span class="ruby-identifier">captures</span>
412:     <span class="ruby-identifier">commitdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span> <span class="ruby-node">&quot;#{date} #{time}&quot;</span>
413: 
414:     <span class="ruby-keyword kw">return</span> {
415:       <span class="ruby-identifier">:filename</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">filename</span>,
416:       <span class="ruby-identifier">:rev</span>         =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">rev</span>),
417:       <span class="ruby-identifier">:commitdate</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">commitdate</span>,
418:       <span class="ruby-identifier">:commitdelta</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">time_delta_string</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">commitdate</span>),
419:       <span class="ruby-identifier">:committer</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">committer</span>,
420:     }
421:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000185">
                    
                    <a name="M000185"></a><b>render</b>(file_name)
                    
                </div>
                
                <div class="description">
                  <p>
Renders the ERb contained in <tt>file_name</tt> relative to the template
directory and returns the result based on the current context.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000185_source')" id="l_M000185_source">show</a>
                        
                    </p>
                    <div id="M000185_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 454</span>
454:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render</span> <span class="ruby-identifier">file_name</span>
455:     <span class="ruby-identifier">template_file</span> = <span class="ruby-ivar">@template_dir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">file_name</span>
456: 
457:     <span class="ruby-identifier">template</span> = <span class="ruby-identifier">template_for</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-constant">ERB</span>
458: 
459:     <span class="ruby-identifier">template</span>.<span class="ruby-identifier">filename</span> = <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">to_s</span>
460: 
461:     <span class="ruby-identifier">template</span>.<span class="ruby-identifier">result</span> <span class="ruby-ivar">@context</span>
462:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000186">
                    
                    <a name="M000186"></a><b>render_template</b>(template_file, out_file)
                    
                </div>
                
                <div class="description">
                  <p>
Load and render the erb template in the given <tt>template_file</tt> and
write it out to <tt>out_file</tt>.
</p>
<p>
Both <tt>template_file</tt> and <tt>out_file</tt> should be Pathname-like
objects.
</p>
<p>
An io will be yielded which must be captured by binding in the caller.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000186_source')" id="l_M000186_source">show</a>
                        
                    </p>
                    <div id="M000186_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 472</span>
472:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render_template</span> <span class="ruby-identifier">template_file</span>, <span class="ruby-identifier">out_file</span> <span class="ruby-comment cmt"># :yield: io</span>
473:     <span class="ruby-identifier">template</span> = <span class="ruby-identifier">template_for</span> <span class="ruby-identifier">template_file</span>
474: 
475:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword kw">then</span>
476:       <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;Outputting to %s&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">expand_path</span>]
477: 
478:       <span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">dirname</span>.<span class="ruby-identifier">mkpath</span>
479:       <span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">open</span> <span class="ruby-value str">'w'</span>, <span class="ruby-value">0644</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
480:         <span class="ruby-identifier">io</span>.<span class="ruby-identifier">set_encoding</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">encoding</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_defined?</span> <span class="ruby-identifier">:Encoding</span>
481: 
482:         <span class="ruby-ivar">@context</span> = <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">io</span>
483: 
484:         <span class="ruby-identifier">template_result</span> <span class="ruby-identifier">template</span>, <span class="ruby-ivar">@context</span>, <span class="ruby-identifier">template_file</span>
485:       <span class="ruby-keyword kw">end</span>
486:     <span class="ruby-keyword kw">else</span>
487:       <span class="ruby-ivar">@context</span> = <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">nil</span>
488: 
489:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">template_result</span> <span class="ruby-identifier">template</span>, <span class="ruby-ivar">@context</span>, <span class="ruby-identifier">template_file</span>
490: 
491:       <span class="ruby-identifier">debug_msg</span> <span class="ruby-value str">&quot;  would have written %d characters to %s&quot;</span> <span class="ruby-operator">%</span> [
492:         <span class="ruby-identifier">output</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">out_file</span>.<span class="ruby-identifier">expand_path</span>
493:       ]
494:     <span class="ruby-keyword kw">end</span>
495:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000189">
                    
                    <a name="M000189"></a><b>template_for</b>(file, page = true, klass = nil)
                    
                </div>
                
                <div class="description">
                  <p>
Retrieves a cache template for <tt>file</tt>, if present, or fills the
cache.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000189_source')" id="l_M000189_source">show</a>
                        
                    </p>
                    <div id="M000189_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 514</span>
514:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">template_for</span> <span class="ruby-identifier">file</span>, <span class="ruby-identifier">page</span> = <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">klass</span> = <span class="ruby-keyword kw">nil</span>
515:     <span class="ruby-identifier">template</span> = <span class="ruby-ivar">@template_cache</span>[<span class="ruby-identifier">file</span>]
516: 
517:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">template</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">template</span>
518: 
519:     <span class="ruby-identifier">klass</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-value">? </span><span class="ruby-constant">ERB</span> <span class="ruby-operator">:</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">ERBIO</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">klass</span>
520: 
521:     <span class="ruby-identifier">template</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">page</span> <span class="ruby-keyword kw">then</span>
522:                  <span class="ruby-identifier">assemble_template</span> <span class="ruby-identifier">file</span>
523:                <span class="ruby-keyword kw">else</span>
524:                  <span class="ruby-identifier">file</span>.<span class="ruby-identifier">read</span>
525:                <span class="ruby-keyword kw">end</span>
526: 
527:     <span class="ruby-identifier">template</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">template</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">'&lt;&gt;'</span>
528:     <span class="ruby-ivar">@template_cache</span>[<span class="ruby-identifier">file</span>] = <span class="ruby-identifier">template</span>
529:     <span class="ruby-identifier">template</span>
530:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000187">
                    
                    <a name="M000187"></a><b>template_result</b>(template, context, template_file)
                    
                </div>
                
                <div class="description">
                  <p>
Creates the result for <tt>template</tt> with <tt>context</tt>. If an error
is raised a Pathname <tt>template_file</tt> will indicate the file where
the error occurred.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000187_source')" id="l_M000187_source">show</a>
                        
                    </p>
                    <div id="M000187_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 501</span>
501:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">template_result</span> <span class="ruby-identifier">template</span>, <span class="ruby-identifier">context</span>, <span class="ruby-identifier">template_file</span>
502:     <span class="ruby-identifier">template</span>.<span class="ruby-identifier">filename</span> = <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">to_s</span>
503:     <span class="ruby-identifier">template</span>.<span class="ruby-identifier">result</span> <span class="ruby-identifier">context</span>
504:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
505:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Error while evaluating %s: %s&quot;</span> <span class="ruby-operator">%</span> [
506:       <span class="ruby-identifier">template_file</span>.<span class="ruby-identifier">expand_path</span>,
507:       <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>,
508:     ], <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
509:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000176">
                    
                    <a name="M000176"></a><b>time_delta_string</b>(seconds)
                    
                </div>
                
                <div class="description">
                  <p>
Return a string describing the amount of time in the given number of
seconds in terms a human can understand easily.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000176_source')" id="l_M000176_source">show</a>
                        
                    </p>
                    <div id="M000176_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rdoc/generator/darkfish.rb, line 375</span>
375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">time_delta_string</span> <span class="ruby-identifier">seconds</span>
376:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'less than a minute'</span>          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">60</span>
377:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 60} minute#{seconds / 60 == 1 ? '' : 's'}&quot;</span> <span class="ruby-keyword kw">if</span>
378:                                             <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">3000</span>     <span class="ruby-comment cmt"># 50 minutes</span>
379:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'about one hour'</span>              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">5400</span>     <span class="ruby-comment cmt"># 90 minutes</span>
380:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 3600} hours&quot;</span>     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">64800</span>    <span class="ruby-comment cmt"># 18 hours</span>
381:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'one day'</span>                     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">86400</span>    <span class="ruby-comment cmt">#  1 day</span>
382:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'about one day'</span>               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">172800</span>   <span class="ruby-comment cmt">#  2 days</span>
383:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 86400} days&quot;</span>     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">604800</span>   <span class="ruby-comment cmt">#  1 week</span>
384:     <span class="ruby-keyword kw">return</span> <span class="ruby-value str">'about one week'</span>              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1209600</span>  <span class="ruby-comment cmt">#  2 week</span>
385:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 604800} weeks&quot;</span>   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">7257600</span>  <span class="ruby-comment cmt">#  3 months</span>
386:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 2419200} months&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">seconds</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">31536000</span> <span class="ruby-comment cmt">#  1 year</span>
387:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{seconds / 31536000} years&quot;</span>
388:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    