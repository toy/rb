<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Object</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Object 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M000001">foreach_proc_entry</a>,</li>
                
                <li><a href="#M000000">func_name</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M000005">gen_callback_file</a>,</li>
                
                <li><a href="#M000004">gen_push_addr_ary</a>,</li>
                
                <li><a href="#M000003">gen_push_proc_ary</a>,</li>
                
                <li><a href="#M000002">gencallback</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000001">
                    
                    <a name="M000001"></a><b>foreach_proc_entry</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000001_source')" id="l_M000001_source">show</a>
                        
                    </p>
                    <div id="M000001_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 110</span>
110: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">foreach_proc_entry</span>
111:   <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">calltype</span> <span class="ruby-keyword kw">in</span> <span class="ruby-constant">CALLTYPES</span>
112:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">calltype</span>
113:     <span class="ruby-keyword kw">when</span> <span class="ruby-constant">CDECL</span>
114:       <span class="ruby-identifier">proc_entry</span> = <span class="ruby-value str">&quot;rb_DLCdeclCallbackProcs&quot;</span>
115:     <span class="ruby-keyword kw">when</span> <span class="ruby-constant">STDCALL</span>
116:       <span class="ruby-identifier">proc_entry</span> = <span class="ruby-value str">&quot;rb_DLStdcallCallbackProcs&quot;</span>
117:     <span class="ruby-keyword kw">else</span>
118:       <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unknown calltype: #{calltype}&quot;</span>
119:     <span class="ruby-keyword kw">end</span>
120:     <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">calltype</span>, <span class="ruby-identifier">proc_entry</span>
121:   <span class="ruby-keyword kw">end</span>
122: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000000">
                    
                    <a name="M000000"></a><b>func_name</b>(ty, argc, n, calltype)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000000_source')" id="l_M000000_source">show</a>
                        
                    </p>
                    <div id="M000000_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 91</span>
91: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">func_name</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">n</span>, <span class="ruby-identifier">calltype</span>)
92:   <span class="ruby-node">&quot;rb_dl_callback_#{DLTYPE[ty][:name]}_#{argc}_#{n}_#{calltype}&quot;</span>
93: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000005">
                    
                    <a name="M000005"></a><b>gen_callback_file</b>(ty)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000005_source')" id="l_M000005_source">show</a>
                        
                    </p>
                    <div id="M000005_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 171</span>
171: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gen_callback_file</span>(<span class="ruby-identifier">ty</span>)
172:   <span class="ruby-identifier">filename</span> = <span class="ruby-node">&quot;#{$output}-#{ty}.c&quot;</span>
173:   <span class="ruby-identifier">initname</span> = <span class="ruby-node">&quot;rb_dl_init_callbacks_#{ty}&quot;</span>
174:   <span class="ruby-identifier">body</span> = <span class="ruby-value str">&quot;#include \&quot;dl.h\&quot;\n\nextern VALUE rb_DLCdeclCallbackAddrs, rb_DLCdeclCallbackProcs;\n#ifdef FUNC_STDCALL\nextern VALUE rb_DLStdcallCallbackAddrs, rb_DLStdcallCallbackProcs;\n#endif\nextern ID   rb_dl_cb_call;\n&quot;</span>
175:   <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">body</span>
176:   <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;void\n\#{initname}()\n{\n\#{gen_push_proc_ary(ty, \&quot;rb_DLCdeclCallbackProcs\&quot;)}\n\#{gen_push_addr_ary(ty, \&quot;rb_DLCdeclCallbackAddrs\&quot;, CDECL)}\n#ifdef FUNC_STDCALL\n\#{gen_push_proc_ary(ty, \&quot;rb_DLStdcallCallbackProcs\&quot;)}\n\#{gen_push_addr_ary(ty, \&quot;rb_DLStdcallCallbackAddrs\&quot;, STDCALL)}\n#endif\n}\n&quot;</span>
177:   [<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">initname</span>, <span class="ruby-identifier">body</span>]
178: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000004">
                    
                    <a name="M000004"></a><b>gen_push_addr_ary</b>(ty, aryname, calltype)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000004_source')" id="l_M000004_source">show</a>
                        
                    </p>
                    <div id="M000004_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 161</span>
161: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gen_push_addr_ary</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">aryname</span>, <span class="ruby-identifier">calltype</span>)
162:   <span class="ruby-identifier">sprintf</span>(<span class="ruby-node">&quot;    rb_ary_push(#{aryname}, rb_ary_new3(%d,%s));&quot;</span>,
163:           <span class="ruby-constant">MAX_CALLBACK</span> <span class="ruby-operator">*</span> <span class="ruby-constant">DLSTACK_SIZE</span>,
164:           (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-constant">MAX_CALLBACK</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
165:             (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-constant">DLSTACK_SIZE</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">argc</span><span class="ruby-operator">|</span>
166:               <span class="ruby-value str">&quot;PTR2NUM(%s)&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">func_name</span>(<span class="ruby-identifier">ty</span>,<span class="ruby-identifier">argc</span>,<span class="ruby-identifier">i</span>,<span class="ruby-identifier">calltype</span>)
167:             }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)
168:           }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>))
169: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000003">
                    
                    <a name="M000003"></a><b>gen_push_proc_ary</b>(ty, aryname)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000003_source')" id="l_M000003_source">show</a>
                        
                    </p>
                    <div id="M000003_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 153</span>
153: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gen_push_proc_ary</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">aryname</span>)
154:   <span class="ruby-identifier">sprintf</span>(<span class="ruby-node">&quot;    rb_ary_push(#{aryname}, rb_ary_new3(%d,%s));&quot;</span>,
155:           <span class="ruby-constant">MAX_CALLBACK</span> <span class="ruby-operator">*</span> <span class="ruby-constant">DLSTACK_SIZE</span>,
156:           (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-constant">MAX_CALLBACK</span>).<span class="ruby-identifier">collect</span>{
157:             (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-constant">DLSTACK_SIZE</span>).<span class="ruby-identifier">collect</span>{ <span class="ruby-value str">&quot;Qnil&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)
158:           }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>))
159: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000002">
                    
                    <a name="M000002"></a><b>gencallback</b>(ty, calltype, proc_entry, argc, n)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000002_source')" id="l_M000002_source">show</a>
                        
                    </p>
                    <div id="M000002_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/dl/callback/mkcallback.rb, line 124</span>
124: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gencallback</span>(<span class="ruby-identifier">ty</span>, <span class="ruby-identifier">calltype</span>, <span class="ruby-identifier">proc_entry</span>, <span class="ruby-identifier">argc</span>, <span class="ruby-identifier">n</span>)
125:   <span class="ruby-value str">&quot;\#{calltype == STDCALL ? \&quot;\\n#ifdef FUNC_STDCALL\&quot; : \&quot;\&quot;}\nstatic \#{DLTYPE[ty][:type]}\nFUNC_\#{calltype.upcase}(\#{func_name(ty,argc,n,calltype)})(\#{(0...argc).collect{|i| \&quot;DLSTACK_TYPE stack\&quot; + i.to_s}.join(\&quot;, \&quot;)})\n{\nVALUE ret, cb\#{argc &gt; 0 ? \&quot;, args[\#{argc}]\&quot; : \&quot;\&quot;};\n\#{\nsizeof_voidp = [\&quot;\&quot;].pack('p').size\nsizeof_long = [0].pack('l!').size\n(0...argc).collect{|i|\nif sizeof_voidp == sizeof_long\n\&quot;    args[%d] = LONG2NUM(stack%d);\&quot; % [i,i]\nelsif sizeof_voidp == 8 # should get sizeof_long_long...\n\&quot;    args[%d] = LL2NUM(stack%d);\&quot; % [i,i]\nelse\nraise \&quot;unknown size of void*\&quot;\nend\n}.join(\&quot;\\n\&quot;)\n}\ncb = rb_ary_entry(rb_ary_entry(\#{proc_entry}, \#{ty}), \#{(n * DLSTACK_SIZE) + argc});\nret = rb_funcall2(cb, rb_dl_cb_call, \#{argc}, \#{argc &gt; 0 ? 'args' : 'NULL'});\nreturn \#{DLTYPE[ty][:conv] ? DLTYPE[ty][:conv] % \&quot;ret\&quot; : \&quot;\&quot;};\n}\n\#{calltype == STDCALL ? \&quot;#endif\\n\&quot; : \&quot;\&quot;}\n&quot;</span>
126: <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    