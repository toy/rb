<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ICU::UCharsetDetector</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            ICU::UCharsetDetector 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/uchardet_rb.html">lib/uchardet.rb</a></li>
            
            <li><a href="../../files/ext/uchardet/uchardet_c.html">ext/uchardet/uchardet.c</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M000011">declared_encoding</a>,</li>
                
                <li><a href="#M000012">declared_encoding=</a>,</li>
                
                <li><a href="#M000013">detect</a>,</li>
                
                <li><a href="#M000001">detect</a>,</li>
                
                <li><a href="#M000014">detect_all</a>,</li>
                
                <li><a href="#M000002">detect_all</a>,</li>
                
                <li><a href="#M000003">detectable_charsets</a>,</li>
                
                <li><a href="#M000015">detectable_charsets</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M000008">input_filtered=</a>,</li>
                
                <li><a href="#M000007">input_filtered?</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M000006">new</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M000009">text</a>,</li>
                
                <li><a href="#M000010">text=</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M000001">
                    
                    <a name="M000001"></a><b>detect</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Shortcut for <a
href="UCharsetDetector.html#M000001">ICU::UCharsetDetector#detect</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000001_source')" id="l_M000001_source">show</a>
                        
                    </p>
                    <div id="M000001_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/uchardet.rb, line 19</span>
19:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">detect</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
20:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">detect</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
21:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000002">
                    
                    <a name="M000002"></a><b>detect_all</b>(*args)
                    
                </div>
                
                <div class="description">
                  <p>
Shortcut for <a
href="UCharsetDetector.html#M000002">ICU::UCharsetDetector#detect_all</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000002_source')" id="l_M000002_source">show</a>
                        
                    </p>
                    <div id="M000002_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/uchardet.rb, line 26</span>
26:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">detect_all</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
27:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">detect_all</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
28:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000003">
                    
                    <a name="M000003"></a><b>detectable_charsets</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Shortcut for <a
href="UCharsetDetector.html#M000003">ICU::UCharsetDetector#detectable_charsets</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000003_source')" id="l_M000003_source">show</a>
                        
                    </p>
                    <div id="M000003_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/uchardet.rb, line 33</span>
33:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">detectable_charsets</span>
34:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">detectable_charsets</span>
35:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000006">
                    
                    <a name="M000006"></a><b>new(text=nil, declared_encoding=nil)
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Create a new charset detector. Optionally set the input text and declared
encoding.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000006_source')" id="l_M000006_source">show</a>
                        
                    </p>
                    <div id="M000006_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_initialize(int argc, VALUE *argv, VALUE self)
{
    VALUE text;
    VALUE declared_encoding;
    
    rb_scan_args(argc, argv, &quot;02&quot;, &amp;text, &amp;declared_encoding);
    if (NIL_P(text))
        UCharsetDetector_set_text(self, Qnil);
    else
        set_text(self, text);
    
    if (NIL_P(declared_encoding))
        UCharsetDetector_set_declared_encoding(self, Qnil);
    else
        set_declared_encoding(self, declared_encoding);
    
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000011">
                    
                    <a name="M000011"></a><b>declared_encoding
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Get the declared encoding for charset detection.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_get_declared_encoding(VALUE self)
{
    return rb_iv_get(self, &quot;@declared_encoding&quot;);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000012">
                    
                    <a name="M000012"></a><b>declared_encoding=
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Set the declared encoding for charset detection. The declared encoding of
an input text is an encoding obtained by the user from an http header or
xml declaration or similar source that can be provided as an additional
hint to the charset detector.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_set_declared_encoding(VALUE self, VALUE declared_encoding)
{
    return rb_iv_set(self, &quot;@declared_encoding&quot;, declared_encoding);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000013">
                    
                    <a name="M000013"></a><b>detect(text=nil, declared_encoding=nil)
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Return the charset that best matches the supplied input data.
</p>
<p>
Note though, that because the detection only looks at the start of the
input data, there is a possibility that the returned charset will fail to
handle the full set of input data.
</p>
<p>
The function will fail if
</p>
<ul>
<li>no charset appears to match the data

</li>
<li>no input text has been provided (with <tt>text</tt> or set with <a
href="UCharsetDetector.html#M000010">text=</a> )

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000013_source')" id="l_M000013_source">show</a>
                        
                    </p>
                    <div id="M000013_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_detect(int argc, VALUE *argv, VALUE self)
{
    VALUE text;
    VALUE declared_encoding;
    
    rb_scan_args(argc, argv, &quot;02&quot;, &amp;text, &amp;declared_encoding);
    set_text(self, text);
    set_declared_encoding(self, declared_encoding);
    
    UErrorCode status = U_ZERO_ERROR;
    UCharsetDetector *detector;
    Data_Get_Struct(self, UCharsetDetector, detector);
    
    const UCharsetMatch *match = ucsdet_detect(detector, &amp;status);
    ensure(status);
        
    const char *encoding_name = ucsdet_getName(match, &amp;status);
    ensure(status);

    int32_t encoding_confidence = ucsdet_getConfidence(match, &amp;status);
    ensure(status);
        
    const char *encoding_language = ucsdet_getLanguage(match, &amp;status);
    ensure(status);
        
    VALUE hash = rb_hash_new();
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;encoding&quot;)), rb_str_new2(encoding_name));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;confidence&quot;)), INT2NUM(encoding_confidence));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;language&quot;)), rb_str_new2(encoding_language));
    
    return hash;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000014">
                    
                    <a name="M000014"></a><b>detect_all(text=nil, declared_encoding=nil)
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Find all charset matches that appear to be consistent with the input,
returning an array of results. The results are ordered with the best
quality match first.
</p>
<p>
Because the detection only looks at a limited amount of the input byte
data, some of the returned charsets may fail to handle the all of input
data.
</p>
<p>
Return an error if
</p>
<ul>
<li>no charset appears to match the data

</li>
<li>no input text has been provided (with <tt>text</tt> or set with <a
href="UCharsetDetector.html#M000010">text=</a> )

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_detect_all(int argc, VALUE *argv, VALUE self)
{
    VALUE text;
    VALUE declared_encoding;
    
    rb_scan_args(argc, argv, &quot;02&quot;, &amp;text, &amp;declared_encoding);
    set_text(self, text);
    set_declared_encoding(self, declared_encoding);
    
    UCharsetDetector *detector;
    Data_Get_Struct(self, UCharsetDetector, detector);
    UErrorCode status = U_ZERO_ERROR;
    int32_t matches_found;
    
    const UCharsetMatch **matches = ucsdet_detectAll(detector, &amp;matches_found, &amp;status);
    ensure(status);
    
    VALUE ary = rb_ary_new();
    int i = 0;
    
    for (i = 0; i &lt; matches_found; i++) {
        const char *encoding_name = ucsdet_getName(matches[i], &amp;status);
        ensure(status);

        int32_t encoding_confidence = ucsdet_getConfidence(matches[i], &amp;status);
        ensure(status);
        
        const char *encoding_language = ucsdet_getLanguage(matches[i], &amp;status);
        ensure(status);
        
        VALUE hash = rb_hash_new();
        rb_hash_aset(hash, ID2SYM(rb_intern(&quot;encoding&quot;)), rb_str_new2(encoding_name));
        rb_hash_aset(hash, ID2SYM(rb_intern(&quot;confidence&quot;)), INT2NUM(encoding_confidence));
        rb_hash_aset(hash, ID2SYM(rb_intern(&quot;language&quot;)), rb_str_new2(encoding_language));
        
        rb_ary_push(ary, hash);
    }
    
    return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000015">
                    
                    <a name="M000015"></a><b>detectable_charsets
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Get array of names of all detectable charsets that are known to the charset
detection service.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_get_detectable_charsets(VALUE self)
{
    UCharsetDetector *detector;
    Data_Get_Struct(self, UCharsetDetector, detector);
    UErrorCode status = U_ZERO_ERROR;
    
    UEnumeration *charsets = ucsdet_getAllDetectableCharsets(detector, &amp;status);
    ensure(status);
    
    VALUE ary = rb_ary_new();
    int32_t result_length;
    const char *charset_name;
    
    while (charset_name = uenum_next(charsets, &amp;result_length, &amp;status)) {
        ensure(status);
        rb_ary_push(ary, rb_str_new2(charset_name));
    }
    uenum_close(charsets);
    
    return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000008">
                    
                    <a name="M000008"></a><b>input_filtered=
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Enable filtering of input text. If filtering is enabled, text within angle
brackets (&#8220;<&#8221; and &#8220;>&#8221;) will be removed before
detection, which will remove most HTML or xml markup.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000008_source')" id="l_M000008_source">show</a>
                        
                    </p>
                    <div id="M000008_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_set_input_filtered(VALUE self, VALUE flag)
{
    UCharsetDetector *detector;
    Data_Get_Struct(self, UCharsetDetector, detector);
    
    ucsdet_enableInputFilter(detector, RTEST(flag) ? TRUE : FALSE);
    return self;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000007">
                    
                    <a name="M000007"></a><b>input_filtered
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Return filtering flag value this charset detector.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_get_input_filtered(VALUE self)
{
    UCharsetDetector *detector;
    Data_Get_Struct(self, UCharsetDetector, detector);
    
    return ucsdet_isInputFilterEnabled(detector) ? Qtrue : Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000009">
                    
                    <a name="M000009"></a><b>text
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Get input text for this detector.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000009_source')" id="l_M000009_source">show</a>
                        
                    </p>
                    <div id="M000009_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_get_text(VALUE self)
{
    return rb_iv_get(self, &quot;@text&quot;);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M000010">
                    
                    <a name="M000010"></a><b>text=
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Set input text for this detector.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000010_source')" id="l_M000010_source">show</a>
                        
                    </p>
                    <div id="M000010_source" class="dyn-source">
                        <pre>static VALUE
UCharsetDetector_set_text(VALUE self, VALUE text)
{
    return rb_iv_set(self, &quot;@text&quot;, text);
}</pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    